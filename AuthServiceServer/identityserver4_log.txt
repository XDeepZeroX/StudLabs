2019-03-02 22:52:08.643 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-02 23:08:02.757 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-02 23:08:02.925 +04:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-02 23:08:02.979 +04:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-03-02 23:08:02.981 +04:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-03-02 23:08:02.982 +04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-03-02 23:08:02.983 +04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-03-02 23:08:02.983 +04:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-03-02 23:08:02.984 +04:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-03-02 23:08:04.468 +04:00 [DBG] Login Url: /Acc/Login
2019-03-02 23:08:04.483 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-02 23:08:04.495 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-02 23:08:04.496 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-02 23:08:04.502 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-02 23:08:04.504 +04:00 [DBG] Error Url: /home/error
2019-03-02 23:08:04.506 +04:00 [DBG] Error Id Parameter: errorId
2019-03-02 23:08:04.706 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-02 23:08:49.680 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-02 23:08:49.851 +04:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-02 23:08:49.911 +04:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-03-02 23:08:49.913 +04:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-03-02 23:08:49.913 +04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-03-02 23:08:49.914 +04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-03-02 23:08:49.915 +04:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-03-02 23:08:49.915 +04:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-03-02 23:08:51.434 +04:00 [DBG] Login Url: /Acc/Login
2019-03-02 23:08:51.477 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-02 23:08:51.484 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-02 23:08:51.496 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-02 23:08:51.507 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-02 23:08:51.512 +04:00 [DBG] Error Url: /home/error
2019-03-02 23:08:51.522 +04:00 [DBG] Error Id Parameter: errorId
2019-03-02 23:08:51.767 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-02 23:09:00.767 +04:00 [INF] AuthenticationScheme: idsrv was challenged.
2019-03-02 23:33:11.339 +04:00 [ERR] Failed executing DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoles] (
    [Id] nvarchar(450) NOT NULL,
    [Name] nvarchar(256) NULL,
    [NormalizedName] nvarchar(256) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetRoles] PRIMARY KEY ([Id])
);
System.Data.SqlClient.SqlException (0x80131904): There is already an object named 'AspNetRoles' in the database.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean asyncWrite, String methodName)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
ClientConnectionId:b53fc01c-28f3-4867-be86-a47bc8b032c7
Error Number:2714,State:6,Class:16
2019-03-02 23:53:45.237 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-02 23:53:45.338 +04:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-02 23:53:45.364 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-02 23:53:45.366 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-02 23:53:45.367 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-02 23:53:45.368 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-02 23:53:45.368 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-02 23:53:45.369 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-02 23:53:47.631 +04:00 [DBG] Login Url: /Account/Login
2019-03-02 23:53:47.642 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-02 23:53:47.647 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-02 23:53:47.649 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-02 23:53:47.651 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-02 23:53:47.654 +04:00 [DBG] Error Url: /home/error
2019-03-02 23:53:47.660 +04:00 [DBG] Error Id Parameter: errorId
2019-03-02 23:53:47.846 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-02 23:53:55.156 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-02 23:55:13.672 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-02 23:55:13.848 +04:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-02 23:55:13.887 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-02 23:55:13.890 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-02 23:55:13.892 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-02 23:55:13.893 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-02 23:55:13.894 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-02 23:55:13.895 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-02 23:55:15.327 +04:00 [DBG] Login Url: /Account/Login
2019-03-02 23:55:15.334 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-02 23:55:15.343 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-02 23:55:15.348 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-02 23:55:15.350 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-02 23:55:15.352 +04:00 [DBG] Error Url: /home/error
2019-03-02 23:55:15.355 +04:00 [DBG] Error Id Parameter: errorId
2019-03-02 23:55:15.492 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-02 23:55:21.128 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-03 08:57:34.073 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-03 08:57:34.313 +04:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-03 08:57:34.357 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-03 08:57:34.360 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-03 08:57:34.363 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-03 08:57:34.364 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-03 08:57:34.366 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-03 08:57:34.367 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-03 08:57:36.704 +04:00 [DBG] Login Url: /Account/Login
2019-03-03 08:57:36.712 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-03 08:57:36.718 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-03 08:57:36.719 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-03 08:57:36.721 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-03 08:57:36.723 +04:00 [DBG] Error Url: /home/error
2019-03-03 08:57:36.735 +04:00 [DBG] Error Id Parameter: errorId
2019-03-03 08:57:36.892 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-03 08:57:49.739 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-03 09:01:36.476 +04:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.AspNetCore.Mvc.Razor.Compilation.CompilationFailedException: One or more compilation failures occurred:
D:\Projects\AuthServiceServer\AuthServiceServer\Views\_ViewImports.cshtml(1,23): error CS0234: The type or namespace name 'Quickstart' does not exist in the namespace 'IdentityServer4' (are you missing an assembly reference?)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(RazorCodeDocument codeDocument, String generatedCode)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.OnCacheMiss(String normalizedPath)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Razor.Internal.DefaultRazorPageFactoryProvider.CreateFactory(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.GetViewStartPages(String path, HashSet`1 expirationTokens)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.CreateCacheResult(HashSet`1 expirationTokens, String relativePath, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.OnCacheMiss(ViewLocationExpanderContext expanderContext, ViewLocationCacheKey cacheKey)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.LocatePageFromViewLocations(ActionContext actionContext, String pageName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewEngines.CompositeViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.FindView(ActionContext actionContext, ViewResult viewResult)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-03-03 09:37:44.921 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-03 09:37:45.017 +04:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-03 09:37:45.046 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-03 09:37:45.047 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-03 09:37:45.049 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-03 09:37:45.050 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-03 09:37:45.050 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-03 09:37:45.051 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-03 09:37:46.452 +04:00 [DBG] Login Url: /Account/Login
2019-03-03 09:37:46.464 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-03 09:37:46.469 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-03 09:37:46.470 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-03 09:37:46.473 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-03 09:37:46.482 +04:00 [DBG] Error Url: /home/error
2019-03-03 09:37:46.485 +04:00 [DBG] Error Id Parameter: errorId
2019-03-03 09:37:46.625 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-03 09:37:53.947 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-03 13:47:27.035 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-03 13:47:27.244 +04:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-03 13:47:27.295 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-03 13:47:27.303 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-03 13:47:27.305 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-03 13:47:27.307 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-03 13:47:27.308 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-03 13:47:27.309 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-03 13:47:36.883 +04:00 [DBG] Login Url: /Account/Login
2019-03-03 13:47:36.892 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-03 13:47:36.896 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-03 13:47:36.900 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-03 13:47:36.902 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-03 13:47:36.904 +04:00 [DBG] Error Url: /home/error
2019-03-03 13:47:36.909 +04:00 [DBG] Error Id Parameter: errorId
2019-03-03 13:47:37.082 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-03 13:47:53.933 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-03 13:49:07.001 +04:00 [ERR] Failed executing DbCommand (430ms) [Parameters=[@__model_Email_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [x].[Id], [x].[AccessFailedCount], [x].[CompanyId], [x].[ConcurrencyStamp], [x].[Email], [x].[EmailConfirmed], [x].[LockoutEnabled], [x].[LockoutEnd], [x].[NormalizedEmail], [x].[NormalizedUserName], [x].[PasswordHash], [x].[PhoneNumber], [x].[PhoneNumberConfirmed], [x].[SecurityStamp], [x].[TwoFactorEnabled], [x].[UserName]
FROM [AspNetUsers] AS [x]
WHERE [x].[Email] = @__model_Email_0
System.Data.SqlClient.SqlException (0x80131904): Invalid column name 'CompanyId'.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
ClientConnectionId:f37110c6-0e5e-4416-83ee-5229436c2867
Error Number:207,State:1,Class:16
2019-03-03 13:49:09.075 +04:00 [ERR] An exception occurred in the database while iterating the results of a query for context type 'AuthServiceServer.Models.Data.UsersDbContext'.
System.Data.SqlClient.SqlException (0x80131904): Invalid column name 'CompanyId'.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
ClientConnectionId:f37110c6-0e5e-4416-83ee-5229436c2867
Error Number:207,State:1,Class:16
System.Data.SqlClient.SqlException (0x80131904): Invalid column name 'CompanyId'.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
ClientConnectionId:f37110c6-0e5e-4416-83ee-5229436c2867
Error Number:207,State:1,Class:16
2019-03-03 13:49:09.429 +04:00 [ERR] An exception occurred in the database while iterating the results of a query for context type 'AuthServiceServer.Models.Data.UsersDbContext'.
System.Data.SqlClient.SqlException (0x80131904): Invalid column name 'CompanyId'.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteSingletonAsyncQuery[TResult](QueryContext queryContext, Func`2 compiledQuery, IDiagnosticsLogger`1 logger, Type contextType)
ClientConnectionId:f37110c6-0e5e-4416-83ee-5229436c2867
Error Number:207,State:1,Class:16
System.Data.SqlClient.SqlException (0x80131904): Invalid column name 'CompanyId'.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteSingletonAsyncQuery[TResult](QueryContext queryContext, Func`2 compiledQuery, IDiagnosticsLogger`1 logger, Type contextType)
ClientConnectionId:f37110c6-0e5e-4416-83ee-5229436c2867
Error Number:207,State:1,Class:16
2019-03-03 13:54:11.294 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-03 13:54:11.452 +04:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-03 13:54:11.491 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-03 13:54:11.493 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-03 13:54:11.495 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-03 13:54:11.496 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-03 13:54:11.497 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-03 13:54:11.498 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-03 13:54:13.530 +04:00 [DBG] Login Url: /Account/Login
2019-03-03 13:54:13.548 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-03 13:54:13.559 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-03 13:54:13.570 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-03 13:54:13.577 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-03 13:54:13.583 +04:00 [DBG] Error Url: /home/error
2019-03-03 13:54:13.587 +04:00 [DBG] Error Id Parameter: errorId
2019-03-03 13:54:13.732 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-03 13:54:21.012 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-03 14:03:59.308 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-03 14:03:59.419 +04:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-03 14:03:59.443 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-03 14:03:59.445 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-03 14:03:59.446 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-03 14:03:59.447 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-03 14:03:59.447 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-03 14:03:59.448 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-03 14:04:00.923 +04:00 [DBG] Login Url: /Account/Login
2019-03-03 14:04:00.930 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-03 14:04:00.934 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-03 14:04:00.937 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-03 14:04:00.938 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-03 14:04:00.939 +04:00 [DBG] Error Url: /home/error
2019-03-03 14:04:00.940 +04:00 [DBG] Error Id Parameter: errorId
2019-03-03 14:04:01.058 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-03 14:04:09.861 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-03 14:04:10.096 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-03 14:06:20.793 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-03 14:06:21.012 +04:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-03 14:06:21.054 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-03 14:06:21.057 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-03 14:06:21.059 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-03 14:06:21.060 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-03 14:06:21.061 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-03 14:06:21.062 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-03 14:06:44.439 +04:00 [WRN] User null password validation failed: PasswordRequiresNonAlphanumeric;PasswordRequiresUpper.
2019-03-03 14:06:45.983 +04:00 [DBG] Login Url: /Account/Login
2019-03-03 14:06:46.020 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-03 14:06:46.038 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-03 14:06:46.045 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-03 14:06:46.069 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-03 14:06:46.084 +04:00 [DBG] Error Url: /home/error
2019-03-03 14:06:46.086 +04:00 [DBG] Error Id Parameter: errorId
2019-03-03 14:06:46.257 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-03 14:08:28.107 +04:00 [WRN] User null password validation failed: PasswordRequiresNonAlphanumeric;PasswordRequiresUpper.
2019-03-03 14:11:22.594 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-03 14:11:22.719 +04:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-03 14:11:22.747 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-03 14:11:22.749 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-03 14:11:22.750 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-03 14:11:22.751 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-03 14:11:22.751 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-03 14:11:22.752 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-03 14:11:38.180 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-03 14:11:40.843 +04:00 [DBG] Login Url: /Account/Login
2019-03-03 14:11:40.852 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-03 14:11:40.858 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-03 14:11:40.859 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-03 14:11:40.861 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-03 14:11:40.863 +04:00 [DBG] Error Url: /home/error
2019-03-03 14:11:40.874 +04:00 [DBG] Error Id Parameter: errorId
2019-03-03 14:11:41.058 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-03 14:12:55.828 +04:00 [WRN] User null validation failed: InvalidUserName.
2019-03-03 19:02:05.750 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-03 19:02:05.939 +04:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-03 19:02:05.981 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-03 19:02:05.984 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-03 19:02:05.986 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-03 19:02:05.987 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-03 19:02:05.988 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-03 19:02:05.989 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-03 19:02:11.908 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-03 19:02:12.523 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-03 19:02:14.713 +04:00 [DBG] Login Url: /Account/Login
2019-03-03 19:02:14.735 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-03 19:02:14.745 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-03 19:02:14.762 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-03 19:02:14.779 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-03 19:02:14.785 +04:00 [DBG] Error Url: /home/error
2019-03-03 19:02:14.803 +04:00 [DBG] Error Id Parameter: errorId
2019-03-03 19:02:15.031 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-03 19:03:38.124 +04:00 [INF] {"Username":"test@test.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLKVT4RP59IE:00000004","TimeStamp":"2019-03-03T15:03:37.0000000Z","ProcessId":14592,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-03-03 19:05:54.203 +04:00 [WRN] User null validation failed: InvalidUserName.
2019-03-03 19:09:12.066 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-03 19:09:12.240 +04:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-03 19:09:12.280 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-03 19:09:12.283 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-03 19:09:12.284 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-03 19:09:12.286 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-03 19:09:12.287 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-03 19:09:12.289 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-03 19:09:14.727 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-03 19:09:15.124 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-03 19:09:17.118 +04:00 [DBG] Login Url: /Account/Login
2019-03-03 19:09:17.136 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-03 19:09:17.143 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-03 19:09:17.153 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-03 19:09:17.156 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-03 19:09:17.159 +04:00 [DBG] Error Url: /home/error
2019-03-03 19:09:17.163 +04:00 [DBG] Error Id Parameter: errorId
2019-03-03 19:09:17.387 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-03 19:10:11.703 +04:00 [DBG] Augmenting SignInContext
2019-03-03 19:10:11.735 +04:00 [DBG] Adding idp claim with value: local
2019-03-03 19:10:11.741 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-03 19:10:11.750 +04:00 [DBG] Adding auth_time claim with value: 1551625811
2019-03-03 19:10:11.864 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-03 19:11:56.080 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-03 19:12:20.035 +04:00 [DBG] Augmenting SignInContext
2019-03-03 19:12:20.037 +04:00 [DBG] Adding idp claim with value: local
2019-03-03 19:12:20.046 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-03 19:12:20.048 +04:00 [DBG] Adding auth_time claim with value: 1551625940
2019-03-03 19:12:20.066 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-03 19:12:38.847 +04:00 [INF] {"Username":"admin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"admin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLKVT8PQH7RR:00000002","TimeStamp":"2019-03-03T15:12:38.0000000Z","ProcessId":14860,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-03 19:13:20.907 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-04 08:38:01.923 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-04 08:38:01.998 +04:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-04 08:38:02.010 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-04 08:38:02.010 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-04 08:38:02.011 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-04 08:38:02.011 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-04 08:38:02.012 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-04 08:38:02.012 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-04 08:38:17.357 +04:00 [ERR] An error occurred using the connection to database 'IdentityServer4' on server '(localdb)\AuthService'.
System.Data.SqlClient.SqlException (0x80131904): A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: SQL Network Interfaces, error: 50 - Local Database Runtime error occurred. The specified LocalDB instance does not exist.
) ---> System.ComponentModel.Win32Exception (0x89C50107): Unknown error (0x89c50107)
   at System.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling)
   at System.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at System.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionPool.WaitForPendingOpen()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)
ClientConnectionId:00000000-0000-0000-0000-000000000000
Error Number:-1983577849,State:0,Class:20
2019-03-04 08:38:17.525 +04:00 [ERR] An exception occurred in the database while iterating the results of a query for context type 'AuthServiceServer.Models.Data.UsersDbContext'.
System.Data.SqlClient.SqlException (0x80131904): A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: SQL Network Interfaces, error: 50 - Local Database Runtime error occurred. The specified LocalDB instance does not exist.
) ---> System.ComponentModel.Win32Exception (0x89C50107): Unknown error (0x89c50107)
   at System.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling)
   at System.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at System.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionPool.WaitForPendingOpen()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
ClientConnectionId:00000000-0000-0000-0000-000000000000
Error Number:-1983577849,State:0,Class:20
System.Data.SqlClient.SqlException (0x80131904): A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: SQL Network Interfaces, error: 50 - Local Database Runtime error occurred. The specified LocalDB instance does not exist.
) ---> System.ComponentModel.Win32Exception (0x89C50107): Unknown error (0x89c50107)
   at System.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling)
   at System.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at System.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionPool.WaitForPendingOpen()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
ClientConnectionId:00000000-0000-0000-0000-000000000000
Error Number:-1983577849,State:0,Class:20
2019-03-04 08:38:17.561 +04:00 [ERR] An exception occurred in the database while iterating the results of a query for context type 'AuthServiceServer.Models.Data.UsersDbContext'.
System.Data.SqlClient.SqlException (0x80131904): A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: SQL Network Interfaces, error: 50 - Local Database Runtime error occurred. The specified LocalDB instance does not exist.
) ---> System.ComponentModel.Win32Exception (0x89C50107): Unknown error (0x89c50107)
   at System.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling)
   at System.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at System.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionPool.WaitForPendingOpen()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteSingletonAsyncQuery[TResult](QueryContext queryContext, Func`2 compiledQuery, IDiagnosticsLogger`1 logger, Type contextType)
ClientConnectionId:00000000-0000-0000-0000-000000000000
Error Number:-1983577849,State:0,Class:20
System.Data.SqlClient.SqlException (0x80131904): A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: SQL Network Interfaces, error: 50 - Local Database Runtime error occurred. The specified LocalDB instance does not exist.
) ---> System.ComponentModel.Win32Exception (0x89C50107): Unknown error (0x89c50107)
   at System.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling)
   at System.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at System.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionPool.WaitForPendingOpen()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteSingletonAsyncQuery[TResult](QueryContext queryContext, Func`2 compiledQuery, IDiagnosticsLogger`1 logger, Type contextType)
ClientConnectionId:00000000-0000-0000-0000-000000000000
Error Number:-1983577849,State:0,Class:20
2019-03-04 08:40:16.912 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-04 08:40:16.955 +04:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-04 08:40:16.964 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-04 08:40:16.965 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-04 08:40:16.965 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-04 08:40:16.965 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-04 08:40:16.965 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-04 08:40:16.966 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-04 08:40:18.882 +04:00 [DBG] Login Url: /Account/Login
2019-03-04 08:40:18.886 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-04 08:40:18.887 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-04 08:40:18.888 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-04 08:40:18.889 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-04 08:40:18.890 +04:00 [DBG] Error Url: /home/error
2019-03-04 08:40:18.891 +04:00 [DBG] Error Id Parameter: errorId
2019-03-04 08:40:18.964 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-04 08:40:48.075 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-04 08:41:27.759 +04:00 [INF] {"Username":"test@test.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLL0BE0BMDTO:00000005","TimeStamp":"2019-03-04T04:41:27.0000000Z","ProcessId":18996,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-03-04 08:41:39.498 +04:00 [INF] {"Username":"test@test.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLL0BE0BMDTO:00000008","TimeStamp":"2019-03-04T04:41:39.0000000Z","ProcessId":18996,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-03-04 08:42:04.644 +04:00 [DBG] Augmenting SignInContext
2019-03-04 08:42:04.647 +04:00 [DBG] Adding idp claim with value: local
2019-03-04 08:42:04.647 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-04 08:42:04.648 +04:00 [DBG] Adding auth_time claim with value: 1551674524
2019-03-04 08:42:04.665 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-04 08:42:04.671 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-04 08:42:44.394 +04:00 [DBG] Augmenting SignInContext
2019-03-04 08:42:44.394 +04:00 [DBG] Adding idp claim with value: local
2019-03-04 08:42:44.396 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-04 08:42:44.396 +04:00 [DBG] Adding auth_time claim with value: 1551674564
2019-03-04 08:42:44.397 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-04 08:42:57.660 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL0BE0BMDTP:00000012","TimeStamp":"2019-03-04T04:42:57.0000000Z","ProcessId":18996,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-04 08:42:59.807 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-04 08:44:49.457 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-04 08:44:57.163 +04:00 [DBG] Augmenting SignInContext
2019-03-04 08:44:57.163 +04:00 [DBG] Adding idp claim with value: local
2019-03-04 08:44:57.165 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-04 08:44:57.168 +04:00 [DBG] Adding auth_time claim with value: 1551674697
2019-03-04 08:44:57.169 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-04 08:44:59.401 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL0BE0BMDU6:00000001","TimeStamp":"2019-03-04T04:44:59.0000000Z","ProcessId":18996,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-04 08:46:10.844 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-04 08:46:22.780 +04:00 [DBG] Augmenting SignInContext
2019-03-04 08:46:22.780 +04:00 [DBG] Adding idp claim with value: local
2019-03-04 08:46:22.782 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-04 08:46:22.783 +04:00 [DBG] Adding auth_time claim with value: 1551674782
2019-03-04 08:46:22.784 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-04 08:46:24.486 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL0BE0BMDUE:00000005","TimeStamp":"2019-03-04T04:46:24.0000000Z","ProcessId":18996,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-04 08:46:24.496 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-04 08:46:41.427 +04:00 [DBG] Augmenting SignInContext
2019-03-04 08:46:41.427 +04:00 [DBG] Adding idp claim with value: local
2019-03-04 08:46:41.429 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-04 08:46:41.429 +04:00 [DBG] Adding auth_time claim with value: 1551674801
2019-03-04 08:46:41.430 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-04 08:47:06.261 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL0BE0BMDUE:0000000D","TimeStamp":"2019-03-04T04:47:06.0000000Z","ProcessId":18996,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-04 08:47:08.229 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-04 08:47:26.526 +04:00 [DBG] Augmenting SignInContext
2019-03-04 08:47:26.526 +04:00 [DBG] Adding idp claim with value: local
2019-03-04 08:47:26.528 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-04 08:47:26.528 +04:00 [DBG] Adding auth_time claim with value: 1551674846
2019-03-04 08:47:26.530 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-04 08:47:30.699 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL0BE0BMDUD:00000003","TimeStamp":"2019-03-04T04:47:30.0000000Z","ProcessId":18996,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-04 08:49:50.333 +04:00 [INF] {"Username":"alice","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLL0BE0BMDUG:00000001","TimeStamp":"2019-03-04T04:49:50.0000000Z","ProcessId":18996,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-03-04 08:52:25.078 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-04 08:52:25.116 +04:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-04 08:52:25.124 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-04 08:52:25.125 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-04 08:52:25.125 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-04 08:52:25.125 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-04 08:52:25.125 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-04 08:52:25.126 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-04 08:52:25.703 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-04 08:52:25.797 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-04 08:52:26.675 +04:00 [DBG] Login Url: /Account/Login
2019-03-04 08:52:26.683 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-04 08:52:26.684 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-04 08:52:26.685 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-04 08:52:26.687 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-04 08:52:26.687 +04:00 [DBG] Error Url: /home/error
2019-03-04 08:52:26.688 +04:00 [DBG] Error Id Parameter: errorId
2019-03-04 08:52:26.742 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-04 08:52:54.607 +04:00 [DBG] Augmenting SignInContext
2019-03-04 08:52:54.610 +04:00 [DBG] Adding idp claim with value: local
2019-03-04 08:52:54.610 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-04 08:52:54.611 +04:00 [DBG] Adding auth_time claim with value: 1551675174
2019-03-04 08:52:54.627 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-04 08:53:21.879 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL0BKPA4J43:00000003","TimeStamp":"2019-03-04T04:53:21.0000000Z","ProcessId":16172,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-04 08:53:21.937 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-04 08:54:30.895 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-04 08:54:30.937 +04:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-04 08:54:30.946 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-04 08:54:30.947 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-04 08:54:30.947 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-04 08:54:30.947 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-04 08:54:30.948 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-04 08:54:30.948 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-04 08:54:31.481 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-04 08:54:31.579 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-04 08:54:32.178 +04:00 [DBG] Login Url: /Account/Login
2019-03-04 08:54:32.181 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-04 08:54:32.183 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-04 08:54:32.183 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-04 08:54:32.184 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-04 08:54:32.185 +04:00 [DBG] Error Url: /home/error
2019-03-04 08:54:32.185 +04:00 [DBG] Error Id Parameter: errorId
2019-03-04 08:54:32.223 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-04 08:54:43.034 +04:00 [DBG] Augmenting SignInContext
2019-03-04 08:54:43.037 +04:00 [DBG] Adding idp claim with value: local
2019-03-04 08:54:43.038 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-04 08:54:43.039 +04:00 [DBG] Adding auth_time claim with value: 1551675283
2019-03-04 08:54:43.053 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-04 08:54:43.093 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL0BLUO5GA1:00000003","TimeStamp":"2019-03-04T04:54:43.0000000Z","ProcessId":2488,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-04 08:54:43.150 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-04 08:57:06.243 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-04 08:57:06.279 +04:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-04 08:57:06.287 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-04 08:57:06.288 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-04 08:57:06.288 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-04 08:57:06.288 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-04 08:57:06.289 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-04 08:57:06.289 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-04 08:57:06.842 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-04 08:57:06.925 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-04 08:57:07.626 +04:00 [DBG] Login Url: /Account/Login
2019-03-04 08:57:07.629 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-04 08:57:07.630 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-04 08:57:07.631 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-04 08:57:07.631 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-04 08:57:07.632 +04:00 [DBG] Error Url: /home/error
2019-03-04 08:57:07.632 +04:00 [DBG] Error Id Parameter: errorId
2019-03-04 08:57:07.670 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-04 08:57:26.741 +04:00 [DBG] Augmenting SignInContext
2019-03-04 08:57:26.744 +04:00 [DBG] Adding idp claim with value: local
2019-03-04 08:57:26.745 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-04 08:57:26.746 +04:00 [DBG] Adding auth_time claim with value: 1551675446
2019-03-04 08:57:26.757 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-04 08:57:28.726 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL0BND2NCRQ:00000003","TimeStamp":"2019-03-04T04:57:28.0000000Z","ProcessId":9592,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-04 08:57:28.784 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-04 09:01:58.585 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-04 09:01:58.622 +04:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-04 09:01:58.632 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-04 09:01:58.633 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-04 09:01:58.634 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-04 09:01:58.634 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-04 09:01:58.635 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-04 09:01:58.635 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-04 09:01:59.203 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-04 09:01:59.293 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-04 09:02:00.233 +04:00 [DBG] Login Url: /Account/Login
2019-03-04 09:02:00.237 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-04 09:02:00.239 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-04 09:02:00.240 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-04 09:02:00.241 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-04 09:02:00.241 +04:00 [DBG] Error Url: /home/error
2019-03-04 09:02:00.242 +04:00 [DBG] Error Id Parameter: errorId
2019-03-04 09:02:00.283 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-04 09:02:08.288 +04:00 [DBG] Augmenting SignInContext
2019-03-04 09:02:08.291 +04:00 [DBG] Adding idp claim with value: local
2019-03-04 09:02:08.291 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-04 09:02:08.295 +04:00 [DBG] Adding auth_time claim with value: 1551675728
2019-03-04 09:02:08.306 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-04 09:02:08.353 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL0BQ494314:00000002","TimeStamp":"2019-03-04T05:02:08.0000000Z","ProcessId":18712,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-04 09:02:08.418 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-04 09:03:02.727 +04:00 [DBG] Augmenting SignInContext
2019-03-04 09:03:02.727 +04:00 [DBG] Adding idp claim with value: local
2019-03-04 09:03:02.728 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-04 09:03:02.729 +04:00 [DBG] Adding auth_time claim with value: 1551675782
2019-03-04 09:03:02.730 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-04 09:03:02.732 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL0BQ494314:00000011","TimeStamp":"2019-03-04T05:03:02.0000000Z","ProcessId":18712,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-04 09:03:20.720 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-04 09:03:23.334 +04:00 [DBG] Augmenting SignInContext
2019-03-04 09:03:23.334 +04:00 [DBG] Adding idp claim with value: local
2019-03-04 09:03:23.336 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-04 09:03:23.337 +04:00 [DBG] Adding auth_time claim with value: 1551675803
2019-03-04 09:03:23.337 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-04 09:03:23.340 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL0BQ494314:00000017","TimeStamp":"2019-03-04T05:03:23.0000000Z","ProcessId":18712,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-04 09:04:17.875 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-04 09:04:17.914 +04:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-04 09:04:17.925 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-04 09:04:17.925 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-04 09:04:17.926 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-04 09:04:17.926 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-04 09:04:17.927 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-04 09:04:17.928 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-04 09:04:18.498 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-04 09:04:18.591 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-04 09:04:19.247 +04:00 [DBG] Login Url: /Account/Login
2019-03-04 09:04:19.250 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-04 09:04:19.252 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-04 09:04:19.252 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-04 09:04:19.253 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-04 09:04:19.254 +04:00 [DBG] Error Url: /home/error
2019-03-04 09:04:19.254 +04:00 [DBG] Error Id Parameter: errorId
2019-03-04 09:04:19.311 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-04 09:04:42.155 +04:00 [DBG] Augmenting SignInContext
2019-03-04 09:04:42.158 +04:00 [DBG] Adding idp claim with value: local
2019-03-04 09:04:42.158 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-04 09:04:42.160 +04:00 [DBG] Adding auth_time claim with value: 1551675882
2019-03-04 09:04:42.173 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-04 09:04:42.216 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL0BRDMTADJ:0000000E","TimeStamp":"2019-03-04T05:04:42.0000000Z","ProcessId":1544,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-04 10:32:17.459 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-04 10:32:17.530 +04:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-04 10:32:17.539 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-04 10:32:17.539 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-04 10:32:17.540 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-04 10:32:17.540 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-04 10:32:17.541 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-04 10:32:17.541 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-04 10:32:18.398 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-04 10:32:18.496 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-04 10:32:19.765 +04:00 [DBG] Login Url: /Account/Login
2019-03-04 10:32:19.779 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-04 10:32:19.781 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-04 10:32:19.782 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-04 10:32:19.782 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-04 10:32:19.783 +04:00 [DBG] Error Url: /home/error
2019-03-04 10:32:19.784 +04:00 [DBG] Error Id Parameter: errorId
2019-03-04 10:32:20.168 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-04 10:34:28.325 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-04 10:34:28.381 +04:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-04 10:34:28.390 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-04 10:34:28.391 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-04 10:34:28.391 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-04 10:34:28.391 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-04 10:34:28.392 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-04 10:34:28.392 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-04 10:34:28.960 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-04 10:34:29.056 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-04 10:34:29.731 +04:00 [DBG] Login Url: /Account/Login
2019-03-04 10:34:29.735 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-04 10:34:29.737 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-04 10:34:29.737 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-04 10:34:29.738 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-04 10:34:29.738 +04:00 [DBG] Error Url: /home/error
2019-03-04 10:34:29.739 +04:00 [DBG] Error Id Parameter: errorId
2019-03-04 10:34:29.799 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-04 10:37:25.184 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-04 10:37:25.222 +04:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-04 10:37:25.230 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-04 10:37:25.230 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-04 10:37:25.230 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-04 10:37:25.231 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-04 10:37:25.231 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-04 10:37:25.231 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-04 10:37:25.852 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-04 10:37:25.937 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-04 10:37:26.973 +04:00 [DBG] Login Url: /Account/Login
2019-03-04 10:37:26.976 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-04 10:37:26.978 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-04 10:37:26.978 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-04 10:37:26.979 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-04 10:37:26.980 +04:00 [DBG] Error Url: /home/error
2019-03-04 10:37:26.980 +04:00 [DBG] Error Id Parameter: errorId
2019-03-04 10:37:27.038 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-04 10:49:56.658 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-04 10:49:56.733 +04:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-04 10:49:56.744 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-04 10:49:56.744 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-04 10:49:56.745 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-04 10:49:56.745 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-04 10:49:56.746 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-04 10:49:56.746 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-04 10:49:57.682 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-04 10:49:57.790 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-04 10:49:58.996 +04:00 [DBG] Login Url: /Account/Login
2019-03-04 10:49:58.999 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-04 10:49:58.999 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-04 10:49:59.001 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-04 10:49:59.002 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-04 10:49:59.002 +04:00 [DBG] Error Url: /home/error
2019-03-04 10:49:59.003 +04:00 [DBG] Error Id Parameter: errorId
2019-03-04 10:49:59.111 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-04 10:50:05.091 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at AspNetCore.Views_Account_Logout.<ExecuteAsync>b__9_0() in D:\Projects\AuthServiceServer\AuthServiceServer\Views\Account\Logout.cshtml:line 16
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext.GetChildContentAsync(Boolean useCachedResult, HtmlEncoder encoder)
   at Microsoft.AspNetCore.Mvc.TagHelpers.RenderAtEndOfFormTagHelper.ProcessAsync(TagHelperContext context, TagHelperOutput output)
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperRunner.RunAsync(TagHelperExecutionContext executionContext)
   at AspNetCore.Views_Account_Logout.ExecuteAsync() in D:\Projects\AuthServiceServer\AuthServiceServer\Views\Account\Logout.cshtml:line 5
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-03-04 10:50:57.705 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-04 10:50:57.755 +04:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-04 10:50:57.767 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-04 10:50:57.767 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-04 10:50:57.768 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-04 10:50:57.769 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-04 10:50:57.769 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-04 10:50:57.770 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-04 10:50:58.362 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-04 10:50:58.465 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-04 10:50:59.517 +04:00 [DBG] Login Url: /Account/Login
2019-03-04 10:50:59.522 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-04 10:50:59.522 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-04 10:50:59.523 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-04 10:50:59.524 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-04 10:50:59.526 +04:00 [DBG] Error Url: /home/error
2019-03-04 10:50:59.527 +04:00 [DBG] Error Id Parameter: errorId
2019-03-04 10:50:59.589 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-04 10:51:04.157 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at AspNetCore.Views_Account_Logout.<ExecuteAsync>b__9_0() in D:\Projects\AuthServiceServer\AuthServiceServer\Views\Account\Logout.cshtml:line 15
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext.GetChildContentAsync(Boolean useCachedResult, HtmlEncoder encoder)
   at Microsoft.AspNetCore.Mvc.TagHelpers.RenderAtEndOfFormTagHelper.ProcessAsync(TagHelperContext context, TagHelperOutput output)
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperRunner.RunAsync(TagHelperExecutionContext executionContext)
   at AspNetCore.Views_Account_Logout.ExecuteAsync() in D:\Projects\AuthServiceServer\AuthServiceServer\Views\Account\Logout.cshtml:line 4
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-03-04 10:51:17.719 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-04 10:51:17.759 +04:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-04 10:51:17.769 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-04 10:51:17.769 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-04 10:51:17.770 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-04 10:51:17.770 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-04 10:51:17.770 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-04 10:51:17.770 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-04 10:51:18.402 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-04 10:51:18.487 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-04 10:51:19.474 +04:00 [DBG] Login Url: /Account/Login
2019-03-04 10:51:19.479 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-04 10:51:19.480 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-04 10:51:19.481 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-04 10:51:19.482 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-04 10:51:19.482 +04:00 [DBG] Error Url: /home/error
2019-03-04 10:51:19.483 +04:00 [DBG] Error Id Parameter: errorId
2019-03-04 10:51:19.538 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-04 10:51:22.761 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at AspNetCore.Views_Account_Logout.<ExecuteAsync>b__9_0() in D:\Projects\AuthServiceServer\AuthServiceServer\Views\Account\Logout.cshtml:line 11
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext.GetChildContentAsync(Boolean useCachedResult, HtmlEncoder encoder)
   at Microsoft.AspNetCore.Mvc.TagHelpers.RenderAtEndOfFormTagHelper.ProcessAsync(TagHelperContext context, TagHelperOutput output)
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperRunner.RunAsync(TagHelperExecutionContext executionContext)
   at AspNetCore.Views_Account_Logout.ExecuteAsync()
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-03-04 10:55:53.404 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-04 10:55:53.453 +04:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-04 10:55:53.462 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-04 10:55:53.462 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-04 10:55:53.462 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-04 10:55:53.463 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-04 10:55:53.463 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-04 10:55:53.463 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-04 10:55:54.035 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-04 10:55:54.131 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-04 10:55:54.192 +04:00 [FTL] Unable to start Kestrel.
System.IO.IOException: Failed to bind to address http://127.0.0.1:5000: address already in use. ---> Microsoft.AspNetCore.Connections.AddressInUseException:        (/ /) ---> System.Net.Sockets.SocketException:        (/ /)
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransport.BindAsync()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransport.BindAsync()
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.<>c__DisplayClass22_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.LocalhostListenOptions.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(IServerAddressesFeature addresses, KestrelServerOptions serverOptions, ILogger logger, Func`2 createBinding)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
2019-03-04 10:56:03.623 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-04 10:56:03.669 +04:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-04 10:56:03.679 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-04 10:56:03.679 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-04 10:56:03.679 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-04 10:56:03.679 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-04 10:56:03.680 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-04 10:56:03.680 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-04 10:56:04.294 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-04 10:56:04.392 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-04 10:56:05.390 +04:00 [DBG] Login Url: /Account/Login
2019-03-04 10:56:05.399 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-04 10:56:05.399 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-04 10:56:05.400 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-04 10:56:05.400 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-04 10:56:05.401 +04:00 [DBG] Error Url: /home/error
2019-03-04 10:56:05.401 +04:00 [DBG] Error Id Parameter: errorId
2019-03-04 10:56:05.456 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-04 10:56:08.759 +04:00 [DBG] Augmenting SignInContext
2019-03-04 10:56:08.765 +04:00 [DBG] Adding idp claim with value: local
2019-03-04 10:56:08.766 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-04 10:56:08.767 +04:00 [DBG] Adding auth_time claim with value: 1551682568
2019-03-04 10:56:08.780 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-04 10:56:08.817 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL0DPS6V07F:00000002","TimeStamp":"2019-03-04T06:56:08.0000000Z","ProcessId":13888,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-04 10:59:10.619 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-04 10:59:10.669 +04:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-04 10:59:10.678 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-04 10:59:10.678 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-04 10:59:10.679 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-04 10:59:10.681 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-04 10:59:10.682 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-04 10:59:10.682 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-04 10:59:11.306 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-04 10:59:11.443 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-04 10:59:12.497 +04:00 [DBG] Login Url: /Account/Login
2019-03-04 10:59:12.503 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-04 10:59:12.504 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-04 10:59:12.504 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-04 10:59:12.505 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-04 10:59:12.505 +04:00 [DBG] Error Url: /home/error
2019-03-04 10:59:12.506 +04:00 [DBG] Error Id Parameter: errorId
2019-03-04 10:59:12.569 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-04 10:59:25.170 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-03-04 10:59:25.172 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-03-04 10:59:25.174 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-03-04 10:59:30.017 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-04 11:21:47.550 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-04 11:21:47.957 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-04 11:21:47.958 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-04 11:21:47.958 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-04 11:21:47.958 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-04 11:21:47.958 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-04 11:21:47.959 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-04 11:21:48.270 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-04 11:21:48.375 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-04 11:21:48.443 +04:00 [DBG] Starting grant removal
2019-03-04 11:21:49.624 +04:00 [DBG] Login Url: /Account/Login
2019-03-04 11:21:49.630 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-04 11:21:49.631 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-04 11:21:49.631 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-04 11:21:49.634 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-04 11:21:49.634 +04:00 [DBG] Error Url: /home/error
2019-03-04 11:21:49.635 +04:00 [DBG] Error Id Parameter: errorId
2019-03-04 11:21:49.682 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 08:42:34.251 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 08:42:34.362 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 08:42:34.363 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 08:42:34.364 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 08:42:34.365 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 08:42:34.367 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 08:42:34.367 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 08:42:36.975 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 08:42:37.094 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 08:42:37.158 +04:00 [DBG] Starting grant removal
2019-03-05 08:42:38.601 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 08:42:38.606 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 08:42:38.608 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 08:42:38.609 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 08:42:38.610 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 08:42:38.611 +04:00 [DBG] Error Url: /home/error
2019-03-05 08:42:38.612 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 08:42:38.661 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 08:43:04.231 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The model item passed into the ViewDataDictionary is of type 'System.Collections.Generic.List`1[IdentityServer4.EntityFramework.Entities.Client]', but this ViewDataDictionary instance requires a model item of type 'System.Collections.Generic.IEnumerable`1[AuthServiceServer.Models.Clients.ClientToView]'.
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewDataDictionary.EnsureCompatible(Object value)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewDataDictionary..ctor(ViewDataDictionary source, Object model, Type declaredModelType)
   at lambda_method(Closure , ViewDataDictionary )
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorPagePropertyActivator.CreateViewDataDictionary(ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorPagePropertyActivator.Activate(Object page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorPageActivator.Activate(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-03-05 08:50:30.406 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 08:50:30.467 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 08:50:30.467 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 08:50:30.468 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 08:50:30.468 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 08:50:30.468 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 08:50:30.469 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 08:50:32.121 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 08:50:32.214 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 08:50:32.268 +04:00 [DBG] Starting grant removal
2019-03-05 08:50:33.051 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 08:50:33.055 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 08:50:33.056 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 08:50:33.057 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 08:50:33.057 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 08:50:33.058 +04:00 [DBG] Error Url: /home/error
2019-03-05 08:50:33.058 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 08:50:33.100 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 09:00:07.587 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 09:00:07.652 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 09:00:07.653 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 09:00:07.654 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 09:00:07.654 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 09:00:07.654 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 09:00:07.654 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 09:00:09.041 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 09:00:09.131 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 09:00:09.189 +04:00 [DBG] Starting grant removal
2019-03-05 09:00:09.826 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 09:00:09.831 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 09:00:09.832 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 09:00:09.833 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 09:00:09.834 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 09:00:09.834 +04:00 [DBG] Error Url: /home/error
2019-03-05 09:00:09.835 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 09:00:09.877 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 09:03:22.469 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 09:03:22.533 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 09:03:22.534 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 09:03:22.535 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 09:03:22.535 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 09:03:22.535 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 09:03:22.536 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 09:03:23.110 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 09:03:23.203 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 09:03:23.256 +04:00 [DBG] Starting grant removal
2019-03-05 09:03:23.836 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 09:03:23.841 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 09:03:23.843 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 09:03:23.843 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 09:03:23.845 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 09:03:23.846 +04:00 [DBG] Error Url: /home/error
2019-03-05 09:03:23.846 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 09:03:23.887 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 09:03:34.868 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 09:03:34.923 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 09:03:34.924 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 09:03:34.924 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 09:03:34.924 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 09:03:34.925 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 09:03:34.925 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 09:03:35.533 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 09:03:35.623 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 09:03:35.675 +04:00 [DBG] Starting grant removal
2019-03-05 09:03:36.241 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 09:03:36.244 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 09:03:36.245 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 09:03:36.248 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 09:03:36.249 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 09:03:36.250 +04:00 [DBG] Error Url: /home/error
2019-03-05 09:03:36.251 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 09:03:36.302 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 09:03:58.447 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 09:03:58.500 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 09:03:58.501 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 09:03:58.501 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 09:03:58.501 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 09:03:58.502 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 09:03:58.502 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 09:03:59.044 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 09:03:59.130 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 09:03:59.213 +04:00 [DBG] Starting grant removal
2019-03-05 09:03:59.996 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 09:04:00.000 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 09:04:00.001 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 09:04:00.002 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 09:04:00.003 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 09:04:00.004 +04:00 [DBG] Error Url: /home/error
2019-03-05 09:04:00.005 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 09:04:00.042 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 09:06:32.329 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 09:06:32.386 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 09:06:32.387 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 09:06:32.388 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 09:06:32.388 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 09:06:32.389 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 09:06:32.390 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 09:06:32.939 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 09:06:33.033 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 09:06:33.085 +04:00 [DBG] Starting grant removal
2019-03-05 09:06:33.853 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 09:06:33.856 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 09:06:33.857 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 09:06:33.858 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 09:06:33.858 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 09:06:33.864 +04:00 [DBG] Error Url: /home/error
2019-03-05 09:06:33.874 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 09:06:33.912 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 09:07:45.410 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 09:07:45.466 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 09:07:45.467 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 09:07:45.467 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 09:07:45.468 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 09:07:45.468 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 09:07:45.469 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 09:07:46.020 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 09:07:46.106 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 09:07:46.158 +04:00 [DBG] Starting grant removal
2019-03-05 09:07:46.943 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 09:07:46.946 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 09:07:46.947 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 09:07:46.948 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 09:07:46.949 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 09:07:46.949 +04:00 [DBG] Error Url: /home/error
2019-03-05 09:07:46.950 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 09:07:46.988 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 09:13:05.192 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 09:13:05.248 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 09:13:05.249 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 09:13:05.249 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 09:13:05.249 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 09:13:05.249 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 09:13:05.250 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 09:13:05.819 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 09:13:05.911 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 09:13:05.969 +04:00 [DBG] Starting grant removal
2019-03-05 09:13:06.718 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 09:13:06.722 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 09:13:06.725 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 09:13:06.726 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 09:13:06.727 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 09:13:06.727 +04:00 [DBG] Error Url: /home/error
2019-03-05 09:13:06.729 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 09:13:06.767 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 09:20:20.489 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 09:20:20.547 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 09:20:20.548 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 09:20:20.548 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 09:20:20.548 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 09:20:20.548 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 09:20:20.549 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 09:20:21.960 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 09:20:22.046 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 09:20:22.101 +04:00 [DBG] Starting grant removal
2019-03-05 09:20:22.553 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 09:20:22.559 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 09:20:22.560 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 09:20:22.561 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 09:20:22.562 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 09:20:22.563 +04:00 [DBG] Error Url: /home/error
2019-03-05 09:20:22.564 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 09:20:22.610 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 09:22:36.267 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 09:22:36.321 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 09:22:36.322 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 09:22:36.323 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 09:22:36.323 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 09:22:36.323 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 09:22:36.324 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 09:22:36.871 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 09:22:36.956 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 09:22:37.011 +04:00 [DBG] Starting grant removal
2019-03-05 09:22:37.714 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 09:22:37.718 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 09:22:37.719 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 09:22:37.720 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 09:22:37.720 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 09:22:37.721 +04:00 [DBG] Error Url: /home/error
2019-03-05 09:22:37.722 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 09:22:37.754 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 09:23:28.061 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 09:23:28.118 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 09:23:28.119 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 09:23:28.119 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 09:23:28.120 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 09:23:28.120 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 09:23:28.120 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 09:23:28.662 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 09:23:28.752 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 09:23:28.802 +04:00 [DBG] Starting grant removal
2019-03-05 09:23:29.284 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 09:23:29.287 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 09:23:29.289 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 09:23:29.290 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 09:23:29.290 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 09:23:29.290 +04:00 [DBG] Error Url: /home/error
2019-03-05 09:23:29.291 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 09:23:29.328 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 09:33:11.874 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 09:33:11.929 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 09:33:11.929 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 09:33:11.929 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 09:33:11.930 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 09:33:11.930 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 09:33:11.931 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 09:33:13.257 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 09:33:13.347 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 09:33:13.398 +04:00 [DBG] Starting grant removal
2019-03-05 09:33:14.079 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 09:33:14.082 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 09:33:14.083 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 09:33:14.084 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 09:33:14.086 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 09:33:14.087 +04:00 [DBG] Error Url: /home/error
2019-03-05 09:33:14.088 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 09:33:14.131 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 09:33:14.248 +04:00 [ERR] Request matched multiple actions resulting in ambiguity. Matching actions: AuthServiceServer.Controllers.ClientsController.Index (AuthServiceServer)
AuthServiceServer.Controllers.ClientsController.Create (AuthServiceServer)
2019-03-05 09:33:14.255 +04:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.AspNetCore.Mvc.Internal.AmbiguousActionException: Multiple actions matched. The following actions matched route data and had all constraints satisfied:

AuthServiceServer.Controllers.ClientsController.Index (AuthServiceServer)
AuthServiceServer.Controllers.ClientsController.Create (AuthServiceServer)
   at Microsoft.AspNetCore.Mvc.Internal.ActionSelector.SelectBestCandidate(RouteContext context, IReadOnlyList`1 candidates)
   at Microsoft.AspNetCore.Mvc.Internal.MvcAttributeRouteHandler.RouteAsync(RouteContext context)
   at Microsoft.AspNetCore.Routing.Tree.TreeRouter.RouteAsync(RouteContext context)
   at Microsoft.AspNetCore.Routing.RouteCollection.RouteAsync(RouteContext context)
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-03-05 09:33:47.835 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 09:33:47.889 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 09:33:47.890 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 09:33:47.891 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 09:33:47.891 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 09:33:47.891 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 09:33:47.892 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 09:33:48.454 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 09:33:48.548 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 09:33:48.601 +04:00 [DBG] Starting grant removal
2019-03-05 09:33:49.075 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 09:33:49.078 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 09:33:49.080 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 09:33:49.081 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 09:33:49.081 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 09:33:49.082 +04:00 [DBG] Error Url: /home/error
2019-03-05 09:33:49.083 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 09:33:49.119 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 09:39:59.888 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 09:39:59.943 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 09:39:59.944 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 09:39:59.944 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 09:39:59.945 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 09:39:59.945 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 09:39:59.946 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 09:40:01.335 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 09:40:01.434 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 09:40:01.490 +04:00 [DBG] Starting grant removal
2019-03-05 09:40:02.457 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 09:40:02.462 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 09:40:02.467 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 09:40:02.468 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 09:40:02.468 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 09:40:02.469 +04:00 [DBG] Error Url: /home/error
2019-03-05 09:40:02.470 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 09:40:02.510 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 09:54:12.445 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 09:54:12.503 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 09:54:12.503 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 09:54:12.504 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 09:54:12.504 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 09:54:12.504 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 09:54:12.504 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 09:54:13.965 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 09:54:14.056 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 09:54:14.114 +04:00 [DBG] Starting grant removal
2019-03-05 09:54:14.757 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 09:54:14.763 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 09:54:14.765 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 09:54:14.766 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 09:54:14.767 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 09:54:14.767 +04:00 [DBG] Error Url: /home/error
2019-03-05 09:54:14.768 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 09:54:14.820 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 10:01:10.992 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 10:01:11.049 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 10:01:11.050 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 10:01:11.051 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 10:01:11.051 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 10:01:11.051 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 10:01:11.052 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 10:01:12.506 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 10:01:12.606 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 10:01:12.660 +04:00 [DBG] Starting grant removal
2019-03-05 10:01:13.754 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 10:01:13.758 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 10:01:13.761 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 10:01:13.761 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 10:01:13.762 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 10:01:13.762 +04:00 [DBG] Error Url: /home/error
2019-03-05 10:01:13.763 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 10:01:13.807 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 10:14:23.373 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 10:14:23.430 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 10:14:23.431 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 10:14:23.432 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 10:14:23.432 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 10:14:23.432 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 10:14:23.433 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 10:14:24.882 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 10:14:24.976 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 10:14:25.033 +04:00 [DBG] Starting grant removal
2019-03-05 10:14:25.647 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 10:14:25.650 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 10:14:25.652 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 10:14:25.652 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 10:14:25.653 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 10:14:25.656 +04:00 [DBG] Error Url: /home/error
2019-03-05 10:14:25.657 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 10:14:25.693 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 10:20:16.756 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 10:20:16.817 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 10:20:16.818 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 10:20:16.818 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 10:20:16.818 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 10:20:16.819 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 10:20:16.819 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 10:20:17.395 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 10:20:17.492 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 10:20:17.553 +04:00 [DBG] Starting grant removal
2019-03-05 10:20:18.098 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 10:20:18.102 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 10:20:18.103 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 10:20:18.104 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 10:20:18.105 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 10:20:18.105 +04:00 [DBG] Error Url: /home/error
2019-03-05 10:20:18.107 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 10:20:18.146 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 10:31:41.865 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 10:31:41.923 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 10:31:41.923 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 10:31:41.924 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 10:31:41.924 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 10:31:41.925 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 10:31:41.925 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 10:31:43.482 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 10:31:43.570 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 10:31:43.623 +04:00 [DBG] Starting grant removal
2019-03-05 10:31:44.717 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 10:31:44.720 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 10:31:44.722 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 10:31:44.723 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 10:31:44.723 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 10:31:44.724 +04:00 [DBG] Error Url: /home/error
2019-03-05 10:31:44.725 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 10:31:44.773 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 10:32:15.375 +04:00 [DBG] CORS request made for path: /Clients/Create from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-03-05 10:38:00.550 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 10:38:00.609 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 10:38:00.610 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 10:38:00.610 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 10:38:00.610 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 10:38:00.610 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 10:38:00.611 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 10:38:01.199 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 10:38:01.290 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 10:38:01.351 +04:00 [DBG] Starting grant removal
2019-03-05 10:38:01.985 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 10:38:01.989 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 10:38:01.991 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 10:38:01.991 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 10:38:01.992 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 10:38:01.993 +04:00 [DBG] Error Url: /home/error
2019-03-05 10:38:01.995 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 10:38:02.033 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 10:38:08.074 +04:00 [DBG] CORS request made for path: /Clients/Create from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-03-05 10:40:06.741 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 10:40:06.797 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 10:40:06.798 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 10:40:06.798 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 10:40:06.798 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 10:40:06.799 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 10:40:06.799 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 10:40:07.410 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 10:40:07.519 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 10:40:07.579 +04:00 [DBG] Starting grant removal
2019-03-05 10:40:08.365 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 10:40:08.370 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 10:40:08.371 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 10:40:08.371 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 10:40:08.373 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 10:40:08.374 +04:00 [DBG] Error Url: /home/error
2019-03-05 10:40:08.375 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 10:40:08.409 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 10:40:10.880 +04:00 [DBG] CORS request made for path: /Clients/Create from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-03-05 10:40:41.179 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 10:40:41.235 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 10:40:41.236 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 10:40:41.236 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 10:40:41.236 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 10:40:41.237 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 10:40:41.237 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 10:40:41.806 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 10:40:41.895 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 10:40:41.950 +04:00 [DBG] Starting grant removal
2019-03-05 10:40:42.569 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 10:40:42.573 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 10:40:42.574 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 10:40:42.574 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 10:40:42.575 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 10:40:42.577 +04:00 [DBG] Error Url: /home/error
2019-03-05 10:40:42.578 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 10:40:42.619 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 10:40:45.049 +04:00 [DBG] CORS request made for path: /Clients/Create from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-03-05 10:40:59.003 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 10:40:59.064 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 10:40:59.064 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 10:40:59.065 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 10:40:59.065 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 10:40:59.065 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 10:40:59.065 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 10:40:59.640 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 10:40:59.735 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 10:40:59.798 +04:00 [DBG] Starting grant removal
2019-03-05 10:41:00.199 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 10:41:00.202 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 10:41:00.204 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 10:41:00.204 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 10:41:00.205 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 10:41:00.207 +04:00 [DBG] Error Url: /home/error
2019-03-05 10:41:00.207 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 10:41:00.251 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 10:41:02.463 +04:00 [DBG] CORS request made for path: /Clients/Create from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-03-05 10:41:53.067 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 10:41:53.123 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 10:41:53.124 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 10:41:53.125 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 10:41:53.125 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 10:41:53.125 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 10:41:53.125 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 10:41:53.701 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 10:41:53.791 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 10:41:53.854 +04:00 [DBG] Starting grant removal
2019-03-05 10:41:54.968 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 10:41:54.972 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 10:41:54.974 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 10:41:54.974 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 10:41:54.975 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 10:41:54.976 +04:00 [DBG] Error Url: /home/error
2019-03-05 10:41:54.976 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 10:41:55.017 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 10:43:18.773 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 10:43:18.835 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 10:43:18.836 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 10:43:18.836 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 10:43:18.836 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 10:43:18.836 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 10:43:18.837 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 10:43:19.403 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 10:43:19.499 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 10:43:19.555 +04:00 [DBG] Starting grant removal
2019-03-05 10:43:20.439 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 10:43:20.442 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 10:43:20.444 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 10:43:20.444 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 10:43:20.445 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 10:43:20.446 +04:00 [DBG] Error Url: /home/error
2019-03-05 10:43:20.447 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 10:43:20.490 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 10:43:30.569 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at AuthServiceServer.Controllers.ClientsController.Create(ClientCreate model) in D:\Projects\AuthServiceServer\AuthServiceServer\Controllers\ClientsController.cs:line 67
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-03-05 10:43:33.058 +04:00 [DBG] TaskCanceledException. Exiting.
2019-03-05 10:43:33.089 +04:00 [DBG] Stopping grant removal
2019-03-05 10:43:46.995 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 10:43:47.052 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 10:43:47.053 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 10:43:47.053 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 10:43:47.054 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 10:43:47.054 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 10:43:47.054 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 10:43:47.630 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 10:43:47.723 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 10:43:47.773 +04:00 [DBG] Starting grant removal
2019-03-05 10:43:48.297 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 10:43:48.302 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 10:43:48.303 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 10:43:48.304 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 10:43:48.304 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 10:43:48.306 +04:00 [DBG] Error Url: /home/error
2019-03-05 10:43:48.307 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 10:43:48.349 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 10:46:35.515 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 10:46:35.574 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 10:46:35.575 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 10:46:35.575 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 10:46:35.576 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 10:46:35.576 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 10:46:35.576 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 10:46:36.158 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 10:46:36.248 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 10:46:36.300 +04:00 [DBG] Starting grant removal
2019-03-05 10:46:36.929 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 10:46:36.934 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 10:46:36.935 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 10:46:36.937 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 10:46:36.938 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 10:46:36.941 +04:00 [DBG] Error Url: /home/error
2019-03-05 10:46:36.942 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 10:46:36.986 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 10:48:49.141 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 10:48:49.197 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 10:48:49.198 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 10:48:49.198 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 10:48:49.199 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 10:48:49.199 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 10:48:49.199 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 10:48:49.780 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 10:48:49.876 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 10:48:49.932 +04:00 [DBG] Starting grant removal
2019-03-05 10:48:50.937 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 10:48:50.940 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 10:48:50.942 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 10:48:50.943 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 10:48:50.943 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 10:48:50.944 +04:00 [DBG] Error Url: /home/error
2019-03-05 10:48:50.946 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 10:48:50.986 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 10:51:02.589 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 10:51:02.660 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 10:51:02.661 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 10:51:02.661 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 10:51:02.661 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 10:51:02.661 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 10:51:02.662 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 10:51:03.223 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 10:51:03.314 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 10:51:03.368 +04:00 [DBG] Starting grant removal
2019-03-05 10:51:04.177 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 10:51:04.180 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 10:51:04.183 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 10:51:04.184 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 10:51:04.185 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 10:51:04.186 +04:00 [DBG] Error Url: /home/error
2019-03-05 10:51:04.187 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 10:51:04.238 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 10:58:52.081 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 10:58:52.142 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 10:58:52.143 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 10:58:52.143 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 10:58:52.143 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 10:58:52.143 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 10:58:52.144 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 10:58:53.550 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 10:58:53.643 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 10:58:53.700 +04:00 [DBG] Starting grant removal
2019-03-05 10:58:54.456 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 10:58:54.460 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 10:58:54.463 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 10:58:54.463 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 10:58:54.464 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 10:58:54.465 +04:00 [DBG] Error Url: /home/error
2019-03-05 10:58:54.466 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 10:58:54.501 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 11:00:46.475 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-05 11:03:15.611 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 11:03:15.670 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 11:03:15.671 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 11:03:15.671 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 11:03:15.671 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 11:03:15.672 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 11:03:15.672 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 11:03:16.235 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 11:03:16.325 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 11:03:16.378 +04:00 [DBG] Starting grant removal
2019-03-05 11:03:16.941 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 11:03:16.947 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 11:03:16.951 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 11:03:16.951 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 11:03:16.954 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 11:03:16.954 +04:00 [DBG] Error Url: /home/error
2019-03-05 11:03:16.955 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 11:03:17.000 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 11:07:45.860 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 11:07:45.917 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 11:07:45.918 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 11:07:45.918 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 11:07:45.918 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 11:07:45.919 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 11:07:45.919 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 11:07:46.476 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 11:07:46.569 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 11:07:46.624 +04:00 [DBG] Starting grant removal
2019-03-05 11:07:47.315 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 11:07:47.345 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 11:07:47.347 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 11:07:47.348 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 11:07:47.348 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 11:07:47.349 +04:00 [DBG] Error Url: /home/error
2019-03-05 11:07:47.350 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 11:07:47.397 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 11:14:06.424 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 11:14:06.492 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 11:14:06.493 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 11:14:06.494 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 11:14:06.494 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 11:14:06.494 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 11:14:06.495 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 11:14:07.511 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 11:14:07.631 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 11:14:07.730 +04:00 [DBG] Starting grant removal
2019-03-05 11:14:08.991 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 11:14:08.996 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 11:14:08.997 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 11:14:08.998 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 11:14:08.999 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 11:14:08.999 +04:00 [DBG] Error Url: /home/error
2019-03-05 11:14:09.000 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 11:14:09.033 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 11:14:44.102 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 11:14:44.171 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 11:14:44.172 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 11:14:44.173 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 11:14:44.173 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 11:14:44.173 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 11:14:44.174 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 11:14:44.723 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 11:14:44.823 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 11:14:44.876 +04:00 [DBG] Starting grant removal
2019-03-05 11:14:45.916 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 11:14:45.918 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 11:14:45.923 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 11:14:45.925 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 11:14:45.925 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 11:14:45.926 +04:00 [DBG] Error Url: /home/error
2019-03-05 11:14:45.927 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 11:14:45.964 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 11:15:10.183 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 11:15:10.243 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 11:15:10.244 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 11:15:10.244 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 11:15:10.244 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 11:15:10.245 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 11:15:10.245 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 11:15:10.837 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 11:15:10.936 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 11:15:10.990 +04:00 [DBG] Starting grant removal
2019-03-05 11:15:11.908 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 11:15:11.911 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 11:15:11.913 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 11:15:11.914 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 11:15:11.915 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 11:15:11.915 +04:00 [DBG] Error Url: /home/error
2019-03-05 11:15:11.916 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 11:15:11.956 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 11:17:04.361 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 11:17:04.419 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 11:17:04.420 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 11:17:04.421 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 11:17:04.421 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 11:17:04.421 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 11:17:04.422 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 11:17:04.960 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 11:17:05.049 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 11:17:05.099 +04:00 [DBG] Starting grant removal
2019-03-05 11:17:05.824 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 11:17:05.829 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 11:17:05.838 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 11:17:05.838 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 11:17:05.839 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 11:17:05.839 +04:00 [DBG] Error Url: /home/error
2019-03-05 11:17:05.842 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 11:17:05.894 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 11:18:18.751 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 11:18:18.813 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 11:18:18.813 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 11:18:18.814 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 11:18:18.814 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 11:18:18.814 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 11:18:18.814 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 11:18:19.349 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 11:18:19.438 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 11:18:19.491 +04:00 [DBG] Starting grant removal
2019-03-05 11:18:20.093 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 11:18:20.103 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 11:18:20.104 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 11:18:20.105 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 11:18:20.105 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 11:18:20.106 +04:00 [DBG] Error Url: /home/error
2019-03-05 11:18:20.107 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 11:18:20.147 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 11:18:46.919 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 11:18:46.993 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 11:18:46.993 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 11:18:46.993 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 11:18:46.994 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 11:18:46.994 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 11:18:46.995 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 11:18:47.588 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 11:18:47.686 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 11:18:47.741 +04:00 [DBG] Starting grant removal
2019-03-05 11:18:48.255 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 11:18:48.258 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 11:18:48.260 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 11:18:48.260 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 11:18:48.261 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 11:18:48.261 +04:00 [DBG] Error Url: /home/error
2019-03-05 11:18:48.262 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 11:18:48.319 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 11:19:34.078 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 11:19:34.133 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 11:19:34.134 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 11:19:34.134 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 11:19:34.134 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 11:19:34.135 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 11:19:34.135 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 11:19:34.684 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 11:19:34.775 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 11:19:34.839 +04:00 [DBG] Starting grant removal
2019-03-05 11:19:35.855 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 11:19:35.859 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 11:19:35.860 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 11:19:35.861 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 11:19:35.862 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 11:19:35.862 +04:00 [DBG] Error Url: /home/error
2019-03-05 11:19:35.863 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 11:19:35.899 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 11:20:04.689 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 11:20:04.750 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 11:20:04.751 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 11:20:04.753 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 11:20:04.754 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 11:20:04.754 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 11:20:04.754 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 11:20:05.332 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 11:20:05.453 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 11:20:05.505 +04:00 [DBG] Starting grant removal
2019-03-05 11:20:06.577 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 11:20:06.579 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 11:20:06.581 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 11:20:06.582 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 11:20:06.584 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 11:20:06.585 +04:00 [DBG] Error Url: /home/error
2019-03-05 11:20:06.586 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 11:20:06.620 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 11:20:41.031 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 11:20:41.103 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 11:20:41.104 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 11:20:41.104 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 11:20:41.105 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 11:20:41.105 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 11:20:41.105 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 11:20:41.700 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 11:20:41.789 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 11:20:41.842 +04:00 [DBG] Starting grant removal
2019-03-05 11:20:42.548 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 11:20:42.552 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 11:20:42.553 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 11:20:42.553 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 11:20:42.556 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 11:20:42.559 +04:00 [DBG] Error Url: /home/error
2019-03-05 11:20:42.560 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 11:20:42.599 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 11:21:43.318 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 11:21:43.372 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 11:21:43.373 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 11:21:43.373 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 11:21:43.373 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 11:21:43.374 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 11:21:43.374 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 11:21:43.931 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 11:21:44.023 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 11:21:44.072 +04:00 [DBG] Starting grant removal
2019-03-05 11:21:44.733 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 11:21:44.736 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 11:21:44.738 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 11:21:44.739 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 11:21:44.739 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 11:21:44.740 +04:00 [DBG] Error Url: /home/error
2019-03-05 11:21:44.741 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 11:21:44.779 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 11:21:53.286 +04:00 [DBG] CORS request made for path: /Clients/Create from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-03-05 11:22:46.351 +04:00 [DBG] CORS request made for path: /Clients/Create from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-03-05 11:25:51.330 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 11:25:51.387 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 11:25:51.388 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 11:25:51.388 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 11:25:51.390 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 11:25:51.390 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 11:25:51.391 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 11:25:51.980 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 11:25:52.084 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 11:25:52.140 +04:00 [DBG] Starting grant removal
2019-03-05 11:25:52.899 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 11:25:52.902 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 11:25:52.904 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 11:25:52.905 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 11:25:52.906 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 11:25:52.907 +04:00 [DBG] Error Url: /home/error
2019-03-05 11:25:52.910 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 11:25:52.950 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 11:25:57.734 +04:00 [DBG] CORS request made for path: /Clients/Create from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-03-05 11:27:02.514 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at AuthServiceServer.Controllers.ClientsController.Create(ClientCreateModel model, String button) in D:\Projects\AuthServiceServer\AuthServiceServer\Controllers\ClientsController.cs:line 71
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-03-05 11:28:04.148 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 11:28:04.204 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 11:28:04.206 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 11:28:04.206 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 11:28:04.207 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 11:28:04.207 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 11:28:04.207 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 11:28:04.788 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 11:28:04.874 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 11:28:04.929 +04:00 [DBG] Starting grant removal
2019-03-05 11:28:05.809 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 11:28:05.816 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 11:28:05.818 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 11:28:05.818 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 11:28:05.819 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 11:28:05.820 +04:00 [DBG] Error Url: /home/error
2019-03-05 11:28:05.821 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 11:28:05.872 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 11:30:30.553 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 11:30:30.612 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 11:30:30.613 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 11:30:30.613 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 11:30:30.614 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 11:30:30.614 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 11:30:30.615 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 11:30:31.240 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 11:30:31.333 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 11:30:31.389 +04:00 [DBG] Starting grant removal
2019-03-05 11:30:32.379 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 11:30:32.382 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 11:30:32.385 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 11:30:32.385 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 11:30:32.387 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 11:30:32.387 +04:00 [DBG] Error Url: /home/error
2019-03-05 11:30:32.388 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 11:30:32.431 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 11:31:33.410 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 11:31:33.470 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 11:31:33.471 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 11:31:33.471 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 11:31:33.472 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 11:31:33.472 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 11:31:33.472 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 11:31:34.028 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 11:31:34.116 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 11:31:34.181 +04:00 [DBG] Starting grant removal
2019-03-05 11:31:35.202 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 11:31:35.206 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 11:31:35.209 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 11:31:35.210 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 11:31:35.211 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 11:31:35.213 +04:00 [DBG] Error Url: /home/error
2019-03-05 11:31:35.214 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 11:31:35.254 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 11:32:04.883 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 11:32:04.947 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 11:32:04.948 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 11:32:04.950 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 11:32:04.951 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 11:32:04.951 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 11:32:04.952 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 11:32:05.536 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 11:32:05.630 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 11:32:05.686 +04:00 [DBG] Starting grant removal
2019-03-05 11:32:06.537 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 11:32:06.540 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 11:32:06.542 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 11:32:06.542 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 11:32:06.543 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 11:32:06.544 +04:00 [DBG] Error Url: /home/error
2019-03-05 11:32:06.544 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 11:32:06.582 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-05 11:36:44.144 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-05 11:36:44.204 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-05 11:36:44.205 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-05 11:36:44.207 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-05 11:36:44.208 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-05 11:36:44.209 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-05 11:36:44.210 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-05 11:36:44.783 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-05 11:36:44.872 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-05 11:36:44.925 +04:00 [DBG] Starting grant removal
2019-03-05 11:36:45.653 +04:00 [DBG] Login Url: /Account/Login
2019-03-05 11:36:45.655 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-05 11:36:45.657 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-05 11:36:45.658 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-05 11:36:45.658 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-05 11:36:45.659 +04:00 [DBG] Error Url: /home/error
2019-03-05 11:36:45.660 +04:00 [DBG] Error Id Parameter: errorId
2019-03-05 11:36:45.697 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 08:32:17.132 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 08:32:17.244 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 08:32:17.245 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 08:32:17.245 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 08:32:17.246 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 08:32:17.246 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 08:32:17.246 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 08:32:18.040 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 08:32:18.250 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 08:32:18.364 +04:00 [DBG] Starting grant removal
2019-03-06 08:32:19.210 +04:00 [DBG] Login Url: /Account/Login
2019-03-06 08:32:19.214 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 08:32:19.219 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 08:32:19.220 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 08:32:19.221 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 08:32:19.222 +04:00 [DBG] Error Url: /home/error
2019-03-06 08:32:19.229 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 08:32:19.270 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 08:32:19.740 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-06 08:32:23.113 +04:00 [DBG] Augmenting SignInContext
2019-03-06 08:32:23.158 +04:00 [DBG] Adding idp claim with value: local
2019-03-06 08:32:23.159 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-06 08:32:23.161 +04:00 [DBG] Adding auth_time claim with value: 1551846743
2019-03-06 08:32:23.176 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 08:32:23.270 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL1TIRP8P0H:00000003","TimeStamp":"2019-03-06T04:32:23.0000000Z","ProcessId":15188,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-06 08:32:46.493 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 08:32:46.554 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 08:32:46.555 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 08:32:46.555 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 08:32:46.555 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 08:32:46.555 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 08:32:46.556 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 08:32:47.134 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 08:32:47.149 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 08:32:47.151 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 08:32:47.235 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 08:32:47.294 +04:00 [DBG] Starting grant removal
2019-03-06 08:32:48.326 +04:00 [DBG] Login Url: /Account/Login
2019-03-06 08:32:48.329 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 08:32:48.330 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 08:32:48.331 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 08:32:48.332 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 08:32:48.333 +04:00 [DBG] Error Url: /home/error
2019-03-06 08:32:48.334 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 08:32:48.390 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 08:32:48.586 +04:00 [INF] AuthenticationScheme: Identity.Application was forbidden.
2019-03-06 08:33:01.799 +04:00 [INF] AuthenticationScheme: Identity.Application was forbidden.
2019-03-06 08:35:23.043 +04:00 [INF] AuthenticationScheme: Identity.Application was forbidden.
2019-03-06 08:35:29.073 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 08:35:29.136 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 08:35:29.139 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 08:35:29.139 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 08:35:29.139 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 08:35:29.140 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 08:35:29.140 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 08:35:29.698 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 08:35:29.713 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 08:35:29.716 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 08:35:29.799 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 08:35:29.852 +04:00 [DBG] Starting grant removal
2019-03-06 08:35:30.571 +04:00 [DBG] Login Url: /Account/Login
2019-03-06 08:35:30.576 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 08:35:30.577 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 08:35:30.578 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 08:35:30.579 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 08:35:30.580 +04:00 [DBG] Error Url: /home/error
2019-03-06 08:35:30.580 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 08:35:30.645 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 08:35:30.810 +04:00 [INF] AuthenticationScheme: Identity.Application was forbidden.
2019-03-06 08:39:33.189 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-03-06 08:39:33.191 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-03-06 08:39:33.193 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-03-06 08:39:36.940 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-06 08:40:05.343 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 08:40:05.400 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 08:40:05.401 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 08:40:05.402 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 08:40:05.402 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 08:40:05.402 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 08:40:05.402 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 08:40:05.969 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 08:40:05.978 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 08:40:05.981 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 08:40:06.086 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 08:40:06.146 +04:00 [DBG] Starting grant removal
2019-03-06 08:40:07.201 +04:00 [DBG] Login Url: /Account/Login
2019-03-06 08:40:07.205 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 08:40:07.207 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 08:40:07.207 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 08:40:07.208 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 08:40:07.209 +04:00 [DBG] Error Url: /home/error
2019-03-06 08:40:07.211 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 08:40:07.264 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 08:40:07.477 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-06 08:40:44.160 +04:00 [DBG] Augmenting SignInContext
2019-03-06 08:40:44.199 +04:00 [DBG] Adding idp claim with value: local
2019-03-06 08:40:44.200 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-06 08:40:44.203 +04:00 [DBG] Adding auth_time claim with value: 1551847244
2019-03-06 08:40:44.217 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 08:41:14.361 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-03-06 08:41:14.364 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-03-06 08:41:14.365 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-03-06 08:41:17.160 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-06 08:41:22.329 +04:00 [DBG] Augmenting SignInContext
2019-03-06 08:41:22.330 +04:00 [DBG] Adding idp claim with value: local
2019-03-06 08:41:22.331 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-06 08:41:22.332 +04:00 [DBG] Adding auth_time claim with value: 1551847282
2019-03-06 08:41:22.334 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 08:41:22.431 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL1TN7ABLJQ:00000006","TimeStamp":"2019-03-06T04:41:22.0000000Z","ProcessId":8656,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-06 08:41:27.343 +04:00 [INF] AuthenticationScheme: Identity.Application was forbidden.
2019-03-06 08:41:46.648 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-03-06 08:41:46.650 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-03-06 08:41:46.652 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-03-06 08:41:48.642 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-06 08:41:52.766 +04:00 [DBG] Augmenting SignInContext
2019-03-06 08:41:52.767 +04:00 [DBG] Adding idp claim with value: local
2019-03-06 08:41:52.768 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-06 08:41:52.769 +04:00 [DBG] Adding auth_time claim with value: 1551847312
2019-03-06 08:41:52.769 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 08:41:52.773 +04:00 [INF] {"Username":"godAdmin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"1002","DisplayName":"godAdmin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL1TN7ABLJV:00000001","TimeStamp":"2019-03-06T04:41:52.0000000Z","ProcessId":8656,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-06 08:45:52.785 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 08:45:52.843 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 08:45:52.844 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 08:45:52.845 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 08:45:52.845 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 08:45:52.845 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 08:45:52.846 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 08:45:53.386 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 08:45:53.396 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 08:45:53.398 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 08:45:53.476 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 08:45:53.534 +04:00 [DBG] Starting grant removal
2019-03-06 08:45:54.402 +04:00 [DBG] Login Url: /Account/Login
2019-03-06 08:45:54.406 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 08:45:54.408 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 08:45:54.411 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 08:45:54.411 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 08:45:54.412 +04:00 [DBG] Error Url: /home/error
2019-03-06 08:45:54.413 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 08:45:54.480 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 08:50:14.378 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 08:50:14.441 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 08:50:14.441 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 08:50:14.442 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 08:50:14.442 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 08:50:14.442 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 08:50:14.442 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 08:50:15.015 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 08:50:15.030 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 08:50:15.032 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 08:50:15.113 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 08:50:15.171 +04:00 [DBG] Starting grant removal
2019-03-06 08:50:16.240 +04:00 [DBG] Login Url: /Account/Login
2019-03-06 08:50:16.244 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 08:50:16.245 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 08:50:16.246 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 08:50:16.246 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 08:50:16.247 +04:00 [DBG] Error Url: /home/error
2019-03-06 08:50:16.249 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 08:50:16.317 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 09:10:12.830 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 09:10:12.914 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 09:10:12.914 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 09:10:12.915 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 09:10:12.915 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 09:10:12.915 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 09:10:12.915 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 09:10:14.113 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:10:14.125 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:10:14.127 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:10:14.220 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 09:10:14.327 +04:00 [DBG] Starting grant removal
2019-03-06 09:10:15.051 +04:00 [DBG] Login Url: /Account/Login
2019-03-06 09:10:15.053 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 09:10:15.056 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 09:10:15.090 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 09:10:15.091 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 09:10:15.092 +04:00 [DBG] Error Url: /home/error
2019-03-06 09:10:15.092 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 09:10:15.164 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 09:10:21.864 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-06 09:10:21.870 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-06 09:10:21.871 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-06 09:10:21.881 +04:00 [DBG] Start discovery request
2019-03-06 09:10:22.467 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-06 09:10:22.666 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-06 09:10:22.669 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-06 09:10:22.670 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-06 09:10:22.674 +04:00 [DBG] Start key discovery request
2019-03-06 09:10:22.785 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-06 09:10:22.796 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-06 09:10:22.798 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-06 09:10:22.803 +04:00 [DBG] Start authorize request
2019-03-06 09:10:22.817 +04:00 [DBG] User in authorize request: 1002
2019-03-06 09:10:22.823 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 09:10:23.125 +04:00 [DBG] BiLab found in database: true
2019-03-06 09:10:23.134 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 09:10:23.153 +04:00 [ERR] Invalid redirect_uri: https://localhost:5001/signin-oidc
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5001/signin-oidc"],"SubjectId":"1002","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5001/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874458227641089.ODhkN2I4NWMtZDYzMy00NjBjLTg0NTItYzdiYTU1Yjc0ZTRjMGY5NGU0MjYtMDVjZC00ZWJmLTk5NGMtNjQxZDQ0YTEyMGU1","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDe1uYkwU3Ix-IsNjXOzo2Q0IJD7cMTCEGTElgl4vuZu-5wzTun9vqdlKA_6_7SF7nLEUnA8WvXHDeIkBubC1fSJlF0eDcp6fRG9qm32adozT4NnXviNCZ9Z2E7KhdAKWuuKSlkhTM4Yxa7RzAmwFuqwY6IOOarBMoPCwyam8xC33XH4tn5pzNWnWXwxdi5JYOt0GKUnXzD6_T0FYh0PUDfRvQNe_z28_j90vYhAyd8rNY_QTfGLtQ5wsfaLS82MwdoN1TqS2zlqxv6Fbq5LRJ5cvOFasf1EaIFK8F5C3HXF-zh1r-rBrGBJZbExkzFaGY","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 09:10:23.168 +04:00 [ERR] Request validation failed
2019-03-06 09:10:23.171 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5001/signin-oidc"],"SubjectId":"1002","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5001/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874458227641089.ODhkN2I4NWMtZDYzMy00NjBjLTg0NTItYzdiYTU1Yjc0ZTRjMGY5NGU0MjYtMDVjZC00ZWJmLTk5NGMtNjQxZDQ0YTEyMGU1","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDe1uYkwU3Ix-IsNjXOzo2Q0IJD7cMTCEGTElgl4vuZu-5wzTun9vqdlKA_6_7SF7nLEUnA8WvXHDeIkBubC1fSJlF0eDcp6fRG9qm32adozT4NnXviNCZ9Z2E7KhdAKWuuKSlkhTM4Yxa7RzAmwFuqwY6IOOarBMoPCwyam8xC33XH4tn5pzNWnWXwxdi5JYOt0GKUnXzD6_T0FYh0PUDfRvQNe_z28_j90vYhAyd8rNY_QTfGLtQ5wsfaLS82MwdoN1TqS2zlqxv6Fbq5LRJ5cvOFasf1EaIFK8F5C3HXF-zh1r-rBrGBJZbExkzFaGY","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 09:10:23.222 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Authorize","SubjectId":"1002","Scopes":"","GrantType":null,"Error":"unauthorized_client","ErrorDescription":"Invalid redirect_uri","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLL1U822N7DG:00000001","TimeStamp":"2019-03-06T05:10:23.0000000Z","ProcessId":9076,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-03-06 09:11:58.438 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-03-06 09:11:58.439 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-03-06 09:11:58.440 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-03-06 09:12:07.120 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-06 09:12:07.122 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-06 09:12:07.122 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-06 09:12:07.126 +04:00 [DBG] Start authorize request
2019-03-06 09:12:07.127 +04:00 [DBG] No user present in authorize request
2019-03-06 09:12:07.127 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 09:12:07.158 +04:00 [DBG] BiLab found in database: true
2019-03-06 09:12:07.159 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 09:12:07.161 +04:00 [ERR] Invalid redirect_uri: https://localhost:5001/signin-oidc
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5001/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5001/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874459270912524.OWFkYjdlOWItZWJjNi00MThiLTllZDctY2YzNGVlM2EwMDBhOTc1Y2U1MzAtMzM5Ny00ZDg3LTg5YjUtMTlhNDZiZDUxMzI5","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBwJyl48HxEujfSlvDN4p5SlmUHxjwfftfpEb1B-adxDFzeRwDaPpQGCXtF_9fMQK_cvpF691x4E6fDpOBggeGNCMQvvQIT7m235TsuRnjzdv23OE0uO39n0102nw6kiqXn-8gNJ6VSjlzRMJGUMyaXPv3N0wmvKxOO6wOk7D2E93qQC_pibvldeJ-pSCjMpPgLcAPkcWAHHMaqHMQ64ud1wNRVv3Oibf6j2m6t1Mx4RnNJviTzymhD7ch2I26jZmeXXno77TdbZA3EchY5OJS7Td-WrjFbh0R717nf4ebgLNx8IcWHRINet3m1m1kngwo","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 09:12:07.168 +04:00 [ERR] Request validation failed
2019-03-06 09:12:07.172 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5001/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5001/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874459270912524.OWFkYjdlOWItZWJjNi00MThiLTllZDctY2YzNGVlM2EwMDBhOTc1Y2U1MzAtMzM5Ny00ZDg3LTg5YjUtMTlhNDZiZDUxMzI5","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBwJyl48HxEujfSlvDN4p5SlmUHxjwfftfpEb1B-adxDFzeRwDaPpQGCXtF_9fMQK_cvpF691x4E6fDpOBggeGNCMQvvQIT7m235TsuRnjzdv23OE0uO39n0102nw6kiqXn-8gNJ6VSjlzRMJGUMyaXPv3N0wmvKxOO6wOk7D2E93qQC_pibvldeJ-pSCjMpPgLcAPkcWAHHMaqHMQ64ud1wNRVv3Oibf6j2m6t1Mx4RnNJviTzymhD7ch2I26jZmeXXno77TdbZA3EchY5OJS7Td-WrjFbh0R717nf4ebgLNx8IcWHRINet3m1m1kngwo","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 09:12:07.179 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Authorize","SubjectId":null,"Scopes":"","GrantType":null,"Error":"unauthorized_client","ErrorDescription":"Invalid redirect_uri","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLL1U822N7DV:00000001","TimeStamp":"2019-03-06T05:12:07.0000000Z","ProcessId":9076,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-03-06 09:15:43.717 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 09:15:43.779 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 09:15:43.780 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 09:15:43.780 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 09:15:43.781 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 09:15:43.781 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 09:15:43.781 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 09:15:44.368 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:15:44.384 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:15:44.388 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:15:44.476 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 09:15:44.547 +04:00 [DBG] Starting grant removal
2019-03-06 09:15:45.593 +04:00 [DBG] Login Url: /Account/Login
2019-03-06 09:15:45.597 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 09:15:45.599 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 09:15:45.600 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 09:15:45.601 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 09:15:45.602 +04:00 [DBG] Error Url: /home/error
2019-03-06 09:15:45.603 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 09:15:45.655 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 09:15:45.854 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-06 09:16:00.640 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-06 09:16:00.646 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-06 09:16:00.647 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-06 09:16:00.655 +04:00 [DBG] Start discovery request
2019-03-06 09:16:01.299 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-06 09:16:01.443 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-06 09:16:01.446 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-06 09:16:01.447 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-06 09:16:01.452 +04:00 [DBG] Start key discovery request
2019-03-06 09:16:01.560 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-06 09:16:01.566 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-06 09:16:01.567 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-06 09:16:01.574 +04:00 [DBG] Start authorize request
2019-03-06 09:16:01.585 +04:00 [DBG] No user present in authorize request
2019-03-06 09:16:01.592 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 09:16:01.927 +04:00 [DBG] BiLab found in database: true
2019-03-06 09:16:01.934 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 09:16:01.953 +04:00 [ERR] Invalid redirect_uri: https://localhost:5001/signin-oidc
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5001/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5001/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874461614945085.M2NlZjQ5NTgtMDJiMS00NTE5LThiOTQtNDc1MjVjMzc5ZThhMThmYTYzZDUtZThiMC00NzM0LThjMTAtZGNiODgwYjI4YzY2","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDrMypcJpxpqqjonbvDMm9gTEyKSzfNIEorTpDGtBrSIxJ3_AJxVWkNd2vBuDqLGyrklwyxM7iVX45Oq2o7mEk1DakEV2t_5X6eJyt-QHFc2nQV5QSvNOXXdEispTmdBlMeBA2vlBHVcex5PwN_V2TXg_Tvn60-D8fAMq_ocfTL3gnKfqzYZLTkQ0OujcpksnpEBmqjl2Qrv2ObJkq3-2ZsyQhw9bE5QnCpqb-VIjBDARelSm4r3woGSgL0FXF1B0VfjgJ3QM-vbk2W7dTtIsg9ifl84obz-TqDxRTY1N6NnVBPzjNcOFNa8rpw6CesFTw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 09:16:01.970 +04:00 [ERR] Request validation failed
2019-03-06 09:16:01.972 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5001/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5001/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874461614945085.M2NlZjQ5NTgtMDJiMS00NTE5LThiOTQtNDc1MjVjMzc5ZThhMThmYTYzZDUtZThiMC00NzM0LThjMTAtZGNiODgwYjI4YzY2","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDrMypcJpxpqqjonbvDMm9gTEyKSzfNIEorTpDGtBrSIxJ3_AJxVWkNd2vBuDqLGyrklwyxM7iVX45Oq2o7mEk1DakEV2t_5X6eJyt-QHFc2nQV5QSvNOXXdEispTmdBlMeBA2vlBHVcex5PwN_V2TXg_Tvn60-D8fAMq_ocfTL3gnKfqzYZLTkQ0OujcpksnpEBmqjl2Qrv2ObJkq3-2ZsyQhw9bE5QnCpqb-VIjBDARelSm4r3woGSgL0FXF1B0VfjgJ3QM-vbk2W7dTtIsg9ifl84obz-TqDxRTY1N6NnVBPzjNcOFNa8rpw6CesFTw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 09:16:01.998 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Authorize","SubjectId":null,"Scopes":"","GrantType":null,"Error":"unauthorized_client","ErrorDescription":"Invalid redirect_uri","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLL1UB4JUM3L:00000001","TimeStamp":"2019-03-06T05:16:01.0000000Z","ProcessId":10260,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-03-06 09:21:20.501 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 09:21:20.556 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 09:21:20.557 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 09:21:20.557 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 09:21:20.558 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 09:21:20.558 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 09:21:20.558 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 09:21:21.138 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:21:21.153 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:21:21.155 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:21:21.240 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 09:21:21.303 +04:00 [DBG] Starting grant removal
2019-03-06 09:21:22.171 +04:00 [DBG] Login Url: Account/Login
2019-03-06 09:21:22.173 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 09:21:22.175 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 09:21:22.176 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 09:21:22.177 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 09:21:22.178 +04:00 [DBG] Error Url: /home/error
2019-03-06 09:21:22.179 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 09:21:22.219 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 09:21:22.383 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-06 09:21:34.065 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-06 09:21:34.071 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-06 09:21:34.072 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-06 09:21:34.079 +04:00 [DBG] Start discovery request
2019-03-06 09:21:34.706 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-06 09:21:34.850 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-06 09:21:34.854 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-06 09:21:34.855 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-06 09:21:34.860 +04:00 [DBG] Start key discovery request
2019-03-06 09:21:34.971 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-06 09:21:34.979 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-06 09:21:34.980 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-06 09:21:34.985 +04:00 [DBG] Start authorize request
2019-03-06 09:21:34.996 +04:00 [DBG] No user present in authorize request
2019-03-06 09:21:35.002 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 09:21:35.300 +04:00 [DBG] BiLab found in database: true
2019-03-06 09:21:35.309 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 09:21:35.329 +04:00 [ERR] Invalid redirect_uri: https://localhost:5001/signin-oidc
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5001/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5001/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874464949065367.NmZhYTQyMWUtOWI2Yi00MDFiLWFhMmYtY2Y1MjEwM2ZjMTA5NDA1NTFmZWMtYzVlZC00OWU4LTk2YzYtMzc5ZWQ5MmY4YWQ0","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCPrh6h8_JVDxLOpV1VJ5qmw1w3hf1L7XM6tbZghHfq6F59FZnsEO0yPcg_MCrX-LaiEwQdZ9WGgsezjzGmTXcm7WRdLK8a8wiILsDPc-bVcm7Bq9NZunbWGpQ60WAsu1d3v-JJDmEVb7wnqDVttgXoYDaos6N_vQCqtMmwKLU-J77HTioOb7MgAThiUFm7qLT2YJcqSW_ae_HTHaRZPONNDjNuN4lnr5TKJTf5w5Gvt7T3GOrOnDtzAdUidMDmVyzxgAEFacCj4uiQHYAx6SanC5C5mcZDh912iW_zC8jTJuINwSHuJWSIKUDfMSJCnjw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 09:21:35.345 +04:00 [ERR] Request validation failed
2019-03-06 09:21:35.346 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5001/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5001/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874464949065367.NmZhYTQyMWUtOWI2Yi00MDFiLWFhMmYtY2Y1MjEwM2ZjMTA5NDA1NTFmZWMtYzVlZC00OWU4LTk2YzYtMzc5ZWQ5MmY4YWQ0","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCPrh6h8_JVDxLOpV1VJ5qmw1w3hf1L7XM6tbZghHfq6F59FZnsEO0yPcg_MCrX-LaiEwQdZ9WGgsezjzGmTXcm7WRdLK8a8wiILsDPc-bVcm7Bq9NZunbWGpQ60WAsu1d3v-JJDmEVb7wnqDVttgXoYDaos6N_vQCqtMmwKLU-J77HTioOb7MgAThiUFm7qLT2YJcqSW_ae_HTHaRZPONNDjNuN4lnr5TKJTf5w5Gvt7T3GOrOnDtzAdUidMDmVyzxgAEFacCj4uiQHYAx6SanC5C5mcZDh912iW_zC8jTJuINwSHuJWSIKUDfMSJCnjw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 09:21:35.374 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Authorize","SubjectId":null,"Scopes":"","GrantType":null,"Error":"unauthorized_client","ErrorDescription":"Invalid redirect_uri","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLL1UE8TM8HJ:00000003","TimeStamp":"2019-03-06T05:21:35.0000000Z","ProcessId":11952,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-03-06 09:29:03.236 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 09:29:03.293 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 09:29:03.294 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 09:29:03.294 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 09:29:03.294 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 09:29:03.295 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 09:29:03.295 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 09:29:03.867 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:29:03.882 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:29:03.885 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:29:03.964 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 09:29:04.021 +04:00 [DBG] Starting grant removal
2019-03-06 09:29:04.816 +04:00 [DBG] Login Url: Account/Login
2019-03-06 09:29:04.820 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 09:29:04.821 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 09:29:04.822 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 09:29:04.823 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 09:29:04.823 +04:00 [DBG] Error Url: /home/error
2019-03-06 09:29:04.824 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 09:29:04.868 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 09:29:05.041 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-06 09:29:18.638 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-06 09:29:18.644 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-06 09:29:18.647 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-06 09:29:18.652 +04:00 [DBG] Start discovery request
2019-03-06 09:29:19.292 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-06 09:29:19.426 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-06 09:29:19.428 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-06 09:29:19.433 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-06 09:29:19.437 +04:00 [DBG] Start key discovery request
2019-03-06 09:29:19.551 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-06 09:29:19.559 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-06 09:29:19.570 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-06 09:29:19.576 +04:00 [DBG] Start authorize request
2019-03-06 09:29:19.588 +04:00 [DBG] No user present in authorize request
2019-03-06 09:29:19.593 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 09:29:19.926 +04:00 [DBG] BiLab found in database: true
2019-03-06 09:29:19.935 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 09:29:19.952 +04:00 [ERR] Invalid redirect_uri: https://localhost:5001/signin-oidc
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5001/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5001/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874469594835237.NTUxNzhlNDItOTM1ZS00NzYzLWIzMGQtZWQ3YTQ3NDZlNmFlOTY5NDc3OWUtMjA4NC00NGFlLWFkOGEtOWUxZjk3ZWUzYzc2","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAzVnqhg7v0370uIH0I03nCTbORA58Ma5GUZyXgRCoM4sQIqcf5itt1OvSVI8tKGMKg6jjnUcm30eroid6kZj3N6pLPx6f_9yZkq82UwFn46T2XxIMpLHmOOej_FvQDn7jP3o3T0iaQAvrQuOPDMh4RFdQlmLUBoi2sH-KwN_Sg4NYkMlKctbrz0rSgpzqmiZEzTs-oGfh6UBSWPai2q-puRnDTss0R5ys2vjmt1ocu34KdLbf50UsgBVs7Hxc1KHMaFP7ybqvf_gvs_Mo1ZYWVOFSZpHLx14Gf0lVTmlwjiibDzW1WGedAOdBWOIPN8hE","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 09:29:19.972 +04:00 [ERR] Request validation failed
2019-03-06 09:29:19.973 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5001/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5001/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874469594835237.NTUxNzhlNDItOTM1ZS00NzYzLWIzMGQtZWQ3YTQ3NDZlNmFlOTY5NDc3OWUtMjA4NC00NGFlLWFkOGEtOWUxZjk3ZWUzYzc2","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAzVnqhg7v0370uIH0I03nCTbORA58Ma5GUZyXgRCoM4sQIqcf5itt1OvSVI8tKGMKg6jjnUcm30eroid6kZj3N6pLPx6f_9yZkq82UwFn46T2XxIMpLHmOOej_FvQDn7jP3o3T0iaQAvrQuOPDMh4RFdQlmLUBoi2sH-KwN_Sg4NYkMlKctbrz0rSgpzqmiZEzTs-oGfh6UBSWPai2q-puRnDTss0R5ys2vjmt1ocu34KdLbf50UsgBVs7Hxc1KHMaFP7ybqvf_gvs_Mo1ZYWVOFSZpHLx14Gf0lVTmlwjiibDzW1WGedAOdBWOIPN8hE","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 09:29:20.002 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Authorize","SubjectId":null,"Scopes":"","GrantType":null,"Error":"unauthorized_client","ErrorDescription":"Invalid redirect_uri","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLL1UIIQ9H3U:00000003","TimeStamp":"2019-03-06T05:29:19.0000000Z","ProcessId":5036,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-03-06 09:31:37.670 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 09:31:37.727 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 09:31:37.728 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 09:31:37.728 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 09:31:37.729 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 09:31:37.729 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 09:31:37.729 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 09:31:38.338 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:31:38.354 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:31:38.356 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:31:38.450 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 09:31:38.526 +04:00 [DBG] Starting grant removal
2019-03-06 09:31:39.277 +04:00 [DBG] Login Url: Account/Login
2019-03-06 09:31:39.280 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 09:31:39.282 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 09:31:39.283 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 09:31:39.284 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 09:31:39.285 +04:00 [DBG] Error Url: /home/error
2019-03-06 09:31:39.287 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 09:31:39.326 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 09:31:39.498 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-06 09:32:01.288 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 09:32:01.345 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 09:32:01.345 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 09:32:01.345 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 09:32:01.346 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 09:32:01.346 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 09:32:01.346 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 09:32:01.928 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:32:01.945 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:32:01.947 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:32:02.032 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 09:32:02.086 +04:00 [DBG] Starting grant removal
2019-03-06 09:32:02.917 +04:00 [DBG] Login Url: Account/Login
2019-03-06 09:32:02.921 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 09:32:02.923 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 09:32:02.924 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 09:32:02.924 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 09:32:02.925 +04:00 [DBG] Error Url: /home/error
2019-03-06 09:32:02.926 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 09:32:02.965 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 09:32:03.131 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-06 09:33:04.305 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 09:33:04.365 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 09:33:04.366 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 09:33:04.366 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 09:33:04.366 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 09:33:04.366 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 09:33:04.367 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 09:33:04.950 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:33:04.964 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:33:04.968 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:33:05.044 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 09:33:05.095 +04:00 [DBG] Starting grant removal
2019-03-06 09:33:05.690 +04:00 [DBG] Login Url: Account/Login
2019-03-06 09:33:05.694 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 09:33:05.694 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 09:33:05.696 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 09:33:05.696 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 09:33:05.697 +04:00 [DBG] Error Url: /home/error
2019-03-06 09:33:05.699 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 09:33:05.738 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 09:33:05.918 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-06 09:35:26.239 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 09:35:26.300 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 09:35:26.301 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 09:35:26.301 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 09:35:26.301 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 09:35:26.302 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 09:35:26.302 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 09:35:26.877 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:35:26.892 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:35:26.895 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:35:26.974 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 09:35:27.039 +04:00 [DBG] Starting grant removal
2019-03-06 09:35:27.507 +04:00 [DBG] Login Url: Account/Login
2019-03-06 09:35:27.514 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 09:35:27.515 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 09:35:27.516 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 09:35:27.517 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 09:35:27.517 +04:00 [DBG] Error Url: /home/error
2019-03-06 09:35:27.518 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 09:35:27.557 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 09:35:27.752 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-06 09:36:05.448 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 09:36:05.504 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 09:36:05.506 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 09:36:05.507 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 09:36:05.508 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 09:36:05.509 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 09:36:05.509 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 09:36:06.090 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:36:06.105 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:36:06.108 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:36:06.196 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 09:36:06.255 +04:00 [DBG] Starting grant removal
2019-03-06 09:36:07.048 +04:00 [DBG] Login Url: Account/Login
2019-03-06 09:36:07.051 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 09:36:07.053 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 09:36:07.053 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 09:36:07.054 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 09:36:07.055 +04:00 [DBG] Error Url: /home/error
2019-03-06 09:36:07.056 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 09:36:07.088 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 09:36:07.251 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-06 09:36:48.732 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-06 09:36:48.738 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-06 09:36:48.740 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-06 09:36:48.747 +04:00 [DBG] Start discovery request
2019-03-06 09:36:49.353 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-06 09:36:49.497 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-06 09:36:49.499 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-06 09:36:49.500 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-06 09:36:49.504 +04:00 [DBG] Start key discovery request
2019-03-06 09:36:49.592 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-06 09:36:49.597 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-06 09:36:49.598 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-06 09:36:49.603 +04:00 [DBG] Start authorize request
2019-03-06 09:36:49.614 +04:00 [DBG] No user present in authorize request
2019-03-06 09:36:49.619 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 09:36:49.936 +04:00 [DBG] BiLab found in database: true
2019-03-06 09:36:49.944 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 09:36:49.962 +04:00 [ERR] Invalid redirect_uri: https://localhost:5001/signin-oidc
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5001/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5001/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874474095654718.Mzk4OWUxMzktZWRhMi00MzQ1LWEwYmYtODM1OWZiZTZkOTA2MjRmZGJkYzYtYTY1ZS00NTVjLTlhZTgtODQwMDhiMDJmZmEx","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDvq5vSrwNyDAz-pW-Jpjuyi6mAo6KOHA3SYljMNp1qL3RajlxjffoRpO2Vtt4FFDPgeZ34afdiP5mWcqeT0bBrE-G_pBYi4Ci4frGOT659Mz-fZ610dxPBZEYZ9ckT6i79FzY9kK0iZF6BWOqwRnqdD9OXIvWInFYvHZvNPnaOaJ-jVfKjKLFmVxWauUPrJOmLd1OJEsh7z73xmvtdjoNbB2OxyKJbhDQKI29eXpmgGwQyrJ7oUsEj3PfQas2n7wQhUxKDoa0qsElI-Y4aMzoCP-XJAjIp6Gs2TYQ54sQXnHm5Ge5EFZALmYQoFwa0InE","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 09:36:49.975 +04:00 [ERR] Request validation failed
2019-03-06 09:36:49.976 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5001/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5001/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874474095654718.Mzk4OWUxMzktZWRhMi00MzQ1LWEwYmYtODM1OWZiZTZkOTA2MjRmZGJkYzYtYTY1ZS00NTVjLTlhZTgtODQwMDhiMDJmZmEx","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDvq5vSrwNyDAz-pW-Jpjuyi6mAo6KOHA3SYljMNp1qL3RajlxjffoRpO2Vtt4FFDPgeZ34afdiP5mWcqeT0bBrE-G_pBYi4Ci4frGOT659Mz-fZ610dxPBZEYZ9ckT6i79FzY9kK0iZF6BWOqwRnqdD9OXIvWInFYvHZvNPnaOaJ-jVfKjKLFmVxWauUPrJOmLd1OJEsh7z73xmvtdjoNbB2OxyKJbhDQKI29eXpmgGwQyrJ7oUsEj3PfQas2n7wQhUxKDoa0qsElI-Y4aMzoCP-XJAjIp6Gs2TYQ54sQXnHm5Ge5EFZALmYQoFwa0InE","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 09:36:50.002 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Authorize","SubjectId":null,"Scopes":"","GrantType":null,"Error":"unauthorized_client","ErrorDescription":"Invalid redirect_uri","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLL1UMGMJIJ3:00000003","TimeStamp":"2019-03-06T05:36:49.0000000Z","ProcessId":10768,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-03-06 09:41:37.761 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 09:41:37.820 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 09:41:37.821 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 09:41:37.821 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 09:41:37.821 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 09:41:37.822 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 09:41:37.822 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 09:41:38.041 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:41:38.059 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:41:38.062 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:41:38.143 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 09:41:38.197 +04:00 [DBG] Starting grant removal
2019-03-06 09:41:38.987 +04:00 [DBG] Login Url: Account/Login
2019-03-06 09:41:38.990 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 09:41:38.991 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 09:41:38.993 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 09:41:38.994 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 09:41:38.994 +04:00 [DBG] Error Url: /home/error
2019-03-06 09:41:38.995 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 09:41:39.031 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 09:41:39.192 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-06 09:41:44.523 +04:00 [DBG] Augmenting SignInContext
2019-03-06 09:41:44.537 +04:00 [DBG] Adding idp claim with value: local
2019-03-06 09:41:44.537 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-06 09:41:44.538 +04:00 [DBG] Adding auth_time claim with value: 1551850904
2019-03-06 09:41:44.554 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 09:41:44.593 +04:00 [INF] {"Username":"godAdmin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"1002","DisplayName":"godAdmin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL1UPJK2FR9:00000003","TimeStamp":"2019-03-06T05:41:44.0000000Z","ProcessId":11032,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-06 09:44:59.498 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 09:44:59.559 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 09:44:59.561 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 09:44:59.562 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 09:44:59.563 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 09:44:59.564 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 09:44:59.564 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 09:44:59.789 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:44:59.806 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:44:59.808 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:44:59.893 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 09:44:59.953 +04:00 [DBG] Starting grant removal
2019-03-06 09:45:00.558 +04:00 [DBG] Login Url: Account/Login
2019-03-06 09:45:00.561 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 09:45:00.563 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 09:45:00.564 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 09:45:00.565 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 09:45:00.568 +04:00 [DBG] Error Url: /home/error
2019-03-06 09:45:00.568 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 09:45:00.629 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 09:45:40.086 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 09:45:40.146 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 09:45:40.147 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 09:45:40.147 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 09:45:40.149 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 09:45:40.149 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 09:45:40.150 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 09:45:40.379 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:45:40.396 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:45:40.399 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:45:40.486 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 09:45:40.552 +04:00 [DBG] Starting grant removal
2019-03-06 09:45:41.366 +04:00 [DBG] Login Url: Account/Login
2019-03-06 09:45:41.371 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 09:45:41.371 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 09:45:41.372 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 09:45:41.372 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 09:45:41.373 +04:00 [DBG] Error Url: /home/error
2019-03-06 09:45:41.373 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 09:45:41.432 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 09:46:15.294 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-06 09:46:15.302 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-06 09:46:15.303 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-06 09:46:15.310 +04:00 [DBG] Start discovery request
2019-03-06 09:46:15.782 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-06 09:46:15.918 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-06 09:46:15.922 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-06 09:46:15.925 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-06 09:46:15.930 +04:00 [DBG] Start key discovery request
2019-03-06 09:46:16.029 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-06 09:46:16.036 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-06 09:46:16.039 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-06 09:46:16.045 +04:00 [DBG] Start authorize request
2019-03-06 09:46:16.058 +04:00 [DBG] User in authorize request: 1002
2019-03-06 09:46:16.062 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 09:46:16.384 +04:00 [DBG] BiLab found in database: true
2019-03-06 09:46:16.393 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 09:46:16.412 +04:00 [ERR] Invalid redirect_uri: https://localhost:5002/signin-oidc
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874479759940079.YzU0ZmJiYTYtMzU3My00M2FmLWJhZmMtZGZhYTM2ZWE1MTkwNDg2YjFlODItNDY1MS00NTczLWI1OTgtMjQyNGQwZjA0ZTJh","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCU5dDXZLOBPQjs6SuPzyb0n_wLHoncGuaOKAbZVUao2cObcEoq2bUyixD7KEn9LxW-y85oXyDGmJvSwMR2rOZ_9NdzbVsrYI81XlzVPAA0ZfH7mjjcYy8MSF7vahad1lEXw8XTPXBpDXcUZS84asn9spsHyGdyYdsCxpGYzTLtvRD_d3nhP2Vb3_X3-jb6YhgUra4VGvlw7LRqJh1YIpO7mHL8ExFeOLvXf4C-jGmlOMkp6SUObo2ej9Xa2GsjcYOz0mPEICrJwNDTx6S5otVwfyI6IfyPblnac92AdyklbXUX6klcIGXuU5xQBNVBG9Q","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 09:46:16.428 +04:00 [ERR] Request validation failed
2019-03-06 09:46:16.430 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874479759940079.YzU0ZmJiYTYtMzU3My00M2FmLWJhZmMtZGZhYTM2ZWE1MTkwNDg2YjFlODItNDY1MS00NTczLWI1OTgtMjQyNGQwZjA0ZTJh","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCU5dDXZLOBPQjs6SuPzyb0n_wLHoncGuaOKAbZVUao2cObcEoq2bUyixD7KEn9LxW-y85oXyDGmJvSwMR2rOZ_9NdzbVsrYI81XlzVPAA0ZfH7mjjcYy8MSF7vahad1lEXw8XTPXBpDXcUZS84asn9spsHyGdyYdsCxpGYzTLtvRD_d3nhP2Vb3_X3-jb6YhgUra4VGvlw7LRqJh1YIpO7mHL8ExFeOLvXf4C-jGmlOMkp6SUObo2ej9Xa2GsjcYOz0mPEICrJwNDTx6S5otVwfyI6IfyPblnac92AdyklbXUX6klcIGXuU5xQBNVBG9Q","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 09:46:16.457 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Authorize","SubjectId":"1002","Scopes":"","GrantType":null,"Error":"unauthorized_client","ErrorDescription":"Invalid redirect_uri","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLL1URRQN379:00000002","TimeStamp":"2019-03-06T05:46:16.0000000Z","ProcessId":16092,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-03-06 09:47:25.370 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 09:47:25.423 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 09:47:25.424 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 09:47:25.424 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 09:47:25.425 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 09:47:25.425 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 09:47:25.425 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 09:47:25.659 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:47:25.684 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:47:25.687 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:47:25.777 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 09:47:25.831 +04:00 [DBG] Starting grant removal
2019-03-06 09:47:26.578 +04:00 [DBG] Login Url: Account/Login
2019-03-06 09:47:26.581 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 09:47:26.583 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 09:47:26.584 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 09:47:26.584 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 09:47:26.585 +04:00 [DBG] Error Url: /home/error
2019-03-06 09:47:26.587 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 09:47:26.645 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 09:48:45.650 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 09:48:45.709 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 09:48:45.710 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 09:48:45.710 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 09:48:45.711 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 09:48:45.711 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 09:48:45.711 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 09:48:45.930 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:48:45.944 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:48:45.947 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:48:46.029 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 09:48:46.083 +04:00 [DBG] Starting grant removal
2019-03-06 09:48:46.762 +04:00 [DBG] Login Url: Account/Login
2019-03-06 09:48:46.765 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 09:48:46.766 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 09:48:46.768 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 09:48:46.768 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 09:48:46.769 +04:00 [DBG] Error Url: /home/error
2019-03-06 09:48:46.770 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 09:48:46.840 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 09:49:23.398 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 09:49:23.454 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 09:49:23.455 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 09:49:23.455 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 09:49:23.456 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 09:49:23.456 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 09:49:23.456 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 09:49:23.654 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:49:23.669 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:49:23.673 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:49:23.750 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 09:49:23.804 +04:00 [DBG] Starting grant removal
2019-03-06 09:49:24.648 +04:00 [DBG] Login Url: Account/Login
2019-03-06 09:49:24.654 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 09:49:24.655 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 09:49:24.656 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 09:49:24.657 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 09:49:24.657 +04:00 [DBG] Error Url: /home/error
2019-03-06 09:49:24.658 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 09:49:24.713 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 09:49:41.366 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-06 09:49:41.372 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-06 09:49:41.374 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-06 09:49:41.378 +04:00 [DBG] Start discovery request
2019-03-06 09:49:41.591 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-06 09:49:41.735 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-06 09:49:41.737 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-06 09:49:41.738 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-06 09:49:41.743 +04:00 [DBG] Start key discovery request
2019-03-06 09:49:41.836 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-06 09:49:41.846 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-06 09:49:41.848 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-06 09:49:41.860 +04:00 [DBG] Start authorize request
2019-03-06 09:49:41.872 +04:00 [DBG] User in authorize request: 1002
2019-03-06 09:49:41.877 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 09:49:42.060 +04:00 [DBG] BiLab found in database: true
2019-03-06 09:49:42.069 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 09:49:42.086 +04:00 [ERR] Invalid redirect_uri: https://localhost:5002/signin-oidc
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874481818103209.ZjdkMWU5YmMtYjY5My00NTUzLThhMmEtMmY3NjAyOThjNGE3NzQxMzBkNjItNjEyOC00OTMwLThhOTktNWY0ZTc1YzJjYWEw","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDQVSThxKsVEcihUCCje2G2jkedBy-0wJso296e5e8AHY-peQZ1-l1cCQPz12hv9xmws6B-9j-CQvqMNJs4n1UyEprEXVDLzWMCHvTYgwNVGnQjEVn3ZxHqOhIu3EXOIn6Zf2ld3PqOzFZGx5PIabjzm14gC6rirV4oK0_gDQgngQN4BT7yJUF_bSOwn_Pb2cumbFkk_0boFb0uFGEAlm5htsTKQHLFaESveEchKhWM3tnLhVDDz1pTeIuXMKgBoUx4Ide_sVKTJpD8TH6CNMrU8f3llh0f23wQykOc0WsXT-_MIdqdvjlD6AsDyqjkDEI","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 09:49:42.102 +04:00 [ERR] Request validation failed
2019-03-06 09:49:42.103 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874481818103209.ZjdkMWU5YmMtYjY5My00NTUzLThhMmEtMmY3NjAyOThjNGE3NzQxMzBkNjItNjEyOC00OTMwLThhOTktNWY0ZTc1YzJjYWEw","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDQVSThxKsVEcihUCCje2G2jkedBy-0wJso296e5e8AHY-peQZ1-l1cCQPz12hv9xmws6B-9j-CQvqMNJs4n1UyEprEXVDLzWMCHvTYgwNVGnQjEVn3ZxHqOhIu3EXOIn6Zf2ld3PqOzFZGx5PIabjzm14gC6rirV4oK0_gDQgngQN4BT7yJUF_bSOwn_Pb2cumbFkk_0boFb0uFGEAlm5htsTKQHLFaESveEchKhWM3tnLhVDDz1pTeIuXMKgBoUx4Ide_sVKTJpD8TH6CNMrU8f3llh0f23wQykOc0WsXT-_MIdqdvjlD6AsDyqjkDEI","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 09:49:42.136 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Authorize","SubjectId":"1002","Scopes":"","GrantType":null,"Error":"unauthorized_client","ErrorDescription":"Invalid redirect_uri","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLL1UTUCVPL5:00000001","TimeStamp":"2019-03-06T05:49:42.0000000Z","ProcessId":9156,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-03-06 09:52:18.890 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 09:52:18.939 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 09:52:18.940 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 09:52:18.940 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 09:52:18.940 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 09:52:18.941 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 09:52:18.941 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 09:52:19.165 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:52:19.178 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:52:19.181 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:52:19.259 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 09:52:19.317 +04:00 [DBG] Starting grant removal
2019-03-06 09:52:20.114 +04:00 [DBG] Login Url: Account/Login
2019-03-06 09:52:20.119 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 09:52:20.121 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 09:52:20.125 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 09:52:20.125 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 09:52:20.126 +04:00 [DBG] Error Url: /home/error
2019-03-06 09:52:20.128 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 09:52:20.206 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 09:55:12.018 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 09:55:12.069 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 09:55:12.070 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 09:55:12.070 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 09:55:12.070 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 09:55:12.071 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 09:55:12.071 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 09:55:12.291 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:55:12.306 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:55:12.309 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:55:12.391 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 09:55:12.444 +04:00 [DBG] Starting grant removal
2019-03-06 09:55:13.067 +04:00 [DBG] Login Url: Account/Login
2019-03-06 09:55:13.071 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 09:55:13.072 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 09:55:13.073 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 09:55:13.073 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 09:55:13.076 +04:00 [DBG] Error Url: /home/error
2019-03-06 09:55:13.076 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 09:55:13.135 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 09:56:05.161 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 09:56:05.212 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 09:56:05.213 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 09:56:05.213 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 09:56:05.213 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 09:56:05.214 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 09:56:05.214 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 09:56:05.460 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:56:05.475 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:56:05.478 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:56:05.561 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 09:56:05.615 +04:00 [DBG] Starting grant removal
2019-03-06 09:56:06.341 +04:00 [DBG] Login Url: Account/Login
2019-03-06 09:56:06.345 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 09:56:06.345 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 09:56:06.346 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 09:56:06.347 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 09:56:06.347 +04:00 [DBG] Error Url: /home/error
2019-03-06 09:56:06.348 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 09:56:06.404 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 09:56:17.652 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-06 09:56:17.658 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-06 09:56:17.659 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-06 09:56:17.663 +04:00 [DBG] Start discovery request
2019-03-06 09:56:18.146 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-06 09:56:18.283 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-06 09:56:18.286 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-06 09:56:18.287 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-06 09:56:18.292 +04:00 [DBG] Start key discovery request
2019-03-06 09:56:18.391 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-06 09:56:18.400 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-06 09:56:18.401 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-06 09:56:18.406 +04:00 [DBG] Start authorize request
2019-03-06 09:56:18.419 +04:00 [DBG] User in authorize request: 1002
2019-03-06 09:56:18.423 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 09:56:18.731 +04:00 [DBG] BiLab found in database: true
2019-03-06 09:56:18.739 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 09:56:18.757 +04:00 [ERR] Invalid redirect_uri: https://localhost:5002/signin-oidc
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874485783567472.YWExNTA5YjgtMzJkYS00OWU3LWE4ZmUtNDE4M2FjZDQ3ODcyNzJjMDgwZWEtZWNlMC00MTcwLTk0MjgtN2RkZGNhMzljYmM5","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAnjvsWPIgJwI_m1ETtGqEzGMm_L6VbZBkvIdCeodUe1U0rBedgv43m3BTBUgON_ly6MJDaFA4eg-y0D9VMZSE7rGuS9I5Wq3JjdNxuSR19J0L4jZPF06MldMZU-BE4FjeRLw7bEZhB4gvCg8Xy8EK_mFrvYZDuVwAofu4uDSoaD2qXtFdOqGUieej0FHit4O-NIxjYyqZMiumXGX_9gIijczSau44h-YobrUQTwzLUWmoCkXR3n2T_0Ld2x5m0U4Ws9fqdHTqhMmdthRpf16WwWBNrqMfbZ7kOo5m_F-ixvUJ-NAsm8YRknHZXup1Jcy8","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 09:56:18.773 +04:00 [ERR] Request validation failed
2019-03-06 09:56:18.775 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874485783567472.YWExNTA5YjgtMzJkYS00OWU3LWE4ZmUtNDE4M2FjZDQ3ODcyNzJjMDgwZWEtZWNlMC00MTcwLTk0MjgtN2RkZGNhMzljYmM5","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAnjvsWPIgJwI_m1ETtGqEzGMm_L6VbZBkvIdCeodUe1U0rBedgv43m3BTBUgON_ly6MJDaFA4eg-y0D9VMZSE7rGuS9I5Wq3JjdNxuSR19J0L4jZPF06MldMZU-BE4FjeRLw7bEZhB4gvCg8Xy8EK_mFrvYZDuVwAofu4uDSoaD2qXtFdOqGUieej0FHit4O-NIxjYyqZMiumXGX_9gIijczSau44h-YobrUQTwzLUWmoCkXR3n2T_0Ld2x5m0U4Ws9fqdHTqhMmdthRpf16WwWBNrqMfbZ7kOo5m_F-ixvUJ-NAsm8YRknHZXup1Jcy8","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 09:56:18.804 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Authorize","SubjectId":"1002","Scopes":"","GrantType":null,"Error":"unauthorized_client","ErrorDescription":"Invalid redirect_uri","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLL1V1M2AVGM:00000002","TimeStamp":"2019-03-06T05:56:18.0000000Z","ProcessId":1824,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-03-06 09:57:10.039 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-06 09:57:10.043 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-06 09:57:10.044 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-06 09:57:10.046 +04:00 [DBG] Start authorize request
2019-03-06 09:57:10.047 +04:00 [DBG] No user present in authorize request
2019-03-06 09:57:10.048 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 09:57:10.077 +04:00 [DBG] BiLab found in database: true
2019-03-06 09:57:10.078 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 09:57:10.081 +04:00 [ERR] Invalid redirect_uri: https://localhost:5002/signin-oidc
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874486300265583.NjFlN2NlOGItMmYxYS00OTNjLWJjODUtOGEwZThmOWM0ZTU0ZjYyNDVlNWQtYTRmNy00YmQ2LThkZTYtYjJhMGRiOTdlZGZi","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCRjnuaLMmI_XkfCIS_foubPfNhBDkRkTvZj71t_4eX2Q5iJ-irdmpsHjRu3pSDAovnVotariBLwQt29yWkiS5H2NLQMKTal88zvBjd62-4SnoJwxJJrv6RCqX5wMixKTL1MxGal8bl7AeJjSJwLX0N1aGsoUU36c_YIUfrjajXyzcT_2mW0OJwgW8GkVIxv5bHIulaAEoDwjDkX9JXk2i35f--4CpfOp7BnImdfMR8dwMb3RLecUg2O8EFwQ_wv83WxcMsrxut3XKDSIpiePW0rE09XhDagr4uRftTvAtKbUG6h_KRd61H55Scp2cDUlc","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 09:57:10.095 +04:00 [ERR] Request validation failed
2019-03-06 09:57:10.097 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874486300265583.NjFlN2NlOGItMmYxYS00OTNjLWJjODUtOGEwZThmOWM0ZTU0ZjYyNDVlNWQtYTRmNy00YmQ2LThkZTYtYjJhMGRiOTdlZGZi","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCRjnuaLMmI_XkfCIS_foubPfNhBDkRkTvZj71t_4eX2Q5iJ-irdmpsHjRu3pSDAovnVotariBLwQt29yWkiS5H2NLQMKTal88zvBjd62-4SnoJwxJJrv6RCqX5wMixKTL1MxGal8bl7AeJjSJwLX0N1aGsoUU36c_YIUfrjajXyzcT_2mW0OJwgW8GkVIxv5bHIulaAEoDwjDkX9JXk2i35f--4CpfOp7BnImdfMR8dwMb3RLecUg2O8EFwQ_wv83WxcMsrxut3XKDSIpiePW0rE09XhDagr4uRftTvAtKbUG6h_KRd61H55Scp2cDUlc","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 09:57:10.109 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Authorize","SubjectId":null,"Scopes":"","GrantType":null,"Error":"unauthorized_client","ErrorDescription":"Invalid redirect_uri","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLL1V1M2AVGS:00000001","TimeStamp":"2019-03-06T05:57:10.0000000Z","ProcessId":1824,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-03-06 09:59:45.764 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 09:59:45.821 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 09:59:45.822 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 09:59:45.822 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 09:59:45.822 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 09:59:45.823 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 09:59:45.823 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 09:59:46.067 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:59:46.082 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:59:46.084 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 09:59:46.163 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 09:59:46.219 +04:00 [DBG] Starting grant removal
2019-03-06 09:59:46.883 +04:00 [DBG] Login Url: Account/Login
2019-03-06 09:59:46.886 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 09:59:46.887 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 09:59:46.888 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 09:59:46.889 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 09:59:46.889 +04:00 [DBG] Error Url: /home/error
2019-03-06 09:59:46.890 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 09:59:46.959 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 10:00:12.844 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-06 10:00:12.851 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-06 10:00:12.852 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-06 10:00:12.856 +04:00 [DBG] Start discovery request
2019-03-06 10:00:13.317 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-06 10:00:13.452 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-06 10:00:13.455 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-06 10:00:13.455 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-06 10:00:13.459 +04:00 [DBG] Start key discovery request
2019-03-06 10:00:13.567 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-06 10:00:13.574 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-06 10:00:13.575 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-06 10:00:13.581 +04:00 [DBG] Start authorize request
2019-03-06 10:00:13.593 +04:00 [DBG] User in authorize request: 1002
2019-03-06 10:00:13.599 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 10:00:13.879 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:00:13.887 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:00:13.903 +04:00 [ERR] Invalid redirect_uri: https://localhost:5002/signin-oidc
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874488135269398.YzJhMmIzYjUtYThjZS00YjFlLThkNWMtNzZkODdjN2FhMWRlNTJjNDQzOTctZmExMS00N2FiLWIzODYtYzY4NGIwNGJjYjg3","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCfjQQnioLkLewG-x32uo2bMvipHTM6IIUnZNzedQlH8l5n2Mgqchy2tkprkxGlaY7Fjc9VrPP9mno2lMDFGD9iu0nwDlCMW_px2sZisH3Qo6O1XbOP_1jBqyllb-HCh7DYQZTYU6ZAmYzwME1vZUmR0OcpX2r3mRfrOAfjsfv2UIDdYOpkvfsVsTcFcOFsC8LEdHz33rWdNGE3Eu9Mlp9i6lkrUPLmjmpPySoqZfxTQYSdHSsQIDVFVKxuls73ChTjAPwyZ442EsmF84BVYA-hXIHFKMctfGs8c10QKLhA6rF-2ZAG-5bfmKAwWqGcorI","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 10:00:13.924 +04:00 [ERR] Request validation failed
2019-03-06 10:00:13.925 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874488135269398.YzJhMmIzYjUtYThjZS00YjFlLThkNWMtNzZkODdjN2FhMWRlNTJjNDQzOTctZmExMS00N2FiLWIzODYtYzY4NGIwNGJjYjg3","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCfjQQnioLkLewG-x32uo2bMvipHTM6IIUnZNzedQlH8l5n2Mgqchy2tkprkxGlaY7Fjc9VrPP9mno2lMDFGD9iu0nwDlCMW_px2sZisH3Qo6O1XbOP_1jBqyllb-HCh7DYQZTYU6ZAmYzwME1vZUmR0OcpX2r3mRfrOAfjsfv2UIDdYOpkvfsVsTcFcOFsC8LEdHz33rWdNGE3Eu9Mlp9i6lkrUPLmjmpPySoqZfxTQYSdHSsQIDVFVKxuls73ChTjAPwyZ442EsmF84BVYA-hXIHFKMctfGs8c10QKLhA6rF-2ZAG-5bfmKAwWqGcorI","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 10:00:13.955 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Authorize","SubjectId":"1002","Scopes":"","GrantType":null,"Error":"unauthorized_client","ErrorDescription":"Invalid redirect_uri","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLL1V3NR2MAP:00000002","TimeStamp":"2019-03-06T06:00:13.0000000Z","ProcessId":12460,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-03-06 10:00:42.923 +04:00 [ERR] The view 'Error' was not found. Searched locations: ["/Views/Home/Error.cshtml","/Views/Shared/Error.cshtml","/Pages/Shared/Error.cshtml"]
2019-03-06 10:00:42.930 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The view 'Error' was not found. The following locations were searched:
/Views/Home/Error.cshtml
/Views/Shared/Error.cshtml
/Pages/Shared/Error.cshtml
   at Microsoft.AspNetCore.Mvc.ViewEngines.ViewEngineResult.EnsureSuccessful(IEnumerable`1 originalLocations)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-03-06 10:02:02.231 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 10:02:02.282 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 10:02:02.283 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 10:02:02.284 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 10:02:02.284 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 10:02:02.285 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 10:02:02.285 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 10:02:02.506 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:02:02.521 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:02:02.523 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:02:02.601 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 10:02:02.660 +04:00 [DBG] Starting grant removal
2019-03-06 10:02:03.469 +04:00 [DBG] Login Url: Account/Login
2019-03-06 10:02:03.472 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 10:02:03.473 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 10:02:03.474 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 10:02:03.475 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 10:02:03.475 +04:00 [DBG] Error Url: /home/error
2019-03-06 10:02:03.476 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 10:02:03.539 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 10:02:16.111 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-06 10:02:16.117 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-06 10:02:16.119 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-06 10:02:16.125 +04:00 [DBG] Start discovery request
2019-03-06 10:02:16.588 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-06 10:02:16.746 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-06 10:02:16.749 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-06 10:02:16.750 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-06 10:02:16.755 +04:00 [DBG] Start key discovery request
2019-03-06 10:02:16.853 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-06 10:02:16.864 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-06 10:02:16.865 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-06 10:02:16.875 +04:00 [DBG] Start authorize request
2019-03-06 10:02:16.887 +04:00 [DBG] User in authorize request: 1002
2019-03-06 10:02:16.892 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 10:02:17.178 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:02:17.184 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:02:17.201 +04:00 [ERR] Invalid redirect_uri: https://localhost:5002/signin-oidc
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874489368170896.ZjAwZmVkMTYtN2QxYi00MzYyLTg3ZmYtMGIyNzhlYTZiMjU3NDhhNTliMzYtN2U4My00NjkzLTg5MmMtNWJiOTllYTAyYmMx","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYND7QyCB6tBNQxGljsihHRXVeh1y1IkjA1Zm4aH6JiePo8KQnNTEnXpxHPOWlM--n9ISDVZskyRJYRx6RRWKNtXXX2sPx3QtvAhKWq7RH3bAh97flqKxw2d30Dzl64KqkHwIYopduH_5_XFabIa9vTL3eyXr-D6PEpDaV-kUywQ5ARonkX4gOeTvr3ruYUbwYkF1ANXS7V_NDy6BPSRadeQJUz6bgadCEKzDeUY--ns1K_Nvz-lkaz9zoQHaGRjuKKH3d3JvLYerzg4ZLAmL9TsIiLs_0GcQHBW0VCPZnmoSlvuAk2dDV67DCII2hgUkZbk","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 10:02:17.222 +04:00 [ERR] Request validation failed
2019-03-06 10:02:17.223 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874489368170896.ZjAwZmVkMTYtN2QxYi00MzYyLTg3ZmYtMGIyNzhlYTZiMjU3NDhhNTliMzYtN2U4My00NjkzLTg5MmMtNWJiOTllYTAyYmMx","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYND7QyCB6tBNQxGljsihHRXVeh1y1IkjA1Zm4aH6JiePo8KQnNTEnXpxHPOWlM--n9ISDVZskyRJYRx6RRWKNtXXX2sPx3QtvAhKWq7RH3bAh97flqKxw2d30Dzl64KqkHwIYopduH_5_XFabIa9vTL3eyXr-D6PEpDaV-kUywQ5ARonkX4gOeTvr3ruYUbwYkF1ANXS7V_NDy6BPSRadeQJUz6bgadCEKzDeUY--ns1K_Nvz-lkaz9zoQHaGRjuKKH3d3JvLYerzg4ZLAmL9TsIiLs_0GcQHBW0VCPZnmoSlvuAk2dDV67DCII2hgUkZbk","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 10:02:17.259 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Authorize","SubjectId":"1002","Scopes":"","GrantType":null,"Error":"unauthorized_client","ErrorDescription":"Invalid redirect_uri","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLL1V50HKVDU:00000002","TimeStamp":"2019-03-06T06:02:17.0000000Z","ProcessId":7896,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-03-06 10:12:48.803 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 10:12:48.865 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 10:12:48.865 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 10:12:48.866 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 10:12:48.866 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 10:12:48.866 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 10:12:48.866 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 10:12:49.118 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:12:49.133 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:12:49.136 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:12:49.220 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 10:12:49.276 +04:00 [DBG] Starting grant removal
2019-03-06 10:12:49.869 +04:00 [DBG] Login Url: Account/Login
2019-03-06 10:12:49.872 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 10:12:49.875 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 10:12:49.876 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 10:12:49.876 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 10:12:49.877 +04:00 [DBG] Error Url: /home/error
2019-03-06 10:12:49.878 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 10:12:50.088 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 10:12:59.737 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 10:12:59.795 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 10:12:59.797 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 10:12:59.798 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 10:12:59.798 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 10:12:59.799 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 10:12:59.799 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 10:13:00.014 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:13:00.028 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:13:00.031 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:13:00.107 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 10:13:00.168 +04:00 [DBG] Starting grant removal
2019-03-06 10:13:00.745 +04:00 [DBG] Login Url: Account/Login
2019-03-06 10:13:00.750 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 10:13:00.751 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 10:13:00.752 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 10:13:00.752 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 10:13:00.753 +04:00 [DBG] Error Url: /home/error
2019-03-06 10:13:00.754 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 10:13:00.812 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 10:13:25.160 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 10:13:25.215 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 10:13:25.216 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 10:13:25.216 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 10:13:25.217 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 10:13:25.217 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 10:13:25.217 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 10:13:25.447 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:13:25.461 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:13:25.463 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:13:25.542 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 10:13:25.600 +04:00 [DBG] Starting grant removal
2019-03-06 10:13:26.206 +04:00 [DBG] Login Url: Account/Login
2019-03-06 10:13:26.210 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 10:13:26.212 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 10:13:26.213 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 10:13:26.213 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 10:13:26.214 +04:00 [DBG] Error Url: /home/error
2019-03-06 10:13:26.215 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 10:13:26.276 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 10:13:37.403 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-06 10:13:37.412 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-06 10:13:37.414 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-06 10:13:37.419 +04:00 [DBG] Start discovery request
2019-03-06 10:13:37.922 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-06 10:13:38.073 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-06 10:13:38.077 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-06 10:13:38.079 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-06 10:13:38.084 +04:00 [DBG] Start key discovery request
2019-03-06 10:13:38.188 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-06 10:13:38.196 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-06 10:13:38.197 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-06 10:13:38.203 +04:00 [DBG] Start authorize request
2019-03-06 10:13:38.216 +04:00 [DBG] User in authorize request: 1002
2019-03-06 10:13:38.220 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 10:13:38.517 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:13:38.525 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:13:38.535 +04:00 [DBG] Checking for PKCE parameters
2019-03-06 10:13:38.537 +04:00 [DBG] No PKCE used.
2019-03-06 10:13:38.589 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:13:38.637 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:13:38.649 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:13:38.651 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:13:38.660 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-06 10:13:38.675 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNC7TefmtnU6blnoUYrN3xlZH_zq6g3LIUxNywXt_LzlmGC97MxS4RrK0o3o1wxi-ir2luWdqevAaxyfkwkHtmUoTJcP_xVRvPIFNgLYs8vpZanoAQEenwMMs5NCWypxviXeYqMjmZj0114f5in51Izr-oqQgqQ-0y7bD4rYvnbjKNvgFQmstDm0MTeLwSJjgtlzXpouyiVHb6mrQx19hghZ1DsWgPKMU29-FWo5VRrbWdyE5NxkcF0yI8kEhc_b0gQWaMNnX5ylfjmvrkH__GagP1mHoP_-1YG4lcg33WpLeSjGrHxVsiqZllHfcNFeCtc","UiLocales":null,"Nonce":"636874496181529797.NDI4ZjEwNjctYzZiYy00MTcyLTkxMWQtNGFmMjYzYWExMjQzNWQ3ZTg3YTEtZjIxOC00MDQ4LTkyOTEtZjEzMDBjYjA4ZjYx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e1c3e9e002ebb4114055579ad33fe427","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874496181529797.NDI4ZjEwNjctYzZiYy00MTcyLTkxMWQtNGFmMjYzYWExMjQzNWQ3ZTg3YTEtZjIxOC00MDQ4LTkyOTEtZjEzMDBjYjA4ZjYx","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNC7TefmtnU6blnoUYrN3xlZH_zq6g3LIUxNywXt_LzlmGC97MxS4RrK0o3o1wxi-ir2luWdqevAaxyfkwkHtmUoTJcP_xVRvPIFNgLYs8vpZanoAQEenwMMs5NCWypxviXeYqMjmZj0114f5in51Izr-oqQgqQ-0y7bD4rYvnbjKNvgFQmstDm0MTeLwSJjgtlzXpouyiVHb6mrQx19hghZ1DsWgPKMU29-FWo5VRrbWdyE5NxkcF0yI8kEhc_b0gQWaMNnX5ylfjmvrkH__GagP1mHoP_-1YG4lcg33WpLeSjGrHxVsiqZllHfcNFeCtc","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 10:13:38.735 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-06 10:13:38.742 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-06 10:13:38.783 +04:00 [DBG] YuXKycKf79leCMXvYK13ikK1bxdUupSwv8Z6+fTbN7Q= not found in database
2019-03-06 10:13:38.845 +04:00 [DBG] Creating Implicit Flow response.
2019-03-06 10:13:38.854 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-06 10:13:38.859 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-06 10:13:38.965 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"1002","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****s1MA","$type":"Token"},{"TokenType":"code","TokenValue":"****8678","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL1VBBVTUAQ:00000002","TimeStamp":"2019-03-06T06:13:38.0000000Z","ProcessId":15884,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-06 10:13:38.972 +04:00 [INF] Authorize endpoint response
{"SubjectId":"1002","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNC7TefmtnU6blnoUYrN3xlZH_zq6g3LIUxNywXt_LzlmGC97MxS4RrK0o3o1wxi-ir2luWdqevAaxyfkwkHtmUoTJcP_xVRvPIFNgLYs8vpZanoAQEenwMMs5NCWypxviXeYqMjmZj0114f5in51Izr-oqQgqQ-0y7bD4rYvnbjKNvgFQmstDm0MTeLwSJjgtlzXpouyiVHb6mrQx19hghZ1DsWgPKMU29-FWo5VRrbWdyE5NxkcF0yI8kEhc_b0gQWaMNnX5ylfjmvrkH__GagP1mHoP_-1YG4lcg33WpLeSjGrHxVsiqZllHfcNFeCtc","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-06 10:13:39.001 +04:00 [DBG] Augmenting SignInContext
2019-03-06 10:13:39.015 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 10:13:39.153 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-06 10:13:39.160 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-06 10:13:39.161 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-06 10:13:39.174 +04:00 [DBG] Start token request.
2019-03-06 10:13:39.181 +04:00 [DBG] Start client validation
2019-03-06 10:13:39.186 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-06 10:13:39.190 +04:00 [DBG] Start parsing for secret in post body
2019-03-06 10:13:39.206 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-06 10:13:39.206 +04:00 [DBG] Secret id found: BiLab
2019-03-06 10:13:39.213 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:13:39.213 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:13:39.223 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-06 10:13:39.223 +04:00 [DBG] Client validation success
2019-03-06 10:13:39.224 +04:00 [INF] {"ClientId":"BiLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLL1VBBVTUAS:00000003","TimeStamp":"2019-03-06T06:13:39.0000000Z","ProcessId":15884,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-03-06 10:13:39.238 +04:00 [DBG] Start token request validation
2019-03-06 10:13:39.250 +04:00 [DBG] Start validation of authorization code token request
2019-03-06 10:13:39.268 +04:00 [DBG] YuXKycKf79leCMXvYK13ikK1bxdUupSwv8Z6+fTbN7Q= found in database: true
2019-03-06 10:13:39.286 +04:00 [DBG] removing YuXKycKf79leCMXvYK13ikK1bxdUupSwv8Z6+fTbN7Q= persisted grant from database
2019-03-06 10:13:39.299 +04:00 [DBG] Validation of authorization code token request success
2019-03-06 10:13:39.305 +04:00 [INF] Token request validation success
{"ClientId":"BiLab","ClientName":"BiLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"6eb72fbf96263106f707e96a1558ce98e5186a67373fa869d1cd248085ef8678","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"BiLab","client_secret":"***REDACTED***","code":"6eb72fbf96263106f707e96a1558ce98e5186a67373fa869d1cd248085ef8678","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-03-06 10:13:39.334 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:13:39.334 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:13:39.355 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:13:39.363 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:13:39.374 +04:00 [DBG] Getting claims for access token for client: BiLab
2019-03-06 10:13:39.375 +04:00 [DBG] Getting claims for access token for subject: 1002
2019-03-06 10:13:39.495 +04:00 [DBG] Creating refresh token
2019-03-06 10:13:39.495 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-03-06 10:13:39.508 +04:00 [DBG] VPh7UrTSt6cjLH6ZIk+D1dOpjlv7t+/jcepGDCMeFUk= not found in database
2019-03-06 10:13:39.522 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:13:39.522 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:13:39.526 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:13:39.530 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:13:39.531 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-06 10:13:39.532 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-06 10:13:39.538 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****xg3A","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****00fa","$type":"Token"},{"TokenType":"access_token","TokenValue":"****7VqA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL1VBBVTUAS:00000003","TimeStamp":"2019-03-06T06:13:39.0000000Z","ProcessId":15884,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-06 10:13:39.550 +04:00 [DBG] Token request success.
2019-03-06 10:14:17.120 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 10:14:17.171 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 10:14:17.172 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 10:14:17.174 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 10:14:17.175 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 10:14:17.175 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 10:14:17.176 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 10:14:17.418 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:14:17.433 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:14:17.440 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:14:17.534 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 10:14:17.592 +04:00 [DBG] Starting grant removal
2019-03-06 10:14:18.251 +04:00 [DBG] Login Url: Account/Login
2019-03-06 10:14:18.254 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 10:14:18.255 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 10:14:18.256 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 10:14:18.256 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 10:14:18.257 +04:00 [DBG] Error Url: /home/error
2019-03-06 10:14:18.258 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 10:14:18.311 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 10:14:27.181 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 10:14:27.234 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 10:14:27.234 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 10:14:27.235 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 10:14:27.235 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 10:14:27.235 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 10:14:27.235 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 10:14:27.455 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:14:27.470 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:14:27.476 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:14:27.576 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 10:14:27.696 +04:00 [DBG] Starting grant removal
2019-03-06 10:14:28.496 +04:00 [DBG] Login Url: Account/Login
2019-03-06 10:14:28.500 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 10:14:28.501 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 10:14:28.502 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 10:14:28.503 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 10:14:28.504 +04:00 [DBG] Error Url: /home/error
2019-03-06 10:14:28.504 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 10:14:28.556 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 10:14:47.343 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-03-06 10:14:47.346 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-03-06 10:14:47.350 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-03-06 10:15:05.026 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-06 10:15:05.034 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-06 10:15:05.035 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-06 10:15:05.040 +04:00 [DBG] Start discovery request
2019-03-06 10:15:05.241 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-06 10:15:05.396 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-06 10:15:05.399 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-06 10:15:05.400 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-06 10:15:05.406 +04:00 [DBG] Start key discovery request
2019-03-06 10:15:05.476 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-06 10:15:05.487 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-06 10:15:05.488 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-06 10:15:05.494 +04:00 [DBG] Start authorize request
2019-03-06 10:15:05.504 +04:00 [DBG] No user present in authorize request
2019-03-06 10:15:05.508 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 10:15:05.702 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:15:05.708 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:15:05.717 +04:00 [DBG] Checking for PKCE parameters
2019-03-06 10:15:05.719 +04:00 [DBG] No PKCE used.
2019-03-06 10:15:05.773 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:15:05.824 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:15:05.835 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:15:05.838 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:15:05.847 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-06 10:15:05.862 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNB0ma9QYz4nHBzelp4TSopqAkcMyWo5F_YaIZ8-vqr6089LuefydPqSW3eKNvqayUxPyis6sImjhZoI_ck6BufVGrh3Ogm5104LTAX3dvr5f1PYvasQ3YVWgZu7L9VIqjtTxlcnD8fFqg2mMGzgcvRVDkOy59FSz-ovr2HZqnoDabGA4j7pKmrTeuvfGLBQBf6Ibo3jMoKwj3iT6_5su_t9lJZbYLCrQy0Y3U8Y0Yev0ZCAiDRAgmB_i2q5kLmQCIK3kR3Q3YyVXs6yKCYMN6WwVHcD4-_SJQz4vjttSnIDjOR3CAPov6ld7Hwqr1l6Ewg","UiLocales":null,"Nonce":"636874497054579619.ZmYwNTEzNjAtYzA1Zi00OWUxLWE0MDAtYjkxZGY5NGVhZjg2ZGUwYzExZTUtNzA1YS00OTgxLWFjN2EtZWRkYzAwYWI2ZjNl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874497054579619.ZmYwNTEzNjAtYzA1Zi00OWUxLWE0MDAtYjkxZGY5NGVhZjg2ZGUwYzExZTUtNzA1YS00OTgxLWFjN2EtZWRkYzAwYWI2ZjNl","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNB0ma9QYz4nHBzelp4TSopqAkcMyWo5F_YaIZ8-vqr6089LuefydPqSW3eKNvqayUxPyis6sImjhZoI_ck6BufVGrh3Ogm5104LTAX3dvr5f1PYvasQ3YVWgZu7L9VIqjtTxlcnD8fFqg2mMGzgcvRVDkOy59FSz-ovr2HZqnoDabGA4j7pKmrTeuvfGLBQBf6Ibo3jMoKwj3iT6_5su_t9lJZbYLCrQy0Y3U8Y0Yev0ZCAiDRAgmB_i2q5kLmQCIK3kR3Q3YyVXs6yKCYMN6WwVHcD4-_SJQz4vjttSnIDjOR3CAPov6ld7Hwqr1l6Ewg","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 10:15:05.888 +04:00 [INF] Showing login: User is not authenticated
2019-03-06 10:15:40.269 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 10:15:40.325 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 10:15:40.326 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 10:15:40.326 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 10:15:40.327 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 10:15:40.327 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 10:15:40.328 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 10:15:40.560 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:15:40.574 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:15:40.576 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:15:40.656 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 10:15:40.715 +04:00 [DBG] Starting grant removal
2019-03-06 10:15:41.526 +04:00 [DBG] Login Url: /Account/Login
2019-03-06 10:15:41.529 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 10:15:41.529 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 10:15:41.530 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 10:15:41.530 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 10:15:41.531 +04:00 [DBG] Error Url: /home/error
2019-03-06 10:15:41.532 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 10:15:41.570 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 10:15:41.743 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-06 10:15:51.988 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-06 10:15:51.996 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-06 10:15:51.997 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-06 10:15:52.002 +04:00 [DBG] Start discovery request
2019-03-06 10:15:52.473 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-06 10:15:52.611 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-06 10:15:52.616 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-06 10:15:52.617 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-06 10:15:52.622 +04:00 [DBG] Start key discovery request
2019-03-06 10:15:52.727 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-06 10:15:52.741 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-06 10:15:52.742 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-06 10:15:52.750 +04:00 [DBG] Start authorize request
2019-03-06 10:15:52.760 +04:00 [DBG] No user present in authorize request
2019-03-06 10:15:52.769 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 10:15:53.084 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:15:53.091 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:15:53.100 +04:00 [DBG] Checking for PKCE parameters
2019-03-06 10:15:53.102 +04:00 [DBG] No PKCE used.
2019-03-06 10:15:53.155 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:15:53.200 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:15:53.208 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:15:53.210 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:15:53.219 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-06 10:15:53.234 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDP8qUA0Rq3O2cMZAgT1AwBfWsRoAMBt5sOi1v2HbG4nBkgxiH-eouB75aEebLcH2bVtYCmMs4PKQBhLqktItLksLGo84Rx_dThQQl_gcOTD10tYlljv5zgmP99ZTJhzuJRVZ_RUVHlr626-9ebfs_ORTC3DCQx6kzuDDgbLku4aIfo7Afs8YWAJmCRfSlHf8BkEllJYzBqbXBkXiN3r-4NfYvPODjYXkz8ThlzEGULAEC71Lcb6xuKbk1Zf92GhN2ja16x_IsmtKiqrGWR5h-IqUrFtOMrm2BYH46sCzdBnbM1MgPKIaZRAHg2pGCePUI","UiLocales":null,"Nonce":"636874497526881593.Yjk3MDM3ODEtMmI2Mi00M2RjLWEzMDktYzQ2Njc2MjU0Y2FhMWI0MWQyYzItOGZiYi00N2IxLWEwMTItNjZlYTVkODRiMGJm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874497526881593.Yjk3MDM3ODEtMmI2Mi00M2RjLWEzMDktYzQ2Njc2MjU0Y2FhMWI0MWQyYzItOGZiYi00N2IxLWEwMTItNjZlYTVkODRiMGJm","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDP8qUA0Rq3O2cMZAgT1AwBfWsRoAMBt5sOi1v2HbG4nBkgxiH-eouB75aEebLcH2bVtYCmMs4PKQBhLqktItLksLGo84Rx_dThQQl_gcOTD10tYlljv5zgmP99ZTJhzuJRVZ_RUVHlr626-9ebfs_ORTC3DCQx6kzuDDgbLku4aIfo7Afs8YWAJmCRfSlHf8BkEllJYzBqbXBkXiN3r-4NfYvPODjYXkz8ThlzEGULAEC71Lcb6xuKbk1Zf92GhN2ja16x_IsmtKiqrGWR5h-IqUrFtOMrm2BYH46sCzdBnbM1MgPKIaZRAHg2pGCePUI","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 10:15:53.261 +04:00 [INF] Showing login: User is not authenticated
2019-03-06 10:16:41.215 +04:00 [DBG] Augmenting SignInContext
2019-03-06 10:16:41.218 +04:00 [DBG] Adding idp claim with value: local
2019-03-06 10:16:41.219 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-06 10:16:41.220 +04:00 [DBG] Adding auth_time claim with value: 1551853001
2019-03-06 10:16:41.231 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 10:16:41.260 +04:00 [INF] {"Username":"godAdmin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"1002","DisplayName":"godAdmin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL1VCK9QPJA:00000005","TimeStamp":"2019-03-06T06:16:41.0000000Z","ProcessId":9512,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-06 10:17:46.631 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 10:17:46.689 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 10:17:46.690 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 10:17:46.690 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 10:17:46.690 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 10:17:46.690 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 10:17:46.691 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 10:17:46.924 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:17:46.939 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:17:46.941 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:17:47.017 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 10:17:47.079 +04:00 [DBG] Starting grant removal
2019-03-06 10:17:47.969 +04:00 [DBG] Login Url: /Account/Login
2019-03-06 10:17:47.972 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 10:17:47.974 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 10:17:47.974 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 10:17:47.975 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 10:17:47.976 +04:00 [DBG] Error Url: /home/error
2019-03-06 10:17:47.976 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 10:17:48.043 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 10:17:52.191 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-03-06 10:17:52.194 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-03-06 10:17:52.199 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-03-06 10:17:55.662 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-06 10:24:27.233 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 10:24:27.284 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 10:24:27.285 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 10:24:27.285 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 10:24:27.285 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 10:24:27.286 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 10:24:27.286 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 10:24:27.521 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:24:27.537 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:24:27.539 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:24:27.620 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 10:24:27.674 +04:00 [DBG] Starting grant removal
2019-03-06 10:24:28.326 +04:00 [DBG] Login Url: /Account/Login
2019-03-06 10:24:28.332 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 10:24:28.333 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 10:24:28.334 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 10:24:28.334 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 10:24:28.335 +04:00 [DBG] Error Url: /home/error
2019-03-06 10:24:28.336 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 10:24:28.377 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 10:24:28.554 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-06 10:24:37.581 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-06 10:24:37.591 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-06 10:24:37.593 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-06 10:24:37.599 +04:00 [DBG] Start discovery request
2019-03-06 10:24:38.084 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-06 10:24:38.235 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-06 10:24:38.238 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-06 10:24:38.239 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-06 10:24:38.246 +04:00 [DBG] Start key discovery request
2019-03-06 10:24:38.332 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-06 10:24:38.339 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-06 10:24:38.340 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-06 10:24:38.346 +04:00 [DBG] Start authorize request
2019-03-06 10:24:38.355 +04:00 [DBG] No user present in authorize request
2019-03-06 10:24:38.360 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 10:24:38.685 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:24:38.691 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:24:38.697 +04:00 [DBG] Checking for PKCE parameters
2019-03-06 10:24:38.702 +04:00 [DBG] No PKCE used.
2019-03-06 10:24:38.752 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:24:38.796 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:24:38.808 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:24:38.810 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:24:38.819 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-06 10:24:38.834 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDtcqFdEeB2RYK_e0P7pVLEVtmSeD6_bn8pMBOAFJJp04y2VZuv7NL443AbJWq62oUte89yG9q1XPGQeP1GmXNHCz6QbXSf0poTJCIow8b85yxxlFuT6vomTeikslVD5VBkiNFXC-Z4Ng2Eoyy2ndjizxpSzm9KT5FCkWgXEXOn9MakuJ6Tpz8p5zpbXzbxqLTRLHGoaGD_1WFZqtQf7BsLcWysPEX79KfYVrRVR9Eo35CW-oJlnqUzew5i3wq0FuP_WBIZ1RBI-Mlol9ggc64dWBjG6grJSXJfWsuTrRI_lXhn93bVjOmACATZuRCKods","UiLocales":null,"Nonce":"636874502783097171.OGY2YjU2NGMtNDYxYi00M2YwLTgyMGUtN2MwYzMxZjE1ZGYyOWE4ZGE2MTgtYzExNy00MGIxLWJlMTctNjUxZmZiN2Y1ZDc4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874502783097171.OGY2YjU2NGMtNDYxYi00M2YwLTgyMGUtN2MwYzMxZjE1ZGYyOWE4ZGE2MTgtYzExNy00MGIxLWJlMTctNjUxZmZiN2Y1ZDc4","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDtcqFdEeB2RYK_e0P7pVLEVtmSeD6_bn8pMBOAFJJp04y2VZuv7NL443AbJWq62oUte89yG9q1XPGQeP1GmXNHCz6QbXSf0poTJCIow8b85yxxlFuT6vomTeikslVD5VBkiNFXC-Z4Ng2Eoyy2ndjizxpSzm9KT5FCkWgXEXOn9MakuJ6Tpz8p5zpbXzbxqLTRLHGoaGD_1WFZqtQf7BsLcWysPEX79KfYVrRVR9Eo35CW-oJlnqUzew5i3wq0FuP_WBIZ1RBI-Mlol9ggc64dWBjG6grJSXJfWsuTrRI_lXhn93bVjOmACATZuRCKods","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 10:24:38.862 +04:00 [INF] Showing login: User is not authenticated
2019-03-06 10:24:47.513 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: Could not create an instance of type 'AuthServiceServer.Models.LoginModel'. Model bound complex types must not be abstract or value types and must have a parameterless constructor. Alternatively, give the 'model' parameter a non-null default value.
   at Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexTypeModelBinder.CreateModel(ModelBindingContext bindingContext)
   at Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexTypeModelBinder.BindModelCoreAsync(ModelBindingContext bindingContext)
   at Microsoft.AspNetCore.Mvc.ModelBinding.ParameterBinder.BindModelAsync(ActionContext actionContext, IModelBinder modelBinder, IValueProvider valueProvider, ParameterDescriptor parameter, ModelMetadata metadata, Object value)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerBinderDelegateProvider.<>c__DisplayClass0_0.<<CreateBinderDelegate>g__Bind|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-03-06 10:27:23.051 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 10:27:23.103 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 10:27:23.103 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 10:27:23.104 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 10:27:23.104 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 10:27:23.104 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 10:27:23.104 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 10:27:23.335 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:27:23.350 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:27:23.353 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:27:23.445 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 10:27:23.501 +04:00 [DBG] Starting grant removal
2019-03-06 10:27:23.969 +04:00 [DBG] Login Url: /Account/Login
2019-03-06 10:27:23.977 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 10:27:23.978 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 10:27:23.979 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 10:27:23.980 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 10:27:23.981 +04:00 [DBG] Error Url: /home/error
2019-03-06 10:27:23.984 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 10:27:24.026 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 10:27:24.194 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-06 10:27:58.212 +04:00 [DBG] Augmenting SignInContext
2019-03-06 10:27:58.222 +04:00 [DBG] Adding idp claim with value: local
2019-03-06 10:27:58.223 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-06 10:27:58.224 +04:00 [DBG] Adding auth_time claim with value: 1551853678
2019-03-06 10:27:58.242 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 10:28:00.296 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL1VJ5MDHSV:00000003","TimeStamp":"2019-03-06T06:28:00.0000000Z","ProcessId":11296,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-06 10:28:02.776 +04:00 [INF] AuthenticationScheme: Identity.Application was forbidden.
2019-03-06 10:28:26.054 +04:00 [ERR] The view 'Index' was not found. Searched locations: ["/Views/Home/Index.cshtml","/Views/Shared/Index.cshtml","/Pages/Shared/Index.cshtml"]
2019-03-06 10:28:26.064 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The view 'Index' was not found. The following locations were searched:
/Views/Home/Index.cshtml
/Views/Shared/Index.cshtml
/Pages/Shared/Index.cshtml
   at Microsoft.AspNetCore.Mvc.ViewEngines.ViewEngineResult.EnsureSuccessful(IEnumerable`1 originalLocations)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-03-06 10:28:35.803 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-03-06 10:28:35.806 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-03-06 10:28:35.810 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-03-06 10:28:37.901 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-06 10:28:41.642 +04:00 [DBG] Augmenting SignInContext
2019-03-06 10:28:41.642 +04:00 [DBG] Adding idp claim with value: local
2019-03-06 10:28:41.644 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-06 10:28:41.644 +04:00 [DBG] Adding auth_time claim with value: 1551853721
2019-03-06 10:28:41.646 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 10:28:43.345 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL1VJ5MDHSV:0000000F","TimeStamp":"2019-03-06T06:28:43.0000000Z","ProcessId":11296,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-06 10:29:41.575 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 10:29:41.627 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 10:29:41.628 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 10:29:41.628 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 10:29:41.628 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 10:29:41.629 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 10:29:41.629 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 10:29:41.857 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:29:41.872 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:29:41.874 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:29:41.956 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 10:29:42.012 +04:00 [DBG] Starting grant removal
2019-03-06 10:29:42.691 +04:00 [DBG] Login Url: /Account/Login
2019-03-06 10:29:42.694 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 10:29:42.696 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 10:29:42.698 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 10:29:42.699 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 10:29:42.700 +04:00 [DBG] Error Url: /home/error
2019-03-06 10:29:42.701 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 10:29:42.766 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 10:29:42.942 +04:00 [INF] AuthenticationScheme: Identity.Application was forbidden.
2019-03-06 10:29:59.666 +04:00 [ERR] The view 'Index' was not found. Searched locations: ["/Views/Home/Index.cshtml","/Views/Shared/Index.cshtml","/Pages/Shared/Index.cshtml"]
2019-03-06 10:29:59.686 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The view 'Index' was not found. The following locations were searched:
/Views/Home/Index.cshtml
/Views/Shared/Index.cshtml
/Pages/Shared/Index.cshtml
   at Microsoft.AspNetCore.Mvc.ViewEngines.ViewEngineResult.EnsureSuccessful(IEnumerable`1 originalLocations)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-03-06 10:30:04.172 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-03-06 10:30:04.175 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-03-06 10:30:04.176 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-03-06 10:30:06.857 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-06 10:30:11.208 +04:00 [DBG] Augmenting SignInContext
2019-03-06 10:30:11.219 +04:00 [DBG] Adding idp claim with value: local
2019-03-06 10:30:11.220 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-06 10:30:11.221 +04:00 [DBG] Adding auth_time claim with value: 1551853811
2019-03-06 10:30:11.230 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 10:30:12.114 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL1VKF161FP:0000000B","TimeStamp":"2019-03-06T06:30:12.0000000Z","ProcessId":16136,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-06 10:30:28.513 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 10:30:28.567 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 10:30:28.567 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 10:30:28.568 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 10:30:28.568 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 10:30:28.569 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 10:30:28.570 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 10:30:28.796 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:30:28.809 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:30:28.813 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:30:28.888 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 10:30:28.942 +04:00 [DBG] Starting grant removal
2019-03-06 10:30:29.733 +04:00 [DBG] Login Url: /Account/Login
2019-03-06 10:30:29.736 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 10:30:29.737 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 10:30:29.738 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 10:30:29.738 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 10:30:29.739 +04:00 [DBG] Error Url: /home/error
2019-03-06 10:30:29.739 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 10:30:29.788 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 10:30:29.933 +04:00 [INF] AuthenticationScheme: Identity.Application was forbidden.
2019-03-06 10:30:44.079 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-03-06 10:30:44.081 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-03-06 10:30:44.083 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-03-06 10:30:45.921 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-06 10:30:47.119 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-06 10:30:54.541 +04:00 [DBG] Augmenting SignInContext
2019-03-06 10:30:54.552 +04:00 [DBG] Adding idp claim with value: local
2019-03-06 10:30:54.553 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-06 10:30:54.555 +04:00 [DBG] Adding auth_time claim with value: 1551853854
2019-03-06 10:30:54.564 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 10:30:54.603 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL1VKT17OCC:0000000B","TimeStamp":"2019-03-06T06:30:54.0000000Z","ProcessId":3152,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-06 10:31:36.181 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-03-06 10:31:36.186 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-03-06 10:31:36.188 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-03-06 10:31:40.394 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-06 10:31:41.670 +04:00 [DBG] Augmenting SignInContext
2019-03-06 10:31:41.674 +04:00 [DBG] Adding idp claim with value: local
2019-03-06 10:31:41.676 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-06 10:31:41.677 +04:00 [DBG] Adding auth_time claim with value: 1551853901
2019-03-06 10:31:41.677 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 10:31:41.682 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL1VKT17OCC:00000013","TimeStamp":"2019-03-06T06:31:41.0000000Z","ProcessId":3152,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-06 10:32:19.467 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 10:32:19.519 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 10:32:19.520 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 10:32:19.521 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 10:32:19.521 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 10:32:19.521 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 10:32:19.521 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 10:32:19.741 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:32:19.755 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:32:19.761 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:32:19.836 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 10:32:19.890 +04:00 [DBG] Starting grant removal
2019-03-06 10:32:20.607 +04:00 [DBG] Login Url: /Account/Login
2019-03-06 10:32:20.611 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 10:32:20.612 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 10:32:20.613 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 10:32:20.613 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 10:32:20.614 +04:00 [DBG] Error Url: /home/error
2019-03-06 10:32:20.615 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 10:32:20.679 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 10:32:20.836 +04:00 [INF] AuthenticationScheme: Identity.Application was forbidden.
2019-03-06 10:32:29.955 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-03-06 10:32:29.964 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-03-06 10:32:29.967 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-03-06 10:32:35.852 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-06 10:32:38.609 +04:00 [DBG] Augmenting SignInContext
2019-03-06 10:32:38.621 +04:00 [DBG] Adding idp claim with value: local
2019-03-06 10:32:38.622 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-06 10:32:38.625 +04:00 [DBG] Adding auth_time claim with value: 1551853958
2019-03-06 10:32:38.634 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 10:32:38.674 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL1VLU3H051:00000008","TimeStamp":"2019-03-06T06:32:38.0000000Z","ProcessId":7224,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-06 10:32:55.772 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-03-06 10:32:55.774 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-03-06 10:32:55.780 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-03-06 10:33:04.881 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-06 10:33:04.888 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-06 10:33:04.889 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-06 10:33:04.894 +04:00 [DBG] Start discovery request
2019-03-06 10:33:05.366 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-06 10:33:05.488 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-06 10:33:05.491 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-06 10:33:05.492 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-06 10:33:05.498 +04:00 [DBG] Start key discovery request
2019-03-06 10:33:05.566 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-06 10:33:05.574 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-06 10:33:05.575 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-06 10:33:05.580 +04:00 [DBG] Start authorize request
2019-03-06 10:33:05.587 +04:00 [DBG] No user present in authorize request
2019-03-06 10:33:05.591 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 10:33:05.921 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:33:05.930 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:33:05.940 +04:00 [DBG] Checking for PKCE parameters
2019-03-06 10:33:05.941 +04:00 [DBG] No PKCE used.
2019-03-06 10:33:05.988 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:33:06.030 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:33:06.041 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:33:06.043 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:33:06.051 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-06 10:33:06.061 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAELFbyugfCkz5AaGiO1enw2AqLsT-Ak1NlCNvueX-bJU0prlSFy6PUdZpEah0rAQqXbNWRxjOPchCYMpRvwMEJgzTCHqyKrza2oYXoxmjOzlePII1AiWlz0SAMmSRUPXkPseBg426BTYWjw3pDGen78peai99175DEQEoZP5TwS5LmZlQe-l4nBKtCADmzN2rt-2E0jrOgU1B64SxHnLyljGLQcoGUMGW2Xy8ijdSzR5mQQZP519lgHZ9Dr3KiOWrfMcHCDEKJJH5lXaMOllWllsUQ_FjzEeQjomoDuGa92GLD-qFhipAstGk7abPVLFo","UiLocales":null,"Nonce":"636874507855440631.NDgxOGM2MzUtZjkzMC00YjA2LTg0OTYtNjU0YjA1ZjlhMThjODU1ZDM3ZjYtOGQ2Mi00N2M3LWE5YTEtM2EyMzZhMDNhNWEw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874507855440631.NDgxOGM2MzUtZjkzMC00YjA2LTg0OTYtNjU0YjA1ZjlhMThjODU1ZDM3ZjYtOGQ2Mi00N2M3LWE5YTEtM2EyMzZhMDNhNWEw","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAELFbyugfCkz5AaGiO1enw2AqLsT-Ak1NlCNvueX-bJU0prlSFy6PUdZpEah0rAQqXbNWRxjOPchCYMpRvwMEJgzTCHqyKrza2oYXoxmjOzlePII1AiWlz0SAMmSRUPXkPseBg426BTYWjw3pDGen78peai99175DEQEoZP5TwS5LmZlQe-l4nBKtCADmzN2rt-2E0jrOgU1B64SxHnLyljGLQcoGUMGW2Xy8ijdSzR5mQQZP519lgHZ9Dr3KiOWrfMcHCDEKJJH5lXaMOllWllsUQ_FjzEeQjomoDuGa92GLD-qFhipAstGk7abPVLFo","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 10:33:06.089 +04:00 [INF] Showing login: User is not authenticated
2019-03-06 10:33:13.871 +04:00 [DBG] Augmenting SignInContext
2019-03-06 10:33:13.872 +04:00 [DBG] Adding idp claim with value: local
2019-03-06 10:33:13.873 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-06 10:33:13.877 +04:00 [DBG] Adding auth_time claim with value: 1551853993
2019-03-06 10:33:13.878 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 10:33:13.881 +04:00 [INF] {"Username":"godAdmin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"1002","DisplayName":"godAdmin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL1VLU3H051:0000000F","TimeStamp":"2019-03-06T06:33:13.0000000Z","ProcessId":7224,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-06 10:34:06.980 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-06 10:34:06.988 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-06 10:34:06.989 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-06 10:34:06.998 +04:00 [DBG] Start authorize callback request
2019-03-06 10:34:07.004 +04:00 [DBG] User in authorize request: 1002
2019-03-06 10:34:07.004 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 10:34:07.027 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:34:07.027 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:34:07.031 +04:00 [DBG] Checking for PKCE parameters
2019-03-06 10:34:07.033 +04:00 [DBG] No PKCE used.
2019-03-06 10:34:07.041 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:34:07.047 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:34:07.050 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:34:07.052 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:34:07.053 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-06 10:34:07.054 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAELFbyugfCkz5AaGiO1enw2AqLsT-Ak1NlCNvueX-bJU0prlSFy6PUdZpEah0rAQqXbNWRxjOPchCYMpRvwMEJgzTCHqyKrza2oYXoxmjOzlePII1AiWlz0SAMmSRUPXkPseBg426BTYWjw3pDGen78peai99175DEQEoZP5TwS5LmZlQe-l4nBKtCADmzN2rt-2E0jrOgU1B64SxHnLyljGLQcoGUMGW2Xy8ijdSzR5mQQZP519lgHZ9Dr3KiOWrfMcHCDEKJJH5lXaMOllWllsUQ_FjzEeQjomoDuGa92GLD-qFhipAstGk7abPVLFo","UiLocales":null,"Nonce":"636874507855440631.NDgxOGM2MzUtZjkzMC00YjA2LTg0OTYtNjU0YjA1ZjlhMThjODU1ZDM3ZjYtOGQ2Mi00N2M3LWE5YTEtM2EyMzZhMDNhNWEw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"7fdd73bc817affeb0491b728626d26e4","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874507855440631.NDgxOGM2MzUtZjkzMC00YjA2LTg0OTYtNjU0YjA1ZjlhMThjODU1ZDM3ZjYtOGQ2Mi00N2M3LWE5YTEtM2EyMzZhMDNhNWEw","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAELFbyugfCkz5AaGiO1enw2AqLsT-Ak1NlCNvueX-bJU0prlSFy6PUdZpEah0rAQqXbNWRxjOPchCYMpRvwMEJgzTCHqyKrza2oYXoxmjOzlePII1AiWlz0SAMmSRUPXkPseBg426BTYWjw3pDGen78peai99175DEQEoZP5TwS5LmZlQe-l4nBKtCADmzN2rt-2E0jrOgU1B64SxHnLyljGLQcoGUMGW2Xy8ijdSzR5mQQZP519lgHZ9Dr3KiOWrfMcHCDEKJJH5lXaMOllWllsUQ_FjzEeQjomoDuGa92GLD-qFhipAstGk7abPVLFo","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 10:34:07.095 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-06 10:34:07.102 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-06 10:34:07.136 +04:00 [DBG] GhyZhM/LzxnKZTltG7XBwwO3GoE6ZCj6LhMkhg7ElIc= not found in database
2019-03-06 10:34:07.196 +04:00 [DBG] Creating Implicit Flow response.
2019-03-06 10:34:07.207 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-06 10:34:07.210 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-06 10:34:07.299 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"1002","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****TZ-w","$type":"Token"},{"TokenType":"code","TokenValue":"****6525","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL1VLU3H051:00000010","TimeStamp":"2019-03-06T06:34:07.0000000Z","ProcessId":7224,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-06 10:34:07.308 +04:00 [INF] Authorize endpoint response
{"SubjectId":"1002","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAELFbyugfCkz5AaGiO1enw2AqLsT-Ak1NlCNvueX-bJU0prlSFy6PUdZpEah0rAQqXbNWRxjOPchCYMpRvwMEJgzTCHqyKrza2oYXoxmjOzlePII1AiWlz0SAMmSRUPXkPseBg426BTYWjw3pDGen78peai99175DEQEoZP5TwS5LmZlQe-l4nBKtCADmzN2rt-2E0jrOgU1B64SxHnLyljGLQcoGUMGW2Xy8ijdSzR5mQQZP519lgHZ9Dr3KiOWrfMcHCDEKJJH5lXaMOllWllsUQ_FjzEeQjomoDuGa92GLD-qFhipAstGk7abPVLFo","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-06 10:34:07.331 +04:00 [DBG] Augmenting SignInContext
2019-03-06 10:34:07.331 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 10:34:07.444 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-06 10:34:07.453 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-06 10:34:07.454 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-06 10:34:07.463 +04:00 [DBG] Start token request.
2019-03-06 10:34:07.485 +04:00 [DBG] Start client validation
2019-03-06 10:34:07.490 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-06 10:34:07.494 +04:00 [DBG] Start parsing for secret in post body
2019-03-06 10:34:07.495 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-06 10:34:07.495 +04:00 [DBG] Secret id found: BiLab
2019-03-06 10:34:07.505 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:34:07.506 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:34:07.523 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-06 10:34:07.523 +04:00 [DBG] Client validation success
2019-03-06 10:34:07.526 +04:00 [INF] {"ClientId":"BiLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLL1VLU3H054:00000003","TimeStamp":"2019-03-06T06:34:07.0000000Z","ProcessId":7224,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-03-06 10:34:07.537 +04:00 [DBG] Start token request validation
2019-03-06 10:34:07.550 +04:00 [DBG] Start validation of authorization code token request
2019-03-06 10:34:07.569 +04:00 [DBG] GhyZhM/LzxnKZTltG7XBwwO3GoE6ZCj6LhMkhg7ElIc= found in database: true
2019-03-06 10:34:07.589 +04:00 [DBG] removing GhyZhM/LzxnKZTltG7XBwwO3GoE6ZCj6LhMkhg7ElIc= persisted grant from database
2019-03-06 10:34:07.605 +04:00 [DBG] Validation of authorization code token request success
2019-03-06 10:34:07.611 +04:00 [INF] Token request validation success
{"ClientId":"BiLab","ClientName":"BiLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"07948e9a3406625d2809d2abe94fef976ed5c9f49517b39fa35fc06c38c76525","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"BiLab","client_secret":"***REDACTED***","code":"07948e9a3406625d2809d2abe94fef976ed5c9f49517b39fa35fc06c38c76525","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-03-06 10:34:07.638 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:34:07.638 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:34:07.646 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:34:07.655 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:34:07.665 +04:00 [DBG] Getting claims for access token for client: BiLab
2019-03-06 10:34:07.666 +04:00 [DBG] Getting claims for access token for subject: 1002
2019-03-06 10:34:07.694 +04:00 [DBG] Creating refresh token
2019-03-06 10:34:07.695 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-03-06 10:34:07.707 +04:00 [DBG] PCZZ8TIIsggf3OTA6g9g7OYXylmTOQwyXJDt7F4mMd4= not found in database
2019-03-06 10:34:07.717 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:34:07.717 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:34:07.720 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:34:07.722 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:34:07.723 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-06 10:34:07.726 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-06 10:34:07.734 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****1Kag","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****d4a5","$type":"Token"},{"TokenType":"access_token","TokenValue":"****zszA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL1VLU3H054:00000003","TimeStamp":"2019-03-06T06:34:07.0000000Z","ProcessId":7224,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-06 10:34:07.740 +04:00 [DBG] Token request success.
2019-03-06 10:34:21.773 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-06 10:34:21.775 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-06 10:34:21.778 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-06 10:34:21.780 +04:00 [DBG] Start authorize request
2019-03-06 10:34:21.781 +04:00 [DBG] No user present in authorize request
2019-03-06 10:34:21.782 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 10:34:21.787 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:34:21.787 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:34:21.789 +04:00 [DBG] Checking for PKCE parameters
2019-03-06 10:34:21.790 +04:00 [DBG] No PKCE used.
2019-03-06 10:34:21.793 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:34:21.798 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:34:21.802 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:34:21.804 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:34:21.810 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-06 10:34:21.811 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNB-h5F3M_2fgzI2tGk8YPwboOcZOi7WIehtqXqdXxSHXp_7oJWOv4x5_-gQG0_qTFdOc78iNI6D8iY-kf63I9xfS6t1No6v6tU4Aaoi9WMXak65VBK3fc1cy4GTW6ZQoBRKy_v5d-8GyHlzLEbyOa81gcPdi3uk-MSUABO7nxfXv42FS22JRxjytp4FValVLFJ0dDab6bUPYwbgbE-IRlMtxJxkmllEkliXxbPZvRAapzJMiO3721LD-zjf_IdBlGjiHt92Hhmy9L7wCLz6hiNiWWd5DU_fB_mECYt1MNXrLH76g7MOtW50nNuKRFXMWcE","UiLocales":null,"Nonce":"636874508617651045.ZDM3NGQyODgtYzZiYy00NDMxLTg3YmYtMmMxYTVlODIwMDM1MzQyYTViNWEtNThkYi00MmRjLTliODctYzhlYzdhZDk3ZGJh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874508617651045.ZDM3NGQyODgtYzZiYy00NDMxLTg3YmYtMmMxYTVlODIwMDM1MzQyYTViNWEtNThkYi00MmRjLTliODctYzhlYzdhZDk3ZGJh","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNB-h5F3M_2fgzI2tGk8YPwboOcZOi7WIehtqXqdXxSHXp_7oJWOv4x5_-gQG0_qTFdOc78iNI6D8iY-kf63I9xfS6t1No6v6tU4Aaoi9WMXak65VBK3fc1cy4GTW6ZQoBRKy_v5d-8GyHlzLEbyOa81gcPdi3uk-MSUABO7nxfXv42FS22JRxjytp4FValVLFJ0dDab6bUPYwbgbE-IRlMtxJxkmllEkliXxbPZvRAapzJMiO3721LD-zjf_IdBlGjiHt92Hhmy9L7wCLz6hiNiWWd5DU_fB_mECYt1MNXrLH76g7MOtW50nNuKRFXMWcE","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 10:34:21.824 +04:00 [INF] Showing login: User is not authenticated
2019-03-06 10:34:23.800 +04:00 [DBG] Augmenting SignInContext
2019-03-06 10:34:23.801 +04:00 [DBG] Adding idp claim with value: local
2019-03-06 10:34:23.802 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-06 10:34:23.803 +04:00 [DBG] Adding auth_time claim with value: 1551854063
2019-03-06 10:34:23.803 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 10:34:23.806 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL1VLU3H051:00000013","TimeStamp":"2019-03-06T06:34:23.0000000Z","ProcessId":7224,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-06 10:34:26.068 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-06 10:34:26.070 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-06 10:34:26.071 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-06 10:34:26.072 +04:00 [DBG] Start authorize callback request
2019-03-06 10:34:26.073 +04:00 [DBG] User in authorize request: 2
2019-03-06 10:34:26.073 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 10:34:26.079 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:34:26.081 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:34:26.082 +04:00 [DBG] Checking for PKCE parameters
2019-03-06 10:34:26.082 +04:00 [DBG] No PKCE used.
2019-03-06 10:34:26.085 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:34:26.090 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:34:26.094 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:34:26.096 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:34:26.099 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-06 10:34:26.107 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNB-h5F3M_2fgzI2tGk8YPwboOcZOi7WIehtqXqdXxSHXp_7oJWOv4x5_-gQG0_qTFdOc78iNI6D8iY-kf63I9xfS6t1No6v6tU4Aaoi9WMXak65VBK3fc1cy4GTW6ZQoBRKy_v5d-8GyHlzLEbyOa81gcPdi3uk-MSUABO7nxfXv42FS22JRxjytp4FValVLFJ0dDab6bUPYwbgbE-IRlMtxJxkmllEkliXxbPZvRAapzJMiO3721LD-zjf_IdBlGjiHt92Hhmy9L7wCLz6hiNiWWd5DU_fB_mECYt1MNXrLH76g7MOtW50nNuKRFXMWcE","UiLocales":null,"Nonce":"636874508617651045.ZDM3NGQyODgtYzZiYy00NDMxLTg3YmYtMmMxYTVlODIwMDM1MzQyYTViNWEtNThkYi00MmRjLTliODctYzhlYzdhZDk3ZGJh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"7b3eed019f4fa93ee3a1be279f0dcc43","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874508617651045.ZDM3NGQyODgtYzZiYy00NDMxLTg3YmYtMmMxYTVlODIwMDM1MzQyYTViNWEtNThkYi00MmRjLTliODctYzhlYzdhZDk3ZGJh","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNB-h5F3M_2fgzI2tGk8YPwboOcZOi7WIehtqXqdXxSHXp_7oJWOv4x5_-gQG0_qTFdOc78iNI6D8iY-kf63I9xfS6t1No6v6tU4Aaoi9WMXak65VBK3fc1cy4GTW6ZQoBRKy_v5d-8GyHlzLEbyOa81gcPdi3uk-MSUABO7nxfXv42FS22JRxjytp4FValVLFJ0dDab6bUPYwbgbE-IRlMtxJxkmllEkliXxbPZvRAapzJMiO3721LD-zjf_IdBlGjiHt92Hhmy9L7wCLz6hiNiWWd5DU_fB_mECYt1MNXrLH76g7MOtW50nNuKRFXMWcE","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 10:34:26.131 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-06 10:34:26.133 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-06 10:34:26.136 +04:00 [DBG] uOOxz6Eyaj/nBEngzGFefpgDScvpp+aljcEuAUkE5sM= not found in database
2019-03-06 10:34:26.140 +04:00 [DBG] Creating Implicit Flow response.
2019-03-06 10:34:26.141 +04:00 [DBG] Getting claims for identity token for subject: 2 and client: BiLab
2019-03-06 10:34:26.142 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-06 10:34:26.147 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"2","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****wqmQ","$type":"Token"},{"TokenType":"code","TokenValue":"****dd5f","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL1VLU3H051:00000014","TimeStamp":"2019-03-06T06:34:26.0000000Z","ProcessId":7224,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-06 10:34:26.155 +04:00 [INF] Authorize endpoint response
{"SubjectId":"2","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNB-h5F3M_2fgzI2tGk8YPwboOcZOi7WIehtqXqdXxSHXp_7oJWOv4x5_-gQG0_qTFdOc78iNI6D8iY-kf63I9xfS6t1No6v6tU4Aaoi9WMXak65VBK3fc1cy4GTW6ZQoBRKy_v5d-8GyHlzLEbyOa81gcPdi3uk-MSUABO7nxfXv42FS22JRxjytp4FValVLFJ0dDab6bUPYwbgbE-IRlMtxJxkmllEkliXxbPZvRAapzJMiO3721LD-zjf_IdBlGjiHt92Hhmy9L7wCLz6hiNiWWd5DU_fB_mECYt1MNXrLH76g7MOtW50nNuKRFXMWcE","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-06 10:34:26.158 +04:00 [DBG] Augmenting SignInContext
2019-03-06 10:34:26.166 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 10:34:26.208 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-06 10:34:26.210 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-06 10:34:26.212 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-06 10:34:26.215 +04:00 [DBG] Start token request.
2019-03-06 10:34:26.217 +04:00 [DBG] Start client validation
2019-03-06 10:34:26.222 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-06 10:34:26.223 +04:00 [DBG] Start parsing for secret in post body
2019-03-06 10:34:26.225 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-06 10:34:26.225 +04:00 [DBG] Secret id found: BiLab
2019-03-06 10:34:26.250 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:34:26.251 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:34:26.253 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-06 10:34:26.253 +04:00 [DBG] Client validation success
2019-03-06 10:34:26.254 +04:00 [INF] {"ClientId":"BiLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLL1VLU3H054:00000004","TimeStamp":"2019-03-06T06:34:26.0000000Z","ProcessId":7224,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-03-06 10:34:26.256 +04:00 [DBG] Start token request validation
2019-03-06 10:34:26.257 +04:00 [DBG] Start validation of authorization code token request
2019-03-06 10:34:26.260 +04:00 [DBG] uOOxz6Eyaj/nBEngzGFefpgDScvpp+aljcEuAUkE5sM= found in database: true
2019-03-06 10:34:26.262 +04:00 [DBG] removing uOOxz6Eyaj/nBEngzGFefpgDScvpp+aljcEuAUkE5sM= persisted grant from database
2019-03-06 10:34:26.283 +04:00 [DBG] Validation of authorization code token request success
2019-03-06 10:34:26.285 +04:00 [INF] Token request validation success
{"ClientId":"BiLab","ClientName":"BiLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"90dd9de5ec9bc6ea5e64fea32f909ac78ec0722a0f445aa688f0b52cefd1dd5f","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"BiLab","client_secret":"***REDACTED***","code":"90dd9de5ec9bc6ea5e64fea32f909ac78ec0722a0f445aa688f0b52cefd1dd5f","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-03-06 10:34:26.299 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:34:26.299 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:34:26.303 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:34:26.306 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:34:26.307 +04:00 [DBG] Getting claims for access token for client: BiLab
2019-03-06 10:34:26.308 +04:00 [DBG] Getting claims for access token for subject: 2
2019-03-06 10:34:26.322 +04:00 [DBG] Creating refresh token
2019-03-06 10:34:26.322 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-03-06 10:34:26.324 +04:00 [DBG] n8CXfd2TQF0+x8gU8SoyHaSFuafRNeN5nWkGGEmliUo= not found in database
2019-03-06 10:34:26.329 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:34:26.329 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:34:26.336 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:34:26.338 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:34:26.339 +04:00 [DBG] Getting claims for identity token for subject: 2 and client: BiLab
2019-03-06 10:34:26.340 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-06 10:34:26.347 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****dQmg","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****2739","$type":"Token"},{"TokenType":"access_token","TokenValue":"****acaQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL1VLU3H054:00000004","TimeStamp":"2019-03-06T06:34:26.0000000Z","ProcessId":7224,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-06 10:34:26.358 +04:00 [DBG] Token request success.
2019-03-06 10:34:31.713 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-06 10:34:31.717 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-06 10:34:31.720 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-06 10:34:31.721 +04:00 [DBG] Start authorize request
2019-03-06 10:34:31.725 +04:00 [DBG] No user present in authorize request
2019-03-06 10:34:31.726 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 10:34:31.733 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:34:31.734 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:34:31.737 +04:00 [DBG] Checking for PKCE parameters
2019-03-06 10:34:31.739 +04:00 [DBG] No PKCE used.
2019-03-06 10:34:31.741 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:34:31.742 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:34:31.744 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:34:31.746 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:34:31.746 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-06 10:34:31.748 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNC4EB9lFiDDquY_Arn0kEhfwTPqlGhPPlHL_3vQhAu_v96OAPjc_l1eLnfbbAa0DdYl62dhii5BQraPCFYvuaAkuDXuoj2pCD0jvKTobwNSWReXdNoygBuGoSs_lTXRWrkjeGrCfiAIkEfTtSMuVOASrEBhWI3tN2cq0U43vxEy7aPz2rXx4sn2cuzB-juVut4USYeibaHchCfN0jPOT1OxVwNEd8YXc40ok-svoHxnC8DsacjmXqNzXN9I0zhryk-wB5I6kMV5usR4SyFk8nXFEgJiwgZmGLwthRXMfGCZylJtnXOZ4THm6mfJXLY6-7M","UiLocales":null,"Nonce":"636874508717023269.MTk1Njc4YWQtMzdkOC00MzUxLTk1YzItNzEwNTE5YWY5ZDZkZjliOTJkZTMtNDI2ZC00NjlmLTgzNmYtM2FmOWY2YzIxNGEx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874508717023269.MTk1Njc4YWQtMzdkOC00MzUxLTk1YzItNzEwNTE5YWY5ZDZkZjliOTJkZTMtNDI2ZC00NjlmLTgzNmYtM2FmOWY2YzIxNGEx","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNC4EB9lFiDDquY_Arn0kEhfwTPqlGhPPlHL_3vQhAu_v96OAPjc_l1eLnfbbAa0DdYl62dhii5BQraPCFYvuaAkuDXuoj2pCD0jvKTobwNSWReXdNoygBuGoSs_lTXRWrkjeGrCfiAIkEfTtSMuVOASrEBhWI3tN2cq0U43vxEy7aPz2rXx4sn2cuzB-juVut4USYeibaHchCfN0jPOT1OxVwNEd8YXc40ok-svoHxnC8DsacjmXqNzXN9I0zhryk-wB5I6kMV5usR4SyFk8nXFEgJiwgZmGLwthRXMfGCZylJtnXOZ4THm6mfJXLY6-7M","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 10:34:31.759 +04:00 [INF] Showing login: User is not authenticated
2019-03-06 10:34:36.000 +04:00 [DBG] Augmenting SignInContext
2019-03-06 10:34:36.000 +04:00 [DBG] Adding idp claim with value: local
2019-03-06 10:34:36.002 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-06 10:34:36.003 +04:00 [DBG] Adding auth_time claim with value: 1551854076
2019-03-06 10:34:36.004 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 10:34:36.010 +04:00 [INF] {"Username":"godAdmin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"1002","DisplayName":"godAdmin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL1VLU3H051:00000017","TimeStamp":"2019-03-06T06:34:36.0000000Z","ProcessId":7224,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-06 10:34:36.023 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-06 10:34:36.025 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-06 10:34:36.026 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-06 10:34:36.027 +04:00 [DBG] Start authorize callback request
2019-03-06 10:34:36.027 +04:00 [DBG] User in authorize request: 1002
2019-03-06 10:34:36.028 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 10:34:36.051 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:34:36.052 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:34:36.056 +04:00 [DBG] Checking for PKCE parameters
2019-03-06 10:34:36.056 +04:00 [DBG] No PKCE used.
2019-03-06 10:34:36.064 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:34:36.070 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:34:36.080 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:34:36.086 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:34:36.087 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-06 10:34:36.092 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNC4EB9lFiDDquY_Arn0kEhfwTPqlGhPPlHL_3vQhAu_v96OAPjc_l1eLnfbbAa0DdYl62dhii5BQraPCFYvuaAkuDXuoj2pCD0jvKTobwNSWReXdNoygBuGoSs_lTXRWrkjeGrCfiAIkEfTtSMuVOASrEBhWI3tN2cq0U43vxEy7aPz2rXx4sn2cuzB-juVut4USYeibaHchCfN0jPOT1OxVwNEd8YXc40ok-svoHxnC8DsacjmXqNzXN9I0zhryk-wB5I6kMV5usR4SyFk8nXFEgJiwgZmGLwthRXMfGCZylJtnXOZ4THm6mfJXLY6-7M","UiLocales":null,"Nonce":"636874508717023269.MTk1Njc4YWQtMzdkOC00MzUxLTk1YzItNzEwNTE5YWY5ZDZkZjliOTJkZTMtNDI2ZC00NjlmLTgzNmYtM2FmOWY2YzIxNGEx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"7ae3185fe1ed18b1eedffdda36e255bf","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874508717023269.MTk1Njc4YWQtMzdkOC00MzUxLTk1YzItNzEwNTE5YWY5ZDZkZjliOTJkZTMtNDI2ZC00NjlmLTgzNmYtM2FmOWY2YzIxNGEx","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNC4EB9lFiDDquY_Arn0kEhfwTPqlGhPPlHL_3vQhAu_v96OAPjc_l1eLnfbbAa0DdYl62dhii5BQraPCFYvuaAkuDXuoj2pCD0jvKTobwNSWReXdNoygBuGoSs_lTXRWrkjeGrCfiAIkEfTtSMuVOASrEBhWI3tN2cq0U43vxEy7aPz2rXx4sn2cuzB-juVut4USYeibaHchCfN0jPOT1OxVwNEd8YXc40ok-svoHxnC8DsacjmXqNzXN9I0zhryk-wB5I6kMV5usR4SyFk8nXFEgJiwgZmGLwthRXMfGCZylJtnXOZ4THm6mfJXLY6-7M","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 10:34:36.111 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-06 10:34:36.111 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-06 10:34:36.114 +04:00 [DBG] D/aZ7FqXSAV0WS/6eqGD1SJ8BznTPxfrUtG2Wc282vw= not found in database
2019-03-06 10:34:36.140 +04:00 [DBG] Creating Implicit Flow response.
2019-03-06 10:34:36.140 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-06 10:34:36.142 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-06 10:34:36.146 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"1002","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****Q8vA","$type":"Token"},{"TokenType":"code","TokenValue":"****de7c","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL1VLU3H051:00000018","TimeStamp":"2019-03-06T06:34:36.0000000Z","ProcessId":7224,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-06 10:34:36.153 +04:00 [INF] Authorize endpoint response
{"SubjectId":"1002","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNC4EB9lFiDDquY_Arn0kEhfwTPqlGhPPlHL_3vQhAu_v96OAPjc_l1eLnfbbAa0DdYl62dhii5BQraPCFYvuaAkuDXuoj2pCD0jvKTobwNSWReXdNoygBuGoSs_lTXRWrkjeGrCfiAIkEfTtSMuVOASrEBhWI3tN2cq0U43vxEy7aPz2rXx4sn2cuzB-juVut4USYeibaHchCfN0jPOT1OxVwNEd8YXc40ok-svoHxnC8DsacjmXqNzXN9I0zhryk-wB5I6kMV5usR4SyFk8nXFEgJiwgZmGLwthRXMfGCZylJtnXOZ4THm6mfJXLY6-7M","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-06 10:34:36.157 +04:00 [DBG] Augmenting SignInContext
2019-03-06 10:34:36.157 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 10:34:36.197 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-06 10:34:36.200 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-06 10:34:36.201 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-06 10:34:36.202 +04:00 [DBG] Start token request.
2019-03-06 10:34:36.203 +04:00 [DBG] Start client validation
2019-03-06 10:34:36.204 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-06 10:34:36.206 +04:00 [DBG] Start parsing for secret in post body
2019-03-06 10:34:36.214 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-06 10:34:36.215 +04:00 [DBG] Secret id found: BiLab
2019-03-06 10:34:36.239 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:34:36.239 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:34:36.242 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-06 10:34:36.242 +04:00 [DBG] Client validation success
2019-03-06 10:34:36.243 +04:00 [INF] {"ClientId":"BiLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLL1VLU3H054:00000005","TimeStamp":"2019-03-06T06:34:36.0000000Z","ProcessId":7224,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-03-06 10:34:36.246 +04:00 [DBG] Start token request validation
2019-03-06 10:34:36.246 +04:00 [DBG] Start validation of authorization code token request
2019-03-06 10:34:36.249 +04:00 [DBG] D/aZ7FqXSAV0WS/6eqGD1SJ8BznTPxfrUtG2Wc282vw= found in database: true
2019-03-06 10:34:36.256 +04:00 [DBG] removing D/aZ7FqXSAV0WS/6eqGD1SJ8BznTPxfrUtG2Wc282vw= persisted grant from database
2019-03-06 10:34:36.262 +04:00 [DBG] Validation of authorization code token request success
2019-03-06 10:34:36.263 +04:00 [INF] Token request validation success
{"ClientId":"BiLab","ClientName":"BiLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"eeb2dc064d7cd1e62c7011fe5d5a66989039611fa396f7d1903e7baa92d1de7c","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"BiLab","client_secret":"***REDACTED***","code":"eeb2dc064d7cd1e62c7011fe5d5a66989039611fa396f7d1903e7baa92d1de7c","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-03-06 10:34:36.294 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:34:36.294 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:34:36.305 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:34:36.311 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:34:36.313 +04:00 [DBG] Getting claims for access token for client: BiLab
2019-03-06 10:34:36.313 +04:00 [DBG] Getting claims for access token for subject: 1002
2019-03-06 10:34:36.327 +04:00 [DBG] Creating refresh token
2019-03-06 10:34:36.328 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-03-06 10:34:36.330 +04:00 [DBG] SNkIYfNVxkYnAIEfNUzEReNQQqaNNXD3Bl5yKDhCEGI= not found in database
2019-03-06 10:34:36.365 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:34:36.366 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:34:36.376 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:34:36.383 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:34:36.384 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-06 10:34:36.385 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-06 10:34:36.391 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****H3lg","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****cc54","$type":"Token"},{"TokenType":"access_token","TokenValue":"****4rQg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL1VLU3H054:00000005","TimeStamp":"2019-03-06T06:34:36.0000000Z","ProcessId":7224,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-06 10:34:36.396 +04:00 [DBG] Token request success.
2019-03-06 10:35:19.552 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 10:35:19.607 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 10:35:19.607 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 10:35:19.608 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 10:35:19.608 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 10:35:19.608 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 10:35:19.608 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 10:35:19.833 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:35:19.849 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:35:19.852 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:35:19.939 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 10:35:19.997 +04:00 [DBG] Starting grant removal
2019-03-06 10:35:20.981 +04:00 [DBG] Login Url: /Account/Login
2019-03-06 10:35:20.985 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 10:35:20.987 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 10:35:20.988 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 10:35:20.989 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 10:35:20.990 +04:00 [DBG] Error Url: /home/error
2019-03-06 10:35:20.991 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 10:35:21.043 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 10:35:38.035 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-06 10:35:38.041 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-06 10:35:38.042 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-06 10:35:38.047 +04:00 [DBG] Start discovery request
2019-03-06 10:35:38.552 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-06 10:35:38.699 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-06 10:35:38.703 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-06 10:35:38.704 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-06 10:35:38.709 +04:00 [DBG] Start key discovery request
2019-03-06 10:35:38.793 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-06 10:35:38.801 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-06 10:35:38.806 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-06 10:35:38.811 +04:00 [DBG] Start authorize request
2019-03-06 10:35:38.822 +04:00 [DBG] No user present in authorize request
2019-03-06 10:35:38.828 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 10:35:39.166 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:35:39.177 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:35:39.184 +04:00 [DBG] Checking for PKCE parameters
2019-03-06 10:35:39.187 +04:00 [DBG] No PKCE used.
2019-03-06 10:35:39.241 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:35:39.280 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:35:39.296 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:35:39.298 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:35:39.307 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-06 10:35:39.323 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCFtd6Fm70b-fwMoYSZeaAv5KfYyvSEMISICKL6gnYRzwwCXsI1rgZ42BI419WkaqEWeZgmKdDjXt8ICw3FKxxl6tpBDlUtIo_gar7nsvBF1-eR4d9XoaeLiLa0DWhgLsu41ynooYR2w7WJATkcUShjPN3ZhUnk_X_OOJF8BEPsZEQhfFZ8o_4ts6W4U1SNs7r392u1va-Motoob7nwNr7sb3jbOu0uYAgDcF6qDVicCn2RXIsjZRfwpNWZGwgAgwSpTnGoU1PahjwizK956dQz1drwQ0nI2qJRA5bvwg8wOyNJXVQ81SS7RDGJu0U1Rgw","UiLocales":null,"Nonce":"636874509387696274.MTdhYjVkNDctY2U0Ni00MjIyLWIzNjctN2NkOTIyZTY2M2U3YzQxNTFhMDQtYzYxZi00OTY5LWIwOTYtMDFkNGNiZWNhZGFk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874509387696274.MTdhYjVkNDctY2U0Ni00MjIyLWIzNjctN2NkOTIyZTY2M2U3YzQxNTFhMDQtYzYxZi00OTY5LWIwOTYtMDFkNGNiZWNhZGFk","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCFtd6Fm70b-fwMoYSZeaAv5KfYyvSEMISICKL6gnYRzwwCXsI1rgZ42BI419WkaqEWeZgmKdDjXt8ICw3FKxxl6tpBDlUtIo_gar7nsvBF1-eR4d9XoaeLiLa0DWhgLsu41ynooYR2w7WJATkcUShjPN3ZhUnk_X_OOJF8BEPsZEQhfFZ8o_4ts6W4U1SNs7r392u1va-Motoob7nwNr7sb3jbOu0uYAgDcF6qDVicCn2RXIsjZRfwpNWZGwgAgwSpTnGoU1PahjwizK956dQz1drwQ0nI2qJRA5bvwg8wOyNJXVQ81SS7RDGJu0U1Rgw","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 10:35:39.357 +04:00 [INF] Showing login: User is not authenticated
2019-03-06 10:35:41.856 +04:00 [DBG] Augmenting SignInContext
2019-03-06 10:35:41.859 +04:00 [DBG] Adding idp claim with value: local
2019-03-06 10:35:41.860 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-06 10:35:41.862 +04:00 [DBG] Adding auth_time claim with value: 1551854141
2019-03-06 10:35:41.873 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 10:35:41.897 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL1VNJQGBLQ:00000004","TimeStamp":"2019-03-06T06:35:41.0000000Z","ProcessId":16136,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-06 10:35:41.941 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-06 10:35:41.945 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-06 10:35:41.946 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-06 10:35:41.955 +04:00 [DBG] Start authorize callback request
2019-03-06 10:35:41.960 +04:00 [DBG] User in authorize request: 2
2019-03-06 10:35:41.961 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 10:35:41.983 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:35:41.984 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:35:41.990 +04:00 [DBG] Checking for PKCE parameters
2019-03-06 10:35:41.992 +04:00 [DBG] No PKCE used.
2019-03-06 10:35:42.001 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:35:42.007 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:35:42.013 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:35:42.014 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:35:42.015 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-06 10:35:42.017 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCFtd6Fm70b-fwMoYSZeaAv5KfYyvSEMISICKL6gnYRzwwCXsI1rgZ42BI419WkaqEWeZgmKdDjXt8ICw3FKxxl6tpBDlUtIo_gar7nsvBF1-eR4d9XoaeLiLa0DWhgLsu41ynooYR2w7WJATkcUShjPN3ZhUnk_X_OOJF8BEPsZEQhfFZ8o_4ts6W4U1SNs7r392u1va-Motoob7nwNr7sb3jbOu0uYAgDcF6qDVicCn2RXIsjZRfwpNWZGwgAgwSpTnGoU1PahjwizK956dQz1drwQ0nI2qJRA5bvwg8wOyNJXVQ81SS7RDGJu0U1Rgw","UiLocales":null,"Nonce":"636874509387696274.MTdhYjVkNDctY2U0Ni00MjIyLWIzNjctN2NkOTIyZTY2M2U3YzQxNTFhMDQtYzYxZi00OTY5LWIwOTYtMDFkNGNiZWNhZGFk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"3af2705448e3fd3a63979d9e7f33e300","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874509387696274.MTdhYjVkNDctY2U0Ni00MjIyLWIzNjctN2NkOTIyZTY2M2U3YzQxNTFhMDQtYzYxZi00OTY5LWIwOTYtMDFkNGNiZWNhZGFk","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCFtd6Fm70b-fwMoYSZeaAv5KfYyvSEMISICKL6gnYRzwwCXsI1rgZ42BI419WkaqEWeZgmKdDjXt8ICw3FKxxl6tpBDlUtIo_gar7nsvBF1-eR4d9XoaeLiLa0DWhgLsu41ynooYR2w7WJATkcUShjPN3ZhUnk_X_OOJF8BEPsZEQhfFZ8o_4ts6W4U1SNs7r392u1va-Motoob7nwNr7sb3jbOu0uYAgDcF6qDVicCn2RXIsjZRfwpNWZGwgAgwSpTnGoU1PahjwizK956dQz1drwQ0nI2qJRA5bvwg8wOyNJXVQ81SS7RDGJu0U1Rgw","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 10:35:42.065 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-06 10:35:42.075 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-06 10:35:42.116 +04:00 [DBG] KIFmDeaq9Hb/PNyw4wiPqtnoJJrsIflcSxG5Yvn/bjE= not found in database
2019-03-06 10:35:42.173 +04:00 [DBG] Creating Implicit Flow response.
2019-03-06 10:35:42.182 +04:00 [DBG] Getting claims for identity token for subject: 2 and client: BiLab
2019-03-06 10:35:42.186 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-06 10:35:42.268 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"2","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****s60A","$type":"Token"},{"TokenType":"code","TokenValue":"****1969","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL1VNJQGBLQ:00000005","TimeStamp":"2019-03-06T06:35:42.0000000Z","ProcessId":16136,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-06 10:35:42.277 +04:00 [INF] Authorize endpoint response
{"SubjectId":"2","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCFtd6Fm70b-fwMoYSZeaAv5KfYyvSEMISICKL6gnYRzwwCXsI1rgZ42BI419WkaqEWeZgmKdDjXt8ICw3FKxxl6tpBDlUtIo_gar7nsvBF1-eR4d9XoaeLiLa0DWhgLsu41ynooYR2w7WJATkcUShjPN3ZhUnk_X_OOJF8BEPsZEQhfFZ8o_4ts6W4U1SNs7r392u1va-Motoob7nwNr7sb3jbOu0uYAgDcF6qDVicCn2RXIsjZRfwpNWZGwgAgwSpTnGoU1PahjwizK956dQz1drwQ0nI2qJRA5bvwg8wOyNJXVQ81SS7RDGJu0U1Rgw","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-06 10:35:42.300 +04:00 [DBG] Augmenting SignInContext
2019-03-06 10:35:42.301 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 10:35:42.419 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-06 10:35:42.427 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-06 10:35:42.428 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-06 10:35:42.441 +04:00 [DBG] Start token request.
2019-03-06 10:35:42.448 +04:00 [DBG] Start client validation
2019-03-06 10:35:42.458 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-06 10:35:42.462 +04:00 [DBG] Start parsing for secret in post body
2019-03-06 10:35:42.463 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-06 10:35:42.463 +04:00 [DBG] Secret id found: BiLab
2019-03-06 10:35:42.492 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:35:42.492 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:35:42.505 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-06 10:35:42.506 +04:00 [DBG] Client validation success
2019-03-06 10:35:42.508 +04:00 [INF] {"ClientId":"BiLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLL1VNJQGBLS:00000003","TimeStamp":"2019-03-06T06:35:42.0000000Z","ProcessId":16136,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-03-06 10:35:42.519 +04:00 [DBG] Start token request validation
2019-03-06 10:35:42.531 +04:00 [DBG] Start validation of authorization code token request
2019-03-06 10:35:42.550 +04:00 [DBG] KIFmDeaq9Hb/PNyw4wiPqtnoJJrsIflcSxG5Yvn/bjE= found in database: true
2019-03-06 10:35:42.568 +04:00 [DBG] removing KIFmDeaq9Hb/PNyw4wiPqtnoJJrsIflcSxG5Yvn/bjE= persisted grant from database
2019-03-06 10:35:42.584 +04:00 [DBG] Validation of authorization code token request success
2019-03-06 10:35:42.591 +04:00 [INF] Token request validation success
{"ClientId":"BiLab","ClientName":"BiLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"ee6eaacbde2f4ce5a7b2e2c669e1755e3c0d6c0039c40503ce0e76cdad0e1969","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"BiLab","client_secret":"***REDACTED***","code":"ee6eaacbde2f4ce5a7b2e2c669e1755e3c0d6c0039c40503ce0e76cdad0e1969","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-03-06 10:35:42.626 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:35:42.627 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:35:42.636 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:35:42.644 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:35:42.659 +04:00 [DBG] Getting claims for access token for client: BiLab
2019-03-06 10:35:42.660 +04:00 [DBG] Getting claims for access token for subject: 2
2019-03-06 10:35:42.693 +04:00 [DBG] Creating refresh token
2019-03-06 10:35:42.694 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-03-06 10:35:42.707 +04:00 [DBG] 3a3TSz4keGBI5OcSqLvCU8QNVfAuqz74qqn47tbQU2c= not found in database
2019-03-06 10:35:42.717 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:35:42.718 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:35:42.721 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:35:42.724 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:35:42.728 +04:00 [DBG] Getting claims for identity token for subject: 2 and client: BiLab
2019-03-06 10:35:42.729 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-06 10:35:42.736 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****ww6g","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****90f8","$type":"Token"},{"TokenType":"access_token","TokenValue":"****tCCA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL1VNJQGBLS:00000003","TimeStamp":"2019-03-06T06:35:42.0000000Z","ProcessId":16136,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-06 10:35:42.746 +04:00 [DBG] Token request success.
2019-03-06 10:36:04.452 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-06 10:36:04.457 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-06 10:36:04.459 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-06 10:36:04.460 +04:00 [DBG] Start authorize request
2019-03-06 10:36:04.461 +04:00 [DBG] No user present in authorize request
2019-03-06 10:36:04.461 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 10:36:04.487 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:36:04.488 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:36:04.491 +04:00 [DBG] Checking for PKCE parameters
2019-03-06 10:36:04.492 +04:00 [DBG] No PKCE used.
2019-03-06 10:36:04.500 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:36:04.509 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:36:04.513 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:36:04.516 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:36:04.516 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-06 10:36:04.519 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBcQh44eTu-eOFMKSVhkchEgnM-oEXWvZN3VkUJTKsz9ii2vUKuqspqFTVu8qMndkHqaPuzRk47i03kFy0WHxeNePlWhMDycr7tCBw2jwIIKd9vSgs9eP4ZHP-NbKYZDUWoqoRHPYRaqnut7AKiU3k36MDW6_4nfejG1LLYbqqkgohMRPUffKbAxwEwwE5aJ_NTmwnFNxsHbh-XxmV1IF6rp2K6_YO1XZ-S60-lnj-MThqR8mqOIcLa_Eax-e13848oZQU_Z0NmgWDXi_SmhwUj-maPjnBOPecz_955rehrxRWs_JWzxvU56HtfGyRH81o","UiLocales":null,"Nonce":"636874509644402530.YzNiNmQwZGMtMTZjNC00ZmJhLWJkZTYtOWZhMjFhM2IwZjYwZDAwOTliOWMtMDYzOS00ZjZiLTliYjAtYTkxNTllY2NiNjZi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874509644402530.YzNiNmQwZGMtMTZjNC00ZmJhLWJkZTYtOWZhMjFhM2IwZjYwZDAwOTliOWMtMDYzOS00ZjZiLTliYjAtYTkxNTllY2NiNjZi","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBcQh44eTu-eOFMKSVhkchEgnM-oEXWvZN3VkUJTKsz9ii2vUKuqspqFTVu8qMndkHqaPuzRk47i03kFy0WHxeNePlWhMDycr7tCBw2jwIIKd9vSgs9eP4ZHP-NbKYZDUWoqoRHPYRaqnut7AKiU3k36MDW6_4nfejG1LLYbqqkgohMRPUffKbAxwEwwE5aJ_NTmwnFNxsHbh-XxmV1IF6rp2K6_YO1XZ-S60-lnj-MThqR8mqOIcLa_Eax-e13848oZQU_Z0NmgWDXi_SmhwUj-maPjnBOPecz_955rehrxRWs_JWzxvU56HtfGyRH81o","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 10:36:04.532 +04:00 [INF] Showing login: User is not authenticated
2019-03-06 10:36:07.879 +04:00 [DBG] Augmenting SignInContext
2019-03-06 10:36:07.879 +04:00 [DBG] Adding idp claim with value: local
2019-03-06 10:36:07.881 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-06 10:36:07.883 +04:00 [DBG] Adding auth_time claim with value: 1551854167
2019-03-06 10:36:07.885 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 10:36:07.887 +04:00 [INF] {"Username":"godAdmin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"1002","DisplayName":"godAdmin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL1VNJQGBLQ:00000008","TimeStamp":"2019-03-06T06:36:07.0000000Z","ProcessId":16136,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-06 10:36:07.899 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-06 10:36:07.901 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-06 10:36:07.904 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-06 10:36:07.905 +04:00 [DBG] Start authorize callback request
2019-03-06 10:36:07.906 +04:00 [DBG] User in authorize request: 1002
2019-03-06 10:36:07.907 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 10:36:07.915 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:36:07.916 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:36:07.917 +04:00 [DBG] Checking for PKCE parameters
2019-03-06 10:36:07.918 +04:00 [DBG] No PKCE used.
2019-03-06 10:36:07.923 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:36:07.927 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:36:07.930 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:36:07.934 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:36:07.935 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-06 10:36:07.936 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBcQh44eTu-eOFMKSVhkchEgnM-oEXWvZN3VkUJTKsz9ii2vUKuqspqFTVu8qMndkHqaPuzRk47i03kFy0WHxeNePlWhMDycr7tCBw2jwIIKd9vSgs9eP4ZHP-NbKYZDUWoqoRHPYRaqnut7AKiU3k36MDW6_4nfejG1LLYbqqkgohMRPUffKbAxwEwwE5aJ_NTmwnFNxsHbh-XxmV1IF6rp2K6_YO1XZ-S60-lnj-MThqR8mqOIcLa_Eax-e13848oZQU_Z0NmgWDXi_SmhwUj-maPjnBOPecz_955rehrxRWs_JWzxvU56HtfGyRH81o","UiLocales":null,"Nonce":"636874509644402530.YzNiNmQwZGMtMTZjNC00ZmJhLWJkZTYtOWZhMjFhM2IwZjYwZDAwOTliOWMtMDYzOS00ZjZiLTliYjAtYTkxNTllY2NiNjZi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"33092235bae8d1f2a3a4f065f3766212","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874509644402530.YzNiNmQwZGMtMTZjNC00ZmJhLWJkZTYtOWZhMjFhM2IwZjYwZDAwOTliOWMtMDYzOS00ZjZiLTliYjAtYTkxNTllY2NiNjZi","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBcQh44eTu-eOFMKSVhkchEgnM-oEXWvZN3VkUJTKsz9ii2vUKuqspqFTVu8qMndkHqaPuzRk47i03kFy0WHxeNePlWhMDycr7tCBw2jwIIKd9vSgs9eP4ZHP-NbKYZDUWoqoRHPYRaqnut7AKiU3k36MDW6_4nfejG1LLYbqqkgohMRPUffKbAxwEwwE5aJ_NTmwnFNxsHbh-XxmV1IF6rp2K6_YO1XZ-S60-lnj-MThqR8mqOIcLa_Eax-e13848oZQU_Z0NmgWDXi_SmhwUj-maPjnBOPecz_955rehrxRWs_JWzxvU56HtfGyRH81o","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 10:36:07.956 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-06 10:36:07.959 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-06 10:36:07.962 +04:00 [DBG] y2+AW0TZ+6MFitaDgsGkukOmFdbXODbU4W7lbZ+EkDc= not found in database
2019-03-06 10:36:07.967 +04:00 [DBG] Creating Implicit Flow response.
2019-03-06 10:36:07.968 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-06 10:36:07.969 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-06 10:36:07.973 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"1002","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****_Kxw","$type":"Token"},{"TokenType":"code","TokenValue":"****b0d9","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL1VNJQGBLQ:00000009","TimeStamp":"2019-03-06T06:36:07.0000000Z","ProcessId":16136,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-06 10:36:07.981 +04:00 [INF] Authorize endpoint response
{"SubjectId":"1002","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBcQh44eTu-eOFMKSVhkchEgnM-oEXWvZN3VkUJTKsz9ii2vUKuqspqFTVu8qMndkHqaPuzRk47i03kFy0WHxeNePlWhMDycr7tCBw2jwIIKd9vSgs9eP4ZHP-NbKYZDUWoqoRHPYRaqnut7AKiU3k36MDW6_4nfejG1LLYbqqkgohMRPUffKbAxwEwwE5aJ_NTmwnFNxsHbh-XxmV1IF6rp2K6_YO1XZ-S60-lnj-MThqR8mqOIcLa_Eax-e13848oZQU_Z0NmgWDXi_SmhwUj-maPjnBOPecz_955rehrxRWs_JWzxvU56HtfGyRH81o","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-06 10:36:07.984 +04:00 [DBG] Augmenting SignInContext
2019-03-06 10:36:07.987 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 10:36:08.048 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-06 10:36:08.056 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-06 10:36:08.064 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-06 10:36:08.067 +04:00 [DBG] Start token request.
2019-03-06 10:36:08.068 +04:00 [DBG] Start client validation
2019-03-06 10:36:08.069 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-06 10:36:08.071 +04:00 [DBG] Start parsing for secret in post body
2019-03-06 10:36:08.073 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-06 10:36:08.074 +04:00 [DBG] Secret id found: BiLab
2019-03-06 10:36:08.079 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:36:08.080 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:36:08.081 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-06 10:36:08.081 +04:00 [DBG] Client validation success
2019-03-06 10:36:08.084 +04:00 [INF] {"ClientId":"BiLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLL1VNJQGBLS:00000004","TimeStamp":"2019-03-06T06:36:08.0000000Z","ProcessId":16136,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-03-06 10:36:08.088 +04:00 [DBG] Start token request validation
2019-03-06 10:36:08.088 +04:00 [DBG] Start validation of authorization code token request
2019-03-06 10:36:08.090 +04:00 [DBG] y2+AW0TZ+6MFitaDgsGkukOmFdbXODbU4W7lbZ+EkDc= found in database: true
2019-03-06 10:36:08.093 +04:00 [DBG] removing y2+AW0TZ+6MFitaDgsGkukOmFdbXODbU4W7lbZ+EkDc= persisted grant from database
2019-03-06 10:36:08.101 +04:00 [DBG] Validation of authorization code token request success
2019-03-06 10:36:08.101 +04:00 [INF] Token request validation success
{"ClientId":"BiLab","ClientName":"BiLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"b1d8727d6ebf698a5ec1111d277424c5d5aec398a6354d0fcd6683f90ce7b0d9","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"BiLab","client_secret":"***REDACTED***","code":"b1d8727d6ebf698a5ec1111d277424c5d5aec398a6354d0fcd6683f90ce7b0d9","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-03-06 10:36:08.112 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:36:08.113 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:36:08.120 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:36:08.126 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:36:08.127 +04:00 [DBG] Getting claims for access token for client: BiLab
2019-03-06 10:36:08.128 +04:00 [DBG] Getting claims for access token for subject: 1002
2019-03-06 10:36:08.138 +04:00 [DBG] Creating refresh token
2019-03-06 10:36:08.138 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-03-06 10:36:08.140 +04:00 [DBG] nQJgQ6uV5Q0uedMmAvbrHPsIs1ACMpUilEzJjKKv1eo= not found in database
2019-03-06 10:36:08.146 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:36:08.147 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:36:08.152 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:36:08.154 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:36:08.156 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-06 10:36:08.157 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-06 10:36:08.161 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****Htjw","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****dfaa","$type":"Token"},{"TokenType":"access_token","TokenValue":"****X0Yw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL1VNJQGBLS:00000004","TimeStamp":"2019-03-06T06:36:08.0000000Z","ProcessId":16136,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-06 10:36:08.168 +04:00 [DBG] Token request success.
2019-03-06 10:36:34.442 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 10:36:34.497 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 10:36:34.497 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 10:36:34.498 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 10:36:34.498 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 10:36:34.498 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 10:36:34.499 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 10:36:34.757 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:36:34.775 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:36:34.781 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:36:34.883 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 10:36:34.941 +04:00 [DBG] Starting grant removal
2019-03-06 10:36:35.777 +04:00 [DBG] Login Url: /Account/Login
2019-03-06 10:36:35.781 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 10:36:35.782 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 10:36:35.783 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 10:36:35.784 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 10:36:35.785 +04:00 [DBG] Error Url: /home/error
2019-03-06 10:36:35.785 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 10:36:35.835 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 10:36:59.451 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-06 10:36:59.457 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-06 10:36:59.458 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-06 10:36:59.465 +04:00 [DBG] Start discovery request
2019-03-06 10:36:59.941 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-06 10:37:00.071 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-06 10:37:00.074 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-06 10:37:00.075 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-06 10:37:00.081 +04:00 [DBG] Start key discovery request
2019-03-06 10:37:00.163 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-06 10:37:00.172 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-06 10:37:00.173 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-06 10:37:00.178 +04:00 [DBG] Start authorize request
2019-03-06 10:37:00.189 +04:00 [DBG] No user present in authorize request
2019-03-06 10:37:00.193 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 10:37:00.466 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:37:00.472 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:37:00.478 +04:00 [DBG] Checking for PKCE parameters
2019-03-06 10:37:00.480 +04:00 [DBG] No PKCE used.
2019-03-06 10:37:00.525 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:37:00.572 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:37:00.582 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:37:00.584 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:37:00.591 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-06 10:37:00.606 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDyasgNUdaY0G7TnArc2qI51b4eSz4btUuuAQzISCXhI1OS-Yx-cEtRKGM31rKLoLumX0kJYCKRb0MYT5rXRvZGPbK9pGOKx3vvRju2oMpcABTbzOptJ2Gj7tAlD3jtXnnFFcYhHDp_OgeUsjyJIO-TVkY6CEjUsa9jzDsSPB3CO-79SSHWd_e_yEjH0-gvdZrXKnh_j6TwibonmSTjLaBX9gaKqOBWbSU8pRPck6nJPv8LI5kk1gOQkkDIXI4ylXockjCIrftoGFlfHS4Blm_kN51qlTyQQqxO-j4at9NzgMA5BAouEt3rCxeqdK67mKg","UiLocales":null,"Nonce":"636874510201427489.ZjQzYzEzMDgtMGVlOC00NTBmLThmNzYtZjc0NGJlOWJiNWQyYmJhODQ2Y2QtNzY0Mi00MzEwLWIyYzktNGE0ZDQzNTgyZGFi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874510201427489.ZjQzYzEzMDgtMGVlOC00NTBmLThmNzYtZjc0NGJlOWJiNWQyYmJhODQ2Y2QtNzY0Mi00MzEwLWIyYzktNGE0ZDQzNTgyZGFi","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDyasgNUdaY0G7TnArc2qI51b4eSz4btUuuAQzISCXhI1OS-Yx-cEtRKGM31rKLoLumX0kJYCKRb0MYT5rXRvZGPbK9pGOKx3vvRju2oMpcABTbzOptJ2Gj7tAlD3jtXnnFFcYhHDp_OgeUsjyJIO-TVkY6CEjUsa9jzDsSPB3CO-79SSHWd_e_yEjH0-gvdZrXKnh_j6TwibonmSTjLaBX9gaKqOBWbSU8pRPck6nJPv8LI5kk1gOQkkDIXI4ylXockjCIrftoGFlfHS4Blm_kN51qlTyQQqxO-j4at9NzgMA5BAouEt3rCxeqdK67mKg","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 10:37:00.637 +04:00 [INF] Showing login: User is not authenticated
2019-03-06 10:37:01.930 +04:00 [ERR] The view 'Index' was not found. Searched locations: ["/Views/Home/Index.cshtml","/Views/Shared/Index.cshtml","/Pages/Shared/Index.cshtml"]
2019-03-06 10:37:01.937 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The view 'Index' was not found. The following locations were searched:
/Views/Home/Index.cshtml
/Views/Shared/Index.cshtml
/Pages/Shared/Index.cshtml
   at Microsoft.AspNetCore.Mvc.ViewEngines.ViewEngineResult.EnsureSuccessful(IEnumerable`1 originalLocations)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-03-06 10:37:27.100 +04:00 [DBG] Augmenting SignInContext
2019-03-06 10:37:27.105 +04:00 [DBG] Adding idp claim with value: local
2019-03-06 10:37:27.106 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-06 10:37:27.107 +04:00 [DBG] Adding auth_time claim with value: 1551854247
2019-03-06 10:37:27.119 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 10:37:27.144 +04:00 [INF] {"Username":"godAdmin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"1002","DisplayName":"godAdmin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL1VOA1S7VO:00000009","TimeStamp":"2019-03-06T06:37:27.0000000Z","ProcessId":10200,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-06 10:37:27.257 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentException: Value cannot be null or empty.
Parameter name: url
   at Microsoft.AspNetCore.Mvc.ControllerBase.Redirect(String url)
   at AuthServiceServer.Controllers.AccountController.Login(LoginModel model) in D:\Projects\AuthServiceServer\AuthServiceServer\Controllers\AccountController.cs:line 54
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-03-06 10:37:38.357 +04:00 [ERR] The view 'Index' was not found. Searched locations: ["/Views/Home/Index.cshtml","/Views/Shared/Index.cshtml","/Pages/Shared/Index.cshtml"]
2019-03-06 10:37:38.363 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The view 'Index' was not found. The following locations were searched:
/Views/Home/Index.cshtml
/Views/Shared/Index.cshtml
/Pages/Shared/Index.cshtml
   at Microsoft.AspNetCore.Mvc.ViewEngines.ViewEngineResult.EnsureSuccessful(IEnumerable`1 originalLocations)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-03-06 10:37:43.552 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-06 10:37:48.348 +04:00 [DBG] Augmenting SignInContext
2019-03-06 10:37:48.348 +04:00 [DBG] Adding idp claim with value: local
2019-03-06 10:37:48.350 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-06 10:37:48.351 +04:00 [DBG] Adding auth_time claim with value: 1551854268
2019-03-06 10:37:48.355 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 10:37:48.360 +04:00 [INF] {"Username":"godAdmin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"1002","DisplayName":"godAdmin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL1VOA1S7VO:0000000E","TimeStamp":"2019-03-06T06:37:48.0000000Z","ProcessId":10200,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-06 10:38:11.476 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-06 10:38:11.481 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-06 10:38:11.482 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-06 10:38:11.483 +04:00 [DBG] Start authorize request
2019-03-06 10:38:11.484 +04:00 [DBG] User in authorize request: 1002
2019-03-06 10:38:11.487 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 10:38:11.515 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:38:11.515 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:38:11.517 +04:00 [DBG] Checking for PKCE parameters
2019-03-06 10:38:11.518 +04:00 [DBG] No PKCE used.
2019-03-06 10:38:11.528 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:38:11.539 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:38:11.543 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:38:11.545 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:38:11.546 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-06 10:38:11.547 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBkv9qW4TsRlR_S9lfazkDSI9FTxCA1DqMUHQL7dDUmpefm8Ljvy32NEReICjlqo5kOuHpEuWQ4WlnpZWGUDxy2ilRVrsJAU6-72qDKFZC6dCW7aj7AEjfby9mTqu_oSAy-T5ABUY9pR0XHmz5zD-8_LDRNUaTURKOWRMO1cLZFM8S1HsCiSKhzdfaKbuxoaIfDa-B7WZ7eKBkU121by3TUMB5DwRRdpMah4FvyhAZOr2-C5x8nbv5GLSdyEGo6GuEe7rPcCiDGtQfyDynIsxXwsPGJaHjv_z4gWUDp4ERulPwkNQVYhiya-zK8jy2ZRiI","UiLocales":null,"Nonce":"636874510914663560.MzI3M2RlODgtZTQwMi00Mjg2LTkyYTQtYTkzNzFhZDczMzViNWVmNjFlNmUtNmRhYy00OTcxLTllYTUtYzk3NzczMzc2OWQ1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"74a807f7c92defdbc6222c898ab9ed37","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874510914663560.MzI3M2RlODgtZTQwMi00Mjg2LTkyYTQtYTkzNzFhZDczMzViNWVmNjFlNmUtNmRhYy00OTcxLTllYTUtYzk3NzczMzc2OWQ1","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBkv9qW4TsRlR_S9lfazkDSI9FTxCA1DqMUHQL7dDUmpefm8Ljvy32NEReICjlqo5kOuHpEuWQ4WlnpZWGUDxy2ilRVrsJAU6-72qDKFZC6dCW7aj7AEjfby9mTqu_oSAy-T5ABUY9pR0XHmz5zD-8_LDRNUaTURKOWRMO1cLZFM8S1HsCiSKhzdfaKbuxoaIfDa-B7WZ7eKBkU121by3TUMB5DwRRdpMah4FvyhAZOr2-C5x8nbv5GLSdyEGo6GuEe7rPcCiDGtQfyDynIsxXwsPGJaHjv_z4gWUDp4ERulPwkNQVYhiya-zK8jy2ZRiI","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 10:38:11.593 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-06 10:38:11.599 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-06 10:38:11.644 +04:00 [DBG] vcP1cEWeUaq/4KfMWLPnk8w7ORmgKIP5o3XTZjJjVpQ= not found in database
2019-03-06 10:38:11.706 +04:00 [DBG] Creating Implicit Flow response.
2019-03-06 10:38:11.716 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-06 10:38:11.720 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-06 10:38:11.802 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"1002","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****a-yA","$type":"Token"},{"TokenType":"code","TokenValue":"****f9f3","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL1VOA1S7VO:00000012","TimeStamp":"2019-03-06T06:38:11.0000000Z","ProcessId":10200,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-06 10:38:11.810 +04:00 [INF] Authorize endpoint response
{"SubjectId":"1002","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBkv9qW4TsRlR_S9lfazkDSI9FTxCA1DqMUHQL7dDUmpefm8Ljvy32NEReICjlqo5kOuHpEuWQ4WlnpZWGUDxy2ilRVrsJAU6-72qDKFZC6dCW7aj7AEjfby9mTqu_oSAy-T5ABUY9pR0XHmz5zD-8_LDRNUaTURKOWRMO1cLZFM8S1HsCiSKhzdfaKbuxoaIfDa-B7WZ7eKBkU121by3TUMB5DwRRdpMah4FvyhAZOr2-C5x8nbv5GLSdyEGo6GuEe7rPcCiDGtQfyDynIsxXwsPGJaHjv_z4gWUDp4ERulPwkNQVYhiya-zK8jy2ZRiI","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-06 10:38:11.839 +04:00 [DBG] Augmenting SignInContext
2019-03-06 10:38:11.841 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 10:38:11.976 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-06 10:38:11.983 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-06 10:38:11.984 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-06 10:38:11.996 +04:00 [DBG] Start token request.
2019-03-06 10:38:12.002 +04:00 [DBG] Start client validation
2019-03-06 10:38:12.008 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-06 10:38:12.012 +04:00 [DBG] Start parsing for secret in post body
2019-03-06 10:38:12.013 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-06 10:38:12.014 +04:00 [DBG] Secret id found: BiLab
2019-03-06 10:38:12.020 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:38:12.020 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:38:12.031 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-06 10:38:12.031 +04:00 [DBG] Client validation success
2019-03-06 10:38:12.032 +04:00 [INF] {"ClientId":"BiLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLL1VOA1S7VP:00000003","TimeStamp":"2019-03-06T06:38:12.0000000Z","ProcessId":10200,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-03-06 10:38:12.043 +04:00 [DBG] Start token request validation
2019-03-06 10:38:12.053 +04:00 [DBG] Start validation of authorization code token request
2019-03-06 10:38:12.069 +04:00 [DBG] vcP1cEWeUaq/4KfMWLPnk8w7ORmgKIP5o3XTZjJjVpQ= found in database: true
2019-03-06 10:38:12.088 +04:00 [DBG] removing vcP1cEWeUaq/4KfMWLPnk8w7ORmgKIP5o3XTZjJjVpQ= persisted grant from database
2019-03-06 10:38:12.100 +04:00 [DBG] Validation of authorization code token request success
2019-03-06 10:38:12.108 +04:00 [INF] Token request validation success
{"ClientId":"BiLab","ClientName":"BiLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"cc835b7ed5e6b8f9d90e493533f928bae29c323467ee10a03cab5ef53f40f9f3","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"BiLab","client_secret":"***REDACTED***","code":"cc835b7ed5e6b8f9d90e493533f928bae29c323467ee10a03cab5ef53f40f9f3","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-03-06 10:38:12.134 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:38:12.135 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:38:12.144 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:38:12.149 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:38:12.161 +04:00 [DBG] Getting claims for access token for client: BiLab
2019-03-06 10:38:12.162 +04:00 [DBG] Getting claims for access token for subject: 1002
2019-03-06 10:38:12.193 +04:00 [DBG] Creating refresh token
2019-03-06 10:38:12.193 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-03-06 10:38:12.207 +04:00 [DBG] pzfifCqlOIbfwO4CllI9sfD3AnP2xWWRwCIqBLut1xA= not found in database
2019-03-06 10:38:12.214 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:38:12.214 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:38:12.220 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:38:12.223 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:38:12.224 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-06 10:38:12.225 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-06 10:38:12.233 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****WCGA","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****cb7e","$type":"Token"},{"TokenType":"access_token","TokenValue":"****2xDQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL1VOA1S7VP:00000003","TimeStamp":"2019-03-06T06:38:12.0000000Z","ProcessId":10200,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-06 10:38:12.240 +04:00 [DBG] Token request success.
2019-03-06 10:38:12.256 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-03-06 10:38:12.258 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-03-06 10:38:12.259 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-03-06 10:38:12.266 +04:00 [DBG] Start userinfo request
2019-03-06 10:38:12.272 +04:00 [DBG] Bearer token found in header
2019-03-06 10:38:12.336 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:38:12.337 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:38:12.346 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:38:12.346 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:38:12.359 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-03-06 10:38:12.362 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1551854292,"exp":1551857892,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"BiLab","sub":"1002","auth_time":1551854268,"idp":"local","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-03-06 10:38:12.378 +04:00 [DBG] Creating userinfo response
2019-03-06 10:38:12.382 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-06 10:38:12.388 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-06 10:38:12.393 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:38:12.394 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-03-06 10:38:12.395 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-06 10:38:12.400 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:38:12.411 +04:00 [INF] Profile service returned the following claim types: sub preferred_username name
2019-03-06 10:38:12.412 +04:00 [DBG] End userinfo request
2019-03-06 10:38:56.665 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 10:38:56.723 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 10:38:56.723 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 10:38:56.724 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 10:38:56.724 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 10:38:56.724 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 10:38:56.725 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 10:38:56.952 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:38:56.966 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:38:56.969 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 10:38:57.052 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 10:38:57.106 +04:00 [DBG] Starting grant removal
2019-03-06 10:38:57.967 +04:00 [DBG] Login Url: /Account/Login
2019-03-06 10:38:57.973 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 10:38:57.974 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 10:38:57.974 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 10:38:57.975 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 10:38:57.976 +04:00 [DBG] Error Url: /home/error
2019-03-06 10:38:57.976 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 10:38:58.026 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 10:39:23.715 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-06 10:39:23.721 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-06 10:39:23.722 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-06 10:39:23.728 +04:00 [DBG] Start discovery request
2019-03-06 10:39:24.211 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-06 10:39:24.359 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-06 10:39:24.361 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-06 10:39:24.362 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-06 10:39:24.367 +04:00 [DBG] Start key discovery request
2019-03-06 10:39:24.457 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-06 10:39:24.470 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-06 10:39:24.471 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-06 10:39:24.476 +04:00 [DBG] Start authorize request
2019-03-06 10:39:24.488 +04:00 [DBG] No user present in authorize request
2019-03-06 10:39:24.493 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 10:39:24.782 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:39:24.790 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:39:24.800 +04:00 [DBG] Checking for PKCE parameters
2019-03-06 10:39:24.802 +04:00 [DBG] No PKCE used.
2019-03-06 10:39:24.849 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:39:24.899 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:39:24.911 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:39:24.914 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:39:24.923 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-06 10:39:24.938 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDOSYlcZPCuynUhQU0mxgz1ntgdU9_zvpZIW8oRoCxIH0b1bXDuXZ_-4g8DN3LkhzzAWmkjHqbHPYfEtvxgYxi1kjBkNLjM758pd1N_6aEXdcUCw9MbZGVJh1SErQlwXKI28mwb64vi7vz9fAoHnjuboYQsyTQWDWNUhSw4EWjSNjkzInf6fGAOMetIFa6wE2nWhZO1be4Uw90NMTiWYQL4NCLc2FekonuYHm1LUjq-sXbaikB7g3BiEXIpmEh1cKP87Qn-AaGh6fZZFuieQwSpb77nEjacuwcNgOimGv3iEMzKA1_gK-C7ymQkIezauc0","UiLocales":null,"Nonce":"636874511644307896.ZTdmYmNkYzktMTc2Ny00OGY2LWE4YzYtMjQzNjMwNDZmMDIwZWEwMDAyMzUtZDkxNC00YmJmLWFjMDUtMTc5N2FhMjc2MmNk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874511644307896.ZTdmYmNkYzktMTc2Ny00OGY2LWE4YzYtMjQzNjMwNDZmMDIwZWEwMDAyMzUtZDkxNC00YmJmLWFjMDUtMTc5N2FhMjc2MmNk","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDOSYlcZPCuynUhQU0mxgz1ntgdU9_zvpZIW8oRoCxIH0b1bXDuXZ_-4g8DN3LkhzzAWmkjHqbHPYfEtvxgYxi1kjBkNLjM758pd1N_6aEXdcUCw9MbZGVJh1SErQlwXKI28mwb64vi7vz9fAoHnjuboYQsyTQWDWNUhSw4EWjSNjkzInf6fGAOMetIFa6wE2nWhZO1be4Uw90NMTiWYQL4NCLc2FekonuYHm1LUjq-sXbaikB7g3BiEXIpmEh1cKP87Qn-AaGh6fZZFuieQwSpb77nEjacuwcNgOimGv3iEMzKA1_gK-C7ymQkIezauc0","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 10:39:24.966 +04:00 [INF] Showing login: User is not authenticated
2019-03-06 10:39:26.518 +04:00 [DBG] Augmenting SignInContext
2019-03-06 10:39:26.520 +04:00 [DBG] Adding idp claim with value: local
2019-03-06 10:39:26.521 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-06 10:39:26.522 +04:00 [DBG] Adding auth_time claim with value: 1551854366
2019-03-06 10:39:26.533 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 10:39:26.558 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL1VPKH14FP:00000004","TimeStamp":"2019-03-06T06:39:26.0000000Z","ProcessId":9256,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-06 10:39:26.599 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-06 10:39:26.602 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-06 10:39:26.604 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-06 10:39:26.614 +04:00 [DBG] Start authorize callback request
2019-03-06 10:39:26.621 +04:00 [DBG] User in authorize request: 2
2019-03-06 10:39:26.622 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 10:39:26.631 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:39:26.631 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:39:26.632 +04:00 [DBG] Checking for PKCE parameters
2019-03-06 10:39:26.633 +04:00 [DBG] No PKCE used.
2019-03-06 10:39:26.636 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:39:26.641 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:39:26.648 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:39:26.651 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:39:26.652 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-06 10:39:26.654 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDOSYlcZPCuynUhQU0mxgz1ntgdU9_zvpZIW8oRoCxIH0b1bXDuXZ_-4g8DN3LkhzzAWmkjHqbHPYfEtvxgYxi1kjBkNLjM758pd1N_6aEXdcUCw9MbZGVJh1SErQlwXKI28mwb64vi7vz9fAoHnjuboYQsyTQWDWNUhSw4EWjSNjkzInf6fGAOMetIFa6wE2nWhZO1be4Uw90NMTiWYQL4NCLc2FekonuYHm1LUjq-sXbaikB7g3BiEXIpmEh1cKP87Qn-AaGh6fZZFuieQwSpb77nEjacuwcNgOimGv3iEMzKA1_gK-C7ymQkIezauc0","UiLocales":null,"Nonce":"636874511644307896.ZTdmYmNkYzktMTc2Ny00OGY2LWE4YzYtMjQzNjMwNDZmMDIwZWEwMDAyMzUtZDkxNC00YmJmLWFjMDUtMTc5N2FhMjc2MmNk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"33ba53d47aadd8d891eff115e92a61b5","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874511644307896.ZTdmYmNkYzktMTc2Ny00OGY2LWE4YzYtMjQzNjMwNDZmMDIwZWEwMDAyMzUtZDkxNC00YmJmLWFjMDUtMTc5N2FhMjc2MmNk","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDOSYlcZPCuynUhQU0mxgz1ntgdU9_zvpZIW8oRoCxIH0b1bXDuXZ_-4g8DN3LkhzzAWmkjHqbHPYfEtvxgYxi1kjBkNLjM758pd1N_6aEXdcUCw9MbZGVJh1SErQlwXKI28mwb64vi7vz9fAoHnjuboYQsyTQWDWNUhSw4EWjSNjkzInf6fGAOMetIFa6wE2nWhZO1be4Uw90NMTiWYQL4NCLc2FekonuYHm1LUjq-sXbaikB7g3BiEXIpmEh1cKP87Qn-AaGh6fZZFuieQwSpb77nEjacuwcNgOimGv3iEMzKA1_gK-C7ymQkIezauc0","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 10:39:26.702 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-06 10:39:26.710 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-06 10:39:26.750 +04:00 [DBG] 3++WNQzGXtERDT4m1KUd6cqBz30k5mMUTn4q/VIviHY= not found in database
2019-03-06 10:39:26.820 +04:00 [DBG] Creating Implicit Flow response.
2019-03-06 10:39:26.831 +04:00 [DBG] Getting claims for identity token for subject: 2 and client: BiLab
2019-03-06 10:39:26.835 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-06 10:39:26.918 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"2","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****gjag","$type":"Token"},{"TokenType":"code","TokenValue":"****0f3f","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL1VPKH14FP:00000005","TimeStamp":"2019-03-06T06:39:26.0000000Z","ProcessId":9256,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-06 10:39:26.925 +04:00 [INF] Authorize endpoint response
{"SubjectId":"2","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDOSYlcZPCuynUhQU0mxgz1ntgdU9_zvpZIW8oRoCxIH0b1bXDuXZ_-4g8DN3LkhzzAWmkjHqbHPYfEtvxgYxi1kjBkNLjM758pd1N_6aEXdcUCw9MbZGVJh1SErQlwXKI28mwb64vi7vz9fAoHnjuboYQsyTQWDWNUhSw4EWjSNjkzInf6fGAOMetIFa6wE2nWhZO1be4Uw90NMTiWYQL4NCLc2FekonuYHm1LUjq-sXbaikB7g3BiEXIpmEh1cKP87Qn-AaGh6fZZFuieQwSpb77nEjacuwcNgOimGv3iEMzKA1_gK-C7ymQkIezauc0","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-06 10:39:26.946 +04:00 [DBG] Augmenting SignInContext
2019-03-06 10:39:26.946 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 10:39:27.050 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-06 10:39:27.055 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-06 10:39:27.056 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-06 10:39:27.066 +04:00 [DBG] Start token request.
2019-03-06 10:39:27.073 +04:00 [DBG] Start client validation
2019-03-06 10:39:27.080 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-06 10:39:27.085 +04:00 [DBG] Start parsing for secret in post body
2019-03-06 10:39:27.086 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-06 10:39:27.087 +04:00 [DBG] Secret id found: BiLab
2019-03-06 10:39:27.111 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:39:27.112 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:39:27.125 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-06 10:39:27.125 +04:00 [DBG] Client validation success
2019-03-06 10:39:27.126 +04:00 [INF] {"ClientId":"BiLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLL1VPKH14FR:00000003","TimeStamp":"2019-03-06T06:39:27.0000000Z","ProcessId":9256,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-03-06 10:39:27.140 +04:00 [DBG] Start token request validation
2019-03-06 10:39:27.150 +04:00 [DBG] Start validation of authorization code token request
2019-03-06 10:39:27.167 +04:00 [DBG] 3++WNQzGXtERDT4m1KUd6cqBz30k5mMUTn4q/VIviHY= found in database: true
2019-03-06 10:39:27.184 +04:00 [DBG] removing 3++WNQzGXtERDT4m1KUd6cqBz30k5mMUTn4q/VIviHY= persisted grant from database
2019-03-06 10:39:27.198 +04:00 [DBG] Validation of authorization code token request success
2019-03-06 10:39:27.204 +04:00 [INF] Token request validation success
{"ClientId":"BiLab","ClientName":"BiLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"a6088869d17f0d6d135141d4626ea5e94e78654000690a974974bff64d860f3f","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"BiLab","client_secret":"***REDACTED***","code":"a6088869d17f0d6d135141d4626ea5e94e78654000690a974974bff64d860f3f","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-03-06 10:39:27.253 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:39:27.253 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:39:27.265 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:39:27.272 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:39:27.285 +04:00 [DBG] Getting claims for access token for client: BiLab
2019-03-06 10:39:27.286 +04:00 [DBG] Getting claims for access token for subject: 2
2019-03-06 10:39:27.316 +04:00 [DBG] Creating refresh token
2019-03-06 10:39:27.317 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-03-06 10:39:27.332 +04:00 [DBG] syhlxL09uYh4j2s7a4sJa+8cPCX5JsEf2Y2Ffypn+i0= not found in database
2019-03-06 10:39:27.369 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:39:27.369 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:39:27.380 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:39:27.386 +04:00 [DBG] Found [] API scopes in database
2019-03-06 10:39:27.387 +04:00 [DBG] Getting claims for identity token for subject: 2 and client: BiLab
2019-03-06 10:39:27.388 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-06 10:39:27.397 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****BRpQ","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****dd9d","$type":"Token"},{"TokenType":"access_token","TokenValue":"****Y8SA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL1VPKH14FR:00000003","TimeStamp":"2019-03-06T06:39:27.0000000Z","ProcessId":9256,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-06 10:39:27.405 +04:00 [DBG] Token request success.
2019-03-06 10:39:27.418 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-03-06 10:39:27.421 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-03-06 10:39:27.425 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-03-06 10:39:27.435 +04:00 [DBG] Start userinfo request
2019-03-06 10:39:27.438 +04:00 [DBG] Bearer token found in header
2019-03-06 10:39:27.529 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:39:27.529 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:39:27.558 +04:00 [DBG] BiLab found in database: true
2019-03-06 10:39:27.559 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 10:39:27.568 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-03-06 10:39:27.571 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1551854367,"exp":1551857967,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"BiLab","sub":"2","auth_time":1551854366,"idp":"local","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-03-06 10:39:27.586 +04:00 [DBG] Creating userinfo response
2019-03-06 10:39:27.591 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-06 10:39:27.596 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-06 10:39:27.609 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:39:27.611 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-03-06 10:39:27.612 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-06 10:39:27.621 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 10:39:27.636 +04:00 [INF] Profile service returned the following claim types: sub preferred_username name
2019-03-06 10:39:27.638 +04:00 [DBG] End userinfo request
2019-03-06 11:14:56.871 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 11:14:56.930 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 11:14:56.932 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 11:14:56.933 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 11:14:56.933 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 11:14:56.933 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 11:14:56.934 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 11:14:57.244 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 11:14:57.254 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 11:14:57.256 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 11:14:57.348 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 11:14:57.455 +04:00 [DBG] Starting grant removal
2019-03-06 11:14:58.451 +04:00 [DBG] Login Url: /Account/Login
2019-03-06 11:14:58.457 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 11:14:58.458 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 11:14:58.459 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 11:14:58.459 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 11:14:58.460 +04:00 [DBG] Error Url: /home/error
2019-03-06 11:14:58.461 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 11:14:58.801 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 11:14:59.409 +04:00 [INF] AuthenticationScheme: Identity.Application was forbidden.
2019-03-06 11:25:38.898 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 11:25:38.988 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 11:25:38.989 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 11:25:38.990 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 11:25:38.990 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 11:25:38.990 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 11:25:38.991 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 11:25:39.315 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 11:25:39.326 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 11:25:39.332 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 11:25:39.424 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 11:25:39.536 +04:00 [DBG] Starting grant removal
2019-03-06 11:25:40.985 +04:00 [DBG] Login Url: /Account/Login
2019-03-06 11:25:40.988 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 11:25:40.989 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 11:25:40.991 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 11:25:40.991 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 11:25:40.992 +04:00 [DBG] Error Url: /home/error
2019-03-06 11:25:40.993 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 11:25:41.149 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 11:25:41.710 +04:00 [INF] AuthenticationScheme: Identity.Application was forbidden.
2019-03-06 11:44:57.572 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 11:44:57.639 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 11:44:57.640 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 11:44:57.640 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 11:44:57.640 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 11:44:57.641 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 11:44:57.641 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 11:44:57.896 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 11:44:57.911 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 11:44:57.915 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 11:44:58.001 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 11:44:58.057 +04:00 [DBG] Starting grant removal
2019-03-06 11:44:58.866 +04:00 [DBG] Login Url: /Account/Login
2019-03-06 11:44:58.869 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 11:44:58.870 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 11:44:58.871 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 11:44:58.871 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 11:44:58.872 +04:00 [DBG] Error Url: /home/error
2019-03-06 11:44:58.873 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 11:44:58.928 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 11:44:59.092 +04:00 [INF] AuthenticationScheme: Identity.Application was forbidden.
2019-03-06 11:45:07.683 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-03-06 11:45:07.687 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-03-06 11:45:07.693 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-03-06 11:45:48.809 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-06 11:45:48.815 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-06 11:45:48.816 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-06 11:45:48.822 +04:00 [DBG] Start discovery request
2019-03-06 11:45:49.389 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-06 11:45:49.545 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-06 11:45:49.548 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-06 11:45:49.549 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-06 11:45:49.555 +04:00 [DBG] Start key discovery request
2019-03-06 11:45:49.704 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-06 11:45:49.710 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-06 11:45:49.711 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-06 11:45:49.717 +04:00 [DBG] Start authorize request
2019-03-06 11:45:49.730 +04:00 [DBG] No user present in authorize request
2019-03-06 11:45:49.737 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 11:45:50.076 +04:00 [DBG] BiLab found in database: true
2019-03-06 11:45:50.083 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 11:45:50.092 +04:00 [DBG] Checking for PKCE parameters
2019-03-06 11:45:50.093 +04:00 [DBG] No PKCE used.
2019-03-06 11:45:50.157 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 11:45:50.209 +04:00 [DBG] Found [] API scopes in database
2019-03-06 11:45:50.228 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 11:45:50.231 +04:00 [DBG] Found [] API scopes in database
2019-03-06 11:45:50.240 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-06 11:45:50.257 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAL_Z3AumgB0yRx1D5KOd9TCLdg6IkJ5AeoHvmyB9HR1ftVpOSQPVJgTJ2lte0g-jL9xONr7QVwKZcgQGVJQR6dI0MAO_8uYVr9i516cbZUmu-bJBXuYATOaHSS2Jty2jdOz8TcbSLdsOy3J-WIE5jVzWFEt1aAzSLZxYbl26t8Gnd_FH1Ja4lWoguSeP20OI521SMjqaiN6EnayUA07rl-X82KlToCT9KWIPW2omG8pBrfjh6f_bTdaa9IsMqD00Wb7JrcBWIDTDt2wOVRkfvDewWtnES0jsV68M38B6Ye7GbUmVQUkk2yPGRVvqlgQcg","UiLocales":null,"Nonce":"636874551496757890.N2M1MTFhZmEtMjQ4MC00OWNhLWI2ODItNTlkOTJjOTRjZTlkNTQ3ZmZmZjItMjQyYi00OTczLTgwN2ItN2M4ZWJjZTk2ZDdm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874551496757890.N2M1MTFhZmEtMjQ4MC00OWNhLWI2ODItNTlkOTJjOTRjZTlkNTQ3ZmZmZjItMjQyYi00OTczLTgwN2ItN2M4ZWJjZTk2ZDdm","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAL_Z3AumgB0yRx1D5KOd9TCLdg6IkJ5AeoHvmyB9HR1ftVpOSQPVJgTJ2lte0g-jL9xONr7QVwKZcgQGVJQR6dI0MAO_8uYVr9i516cbZUmu-bJBXuYATOaHSS2Jty2jdOz8TcbSLdsOy3J-WIE5jVzWFEt1aAzSLZxYbl26t8Gnd_FH1Ja4lWoguSeP20OI521SMjqaiN6EnayUA07rl-X82KlToCT9KWIPW2omG8pBrfjh6f_bTdaa9IsMqD00Wb7JrcBWIDTDt2wOVRkfvDewWtnES0jsV68M38B6Ye7GbUmVQUkk2yPGRVvqlgQcg","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 11:45:50.285 +04:00 [INF] Showing login: User is not authenticated
2019-03-06 11:45:57.443 +04:00 [DBG] Augmenting SignInContext
2019-03-06 11:45:57.446 +04:00 [DBG] Adding idp claim with value: local
2019-03-06 11:45:57.446 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-06 11:45:57.447 +04:00 [DBG] Adding auth_time claim with value: 1551858357
2019-03-06 11:45:57.453 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 11:45:57.511 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL20UGRTN2P:00000001","TimeStamp":"2019-03-06T07:45:57.0000000Z","ProcessId":6852,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-06 11:45:57.530 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-06 11:45:57.532 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-06 11:45:57.533 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-06 11:45:57.541 +04:00 [DBG] Start authorize callback request
2019-03-06 11:45:57.547 +04:00 [DBG] User in authorize request: 2
2019-03-06 11:45:57.548 +04:00 [DBG] Start authorize request protocol validation
2019-03-06 11:45:57.573 +04:00 [DBG] BiLab found in database: true
2019-03-06 11:45:57.573 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 11:45:57.576 +04:00 [DBG] Checking for PKCE parameters
2019-03-06 11:45:57.577 +04:00 [DBG] No PKCE used.
2019-03-06 11:45:57.588 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 11:45:57.599 +04:00 [DBG] Found [] API scopes in database
2019-03-06 11:45:57.602 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 11:45:57.605 +04:00 [DBG] Found [] API scopes in database
2019-03-06 11:45:57.611 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-06 11:45:57.614 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAL_Z3AumgB0yRx1D5KOd9TCLdg6IkJ5AeoHvmyB9HR1ftVpOSQPVJgTJ2lte0g-jL9xONr7QVwKZcgQGVJQR6dI0MAO_8uYVr9i516cbZUmu-bJBXuYATOaHSS2Jty2jdOz8TcbSLdsOy3J-WIE5jVzWFEt1aAzSLZxYbl26t8Gnd_FH1Ja4lWoguSeP20OI521SMjqaiN6EnayUA07rl-X82KlToCT9KWIPW2omG8pBrfjh6f_bTdaa9IsMqD00Wb7JrcBWIDTDt2wOVRkfvDewWtnES0jsV68M38B6Ye7GbUmVQUkk2yPGRVvqlgQcg","UiLocales":null,"Nonce":"636874551496757890.N2M1MTFhZmEtMjQ4MC00OWNhLWI2ODItNTlkOTJjOTRjZTlkNTQ3ZmZmZjItMjQyYi00OTczLTgwN2ItN2M4ZWJjZTk2ZDdm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"269430d35df59df69ed996dcdd8a6418","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636874551496757890.N2M1MTFhZmEtMjQ4MC00OWNhLWI2ODItNTlkOTJjOTRjZTlkNTQ3ZmZmZjItMjQyYi00OTczLTgwN2ItN2M4ZWJjZTk2ZDdm","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAL_Z3AumgB0yRx1D5KOd9TCLdg6IkJ5AeoHvmyB9HR1ftVpOSQPVJgTJ2lte0g-jL9xONr7QVwKZcgQGVJQR6dI0MAO_8uYVr9i516cbZUmu-bJBXuYATOaHSS2Jty2jdOz8TcbSLdsOy3J-WIE5jVzWFEt1aAzSLZxYbl26t8Gnd_FH1Ja4lWoguSeP20OI521SMjqaiN6EnayUA07rl-X82KlToCT9KWIPW2omG8pBrfjh6f_bTdaa9IsMqD00Wb7JrcBWIDTDt2wOVRkfvDewWtnES0jsV68M38B6Ye7GbUmVQUkk2yPGRVvqlgQcg","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-06 11:45:57.652 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-06 11:45:57.660 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-06 11:45:57.701 +04:00 [DBG] leJPihvW8xvBeaOC4uzsc53hBJe/Pc33jVioPnYSrwE= not found in database
2019-03-06 11:45:57.781 +04:00 [DBG] Creating Implicit Flow response.
2019-03-06 11:45:57.793 +04:00 [DBG] Getting claims for identity token for subject: 2 and client: BiLab
2019-03-06 11:45:57.796 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-06 11:45:57.887 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"2","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****QA3A","$type":"Token"},{"TokenType":"code","TokenValue":"****2fa7","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL20UGRTN2P:00000002","TimeStamp":"2019-03-06T07:45:57.0000000Z","ProcessId":6852,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-06 11:45:57.896 +04:00 [INF] Authorize endpoint response
{"SubjectId":"2","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAL_Z3AumgB0yRx1D5KOd9TCLdg6IkJ5AeoHvmyB9HR1ftVpOSQPVJgTJ2lte0g-jL9xONr7QVwKZcgQGVJQR6dI0MAO_8uYVr9i516cbZUmu-bJBXuYATOaHSS2Jty2jdOz8TcbSLdsOy3J-WIE5jVzWFEt1aAzSLZxYbl26t8Gnd_FH1Ja4lWoguSeP20OI521SMjqaiN6EnayUA07rl-X82KlToCT9KWIPW2omG8pBrfjh6f_bTdaa9IsMqD00Wb7JrcBWIDTDt2wOVRkfvDewWtnES0jsV68M38B6Ye7GbUmVQUkk2yPGRVvqlgQcg","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-06 11:45:57.920 +04:00 [DBG] Augmenting SignInContext
2019-03-06 11:45:57.922 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 11:45:58.081 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-06 11:45:58.086 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-06 11:45:58.088 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-06 11:45:58.099 +04:00 [DBG] Start token request.
2019-03-06 11:45:58.106 +04:00 [DBG] Start client validation
2019-03-06 11:45:58.114 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-06 11:45:58.118 +04:00 [DBG] Start parsing for secret in post body
2019-03-06 11:45:58.119 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-06 11:45:58.119 +04:00 [DBG] Secret id found: BiLab
2019-03-06 11:45:58.147 +04:00 [DBG] BiLab found in database: true
2019-03-06 11:45:58.148 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 11:45:58.162 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-06 11:45:58.162 +04:00 [DBG] Client validation success
2019-03-06 11:45:58.163 +04:00 [INF] {"ClientId":"BiLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLL20UGRTN2M:00000003","TimeStamp":"2019-03-06T07:45:58.0000000Z","ProcessId":6852,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-03-06 11:45:58.172 +04:00 [DBG] Start token request validation
2019-03-06 11:45:58.184 +04:00 [DBG] Start validation of authorization code token request
2019-03-06 11:45:58.203 +04:00 [DBG] leJPihvW8xvBeaOC4uzsc53hBJe/Pc33jVioPnYSrwE= found in database: true
2019-03-06 11:45:58.232 +04:00 [DBG] removing leJPihvW8xvBeaOC4uzsc53hBJe/Pc33jVioPnYSrwE= persisted grant from database
2019-03-06 11:45:58.273 +04:00 [DBG] Validation of authorization code token request success
2019-03-06 11:45:58.285 +04:00 [INF] Token request validation success
{"ClientId":"BiLab","ClientName":"BiLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"e8a32e6a5345cac1d2af6a7e3fd22fce4f109acfbf9a3b42c3051d91d0812fa7","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"BiLab","client_secret":"***REDACTED***","code":"e8a32e6a5345cac1d2af6a7e3fd22fce4f109acfbf9a3b42c3051d91d0812fa7","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-03-06 11:45:58.331 +04:00 [DBG] BiLab found in database: true
2019-03-06 11:45:58.331 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 11:45:58.346 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 11:45:58.352 +04:00 [DBG] Found [] API scopes in database
2019-03-06 11:45:58.368 +04:00 [DBG] Getting claims for access token for client: BiLab
2019-03-06 11:45:58.369 +04:00 [DBG] Getting claims for access token for subject: 2
2019-03-06 11:45:58.404 +04:00 [DBG] Creating refresh token
2019-03-06 11:45:58.405 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-03-06 11:45:58.421 +04:00 [DBG] fa0s8dSFFuLhh6el2sYNBBoNq361RfhXwcGbMXBthfU= not found in database
2019-03-06 11:45:58.454 +04:00 [DBG] BiLab found in database: true
2019-03-06 11:45:58.454 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 11:45:58.466 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 11:45:58.472 +04:00 [DBG] Found [] API scopes in database
2019-03-06 11:45:58.473 +04:00 [DBG] Getting claims for identity token for subject: 2 and client: BiLab
2019-03-06 11:45:58.476 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-06 11:45:58.485 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****4nnA","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****57f6","$type":"Token"},{"TokenType":"access_token","TokenValue":"****2KLw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL20UGRTN2M:00000003","TimeStamp":"2019-03-06T07:45:58.0000000Z","ProcessId":6852,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-06 11:45:58.492 +04:00 [DBG] Token request success.
2019-03-06 11:45:58.507 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-03-06 11:45:58.513 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-03-06 11:45:58.514 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-03-06 11:45:58.522 +04:00 [DBG] Start userinfo request
2019-03-06 11:45:58.528 +04:00 [DBG] Bearer token found in header
2019-03-06 11:45:58.612 +04:00 [DBG] BiLab found in database: true
2019-03-06 11:45:58.612 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 11:45:58.622 +04:00 [DBG] BiLab found in database: true
2019-03-06 11:45:58.622 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-06 11:45:58.633 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-03-06 11:45:58.637 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1551858358,"exp":1551861958,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"BiLab","sub":"2","auth_time":1551858357,"idp":"local","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-03-06 11:45:58.654 +04:00 [DBG] Creating userinfo response
2019-03-06 11:45:58.658 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-06 11:45:58.665 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-06 11:45:58.675 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 11:45:58.678 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-03-06 11:45:58.680 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-06 11:45:58.683 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-06 11:45:58.696 +04:00 [INF] Profile service returned the following claim types: sub preferred_username name
2019-03-06 11:45:58.698 +04:00 [DBG] End userinfo request
2019-03-06 12:20:19.625 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 12:20:19.725 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 12:20:19.726 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 12:20:19.726 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 12:20:19.727 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 12:20:19.727 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 12:20:19.727 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 12:20:19.974 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 12:20:19.987 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 12:20:19.989 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 12:20:20.079 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 12:20:20.138 +04:00 [DBG] Starting grant removal
2019-03-06 12:20:21.233 +04:00 [DBG] Login Url: /Account/Login
2019-03-06 12:20:21.239 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 12:20:21.241 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 12:20:21.241 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 12:20:21.242 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 12:20:21.242 +04:00 [DBG] Error Url: /home/error
2019-03-06 12:20:21.243 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 12:20:21.260 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:20:21.276 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:20:21.296 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 12:20:21.507 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-06 12:20:21.527 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:20:21.529 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:21:10.879 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 12:21:10.931 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 12:21:10.931 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 12:21:10.932 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 12:21:10.932 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 12:21:10.933 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 12:21:10.934 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 12:21:11.191 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 12:21:11.202 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 12:21:11.205 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 12:21:11.290 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 12:21:11.345 +04:00 [DBG] Starting grant removal
2019-03-06 12:21:12.017 +04:00 [DBG] Login Url: /Account/Login
2019-03-06 12:21:12.020 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 12:21:12.022 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 12:21:12.022 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 12:21:12.023 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 12:21:12.024 +04:00 [DBG] Error Url: /home/error
2019-03-06 12:21:12.025 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 12:21:12.045 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:21:12.068 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:21:12.088 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 12:21:12.286 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-06 12:21:12.317 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:21:12.318 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:21:49.919 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-06 12:21:49.979 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-06 12:21:49.980 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-06 12:21:49.980 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-06 12:21:49.980 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-06 12:21:49.981 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-06 12:21:49.981 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-06 12:21:50.219 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 12:21:50.234 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 12:21:50.236 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-06 12:21:50.320 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-06 12:21:50.378 +04:00 [DBG] Starting grant removal
2019-03-06 12:21:51.487 +04:00 [DBG] Login Url: /Account/Login
2019-03-06 12:21:51.496 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-06 12:21:51.501 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-06 12:21:51.502 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-06 12:21:51.510 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-06 12:21:51.519 +04:00 [DBG] Error Url: /home/error
2019-03-06 12:21:51.524 +04:00 [DBG] Error Id Parameter: errorId
2019-03-06 12:21:51.614 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:21:51.635 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:21:51.662 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-06 12:21:53.410 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-06 12:21:53.445 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:21:53.449 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:23:44.302 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:23:44.308 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:23:47.130 +04:00 [ERR] The view 'Index' was not found. Searched locations: ["/Views/Home/Index.cshtml","/Views/Shared/Index.cshtml","/Pages/Shared/Index.cshtml"]
2019-03-06 12:23:47.189 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The view 'Index' was not found. The following locations were searched:
/Views/Home/Index.cshtml
/Views/Shared/Index.cshtml
/Pages/Shared/Index.cshtml
   at Microsoft.AspNetCore.Mvc.ViewEngines.ViewEngineResult.EnsureSuccessful(IEnumerable`1 originalLocations)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-03-06 12:23:54.083 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:23:54.086 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:23:55.244 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:23:55.246 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:23:55.281 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:23:55.282 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:24:00.935 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:24:00.939 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:24:05.812 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:24:05.814 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:24:06.034 +04:00 [DBG] Augmenting SignInContext
2019-03-06 12:24:06.082 +04:00 [DBG] Adding idp claim with value: local
2019-03-06 12:24:06.083 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-06 12:24:06.085 +04:00 [DBG] Adding auth_time claim with value: 1551860646
2019-03-06 12:24:06.091 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:24:06.105 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 12:24:06.171 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL21J48ULA5:00000001","TimeStamp":"2019-03-06T08:24:06.0000000Z","ProcessId":7264,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-06 12:24:06.294 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentException: Value cannot be null or empty.
Parameter name: url
   at Microsoft.AspNetCore.Mvc.ControllerBase.Redirect(String url)
   at AuthServiceServer.Controllers.AccountController.Login(LoginModel model) in D:\Projects\AuthServiceServer\AuthServiceServer\Controllers\AccountController.cs:line 54
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-03-06 12:24:11.138 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:24:11.146 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:24:11.157 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-06 12:24:11.160 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:24:11.161 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:24:11.738 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:24:11.740 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:24:14.912 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:24:14.916 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:24:14.944 +04:00 [DBG] Augmenting SignInContext
2019-03-06 12:24:14.945 +04:00 [DBG] Adding idp claim with value: local
2019-03-06 12:24:14.949 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-06 12:24:14.951 +04:00 [DBG] Adding auth_time claim with value: 1551860654
2019-03-06 12:24:14.952 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-06 12:24:14.953 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-06 12:24:14.957 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL21J48ULA7:00000001","TimeStamp":"2019-03-06T08:24:14.0000000Z","ProcessId":7264,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 08:43:54.174 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 08:43:54.253 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 08:43:54.254 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 08:43:54.254 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 08:43:54.255 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 08:43:54.255 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 08:43:54.255 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 08:43:54.486 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 08:43:54.496 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 08:43:54.498 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 08:43:54.581 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 08:43:54.636 +04:00 [DBG] Starting grant removal
2019-03-07 08:43:57.403 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 08:43:57.406 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 08:43:57.408 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 08:43:57.409 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 08:43:57.410 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 08:43:57.410 +04:00 [DBG] Error Url: /home/error
2019-03-07 08:43:57.412 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 08:43:57.435 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 08:43:57.451 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 08:43:57.468 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 08:43:57.695 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-07 08:43:57.748 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 08:43:57.751 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 08:44:00.813 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 08:44:00.814 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 08:44:01.229 +04:00 [DBG] Augmenting SignInContext
2019-03-07 08:44:01.275 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 08:44:01.276 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 08:44:01.280 +04:00 [DBG] Adding auth_time claim with value: 1551933841
2019-03-07 08:44:01.287 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 08:44:01.299 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 08:44:01.342 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2MU0JHC00:00000003","TimeStamp":"2019-03-07T04:44:01.0000000Z","ProcessId":15936,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 08:44:01.400 +04:00 [INF] AuthenticationScheme: Identity.Application was forbidden.
2019-03-07 08:53:21.860 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 08:53:21.911 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 08:53:21.912 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 08:53:21.912 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 08:53:21.912 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 08:53:21.913 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 08:53:21.913 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 08:53:22.120 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 08:53:22.135 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 08:53:22.138 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 08:53:22.211 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 08:53:22.269 +04:00 [DBG] Starting grant removal
2019-03-07 08:53:23.116 +04:00 [DBG] TaskCanceledException. Exiting.
2019-03-07 08:53:23.194 +04:00 [DBG] Stopping grant removal
2019-03-07 08:53:28.403 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 08:53:28.452 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 08:53:28.453 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 08:53:28.453 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 08:53:28.453 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 08:53:28.453 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 08:53:28.454 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 08:53:28.687 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 08:53:28.700 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 08:53:28.702 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 08:53:28.783 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 08:53:28.834 +04:00 [DBG] Starting grant removal
2019-03-07 08:53:30.997 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 08:53:31.002 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 08:53:31.002 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 08:53:31.003 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 08:53:31.004 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 08:53:31.005 +04:00 [DBG] Error Url: /home/error
2019-03-07 08:53:31.005 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 08:53:31.059 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 08:53:31.242 +04:00 [INF] AuthenticationScheme: Identity.Application was forbidden.
2019-03-07 08:53:41.273 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-03-07 08:53:41.278 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-03-07 08:53:41.280 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-03-07 08:53:50.325 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-07 08:53:54.547 +04:00 [DBG] Augmenting SignInContext
2019-03-07 08:53:54.559 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 08:53:54.560 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 08:53:54.561 +04:00 [DBG] Adding auth_time claim with value: 1551934434
2019-03-07 08:53:54.570 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 08:53:54.612 +04:00 [INF] {"Username":"godAdmin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"1002","DisplayName":"godAdmin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2N3BNP370:00000008","TimeStamp":"2019-03-07T04:53:54.0000000Z","ProcessId":10516,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 08:54:12.708 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 08:54:12.756 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 08:54:12.757 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 08:54:12.757 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 08:54:12.758 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 08:54:12.760 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 08:54:12.760 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 08:54:12.954 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 08:54:12.968 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 08:54:12.971 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 08:54:13.043 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 08:54:13.107 +04:00 [DBG] Starting grant removal
2019-03-07 08:54:14.962 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 08:54:14.965 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 08:54:14.967 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 08:54:14.967 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 08:54:14.968 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 08:54:14.969 +04:00 [DBG] Error Url: /home/error
2019-03-07 08:54:14.969 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 08:54:15.017 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 08:55:38.453 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 08:55:38.505 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 08:55:38.506 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 08:55:38.506 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 08:55:38.507 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 08:55:38.507 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 08:55:38.507 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 08:55:38.729 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 08:55:38.745 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 08:55:38.748 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 08:55:38.831 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 08:55:38.886 +04:00 [DBG] Starting grant removal
2019-03-07 08:55:40.995 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 08:55:40.999 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 08:55:41.000 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 08:55:41.001 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 08:55:41.004 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 08:55:41.004 +04:00 [DBG] Error Url: /home/error
2019-03-07 08:55:41.005 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 08:55:41.055 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 08:56:05.461 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 08:56:05.518 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 08:56:05.519 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 08:56:05.519 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 08:56:05.519 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 08:56:05.520 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 08:56:05.520 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 08:56:05.804 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 08:56:05.820 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 08:56:05.822 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 08:56:05.905 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 08:56:05.962 +04:00 [DBG] Starting grant removal
2019-03-07 08:56:06.399 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 08:56:06.402 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 08:56:06.404 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 08:56:06.404 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 08:56:06.405 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 08:56:06.406 +04:00 [DBG] Error Url: /home/error
2019-03-07 08:56:06.407 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 08:56:06.454 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 08:56:50.975 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 08:56:51.028 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 08:56:51.029 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 08:56:51.029 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 08:56:51.029 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 08:56:51.030 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 08:56:51.030 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 08:56:51.228 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 08:56:51.243 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 08:56:51.246 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 08:56:51.318 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 08:56:51.373 +04:00 [DBG] Starting grant removal
2019-03-07 08:56:52.387 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 08:56:52.391 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 08:56:52.393 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 08:56:52.393 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 08:56:52.394 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 08:56:52.395 +04:00 [DBG] Error Url: /home/error
2019-03-07 08:56:52.396 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 08:56:52.459 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 08:57:55.362 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 08:57:55.370 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 08:57:55.372 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 08:57:55.376 +04:00 [DBG] Start discovery request
2019-03-07 08:57:55.574 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 08:57:55.707 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 08:57:55.710 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 08:57:55.710 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 08:57:55.715 +04:00 [DBG] Start key discovery request
2019-03-07 08:57:55.789 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 08:57:55.801 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 08:57:55.802 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 08:57:55.807 +04:00 [DBG] Start authorize request
2019-03-07 08:57:55.821 +04:00 [DBG] No user present in authorize request
2019-03-07 08:57:55.827 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 08:57:56.005 +04:00 [DBG] BiLab found in database: true
2019-03-07 08:57:56.012 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 08:57:56.031 +04:00 [ERR] Invalid redirect_uri: https://localhost:44349/signin-oidc
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:44349/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875314757695658.NzU0OTRiMTQtMTI0My00NjVhLWIwNjctNDY3MmQ0ZTEyZmQyYmUxMDFmODEtMGVhZS00MzJlLTg0NGYtNjMyN2ViZDBlYmVm","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNArIcRYjyCC3pR4HDH6SbQrqsqDh0HRCHs1CPm0--OrUAyQbDjDlpmgrTY3gdtxXBLNQU9h1pjs54Q7S_lbBh6pFC0qc27Nv24quiojsEc4sqT0b8t3NUbFTUo0185QJwlopyQnnbqmmjZ5eUSQySesOwiUoarhyGdFTiG0vcoEdACHKQTf7OQUUlzs_B4PgeOfHByQQAJ3UqQ4M14rTFjNbiVT1ovOFkKRYft2CrKpx0yTz8lEmR35mI8VkN0GGwP3s5fF4tGzRSR4UrsMGR-F5iGTYdUyojXO_hAMdZdwo1wIaGnrm6mnLBuOei9DlfE","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 08:57:56.050 +04:00 [ERR] Request validation failed
2019-03-07 08:57:56.050 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:44349/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875314757695658.NzU0OTRiMTQtMTI0My00NjVhLWIwNjctNDY3MmQ0ZTEyZmQyYmUxMDFmODEtMGVhZS00MzJlLTg0NGYtNjMyN2ViZDBlYmVm","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNArIcRYjyCC3pR4HDH6SbQrqsqDh0HRCHs1CPm0--OrUAyQbDjDlpmgrTY3gdtxXBLNQU9h1pjs54Q7S_lbBh6pFC0qc27Nv24quiojsEc4sqT0b8t3NUbFTUo0185QJwlopyQnnbqmmjZ5eUSQySesOwiUoarhyGdFTiG0vcoEdACHKQTf7OQUUlzs_B4PgeOfHByQQAJ3UqQ4M14rTFjNbiVT1ovOFkKRYft2CrKpx0yTz8lEmR35mI8VkN0GGwP3s5fF4tGzRSR4UrsMGR-F5iGTYdUyojXO_hAMdZdwo1wIaGnrm6mnLBuOei9DlfE","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 08:57:56.075 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Authorize","SubjectId":null,"Scopes":"","GrantType":null,"Error":"unauthorized_client","ErrorDescription":"Invalid redirect_uri","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLL2N583OKTN:00000001","TimeStamp":"2019-03-07T04:57:56.0000000Z","ProcessId":16284,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-03-07 08:58:30.036 +04:00 [ERR] The view 'Index' was not found. Searched locations: ["/Views/Home/Index.cshtml","/Views/Shared/Index.cshtml","/Pages/Shared/Index.cshtml"]
2019-03-07 08:58:30.049 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The view 'Index' was not found. The following locations were searched:
/Views/Home/Index.cshtml
/Views/Shared/Index.cshtml
/Pages/Shared/Index.cshtml
   at Microsoft.AspNetCore.Mvc.ViewEngines.ViewEngineResult.EnsureSuccessful(IEnumerable`1 originalLocations)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-03-07 08:59:06.502 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 08:59:06.505 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 08:59:06.509 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 08:59:06.509 +04:00 [DBG] Start authorize request
2019-03-07 08:59:06.510 +04:00 [DBG] No user present in authorize request
2019-03-07 08:59:06.510 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 08:59:06.549 +04:00 [DBG] BiLab found in database: true
2019-03-07 08:59:06.549 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 08:59:06.551 +04:00 [ERR] Invalid redirect_uri: https://localhost:44349/signin-oidc
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:44349/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875315464908765.OTdhNmE3NjYtMDRhZi00YTIwLTk0NWQtNTIyYWQ3ZWUxNDZhNWY0ZjQwNmItM2EwNi00M2E5LWEyOGYtODllYjQyOTlkNDI4","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBqHMaeO5ovht5pGKHAetP6eZdCz7aiwiH8jAVel3RYeywFexwxp7OeLvwPqssSrdFFdke8JV3fIoH7cn6_ezggzsp3xZrvkkZIUCoFISuvZujXO2mrlGVmk722Mu4J_YnmqMLl-yyz_pAKiOPY1eDOaAInSpXiDcJoXVpUC4ultNXu58d7qgzJ9Fl3tpalyRHe1h4rZcoxKU1qvM1l6ZzIyMZIJds_HBEP_6W7cyZgELw1nF2-JCv2bf29-xpX_pgHr847CqQdCyxGZVYT9uk6bqjDrHswosaNTZD9d9sTK3odw7c33hW-S2gzs8L62AA","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 08:59:06.557 +04:00 [ERR] Request validation failed
2019-03-07 08:59:06.558 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:44349/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875315464908765.OTdhNmE3NjYtMDRhZi00YTIwLTk0NWQtNTIyYWQ3ZWUxNDZhNWY0ZjQwNmItM2EwNi00M2E5LWEyOGYtODllYjQyOTlkNDI4","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBqHMaeO5ovht5pGKHAetP6eZdCz7aiwiH8jAVel3RYeywFexwxp7OeLvwPqssSrdFFdke8JV3fIoH7cn6_ezggzsp3xZrvkkZIUCoFISuvZujXO2mrlGVmk722Mu4J_YnmqMLl-yyz_pAKiOPY1eDOaAInSpXiDcJoXVpUC4ultNXu58d7qgzJ9Fl3tpalyRHe1h4rZcoxKU1qvM1l6ZzIyMZIJds_HBEP_6W7cyZgELw1nF2-JCv2bf29-xpX_pgHr847CqQdCyxGZVYT9uk6bqjDrHswosaNTZD9d9sTK3odw7c33hW-S2gzs8L62AA","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 08:59:06.568 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Authorize","SubjectId":null,"Scopes":"","GrantType":null,"Error":"unauthorized_client","ErrorDescription":"Invalid redirect_uri","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLL2N583OKTN:00000007","TimeStamp":"2019-03-07T04:59:06.0000000Z","ProcessId":16284,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-03-07 09:00:58.420 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 09:00:58.477 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 09:00:58.478 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 09:00:58.479 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 09:00:58.479 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 09:00:58.479 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 09:00:58.479 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 09:00:58.697 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:00:58.713 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:00:58.716 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:00:58.802 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 09:00:58.865 +04:00 [DBG] Starting grant removal
2019-03-07 09:00:59.497 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 09:00:59.501 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 09:00:59.502 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 09:00:59.503 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 09:00:59.503 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 09:00:59.504 +04:00 [DBG] Error Url: /home/error
2019-03-07 09:00:59.504 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 09:00:59.544 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 09:00:59.724 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-07 09:01:13.542 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 09:01:13.548 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 09:01:13.549 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 09:01:13.555 +04:00 [DBG] Start discovery request
2019-03-07 09:01:14.007 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 09:01:14.135 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 09:01:14.137 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 09:01:14.138 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 09:01:14.142 +04:00 [DBG] Start key discovery request
2019-03-07 09:01:14.226 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 09:01:14.231 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 09:01:14.232 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 09:01:14.237 +04:00 [DBG] Start authorize request
2019-03-07 09:01:14.246 +04:00 [DBG] No user present in authorize request
2019-03-07 09:01:14.251 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 09:01:14.569 +04:00 [DBG] BiLab found in database: true
2019-03-07 09:01:14.575 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 09:01:14.590 +04:00 [ERR] Invalid redirect_uri: https://localhost:44349/signin-oidc
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:44349/signin-oidc","response_type":"code id_token","scope":"openid profile roles offline_access","response_mode":"form_post","nonce":"636875316742058940.OWUwYzQzNzYtNGM2OC00ZTkyLTg4NjYtOTE1NGM3NGIwMmJkMjUyYmVkMjMtYTE2MC00ODllLWFjZmMtMTJmYjZiMDRiNjZl","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCwWslXs7f8mD4S6yqli7PdWuaH5aXmDptuxv9sDvENBtd8qgnoEU95ByN0plF4nhMtxTJEfeg3kw7hWGm2_OBHVk3KwCecPkzsAYSVm66WKoRSBR7tpx4R7bx_M2NRnKijagbkk1JWzxHJ6y35idQ0xblCjaE5p6bFkmjF4C2Fg6nJvhEVeZCTZUXXaKd3yK86m38bxgPurBCQH76SIEtPth6RtYX2OyrdT9UBkpUUzJer3PL3g9UspYEi3CGpUHZjqcRs979vzRzlH-JQ-Xgt_eLxjCqhNTBNF0nD_QX8dCnrdpbBsdcYb5WetyHU6k4","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 09:01:14.604 +04:00 [ERR] Request validation failed
2019-03-07 09:01:14.607 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:44349/signin-oidc","response_type":"code id_token","scope":"openid profile roles offline_access","response_mode":"form_post","nonce":"636875316742058940.OWUwYzQzNzYtNGM2OC00ZTkyLTg4NjYtOTE1NGM3NGIwMmJkMjUyYmVkMjMtYTE2MC00ODllLWFjZmMtMTJmYjZiMDRiNjZl","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCwWslXs7f8mD4S6yqli7PdWuaH5aXmDptuxv9sDvENBtd8qgnoEU95ByN0plF4nhMtxTJEfeg3kw7hWGm2_OBHVk3KwCecPkzsAYSVm66WKoRSBR7tpx4R7bx_M2NRnKijagbkk1JWzxHJ6y35idQ0xblCjaE5p6bFkmjF4C2Fg6nJvhEVeZCTZUXXaKd3yK86m38bxgPurBCQH76SIEtPth6RtYX2OyrdT9UBkpUUzJer3PL3g9UspYEi3CGpUHZjqcRs979vzRzlH-JQ-Xgt_eLxjCqhNTBNF0nD_QX8dCnrdpbBsdcYb5WetyHU6k4","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 09:01:14.629 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Authorize","SubjectId":null,"Scopes":"","GrantType":null,"Error":"unauthorized_client","ErrorDescription":"Invalid redirect_uri","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLL2N7HPCET4:00000003","TimeStamp":"2019-03-07T05:01:14.0000000Z","ProcessId":2188,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-03-07 09:02:04.227 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 09:02:04.280 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 09:02:04.281 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 09:02:04.281 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 09:02:04.282 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 09:02:04.282 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 09:02:04.283 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 09:02:04.525 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:02:04.534 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:02:04.536 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:02:04.624 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 09:02:04.683 +04:00 [DBG] Starting grant removal
2019-03-07 09:02:05.920 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 09:02:05.925 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 09:02:05.927 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 09:02:05.930 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 09:02:05.931 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 09:02:05.931 +04:00 [DBG] Error Url: /home/error
2019-03-07 09:02:05.932 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 09:02:05.998 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 09:02:06.201 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-07 09:02:11.849 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 09:02:11.854 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 09:02:11.855 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 09:02:11.860 +04:00 [DBG] Start discovery request
2019-03-07 09:02:12.320 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 09:02:12.453 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 09:02:12.455 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 09:02:12.456 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 09:02:12.460 +04:00 [DBG] Start key discovery request
2019-03-07 09:02:12.545 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 09:02:12.551 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 09:02:12.552 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 09:02:12.557 +04:00 [DBG] Start authorize request
2019-03-07 09:02:12.567 +04:00 [DBG] No user present in authorize request
2019-03-07 09:02:12.572 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 09:02:12.876 +04:00 [DBG] BiLab found in database: true
2019-03-07 09:02:12.884 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 09:02:12.901 +04:00 [ERR] Invalid redirect_uri: https://localhost:44349/signin-oidc
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:44349/signin-oidc","response_type":"code id_token","scope":"openid profile role roles offline_access","response_mode":"form_post","nonce":"636875317325255369.MjBmNjZlOTAtMzJjZi00NWJlLThhNzgtODlkZGI5MWNkMjcwM2U3MTA5MjgtODc4ZC00MDI4LWJlNzEtNzY3NGQ4ZmFhN2Q1","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAMKwU5qp5oyrvF7-xrAj5_fDgqglm-fRWiq-Li-bRETfmEAYrtGZbFgdzKjdQlbq3irA-02cUDvbH3Qqvt1Okc1gN2pgSJswyPkrgO8IPiVcVx6XN6ANvKkf1PzEDDa7nxxL4PqXa2kzapXue3CO2zMgc8Ko9kNvQSDnPyXLI1IRxTPAYUN1sihIgxI-AO0IpwXGQWdAtVFicFPQ5GpMa5XP4PYKy8S48DCKrU6msxyTK4BfLOmz9hSrnppkQiiH8EcH86A-vB6l_dOh17330mIkjC6w3ApOYaTSHe65_CwLniFI_Zy7v1MoF9yfE2UGQ","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 09:02:12.915 +04:00 [ERR] Request validation failed
2019-03-07 09:02:12.918 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:44349/signin-oidc","response_type":"code id_token","scope":"openid profile role roles offline_access","response_mode":"form_post","nonce":"636875317325255369.MjBmNjZlOTAtMzJjZi00NWJlLThhNzgtODlkZGI5MWNkMjcwM2U3MTA5MjgtODc4ZC00MDI4LWJlNzEtNzY3NGQ4ZmFhN2Q1","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAMKwU5qp5oyrvF7-xrAj5_fDgqglm-fRWiq-Li-bRETfmEAYrtGZbFgdzKjdQlbq3irA-02cUDvbH3Qqvt1Okc1gN2pgSJswyPkrgO8IPiVcVx6XN6ANvKkf1PzEDDa7nxxL4PqXa2kzapXue3CO2zMgc8Ko9kNvQSDnPyXLI1IRxTPAYUN1sihIgxI-AO0IpwXGQWdAtVFicFPQ5GpMa5XP4PYKy8S48DCKrU6msxyTK4BfLOmz9hSrnppkQiiH8EcH86A-vB6l_dOh17330mIkjC6w3ApOYaTSHe65_CwLniFI_Zy7v1MoF9yfE2UGQ","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 09:02:12.941 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Authorize","SubjectId":null,"Scopes":"","GrantType":null,"Error":"unauthorized_client","ErrorDescription":"Invalid redirect_uri","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLL2N85FKQ7T:00000003","TimeStamp":"2019-03-07T05:02:12.0000000Z","ProcessId":12184,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-03-07 09:02:32.490 +04:00 [DBG] Augmenting SignInContext
2019-03-07 09:02:32.494 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 09:02:32.496 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 09:02:32.496 +04:00 [DBG] Adding auth_time claim with value: 1551934952
2019-03-07 09:02:32.508 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 09:02:32.516 +04:00 [INF] {"Username":"godAdmin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"1002","DisplayName":"godAdmin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2N85FKQ7T:00000006","TimeStamp":"2019-03-07T05:02:32.0000000Z","ProcessId":12184,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 09:02:32.631 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentException: Value cannot be null or empty.
Parameter name: url
   at Microsoft.AspNetCore.Mvc.ControllerBase.Redirect(String url)
   at AuthServiceServer.Controllers.AccountController.Login(LoginModel model) in D:\Projects\AuthServiceServer\AuthServiceServer\Controllers\AccountController.cs:line 54
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-03-07 09:02:41.974 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-07 09:02:44.552 +04:00 [INF] {"Username":"go","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLL2N85FKQ7T:00000009","TimeStamp":"2019-03-07T05:02:44.0000000Z","ProcessId":12184,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-03-07 09:02:53.008 +04:00 [DBG] Augmenting SignInContext
2019-03-07 09:02:53.009 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 09:02:53.011 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 09:02:53.012 +04:00 [DBG] Adding auth_time claim with value: 1551934973
2019-03-07 09:02:53.013 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 09:02:53.017 +04:00 [INF] {"Username":"godAdmin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"1002","DisplayName":"godAdmin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2N85FKQ7T:0000000B","TimeStamp":"2019-03-07T05:02:53.0000000Z","ProcessId":12184,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 09:03:11.184 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 09:03:11.257 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 09:03:11.259 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 09:03:11.261 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 09:03:11.262 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 09:03:11.263 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 09:03:11.263 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 09:03:11.565 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:03:11.593 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:03:11.600 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:03:11.733 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 09:03:11.823 +04:00 [DBG] Starting grant removal
2019-03-07 09:03:12.706 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 09:03:12.713 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 09:03:12.714 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 09:03:12.714 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 09:03:12.715 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 09:03:12.715 +04:00 [DBG] Error Url: /home/error
2019-03-07 09:03:12.716 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 09:03:12.780 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 09:03:17.266 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 09:03:17.271 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 09:03:17.272 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 09:03:17.277 +04:00 [DBG] Start discovery request
2019-03-07 09:03:17.452 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 09:03:17.579 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 09:03:17.581 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 09:03:17.582 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 09:03:17.586 +04:00 [DBG] Start key discovery request
2019-03-07 09:03:17.665 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 09:03:17.672 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 09:03:17.673 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 09:03:17.679 +04:00 [DBG] Start authorize request
2019-03-07 09:03:17.691 +04:00 [DBG] User in authorize request: 1002
2019-03-07 09:03:17.696 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 09:03:17.890 +04:00 [DBG] BiLab found in database: true
2019-03-07 09:03:17.898 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 09:03:17.914 +04:00 [ERR] Invalid redirect_uri: https://localhost:44349/signin-oidc
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:44349/signin-oidc","response_type":"code id_token","scope":"openid profile role roles offline_access","response_mode":"form_post","nonce":"636875317976437775.YTE1NDUxNTctNWVlOC00YmU0LWI5NjUtM2JkYTRkYzc5NDRiZmJlNGNhOTUtOWQ0MC00ZGJkLTg4MzItZWE3N2NhM2Q4MWEz","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBhsQ6CBm49bZPMoM-oH30rrN6AJ2F2ZZ8TbM5A7AeY8ZOBxuikqM6cqTTNdSLCG2dRC1R4xHUuBvjq5wjvzcXPGvi86JDcF853uyaz6i008I8MGSH4FLzthhK1wd3xZ54DTp0Ufv5ON1i6KFF-GGGcvxT9kBnZo_1AAGE-l2KvhpYE8ySUYd_bOLeIdNDa30ckUo7HCIMSwL3-PK2bqH6oQA6ZBkd3qL8q9JPZiGyaLQAWZl9urjdNSicf14UnUVlYX3faBn69qE1vhAbQ9yqhYJZ3GrY5zzaa3Lsxgt_iYld5OeFUz19y7CJ58A3YOXA","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 09:03:17.928 +04:00 [ERR] Request validation failed
2019-03-07 09:03:17.930 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:44349/signin-oidc","response_type":"code id_token","scope":"openid profile role roles offline_access","response_mode":"form_post","nonce":"636875317976437775.YTE1NDUxNTctNWVlOC00YmU0LWI5NjUtM2JkYTRkYzc5NDRiZmJlNGNhOTUtOWQ0MC00ZGJkLTg4MzItZWE3N2NhM2Q4MWEz","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBhsQ6CBm49bZPMoM-oH30rrN6AJ2F2ZZ8TbM5A7AeY8ZOBxuikqM6cqTTNdSLCG2dRC1R4xHUuBvjq5wjvzcXPGvi86JDcF853uyaz6i008I8MGSH4FLzthhK1wd3xZ54DTp0Ufv5ON1i6KFF-GGGcvxT9kBnZo_1AAGE-l2KvhpYE8ySUYd_bOLeIdNDa30ckUo7HCIMSwL3-PK2bqH6oQA6ZBkd3qL8q9JPZiGyaLQAWZl9urjdNSicf14UnUVlYX3faBn69qE1vhAbQ9yqhYJZ3GrY5zzaa3Lsxgt_iYld5OeFUz19y7CJ58A3YOXA","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 09:03:17.957 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Authorize","SubjectId":"1002","Scopes":"","GrantType":null,"Error":"unauthorized_client","ErrorDescription":"Invalid redirect_uri","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLL2N8PE17JP:00000002","TimeStamp":"2019-03-07T05:03:17.0000000Z","ProcessId":12900,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-03-07 09:05:15.213 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 09:05:15.264 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 09:05:15.264 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 09:05:15.265 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 09:05:15.265 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 09:05:15.265 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 09:05:15.266 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 09:05:15.494 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:05:15.507 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:05:15.510 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:05:15.601 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 09:05:15.659 +04:00 [DBG] Starting grant removal
2019-03-07 09:05:16.737 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 09:05:16.741 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 09:05:16.742 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 09:05:16.743 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 09:05:16.744 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 09:05:16.745 +04:00 [DBG] Error Url: /home/error
2019-03-07 09:05:16.746 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 09:05:16.805 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 09:05:53.750 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 09:05:53.755 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 09:05:53.757 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 09:05:53.762 +04:00 [DBG] Start discovery request
2019-03-07 09:05:54.211 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 09:05:54.336 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 09:05:54.339 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 09:05:54.340 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 09:05:54.345 +04:00 [DBG] Start key discovery request
2019-03-07 09:05:54.438 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 09:05:54.446 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 09:05:54.448 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 09:05:54.455 +04:00 [DBG] Start authorize request
2019-03-07 09:05:54.466 +04:00 [DBG] User in authorize request: 1002
2019-03-07 09:05:54.471 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 09:05:54.751 +04:00 [DBG] BiLab found in database: true
2019-03-07 09:05:54.757 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 09:05:54.772 +04:00 [ERR] Invalid redirect_uri: https://localhost:44349/signin-oidc
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:44349/signin-oidc","response_type":"code id_token","scope":"openid profile roles offline_access","response_mode":"form_post","nonce":"636875319544130317.MzlhNTY5MjEtNDUzYi00MDViLWFiNmUtZmIyZmVhYWNmMGVhMzQwMmYzZDUtNzczNi00NDg4LTg5NjYtYjIwNDEwZGQyN2M2","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYND3WA2GEURd6AKxZtVTzTJkGxmX5pqNRup_QEnPOG7dmw4TuvVdyOuwosFWhi433zS87eJWSF_W8TSfwEp_ZVqddTqIt2G3C6LyEQ4cfqaF-Ztw1QptJiqQOgylUBWvQsvArMiZSSi9pa_Qb2P_psamg0jOpms9rrhn2TYNmNhBl7TuUTXMQXiW_6rc2UNv_E55FsvfSjseiQYraZWfUz0zdq9AvolglfwNyG8n8S_3Q1HWSoO0cW33qV148oSsxCSnQUtQCHIKkV6Pvwn6vjz_bwAgtSJXn5YNAJKtz1zV8i3xGGDQPHK0v_Xy0PNBGj4","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 09:05:54.786 +04:00 [ERR] Request validation failed
2019-03-07 09:05:54.787 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:44349/signin-oidc","response_type":"code id_token","scope":"openid profile roles offline_access","response_mode":"form_post","nonce":"636875319544130317.MzlhNTY5MjEtNDUzYi00MDViLWFiNmUtZmIyZmVhYWNmMGVhMzQwMmYzZDUtNzczNi00NDg4LTg5NjYtYjIwNDEwZGQyN2M2","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYND3WA2GEURd6AKxZtVTzTJkGxmX5pqNRup_QEnPOG7dmw4TuvVdyOuwosFWhi433zS87eJWSF_W8TSfwEp_ZVqddTqIt2G3C6LyEQ4cfqaF-Ztw1QptJiqQOgylUBWvQsvArMiZSSi9pa_Qb2P_psamg0jOpms9rrhn2TYNmNhBl7TuUTXMQXiW_6rc2UNv_E55FsvfSjseiQYraZWfUz0zdq9AvolglfwNyG8n8S_3Q1HWSoO0cW33qV148oSsxCSnQUtQCHIKkV6Pvwn6vjz_bwAgtSJXn5YNAJKtz1zV8i3xGGDQPHK0v_Xy0PNBGj4","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 09:05:54.811 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Authorize","SubjectId":"1002","Scopes":"","GrantType":null,"Error":"unauthorized_client","ErrorDescription":"Invalid redirect_uri","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLL2N9UDBJQ1:00000002","TimeStamp":"2019-03-07T05:05:54.0000000Z","ProcessId":12140,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-03-07 09:06:34.869 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 09:06:34.934 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 09:06:34.934 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 09:06:34.935 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 09:06:34.935 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 09:06:34.936 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 09:06:34.936 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 09:06:35.151 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:06:35.165 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:06:35.167 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:06:35.241 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 09:06:35.295 +04:00 [DBG] Starting grant removal
2019-03-07 09:06:36.315 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 09:06:36.319 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 09:06:36.321 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 09:06:36.321 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 09:06:36.322 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 09:06:36.322 +04:00 [DBG] Error Url: /home/error
2019-03-07 09:06:36.324 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 09:06:36.377 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 09:06:55.258 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 09:06:55.307 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 09:06:55.308 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 09:06:55.309 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 09:06:55.309 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 09:06:55.310 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 09:06:55.310 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 09:06:55.507 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:06:55.522 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:06:55.524 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:06:55.600 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 09:06:55.652 +04:00 [DBG] Starting grant removal
2019-03-07 09:06:56.719 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 09:06:56.723 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 09:06:56.724 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 09:06:56.725 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 09:06:56.726 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 09:06:56.726 +04:00 [DBG] Error Url: /home/error
2019-03-07 09:06:56.728 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 09:06:56.788 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 09:07:16.756 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 09:07:16.763 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 09:07:16.764 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 09:07:16.769 +04:00 [DBG] Start discovery request
2019-03-07 09:07:16.942 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 09:07:17.085 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 09:07:17.090 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 09:07:17.091 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 09:07:17.098 +04:00 [DBG] Start key discovery request
2019-03-07 09:07:17.175 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 09:07:17.183 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 09:07:17.184 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 09:07:17.191 +04:00 [DBG] Start authorize request
2019-03-07 09:07:17.202 +04:00 [DBG] User in authorize request: 1002
2019-03-07 09:07:17.207 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 09:07:17.394 +04:00 [DBG] BiLab found in database: true
2019-03-07 09:07:17.400 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 09:07:17.416 +04:00 [ERR] Invalid redirect_uri: https://localhost:44349/signin-oidc
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:44349/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875320371546115.NDQwZWYxMmEtNDZiYS00Y2M3LWJmMWQtMWZiYTIzMWQzMTVhYWZjMjIyOGUtMjYzMC00ZmNiLWIxZDUtY2UwOGNkNTQ1NjM4","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBMun7UmTyqGZyQ0R6VwuhD_ZLDCvf7C0YJZR4RiMbbYxxIQYk8DugReeL5bCjdlajS_yi9e267vqIveS-8JjsnjYOYF7H1ZtHr86v2zwbW98ki1s63yvzDtX85MY_hnjcFIjno9G7MEKgg1H7fCPRC5uJFkQpPXrvxmZfTbxJidXi8nMF1b9NwHNaFOOXtY3hqUIo7m5gJwO9T1M4y68fL7XAonxCOKLEAOJj-Nt95vAz0sT-3F4DlGWczcMYfPxHhNqtRPrh_ayVsNFpKj1SeSN9DEo1_5AnalTc6t1EzfLoKy5Yc7BNAjpn7b_554ng","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 09:07:17.431 +04:00 [ERR] Request validation failed
2019-03-07 09:07:17.432 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:44349/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875320371546115.NDQwZWYxMmEtNDZiYS00Y2M3LWJmMWQtMWZiYTIzMWQzMTVhYWZjMjIyOGUtMjYzMC00ZmNiLWIxZDUtY2UwOGNkNTQ1NjM4","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBMun7UmTyqGZyQ0R6VwuhD_ZLDCvf7C0YJZR4RiMbbYxxIQYk8DugReeL5bCjdlajS_yi9e267vqIveS-8JjsnjYOYF7H1ZtHr86v2zwbW98ki1s63yvzDtX85MY_hnjcFIjno9G7MEKgg1H7fCPRC5uJFkQpPXrvxmZfTbxJidXi8nMF1b9NwHNaFOOXtY3hqUIo7m5gJwO9T1M4y68fL7XAonxCOKLEAOJj-Nt95vAz0sT-3F4DlGWczcMYfPxHhNqtRPrh_ayVsNFpKj1SeSN9DEo1_5AnalTc6t1EzfLoKy5Yc7BNAjpn7b_554ng","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 09:07:17.456 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Authorize","SubjectId":"1002","Scopes":"","GrantType":null,"Error":"unauthorized_client","ErrorDescription":"Invalid redirect_uri","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLL2NAS7BI2H:00000002","TimeStamp":"2019-03-07T05:07:17.0000000Z","ProcessId":11164,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-03-07 09:07:35.346 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 09:07:35.399 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 09:07:35.400 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 09:07:35.400 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 09:07:35.400 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 09:07:35.401 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 09:07:35.401 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 09:07:35.631 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:07:35.641 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:07:35.649 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:07:35.728 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 09:07:35.782 +04:00 [DBG] Starting grant removal
2019-03-07 09:07:36.414 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 09:07:36.416 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 09:07:36.418 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 09:07:36.419 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 09:07:36.419 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 09:07:36.420 +04:00 [DBG] Error Url: /home/error
2019-03-07 09:07:36.420 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 09:07:36.473 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 09:07:52.830 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 09:07:52.886 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 09:07:52.887 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 09:07:52.887 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 09:07:52.888 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 09:07:52.888 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 09:07:52.889 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 09:07:53.081 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:07:53.100 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:07:53.106 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:07:53.180 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 09:07:53.237 +04:00 [DBG] Starting grant removal
2019-03-07 09:07:54.148 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 09:07:54.154 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 09:07:54.158 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 09:07:54.160 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 09:07:54.160 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 09:07:54.161 +04:00 [DBG] Error Url: /home/error
2019-03-07 09:07:54.162 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 09:07:54.232 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 09:08:04.037 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 09:08:04.042 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 09:08:04.043 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 09:08:04.049 +04:00 [DBG] Start discovery request
2019-03-07 09:08:04.239 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 09:08:04.367 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 09:08:04.369 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 09:08:04.370 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 09:08:04.376 +04:00 [DBG] Start key discovery request
2019-03-07 09:08:04.463 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 09:08:04.470 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 09:08:04.471 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 09:08:04.476 +04:00 [DBG] Start authorize request
2019-03-07 09:08:04.488 +04:00 [DBG] User in authorize request: 1002
2019-03-07 09:08:04.493 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 09:08:04.666 +04:00 [DBG] BiLab found in database: true
2019-03-07 09:08:04.674 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 09:08:04.690 +04:00 [ERR] Invalid redirect_uri: https://localhost:44349/signin-oidc
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:44349/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875320844409724.MzM3ZWMxY2UtOTJjNy00ODAzLWI0NjYtYjQ2MGFlNTg4ZDJiMGQ2NTU5NmUtNWQxYi00MzQxLTg1NDQtNDMyYjA4YjQ2NDBm","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYND-rfx21PMDamM4UDgXYRpIowv8-FuK0SxaNplwHNjOXbTi42XaDT_vavRhWA4cLb6OpSQjWroRYIEAz9SBq1HqzlSJ3PeSBKH4n6O4oYZjS4rcTs9TTlFm0B38xd-wCCvHthpnd6KycARVKpA698AH3Ez-rL2WLLxbfsXOoLihtwY7qZXwY_B5bP-r_PJbmdB-iycagjG4jr_UPQeK_9VX6zgbTHMRMUh5NSUZtx3bRxFfLpbTbDzLkeTL1Dy9qTm0-xjvss2MeEpNr3jS2MIxjPrU_dzSSDzgK8yLfmNbayJBYkpEZ3X5EgQ7geMu_dM","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 09:08:04.709 +04:00 [ERR] Request validation failed
2019-03-07 09:08:04.710 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:44349/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875320844409724.MzM3ZWMxY2UtOTJjNy00ODAzLWI0NjYtYjQ2MGFlNTg4ZDJiMGQ2NTU5NmUtNWQxYi00MzQxLTg1NDQtNDMyYjA4YjQ2NDBm","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYND-rfx21PMDamM4UDgXYRpIowv8-FuK0SxaNplwHNjOXbTi42XaDT_vavRhWA4cLb6OpSQjWroRYIEAz9SBq1HqzlSJ3PeSBKH4n6O4oYZjS4rcTs9TTlFm0B38xd-wCCvHthpnd6KycARVKpA698AH3Ez-rL2WLLxbfsXOoLihtwY7qZXwY_B5bP-r_PJbmdB-iycagjG4jr_UPQeK_9VX6zgbTHMRMUh5NSUZtx3bRxFfLpbTbDzLkeTL1Dy9qTm0-xjvss2MeEpNr3jS2MIxjPrU_dzSSDzgK8yLfmNbayJBYkpEZ3X5EgQ7geMu_dM","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 09:08:04.741 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Authorize","SubjectId":"1002","Scopes":"","GrantType":null,"Error":"unauthorized_client","ErrorDescription":"Invalid redirect_uri","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLL2NBDB222Q:00000002","TimeStamp":"2019-03-07T05:08:04.0000000Z","ProcessId":12864,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-03-07 09:15:34.548 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 09:15:34.601 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 09:15:34.603 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 09:15:34.604 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 09:15:34.604 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 09:15:34.604 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 09:15:34.605 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 09:15:34.827 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:15:34.842 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:15:34.845 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:15:34.930 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 09:15:34.981 +04:00 [DBG] Starting grant removal
2019-03-07 09:15:35.624 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 09:15:35.628 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 09:15:35.629 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 09:15:35.630 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 09:15:35.630 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 09:15:35.631 +04:00 [DBG] Error Url: /home/error
2019-03-07 09:15:35.632 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 09:15:35.654 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 09:15:35.672 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 09:15:35.692 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 09:15:35.856 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-07 09:15:35.880 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 09:15:35.882 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 09:15:49.874 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 09:15:49.880 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 09:15:49.881 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 09:15:49.886 +04:00 [DBG] Start discovery request
2019-03-07 09:15:50.470 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 09:15:50.604 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 09:15:50.606 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 09:15:50.607 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 09:15:50.613 +04:00 [DBG] Start key discovery request
2019-03-07 09:15:50.692 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 09:15:50.693 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 09:15:50.695 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 09:15:50.701 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 09:15:50.704 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 09:15:50.709 +04:00 [DBG] Start authorize request
2019-03-07 09:15:50.715 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 09:15:50.722 +04:00 [DBG] No user present in authorize request
2019-03-07 09:15:50.727 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 09:15:51.185 +04:00 [DBG] BiLab found in database: true
2019-03-07 09:15:51.193 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 09:15:51.200 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 09:15:51.202 +04:00 [DBG] No PKCE used.
2019-03-07 09:15:51.336 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 09:15:51.476 +04:00 [DBG] Found [] API scopes in database
2019-03-07 09:15:51.558 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 09:15:51.565 +04:00 [DBG] Found [] API scopes in database
2019-03-07 09:15:51.575 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 09:15:51.589 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDTAJTZX78BYMfIZKquGU0cD-MaK6tvqUrN2d5Tc-f0T7vIMXGyPrYNlMyirSCnNosCRLthZ2wGQyxsTpUawI_ImftxKeuK5URM5JKh1H6nnleUaqSbtYynSfO9P3FjNSVs1Tks8oCdyJNnX7C9PU0bg6E-8rq3wij6ni1Mg7ybxKx4hLE87p4_8Y_lvypvK75aBp3PEJzthcOE0iAngLJsaM3TGiz5PDsHitTBET2FRMosLsWQbLTm8nmGz0pjHDDdyzcPorqebqPmX1lDx9D2MBHws_qV7FnZ2JwXVY5YZI5kdmUiswbC4_t-OkE0Bj4","UiLocales":null,"Nonce":"636875325506726893.YTgyN2MyNDEtMDg0ZC00ZDI4LTkyODUtN2UxNjdlYmVmNDEyNTY0ZThlMTItYjA2Zi00ZTAxLWFiMDEtZDEwOTk4MjFkNWZl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875325506726893.YTgyN2MyNDEtMDg0ZC00ZDI4LTkyODUtN2UxNjdlYmVmNDEyNTY0ZThlMTItYjA2Zi00ZTAxLWFiMDEtZDEwOTk4MjFkNWZl","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDTAJTZX78BYMfIZKquGU0cD-MaK6tvqUrN2d5Tc-f0T7vIMXGyPrYNlMyirSCnNosCRLthZ2wGQyxsTpUawI_ImftxKeuK5URM5JKh1H6nnleUaqSbtYynSfO9P3FjNSVs1Tks8oCdyJNnX7C9PU0bg6E-8rq3wij6ni1Mg7ybxKx4hLE87p4_8Y_lvypvK75aBp3PEJzthcOE0iAngLJsaM3TGiz5PDsHitTBET2FRMosLsWQbLTm8nmGz0pjHDDdyzcPorqebqPmX1lDx9D2MBHws_qV7FnZ2JwXVY5YZI5kdmUiswbC4_t-OkE0Bj4","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 09:15:51.616 +04:00 [INF] Showing login: User is not authenticated
2019-03-07 09:15:51.625 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 09:15:51.626 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 09:16:11.828 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 09:16:11.880 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 09:16:11.880 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 09:16:11.881 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 09:16:11.881 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 09:16:11.881 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 09:16:11.882 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 09:16:12.113 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:16:12.128 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:16:12.130 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:16:12.205 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 09:16:12.258 +04:00 [DBG] Starting grant removal
2019-03-07 09:16:12.910 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 09:16:12.913 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 09:16:12.915 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 09:16:12.915 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 09:16:12.916 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 09:16:12.918 +04:00 [DBG] Error Url: /home/error
2019-03-07 09:16:12.918 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 09:16:12.940 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 09:16:12.964 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 09:16:12.980 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 09:16:13.165 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-07 09:16:13.185 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 09:16:13.187 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 09:16:28.290 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 09:16:28.292 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 09:16:28.510 +04:00 [DBG] Augmenting SignInContext
2019-03-07 09:16:28.520 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 09:16:28.521 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 09:16:28.523 +04:00 [DBG] Adding auth_time claim with value: 1551935788
2019-03-07 09:16:28.527 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 09:16:28.540 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 09:16:28.579 +04:00 [INF] {"Username":"godAdmin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"1002","DisplayName":"godAdmin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2NG1VFA98:00000003","TimeStamp":"2019-03-07T05:16:28.0000000Z","ProcessId":9880,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 09:16:38.293 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 09:16:38.346 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 09:16:38.347 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 09:16:38.348 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 09:16:38.348 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 09:16:38.348 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 09:16:38.349 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 09:16:38.543 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:16:38.556 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:16:38.558 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:16:38.628 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 09:16:38.682 +04:00 [DBG] Starting grant removal
2019-03-07 09:16:39.668 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 09:16:39.672 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 09:16:39.675 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 09:16:39.676 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 09:16:39.677 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 09:16:39.678 +04:00 [DBG] Error Url: /home/error
2019-03-07 09:16:39.678 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 09:16:39.737 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 09:16:44.617 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 09:16:44.623 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 09:16:44.624 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 09:16:44.631 +04:00 [DBG] Start discovery request
2019-03-07 09:16:44.819 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 09:16:44.959 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 09:16:44.963 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 09:16:44.964 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 09:16:44.969 +04:00 [DBG] Start key discovery request
2019-03-07 09:16:45.053 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 09:16:45.063 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 09:16:45.064 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 09:16:45.070 +04:00 [DBG] Start authorize request
2019-03-07 09:16:45.082 +04:00 [DBG] User in authorize request: 1002
2019-03-07 09:16:45.086 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 09:16:45.271 +04:00 [DBG] BiLab found in database: true
2019-03-07 09:16:45.279 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 09:16:45.285 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 09:16:45.286 +04:00 [DBG] No PKCE used.
2019-03-07 09:16:45.337 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 09:16:45.382 +04:00 [DBG] Found [] API scopes in database
2019-03-07 09:16:45.386 +04:00 [ERR] Invalid scope: roles
2019-03-07 09:16:45.392 +04:00 [ERR] Request validation failed
2019-03-07 09:16:45.407 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile roles offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNB1DoNGY2c-ymi7D3fdL5u818hvWn5UiLbcHXYJ7AqyeztA2eLPSFHaMFWpvySGVnE_39d3au5hVM_l87rZ4F7LbKM5mzmvY5cjR_j5ZzsUR5SjfySQ_mUV4N34NYBzJyCzFXSNft0bRjnT3OCLfXPv-wygB9yBUmx2fP2ZRjiESHytBg53s_v2YXugKnnOPbs4Ac2wrOdMlX4p0UAKa9NVXPUasH97Yf4WWojBd4QVEai4rCGcKio30yjbphSNOHz-vml52RC_vAd4KKxI9So-CdQ40dBp07SkY9AM9iBvL09UUycSwLeg-BnVu4g1FN4","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile roles offline_access","response_mode":"form_post","nonce":"636875326050190978.YmU0MDQ2MzQtOGJlZC00MzI1LTgyMjgtNTk3NWI5NjUxZTNhYWQ1ODg1ZDUtM2E3Yi00YWRlLWFlNGYtOWVkMDVkNWJlOWFm","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNB1DoNGY2c-ymi7D3fdL5u818hvWn5UiLbcHXYJ7AqyeztA2eLPSFHaMFWpvySGVnE_39d3au5hVM_l87rZ4F7LbKM5mzmvY5cjR_j5ZzsUR5SjfySQ_mUV4N34NYBzJyCzFXSNft0bRjnT3OCLfXPv-wygB9yBUmx2fP2ZRjiESHytBg53s_v2YXugKnnOPbs4Ac2wrOdMlX4p0UAKa9NVXPUasH97Yf4WWojBd4QVEai4rCGcKio30yjbphSNOHz-vml52RC_vAd4KKxI9So-CdQ40dBp07SkY9AM9iBvL09UUycSwLeg-BnVu4g1FN4","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 09:16:45.442 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"1002","Scopes":"openid profile roles offline_access","GrantType":"hybrid","Error":"invalid_scope","ErrorDescription":"Invalid scope","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLL2NG9SGL93:00000002","TimeStamp":"2019-03-07T05:16:45.0000000Z","ProcessId":9160,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-03-07 09:18:10.233 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 09:18:10.292 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 09:18:10.293 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 09:18:10.293 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 09:18:10.293 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 09:18:10.294 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 09:18:10.294 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 09:18:10.629 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:18:10.640 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:18:10.643 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:18:10.764 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 09:18:10.834 +04:00 [DBG] Starting grant removal
2019-03-07 09:18:11.774 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 09:18:11.779 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 09:18:11.782 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 09:18:11.783 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 09:18:11.784 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 09:18:11.785 +04:00 [DBG] Error Url: /home/error
2019-03-07 09:18:11.786 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 09:18:11.875 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 09:18:59.223 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 09:18:59.229 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 09:18:59.233 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 09:18:59.239 +04:00 [DBG] Start discovery request
2019-03-07 09:18:59.704 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 09:18:59.842 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 09:18:59.845 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 09:18:59.846 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 09:18:59.852 +04:00 [DBG] Start key discovery request
2019-03-07 09:18:59.951 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 09:18:59.958 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 09:18:59.959 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 09:18:59.967 +04:00 [DBG] Start authorize request
2019-03-07 09:18:59.979 +04:00 [DBG] User in authorize request: 1002
2019-03-07 09:18:59.985 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 09:19:00.274 +04:00 [DBG] BiLab found in database: true
2019-03-07 09:19:00.281 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 09:19:00.288 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 09:19:00.289 +04:00 [DBG] No PKCE used.
2019-03-07 09:19:00.337 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 09:19:00.378 +04:00 [DBG] Found [] API scopes in database
2019-03-07 09:19:00.383 +04:00 [ERR] Invalid scope: roles
2019-03-07 09:19:00.387 +04:00 [ERR] Request validation failed
2019-03-07 09:19:00.402 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile roles offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNA4d_AIxK_hfRJvoM07w7b8IGmLZkkTEWbHkJF8oum5lbAI5s9r0qB-DkEW1Abz539N5LdpIGWJqu9JpZTNcGaclhIc7UoZ59jil1YRON-Qro9wAcexLicE8qjecgD1xR_xsELbqgWNo5BfGuOqUvuvZIYQIjmC3qmVLFDaGIPc4AY7Yov7Y0uZ-KKamem5UzPreRFK3QNf2HLdrQy-VVXoAJx2NbU1e4iJTupSDCrTgII2_vX9jFJrN_QpLrfYrJ05YTe1Cecjlp1jnpdWbZlm_lVM4PlqmeAtvzyV1vSN9QZrFVIDKGiX70ztRGnM-fk","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile roles offline_access","response_mode":"form_post","nonce":"636875327399141687.N2VkOWM4NmMtM2E0Mi00MzJiLTkzMGItMTk4MDQ1MDUxYzBiMDg1NDk1ODUtZDI2Yi00YzNmLWE0ODktNDAzMzgyY2EzYjlk","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNA4d_AIxK_hfRJvoM07w7b8IGmLZkkTEWbHkJF8oum5lbAI5s9r0qB-DkEW1Abz539N5LdpIGWJqu9JpZTNcGaclhIc7UoZ59jil1YRON-Qro9wAcexLicE8qjecgD1xR_xsELbqgWNo5BfGuOqUvuvZIYQIjmC3qmVLFDaGIPc4AY7Yov7Y0uZ-KKamem5UzPreRFK3QNf2HLdrQy-VVXoAJx2NbU1e4iJTupSDCrTgII2_vX9jFJrN_QpLrfYrJ05YTe1Cecjlp1jnpdWbZlm_lVM4PlqmeAtvzyV1vSN9QZrFVIDKGiX70ztRGnM-fk","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 09:19:00.440 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"1002","Scopes":"openid profile roles offline_access","GrantType":"hybrid","Error":"invalid_scope","ErrorDescription":"Invalid scope","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLL2NH5C9M91:00000002","TimeStamp":"2019-03-07T05:19:00.0000000Z","ProcessId":6472,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-03-07 09:19:59.951 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 09:19:59.952 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 09:19:59.953 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 09:19:59.953 +04:00 [DBG] Start authorize request
2019-03-07 09:19:59.954 +04:00 [DBG] User in authorize request: 1002
2019-03-07 09:19:59.954 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 09:19:59.957 +04:00 [DBG] BiLab found in database: false
2019-03-07 09:19:59.958 +04:00 [ERR] Unknown client or not enabled: BiLab
{"ClientId":null,"ClientName":null,"RedirectUri":null,"AllowedRedirectUris":null,"SubjectId":"1002","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile roles offline_access","response_mode":"form_post","nonce":"636875327999403488.M2MwNmQ3NzgtODc3YS00NjYwLTk5MjQtY2QxOWZiMDMwMzg1YjQxM2UzY2UtOTc2Ny00MWVjLTgyMmMtY2E2Y2YwODE5MzI1","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAddEAihL2j2BZLjHl9kzpRxhSmDbtypJN64L7tVzgGIWGsGe5MXqsI1fNxmK78iGeKC1gx3z2hR5qHqAkF1KfAmDwSnjEGPmyVFxHDm3GsB5UfOsru0Qx0SHmK6B8adgKVWRPOGvPhFlJ8ftM2gWY57JN6l0qE3N6xf1-Plu5Y3gngrRBfrkSL3TS0oEBwViwIWFnZrE868FeF6TRpfhymab702vD58A8JiabeDeVAKrZn6D4yZqZv7oBFQk3Sfsd3fF0IO7An1vExfIV8nYmBwgIFRhd9A4uqRJtCSv7an79NknEPKdkJ_yEZzVOFV6k","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 09:19:59.961 +04:00 [ERR] Request validation failed
2019-03-07 09:19:59.971 +04:00 [INF] {"ClientId":null,"ClientName":null,"RedirectUri":null,"AllowedRedirectUris":null,"SubjectId":"1002","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile roles offline_access","response_mode":"form_post","nonce":"636875327999403488.M2MwNmQ3NzgtODc3YS00NjYwLTk5MjQtY2QxOWZiMDMwMzg1YjQxM2UzY2UtOTc2Ny00MWVjLTgyMmMtY2E2Y2YwODE5MzI1","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAddEAihL2j2BZLjHl9kzpRxhSmDbtypJN64L7tVzgGIWGsGe5MXqsI1fNxmK78iGeKC1gx3z2hR5qHqAkF1KfAmDwSnjEGPmyVFxHDm3GsB5UfOsru0Qx0SHmK6B8adgKVWRPOGvPhFlJ8ftM2gWY57JN6l0qE3N6xf1-Plu5Y3gngrRBfrkSL3TS0oEBwViwIWFnZrE868FeF6TRpfhymab702vD58A8JiabeDeVAKrZn6D4yZqZv7oBFQk3Sfsd3fF0IO7An1vExfIV8nYmBwgIFRhd9A4uqRJtCSv7an79NknEPKdkJ_yEZzVOFV6k","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 09:19:59.993 +04:00 [INF] {"ClientId":"BiLab","ClientName":null,"RedirectUri":null,"Endpoint":"Authorize","SubjectId":"1002","Scopes":"","GrantType":null,"Error":"unauthorized_client","ErrorDescription":"Unknown client or client not enabled","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLL2NH5C9M91:00000006","TimeStamp":"2019-03-07T05:19:59.0000000Z","ProcessId":6472,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-03-07 09:20:23.005 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 09:20:23.056 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 09:20:23.057 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 09:20:23.057 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 09:20:23.057 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 09:20:23.057 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 09:20:23.058 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 09:20:23.273 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:20:23.287 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:20:23.290 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:20:23.363 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 09:20:23.416 +04:00 [DBG] Starting grant removal
2019-03-07 09:20:24.182 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 09:20:24.184 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 09:20:24.185 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 09:20:24.186 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 09:20:24.186 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 09:20:24.187 +04:00 [DBG] Error Url: /home/error
2019-03-07 09:20:24.188 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 09:20:24.244 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 09:20:42.277 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 09:20:42.283 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 09:20:42.284 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 09:20:42.288 +04:00 [DBG] Start discovery request
2019-03-07 09:20:42.471 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 09:20:42.615 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 09:20:42.618 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 09:20:42.621 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 09:20:42.624 +04:00 [DBG] Start key discovery request
2019-03-07 09:20:42.719 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 09:20:42.728 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 09:20:42.729 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 09:20:42.735 +04:00 [DBG] Start authorize request
2019-03-07 09:20:42.746 +04:00 [DBG] User in authorize request: 1002
2019-03-07 09:20:42.752 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 09:20:42.921 +04:00 [DBG] BiLab found in database: true
2019-03-07 09:20:42.928 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 09:20:42.935 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 09:20:42.937 +04:00 [DBG] No PKCE used.
2019-03-07 09:20:42.991 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 09:20:43.032 +04:00 [DBG] Found [] API scopes in database
2019-03-07 09:20:43.035 +04:00 [ERR] Invalid scope: role
2019-03-07 09:20:43.038 +04:00 [ERR] Request validation failed
2019-03-07 09:20:43.051 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile role offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAJxqTv5luOr3mVmJY5aBiZoBOvMI2Abs0DC4Ca0N8HcrmQ9nHMTku_R4gIMfVA_X2L-IdPrdU26wVGVMhJwOysC4bYcO2Jjr8sSvSy5X_Yc8fdJHkbCFGNEtgSQoFqiS6EofN3mpnCquvzh04-cFYT9f0igIC-X96q82qVHb9Mu3EziMd-JGwIlnZqmf18sk4ppT9Yt9BxyuB7oTTgQQ5mLc1PmrxjZOY7MslDRSZuRvYyzuJ4jHjTt3SUKFnL9aJRhdxJ1KgbLsa2Jih1QU4fXPyQL8s9-bLDzFj64eTO-UdLFeHF3KltnCd0Mt2jcvM","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile role offline_access","response_mode":"form_post","nonce":"636875328426845455.Y2U5NGQ0ZjgtNjBjZS00ZGZhLTkwNmEtNWUxNWM3Y2FjY2U2MWVkYjZmMTUtYWIyNS00ODAyLTgyODgtOGRiZTQ1YmVhMjdl","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAJxqTv5luOr3mVmJY5aBiZoBOvMI2Abs0DC4Ca0N8HcrmQ9nHMTku_R4gIMfVA_X2L-IdPrdU26wVGVMhJwOysC4bYcO2Jjr8sSvSy5X_Yc8fdJHkbCFGNEtgSQoFqiS6EofN3mpnCquvzh04-cFYT9f0igIC-X96q82qVHb9Mu3EziMd-JGwIlnZqmf18sk4ppT9Yt9BxyuB7oTTgQQ5mLc1PmrxjZOY7MslDRSZuRvYyzuJ4jHjTt3SUKFnL9aJRhdxJ1KgbLsa2Jih1QU4fXPyQL8s9-bLDzFj64eTO-UdLFeHF3KltnCd0Mt2jcvM","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 09:20:43.085 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"1002","Scopes":"openid profile role offline_access","GrantType":"hybrid","Error":"invalid_scope","ErrorDescription":"Invalid scope","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLL2NICT2OS6:00000002","TimeStamp":"2019-03-07T05:20:43.0000000Z","ProcessId":14568,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-03-07 09:22:09.861 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 09:22:09.916 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 09:22:09.917 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 09:22:09.917 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 09:22:09.917 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 09:22:09.918 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 09:22:09.918 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 09:22:10.127 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:22:10.139 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:22:10.146 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:22:10.247 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 09:22:10.340 +04:00 [DBG] Starting grant removal
2019-03-07 09:22:11.032 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 09:22:11.037 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 09:22:11.041 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 09:22:11.042 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 09:22:11.044 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 09:22:11.044 +04:00 [DBG] Error Url: /home/error
2019-03-07 09:22:11.045 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 09:22:11.098 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 09:22:21.878 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 09:22:21.886 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 09:22:21.887 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 09:22:21.892 +04:00 [DBG] Start discovery request
2019-03-07 09:22:22.101 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 09:22:22.246 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 09:22:22.249 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 09:22:22.250 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 09:22:22.256 +04:00 [DBG] Start key discovery request
2019-03-07 09:22:22.339 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 09:22:22.346 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 09:22:22.347 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 09:22:22.353 +04:00 [DBG] Start authorize request
2019-03-07 09:22:22.366 +04:00 [DBG] User in authorize request: 1002
2019-03-07 09:22:22.372 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 09:22:22.567 +04:00 [DBG] BiLab found in database: true
2019-03-07 09:22:22.574 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 09:22:22.580 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 09:22:22.582 +04:00 [DBG] No PKCE used.
2019-03-07 09:22:22.632 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 09:22:22.690 +04:00 [DBG] Found [] API scopes in database
2019-03-07 09:22:22.693 +04:00 [ERR] Invalid scope: roles
2019-03-07 09:22:22.696 +04:00 [ERR] Request validation failed
2019-03-07 09:22:22.711 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile roles offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNA7DVn-xSVqTHMjEbBnX4bSPErhq0RDxwjhe1uxPSj9YfthFsEugYAHNvZVnqeDTijGg0ugvBQ-LQqzFikNHPUKnZj0akFQVuDWSaaXAhCCi-tWeKfjZ2-AW-uO9xnp1yMhzecXw3GZUPq1qhivVrcbBi-WcBlvoFFpJrQV4VqpD1ercU2mGquN1MfPSt1JSyaHVa7pbo9GVPbCZPhcn50HUroqgTAfTHtbz4A6miV2AZYyvFOJMEo5rIp4bDw4sGlao97QHdkmAIm_BymKi8tgTlVuw7I6Bn-Jx6kl1gQqDFVscjGxW4MFnhmc5fFbn9w","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile roles offline_access","response_mode":"form_post","nonce":"636875329423088999.OTJlNTkyNjYtYjVjMi00ZmZkLWFhZjItM2Q5YmRkMDg0M2IwYzgxNTA1ODUtZDkwOC00NWIwLTlhNWQtNjg2MWYwMDVkOTQ0","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNA7DVn-xSVqTHMjEbBnX4bSPErhq0RDxwjhe1uxPSj9YfthFsEugYAHNvZVnqeDTijGg0ugvBQ-LQqzFikNHPUKnZj0akFQVuDWSaaXAhCCi-tWeKfjZ2-AW-uO9xnp1yMhzecXw3GZUPq1qhivVrcbBi-WcBlvoFFpJrQV4VqpD1ercU2mGquN1MfPSt1JSyaHVa7pbo9GVPbCZPhcn50HUroqgTAfTHtbz4A6miV2AZYyvFOJMEo5rIp4bDw4sGlao97QHdkmAIm_BymKi8tgTlVuw7I6Bn-Jx6kl1gQqDFVscjGxW4MFnhmc5fFbn9w","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 09:22:22.749 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"1002","Scopes":"openid profile roles offline_access","GrantType":"hybrid","Error":"invalid_scope","ErrorDescription":"Invalid scope","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLL2NJCM875J:00000001","TimeStamp":"2019-03-07T05:22:22.0000000Z","ProcessId":7740,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-03-07 09:24:52.164 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 09:24:52.217 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 09:24:52.218 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 09:24:52.218 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 09:24:52.219 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 09:24:52.219 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 09:24:52.219 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 09:24:52.441 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:24:52.456 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:24:52.462 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:24:52.536 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 09:24:52.594 +04:00 [DBG] Starting grant removal
2019-03-07 09:24:53.510 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 09:24:53.513 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 09:24:53.515 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 09:24:53.516 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 09:24:53.516 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 09:24:53.517 +04:00 [DBG] Error Url: /home/error
2019-03-07 09:24:53.518 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 09:24:53.594 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 09:25:02.196 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 09:25:02.252 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 09:25:02.253 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 09:25:02.253 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 09:25:02.253 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 09:25:02.254 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 09:25:02.254 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 09:25:02.528 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:25:02.541 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:25:02.546 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:25:02.641 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 09:25:02.693 +04:00 [DBG] Starting grant removal
2019-03-07 09:25:03.845 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 09:25:03.849 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 09:25:03.851 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 09:25:03.861 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 09:25:03.862 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 09:25:03.863 +04:00 [DBG] Error Url: /home/error
2019-03-07 09:25:03.864 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 09:25:03.964 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 09:25:08.491 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 09:25:08.501 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 09:25:08.503 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 09:25:08.506 +04:00 [DBG] Start discovery request
2019-03-07 09:25:08.686 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 09:25:08.839 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 09:25:08.842 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 09:25:08.843 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 09:25:08.849 +04:00 [DBG] Start key discovery request
2019-03-07 09:25:08.924 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 09:25:08.933 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 09:25:08.934 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 09:25:08.939 +04:00 [DBG] Start authorize request
2019-03-07 09:25:08.953 +04:00 [DBG] User in authorize request: 1002
2019-03-07 09:25:08.958 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 09:25:09.148 +04:00 [DBG] BiLab found in database: true
2019-03-07 09:25:09.155 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 09:25:09.161 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 09:25:09.164 +04:00 [DBG] No PKCE used.
2019-03-07 09:25:09.215 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 09:25:09.262 +04:00 [DBG] Found [] API scopes in database
2019-03-07 09:25:09.279 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 09:25:09.286 +04:00 [DBG] Found [] API scopes in database
2019-03-07 09:25:09.295 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 09:25:09.310 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAUxXeWZCyeipDlN6ynQDpKR-3C1iepnUwJbfSC4fgQb2me_1dTZj2LiGK2yMAVn5niVesTMqYWnNIBvU5ZVm3odDbXEqg_6t1Y1NPpw0D1tWIBY5Mu96j0XqXgSMtYKKnPcb-viuN8cgTZv4OuxTlmJ5B2GEy8IKIyvUIx4nvoZ3579MdUYLBJEJL0aczoM3KWZCIjaQqfy6ewV55FNSf-F9ltzCuTG_dyC9XHDFWYksLzquOeISfGfLXVhKjDvP7puTAj36pc1K8DukfN9ea-t8HcZggzZs45ZN7JSbo3q7-cSlLAnYQXK12wUala6iI","UiLocales":null,"Nonce":"636875331089018356.YjU2YmEwMWItZjYzMy00NTBiLWFkNDYtN2YzZmJkODc3NDI3ZjIyOWRkMmQtYjJlOS00OTBlLWI2YTMtYmNlMWMwNGMxNTFk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"171ed875759db9c8be06517169335a3b","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875331089018356.YjU2YmEwMWItZjYzMy00NTBiLWFkNDYtN2YzZmJkODc3NDI3ZjIyOWRkMmQtYjJlOS00OTBlLWI2YTMtYmNlMWMwNGMxNTFk","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAUxXeWZCyeipDlN6ynQDpKR-3C1iepnUwJbfSC4fgQb2me_1dTZj2LiGK2yMAVn5niVesTMqYWnNIBvU5ZVm3odDbXEqg_6t1Y1NPpw0D1tWIBY5Mu96j0XqXgSMtYKKnPcb-viuN8cgTZv4OuxTlmJ5B2GEy8IKIyvUIx4nvoZ3579MdUYLBJEJL0aczoM3KWZCIjaQqfy6ewV55FNSf-F9ltzCuTG_dyC9XHDFWYksLzquOeISfGfLXVhKjDvP7puTAj36pc1K8DukfN9ea-t8HcZggzZs45ZN7JSbo3q7-cSlLAnYQXK12wUala6iI","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 09:25:09.376 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-07 09:25:09.383 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-07 09:25:09.423 +04:00 [DBG] gtkLtX+2qSTrV714cBelpta1cjL+nGH81uYhP/7vFaM= not found in database
2019-03-07 09:25:09.450 +04:00 [DBG] Creating Implicit Flow response.
2019-03-07 09:25:09.461 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 09:25:09.466 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-07 09:25:09.582 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"1002","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****Q20A","$type":"Token"},{"TokenType":"code","TokenValue":"****bb08","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2NL04KASU:00000001","TimeStamp":"2019-03-07T05:25:09.0000000Z","ProcessId":7652,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 09:25:09.591 +04:00 [INF] Authorize endpoint response
{"SubjectId":"1002","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAUxXeWZCyeipDlN6ynQDpKR-3C1iepnUwJbfSC4fgQb2me_1dTZj2LiGK2yMAVn5niVesTMqYWnNIBvU5ZVm3odDbXEqg_6t1Y1NPpw0D1tWIBY5Mu96j0XqXgSMtYKKnPcb-viuN8cgTZv4OuxTlmJ5B2GEy8IKIyvUIx4nvoZ3579MdUYLBJEJL0aczoM3KWZCIjaQqfy6ewV55FNSf-F9ltzCuTG_dyC9XHDFWYksLzquOeISfGfLXVhKjDvP7puTAj36pc1K8DukfN9ea-t8HcZggzZs45ZN7JSbo3q7-cSlLAnYQXK12wUala6iI","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-07 09:25:09.626 +04:00 [DBG] Augmenting SignInContext
2019-03-07 09:25:09.639 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 09:25:09.776 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-07 09:25:09.785 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-07 09:25:09.786 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-07 09:25:09.799 +04:00 [DBG] Start token request.
2019-03-07 09:25:09.805 +04:00 [DBG] Start client validation
2019-03-07 09:25:09.812 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-07 09:25:09.817 +04:00 [DBG] Start parsing for secret in post body
2019-03-07 09:25:09.835 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-07 09:25:09.836 +04:00 [DBG] Secret id found: BiLab
2019-03-07 09:25:09.860 +04:00 [DBG] BiLab found in database: true
2019-03-07 09:25:09.861 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 09:25:09.875 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-07 09:25:09.876 +04:00 [DBG] Client validation success
2019-03-07 09:25:09.877 +04:00 [INF] {"ClientId":"BiLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLL2NL04KASV:00000003","TimeStamp":"2019-03-07T05:25:09.0000000Z","ProcessId":7652,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-03-07 09:25:09.887 +04:00 [DBG] Start token request validation
2019-03-07 09:25:09.897 +04:00 [DBG] Start validation of authorization code token request
2019-03-07 09:25:09.912 +04:00 [DBG] gtkLtX+2qSTrV714cBelpta1cjL+nGH81uYhP/7vFaM= found in database: true
2019-03-07 09:25:09.929 +04:00 [DBG] removing gtkLtX+2qSTrV714cBelpta1cjL+nGH81uYhP/7vFaM= persisted grant from database
2019-03-07 09:25:09.940 +04:00 [DBG] Validation of authorization code token request success
2019-03-07 09:25:09.945 +04:00 [INF] Token request validation success
{"ClientId":"BiLab","ClientName":"BiLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"57221237ef3995d60d5f0a92ac485d37facaf8cbb02b6d1bf80cebde9778bb08","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"BiLab","client_secret":"***REDACTED***","code":"57221237ef3995d60d5f0a92ac485d37facaf8cbb02b6d1bf80cebde9778bb08","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-03-07 09:25:09.994 +04:00 [DBG] BiLab found in database: true
2019-03-07 09:25:09.994 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 09:25:10.006 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 09:25:10.013 +04:00 [DBG] Found [] API scopes in database
2019-03-07 09:25:10.026 +04:00 [DBG] Getting claims for access token for client: BiLab
2019-03-07 09:25:10.027 +04:00 [DBG] Getting claims for access token for subject: 1002
2019-03-07 09:25:10.148 +04:00 [DBG] Creating refresh token
2019-03-07 09:25:10.148 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-03-07 09:25:10.162 +04:00 [DBG] 6BShu0Ej+jHmTKq+1OAbe0gimdmuq6UT27+VacO1btM= not found in database
2019-03-07 09:25:10.185 +04:00 [DBG] BiLab found in database: true
2019-03-07 09:25:10.185 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 09:25:10.194 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 09:25:10.204 +04:00 [DBG] Found [] API scopes in database
2019-03-07 09:25:10.205 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 09:25:10.206 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-07 09:25:10.214 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****aBBg","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****0a60","$type":"Token"},{"TokenType":"access_token","TokenValue":"****YleQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2NL04KASV:00000003","TimeStamp":"2019-03-07T05:25:10.0000000Z","ProcessId":7652,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 09:25:10.221 +04:00 [DBG] Token request success.
2019-03-07 09:25:10.238 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-03-07 09:25:10.241 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-03-07 09:25:10.243 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-03-07 09:25:10.251 +04:00 [DBG] Start userinfo request
2019-03-07 09:25:10.255 +04:00 [DBG] Bearer token found in header
2019-03-07 09:25:10.333 +04:00 [DBG] BiLab found in database: true
2019-03-07 09:25:10.334 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 09:25:10.359 +04:00 [DBG] BiLab found in database: true
2019-03-07 09:25:10.360 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 09:25:10.370 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-03-07 09:25:10.373 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1551936310,"exp":1551939910,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"BiLab","sub":"1002","auth_time":1551935788,"idp":"local","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-03-07 09:25:10.387 +04:00 [DBG] Creating userinfo response
2019-03-07 09:25:10.391 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 09:25:10.394 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 09:25:10.405 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 09:25:10.407 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-03-07 09:25:10.409 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 09:25:10.412 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 09:25:10.426 +04:00 [INF] Profile service returned the following claim types: sub preferred_username name
2019-03-07 09:25:10.428 +04:00 [DBG] End userinfo request
2019-03-07 09:26:36.702 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 09:26:36.755 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 09:26:36.756 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 09:26:36.757 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 09:26:36.757 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 09:26:36.758 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 09:26:36.758 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 09:26:36.997 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:26:37.011 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:26:37.014 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:26:37.093 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 09:26:37.148 +04:00 [DBG] Starting grant removal
2019-03-07 09:26:37.925 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 09:26:37.928 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 09:26:37.932 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 09:26:37.932 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 09:26:37.933 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 09:26:37.935 +04:00 [DBG] Error Url: /home/error
2019-03-07 09:26:37.936 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 09:26:37.989 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 09:27:53.176 +04:00 [ERR] The view 'Index' was not found. Searched locations: ["/Views/Home/Index.cshtml","/Views/Shared/Index.cshtml","/Pages/Shared/Index.cshtml"]
2019-03-07 09:27:53.196 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The view 'Index' was not found. The following locations were searched:
/Views/Home/Index.cshtml
/Views/Shared/Index.cshtml
/Pages/Shared/Index.cshtml
   at Microsoft.AspNetCore.Mvc.ViewEngines.ViewEngineResult.EnsureSuccessful(IEnumerable`1 originalLocations)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-03-07 09:28:15.819 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 09:28:15.872 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 09:28:15.873 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 09:28:15.873 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 09:28:15.874 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 09:28:15.874 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 09:28:15.875 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 09:28:16.075 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:28:16.091 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:28:16.093 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:28:16.170 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 09:28:16.227 +04:00 [DBG] Starting grant removal
2019-03-07 09:28:17.139 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 09:28:17.145 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 09:28:17.158 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 09:28:17.164 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 09:28:17.165 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 09:28:17.167 +04:00 [DBG] Error Url: /home/error
2019-03-07 09:28:17.175 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 09:28:17.236 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 09:47:59.410 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 09:47:59.500 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 09:47:59.501 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 09:47:59.501 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 09:47:59.501 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 09:47:59.502 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 09:47:59.502 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 09:48:00.031 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:48:00.307 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:48:00.313 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:48:00.695 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 09:48:00.791 +04:00 [FTL] Unable to start Kestrel.
System.IO.IOException: Failed to bind to address http://127.0.0.1:5000: address already in use. ---> Microsoft.AspNetCore.Connections.AddressInUseException:        (/ /) ---> System.Net.Sockets.SocketException:        (/ /)
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransport.BindAsync()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransport.BindAsync()
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.<>c__DisplayClass22_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.LocalhostListenOptions.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(IServerAddressesFeature addresses, KestrelServerOptions serverOptions, ILogger logger, Func`2 createBinding)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
2019-03-07 09:48:00.918 +04:00 [FTL] An error occurred stopping the application
System.AggregateException: One or more errors occurred. (Not started. Call Start first.) ---> System.InvalidOperationException: Not started. Call Start first.
   at IdentityServer4.EntityFramework.TokenCleanup.Stop() in C:\local\identity\server4\EntityFramework.Storage\src\TokenCleanup\TokenCleanup.cs:line 77
   at Microsoft.Extensions.DependencyInjection.TokenCleanupHost.StopAsync(CancellationToken cancellationToken) in C:\local\identity\server4\EntityFramework\src\TokenCleanupHost.cs:line 37
   at Microsoft.AspNetCore.Hosting.Internal.HostedServiceExecutor.<>c__DisplayClass4_0.<StopAsync>b__0(IHostedService service)
   at Microsoft.AspNetCore.Hosting.Internal.HostedServiceExecutor.ExecuteAsync(Func`2 callback)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Hosting.Internal.HostedServiceExecutor.ExecuteAsync(Func`2 callback)
   at Microsoft.AspNetCore.Hosting.Internal.HostedServiceExecutor.StopAsync(CancellationToken token)
---> (Inner Exception #0) System.InvalidOperationException: Not started. Call Start first.
   at IdentityServer4.EntityFramework.TokenCleanup.Stop() in C:\local\identity\server4\EntityFramework.Storage\src\TokenCleanup\TokenCleanup.cs:line 77
   at Microsoft.Extensions.DependencyInjection.TokenCleanupHost.StopAsync(CancellationToken cancellationToken) in C:\local\identity\server4\EntityFramework\src\TokenCleanupHost.cs:line 37
   at Microsoft.AspNetCore.Hosting.Internal.HostedServiceExecutor.<>c__DisplayClass4_0.<StopAsync>b__0(IHostedService service)
   at Microsoft.AspNetCore.Hosting.Internal.HostedServiceExecutor.ExecuteAsync(Func`2 callback)<---

2019-03-07 09:48:15.605 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 09:48:15.659 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 09:48:15.660 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 09:48:15.660 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 09:48:15.660 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 09:48:15.661 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 09:48:15.661 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 09:48:16.176 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:48:16.446 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:48:16.450 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:48:16.782 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 09:48:16.846 +04:00 [DBG] Starting grant removal
2019-03-07 09:48:17.698 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 09:48:17.701 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 09:48:17.703 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 09:48:17.703 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 09:48:17.704 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 09:48:17.705 +04:00 [DBG] Error Url: /home/error
2019-03-07 09:48:17.705 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 09:48:18.483 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 09:48:27.764 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 09:48:27.849 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 09:48:27.850 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 09:48:27.850 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 09:48:27.851 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 09:48:27.851 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 09:48:27.851 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 09:48:28.339 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:48:28.634 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:48:28.638 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:48:28.728 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 09:48:28.783 +04:00 [DBG] Starting grant removal
2019-03-07 09:48:29.526 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 09:48:29.528 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 09:48:29.530 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 09:48:29.531 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 09:48:29.532 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 09:48:29.533 +04:00 [DBG] Error Url: /home/error
2019-03-07 09:48:29.534 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 09:48:29.589 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 09:49:27.740 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 09:49:27.797 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 09:49:27.798 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 09:49:27.798 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 09:49:27.798 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 09:49:27.799 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 09:49:27.799 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 09:49:28.098 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:49:28.109 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:49:28.112 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:49:28.399 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 09:49:28.464 +04:00 [DBG] Starting grant removal
2019-03-07 09:49:29.430 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 09:49:29.435 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 09:49:29.439 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 09:49:29.440 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 09:49:29.441 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 09:49:29.441 +04:00 [DBG] Error Url: /home/error
2019-03-07 09:49:29.442 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 09:49:29.500 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 09:50:06.744 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 09:50:06.754 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 09:50:06.756 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 09:50:06.763 +04:00 [DBG] Start discovery request
2019-03-07 09:50:07.548 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 09:50:07.694 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 09:50:07.696 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 09:50:07.697 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 09:50:07.703 +04:00 [DBG] Start key discovery request
2019-03-07 09:50:07.802 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 09:50:07.813 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 09:50:07.814 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 09:50:07.820 +04:00 [DBG] Start authorize request
2019-03-07 09:50:07.833 +04:00 [DBG] No user present in authorize request
2019-03-07 09:50:07.838 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 09:50:08.474 +04:00 [DBG] BiLab found in database: true
2019-03-07 09:50:08.482 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 09:50:08.488 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 09:50:08.490 +04:00 [DBG] No PKCE used.
2019-03-07 09:50:09.001 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 09:50:09.292 +04:00 [DBG] Found [] API scopes in database
2019-03-07 09:50:09.296 +04:00 [ERR] Invalid scope: roles
2019-03-07 09:50:09.299 +04:00 [ERR] Request validation failed
2019-03-07 09:50:09.313 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile roles offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDI0pm-hqcqi_jtr3zaIsZT9Sp9UjFXi0HQ4OVyqu2TtxLd-OylOBcABrR8i7yl9FAvJi5UUucU5dAIEQRCsJQcxJy5HUBO1zewe3gxdf5-HAApPkSED-kHcNDk-N_53oEWo13zuoGAff11Bq5deDULCrGgfrkThHhAFyjQbjy9qP27qQa-Hb0Gjhdq5HQOxtDQ_yeRdu7zlAw70_orM6ipO3P0-Oo4YoXRpfgEgc555afkn_AShiV99KePv_iXm7H-j9ANsFVM0RuNOke_AcYjBLyPI1KLU6jOT1jqcjOOIIMjGY88kwFr45qJwwzHqXg","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile roles offline_access","response_mode":"form_post","nonce":"636875346077776604.NGUxM2I5YjEtMzM1Ni00NGNiLTk3NjQtYzVmYjcwNzVlZjkxOGYxMGMxMWUtYzlmYi00OWI3LTkxNjAtNjE4MjY3M2MzOGM0","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDI0pm-hqcqi_jtr3zaIsZT9Sp9UjFXi0HQ4OVyqu2TtxLd-OylOBcABrR8i7yl9FAvJi5UUucU5dAIEQRCsJQcxJy5HUBO1zewe3gxdf5-HAApPkSED-kHcNDk-N_53oEWo13zuoGAff11Bq5deDULCrGgfrkThHhAFyjQbjy9qP27qQa-Hb0Gjhdq5HQOxtDQ_yeRdu7zlAw70_orM6ipO3P0-Oo4YoXRpfgEgc555afkn_AShiV99KePv_iXm7H-j9ANsFVM0RuNOke_AcYjBLyPI1KLU6jOT1jqcjOOIIMjGY88kwFr45qJwwzHqXg","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 09:50:09.375 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":null,"Scopes":"openid profile roles offline_access","GrantType":"hybrid","Error":"invalid_scope","ErrorDescription":"Invalid scope","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLL2O2KUDE13:00000001","TimeStamp":"2019-03-07T05:50:09.0000000Z","ProcessId":3976,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-03-07 09:56:31.865 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 09:56:31.916 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 09:56:31.916 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 09:56:31.917 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 09:56:31.918 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 09:56:31.918 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 09:56:31.919 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 09:56:32.139 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:56:32.149 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:56:32.152 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:56:32.234 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 09:56:32.291 +04:00 [DBG] Starting grant removal
2019-03-07 09:56:33.410 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 09:56:33.414 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 09:56:33.414 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 09:56:33.416 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 09:56:33.417 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 09:56:33.427 +04:00 [DBG] Error Url: /home/error
2019-03-07 09:56:33.428 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 09:56:33.469 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 09:56:33.636 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-07 09:56:37.926 +04:00 [DBG] Augmenting SignInContext
2019-03-07 09:56:37.938 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 09:56:37.938 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 09:56:37.941 +04:00 [DBG] Adding auth_time claim with value: 1551938197
2019-03-07 09:56:37.955 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 09:56:37.999 +04:00 [INF] {"Username":"godAdmin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"1002","DisplayName":"godAdmin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2O6JA6PI4:00000001","TimeStamp":"2019-03-07T05:56:37.0000000Z","ProcessId":16268,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 09:56:45.225 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 09:56:45.287 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 09:56:45.288 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 09:56:45.289 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 09:56:45.289 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 09:56:45.289 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 09:56:45.289 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 09:56:45.578 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:56:45.602 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:56:45.607 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 09:56:45.762 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 09:56:45.873 +04:00 [DBG] Starting grant removal
2019-03-07 09:56:46.828 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 09:56:46.834 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 09:56:46.835 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 09:56:46.836 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 09:56:46.838 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 09:56:46.841 +04:00 [DBG] Error Url: /home/error
2019-03-07 09:56:46.843 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 09:56:46.976 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 09:57:18.971 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-03-07 09:57:18.975 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-03-07 09:57:18.977 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-03-07 09:57:22.571 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 09:57:22.577 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 09:57:22.579 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 09:57:22.585 +04:00 [DBG] Start discovery request
2019-03-07 09:57:22.842 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 09:57:22.980 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 09:57:22.983 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 09:57:22.984 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 09:57:22.988 +04:00 [DBG] Start key discovery request
2019-03-07 09:57:23.058 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 09:57:23.065 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 09:57:23.066 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 09:57:23.071 +04:00 [DBG] Start authorize request
2019-03-07 09:57:23.080 +04:00 [DBG] No user present in authorize request
2019-03-07 09:57:23.085 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 09:57:23.267 +04:00 [DBG] BiLab found in database: true
2019-03-07 09:57:23.274 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 09:57:23.280 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 09:57:23.281 +04:00 [DBG] No PKCE used.
2019-03-07 09:57:23.331 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 09:57:23.377 +04:00 [DBG] Found [] API scopes in database
2019-03-07 09:57:23.393 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 09:57:23.399 +04:00 [DBG] Found [] API scopes in database
2019-03-07 09:57:23.408 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 09:57:23.422 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCLB4hrhJ7nochNnTWVQ3vpd7KgsJAhJelEXRQS3btpW4neR7_WI29qamOZ4Q4BhMRxTg1rPVDls6QhfVm6qqfKCGqWb-pU6nJmJ0ZRu07tDh4KGt4Nnn2N3wVr5ORK-6XGPlVxjGjoeHwq7dEeqlKZYSsNQkDHXzPYNsjFBPsY3q2a-Q5kmfS13c_WoJrY7V3rAjUkZqg6e6zAc-ELJoQAU-qA5PAWcclSQ0XP62V18SrXkAS4P_6Xnv0N6qeaGvvjvXwVckccwfcVPjHM9DvUxJJ3PTAu6Rt0mfjSZN8kRngOlQ3NlIZ5mmGy1x7BfZQ","UiLocales":null,"Nonce":"636875350430361928.YWYwNTYyZjctYWM3OS00NDA5LWFkY2UtYzcxOTI5YjhlYjA5OWE0NjU5NDgtNGUzOS00NmE1LTgzYmQtZjk4MTExYjI3YjEy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875350430361928.YWYwNTYyZjctYWM3OS00NDA5LWFkY2UtYzcxOTI5YjhlYjA5OWE0NjU5NDgtNGUzOS00NmE1LTgzYmQtZjk4MTExYjI3YjEy","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCLB4hrhJ7nochNnTWVQ3vpd7KgsJAhJelEXRQS3btpW4neR7_WI29qamOZ4Q4BhMRxTg1rPVDls6QhfVm6qqfKCGqWb-pU6nJmJ0ZRu07tDh4KGt4Nnn2N3wVr5ORK-6XGPlVxjGjoeHwq7dEeqlKZYSsNQkDHXzPYNsjFBPsY3q2a-Q5kmfS13c_WoJrY7V3rAjUkZqg6e6zAc-ELJoQAU-qA5PAWcclSQ0XP62V18SrXkAS4P_6Xnv0N6qeaGvvjvXwVckccwfcVPjHM9DvUxJJ3PTAu6Rt0mfjSZN8kRngOlQ3NlIZ5mmGy1x7BfZQ","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 09:57:23.450 +04:00 [INF] Showing login: User is not authenticated
2019-03-07 09:57:28.287 +04:00 [DBG] Augmenting SignInContext
2019-03-07 09:57:28.289 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 09:57:28.290 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 09:57:28.291 +04:00 [DBG] Adding auth_time claim with value: 1551938248
2019-03-07 09:57:28.299 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 09:57:28.322 +04:00 [INF] {"Username":"godAdmin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"1002","DisplayName":"godAdmin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2O6NC1FIG:00000003","TimeStamp":"2019-03-07T05:57:28.0000000Z","ProcessId":5892,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 09:57:28.348 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-07 09:57:28.350 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-07 09:57:28.351 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-07 09:57:28.358 +04:00 [DBG] Start authorize callback request
2019-03-07 09:57:28.365 +04:00 [DBG] User in authorize request: 1002
2019-03-07 09:57:28.365 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 09:57:28.389 +04:00 [DBG] BiLab found in database: true
2019-03-07 09:57:28.389 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 09:57:28.391 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 09:57:28.392 +04:00 [DBG] No PKCE used.
2019-03-07 09:57:28.403 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 09:57:28.409 +04:00 [DBG] Found [] API scopes in database
2019-03-07 09:57:28.415 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 09:57:28.419 +04:00 [DBG] Found [] API scopes in database
2019-03-07 09:57:28.421 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 09:57:28.422 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCLB4hrhJ7nochNnTWVQ3vpd7KgsJAhJelEXRQS3btpW4neR7_WI29qamOZ4Q4BhMRxTg1rPVDls6QhfVm6qqfKCGqWb-pU6nJmJ0ZRu07tDh4KGt4Nnn2N3wVr5ORK-6XGPlVxjGjoeHwq7dEeqlKZYSsNQkDHXzPYNsjFBPsY3q2a-Q5kmfS13c_WoJrY7V3rAjUkZqg6e6zAc-ELJoQAU-qA5PAWcclSQ0XP62V18SrXkAS4P_6Xnv0N6qeaGvvjvXwVckccwfcVPjHM9DvUxJJ3PTAu6Rt0mfjSZN8kRngOlQ3NlIZ5mmGy1x7BfZQ","UiLocales":null,"Nonce":"636875350430361928.YWYwNTYyZjctYWM3OS00NDA5LWFkY2UtYzcxOTI5YjhlYjA5OWE0NjU5NDgtNGUzOS00NmE1LTgzYmQtZjk4MTExYjI3YjEy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"57afd2251b93ac63bde0cd59fcda13a3","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875350430361928.YWYwNTYyZjctYWM3OS00NDA5LWFkY2UtYzcxOTI5YjhlYjA5OWE0NjU5NDgtNGUzOS00NmE1LTgzYmQtZjk4MTExYjI3YjEy","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCLB4hrhJ7nochNnTWVQ3vpd7KgsJAhJelEXRQS3btpW4neR7_WI29qamOZ4Q4BhMRxTg1rPVDls6QhfVm6qqfKCGqWb-pU6nJmJ0ZRu07tDh4KGt4Nnn2N3wVr5ORK-6XGPlVxjGjoeHwq7dEeqlKZYSsNQkDHXzPYNsjFBPsY3q2a-Q5kmfS13c_WoJrY7V3rAjUkZqg6e6zAc-ELJoQAU-qA5PAWcclSQ0XP62V18SrXkAS4P_6Xnv0N6qeaGvvjvXwVckccwfcVPjHM9DvUxJJ3PTAu6Rt0mfjSZN8kRngOlQ3NlIZ5mmGy1x7BfZQ","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 09:57:28.472 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-07 09:57:28.481 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-07 09:57:28.520 +04:00 [DBG] PveP66S4LIBE38lumvxvlyrc/V+Avv2PeZE8d4Jk83Q= not found in database
2019-03-07 09:57:28.548 +04:00 [DBG] Creating Implicit Flow response.
2019-03-07 09:57:28.559 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 09:57:28.564 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-07 09:57:28.651 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"1002","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****crmw","$type":"Token"},{"TokenType":"code","TokenValue":"****da76","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2O6NC1FIG:00000004","TimeStamp":"2019-03-07T05:57:28.0000000Z","ProcessId":5892,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 09:57:28.660 +04:00 [INF] Authorize endpoint response
{"SubjectId":"1002","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCLB4hrhJ7nochNnTWVQ3vpd7KgsJAhJelEXRQS3btpW4neR7_WI29qamOZ4Q4BhMRxTg1rPVDls6QhfVm6qqfKCGqWb-pU6nJmJ0ZRu07tDh4KGt4Nnn2N3wVr5ORK-6XGPlVxjGjoeHwq7dEeqlKZYSsNQkDHXzPYNsjFBPsY3q2a-Q5kmfS13c_WoJrY7V3rAjUkZqg6e6zAc-ELJoQAU-qA5PAWcclSQ0XP62V18SrXkAS4P_6Xnv0N6qeaGvvjvXwVckccwfcVPjHM9DvUxJJ3PTAu6Rt0mfjSZN8kRngOlQ3NlIZ5mmGy1x7BfZQ","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-07 09:57:28.683 +04:00 [DBG] Augmenting SignInContext
2019-03-07 09:57:28.683 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 09:57:28.868 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-07 09:57:28.877 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-07 09:57:28.879 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-07 09:57:28.889 +04:00 [DBG] Start token request.
2019-03-07 09:57:28.897 +04:00 [DBG] Start client validation
2019-03-07 09:57:28.909 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-07 09:57:28.916 +04:00 [DBG] Start parsing for secret in post body
2019-03-07 09:57:28.925 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-07 09:57:28.926 +04:00 [DBG] Secret id found: BiLab
2019-03-07 09:57:28.931 +04:00 [DBG] BiLab found in database: true
2019-03-07 09:57:28.932 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 09:57:28.942 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-07 09:57:28.943 +04:00 [DBG] Client validation success
2019-03-07 09:57:28.945 +04:00 [INF] {"ClientId":"BiLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLL2O6NC1FIH:00000003","TimeStamp":"2019-03-07T05:57:28.0000000Z","ProcessId":5892,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-03-07 09:57:28.955 +04:00 [DBG] Start token request validation
2019-03-07 09:57:28.965 +04:00 [DBG] Start validation of authorization code token request
2019-03-07 09:57:28.981 +04:00 [DBG] PveP66S4LIBE38lumvxvlyrc/V+Avv2PeZE8d4Jk83Q= found in database: true
2019-03-07 09:57:28.998 +04:00 [DBG] removing PveP66S4LIBE38lumvxvlyrc/V+Avv2PeZE8d4Jk83Q= persisted grant from database
2019-03-07 09:57:29.009 +04:00 [DBG] Validation of authorization code token request success
2019-03-07 09:57:29.017 +04:00 [INF] Token request validation success
{"ClientId":"BiLab","ClientName":"BiLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"3b9040b77d62e3e332ebaffe1ac0c51b4222a532be41226a251e8407925eda76","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"BiLab","client_secret":"***REDACTED***","code":"3b9040b77d62e3e332ebaffe1ac0c51b4222a532be41226a251e8407925eda76","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-03-07 09:57:29.041 +04:00 [DBG] BiLab found in database: true
2019-03-07 09:57:29.041 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 09:57:29.051 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 09:57:29.057 +04:00 [DBG] Found [] API scopes in database
2019-03-07 09:57:29.069 +04:00 [DBG] Getting claims for access token for client: BiLab
2019-03-07 09:57:29.069 +04:00 [DBG] Getting claims for access token for subject: 1002
2019-03-07 09:57:29.095 +04:00 [DBG] Creating refresh token
2019-03-07 09:57:29.095 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-03-07 09:57:29.107 +04:00 [DBG] TMowy13ovW8vO4UFcKXZLfpO4fmO6iph692nIi6CBbQ= not found in database
2019-03-07 09:57:29.116 +04:00 [DBG] BiLab found in database: true
2019-03-07 09:57:29.117 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 09:57:29.121 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 09:57:29.124 +04:00 [DBG] Found [] API scopes in database
2019-03-07 09:57:29.125 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 09:57:29.126 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-07 09:57:29.133 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****PShQ","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****ed77","$type":"Token"},{"TokenType":"access_token","TokenValue":"****fcLg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2O6NC1FIH:00000003","TimeStamp":"2019-03-07T05:57:29.0000000Z","ProcessId":5892,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 09:57:29.141 +04:00 [DBG] Token request success.
2019-03-07 09:57:29.153 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-03-07 09:57:29.156 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-03-07 09:57:29.157 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-03-07 09:57:29.165 +04:00 [DBG] Start userinfo request
2019-03-07 09:57:29.168 +04:00 [DBG] Bearer token found in header
2019-03-07 09:57:29.231 +04:00 [DBG] BiLab found in database: true
2019-03-07 09:57:29.231 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 09:57:29.239 +04:00 [DBG] BiLab found in database: true
2019-03-07 09:57:29.239 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 09:57:29.249 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-03-07 09:57:29.252 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1551938249,"exp":1551941849,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"BiLab","sub":"1002","auth_time":1551938248,"idp":"local","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-03-07 09:57:29.266 +04:00 [DBG] Creating userinfo response
2019-03-07 09:57:29.269 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 09:57:29.273 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 09:57:29.279 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 09:57:29.281 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-03-07 09:57:29.282 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 09:57:29.284 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 09:57:29.293 +04:00 [INF] Profile service returned the following claim types: sub preferred_username name
2019-03-07 09:57:29.295 +04:00 [DBG] End userinfo request
2019-03-07 10:07:46.190 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 10:07:46.241 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 10:07:46.242 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 10:07:46.242 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 10:07:46.242 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 10:07:46.243 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 10:07:46.243 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 10:07:46.470 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 10:07:46.484 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 10:07:46.486 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 10:07:46.569 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 10:07:46.647 +04:00 [DBG] Starting grant removal
2019-03-07 10:07:47.595 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 10:07:47.599 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 10:07:47.603 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 10:07:47.604 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 10:07:47.604 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 10:07:47.605 +04:00 [DBG] Error Url: /home/error
2019-03-07 10:07:47.606 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 10:07:47.672 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 11:08:56.276 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 11:08:56.355 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 11:08:56.355 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 11:08:56.356 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 11:08:56.356 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 11:08:56.356 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 11:08:56.357 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 11:08:56.598 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:08:56.608 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:08:56.610 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:08:56.690 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 11:08:56.748 +04:00 [DBG] Starting grant removal
2019-03-07 11:08:57.651 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 11:08:57.654 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 11:08:57.656 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 11:08:57.657 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 11:08:57.657 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 11:08:57.658 +04:00 [DBG] Error Url: /home/error
2019-03-07 11:08:57.659 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 11:08:57.679 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 11:08:57.698 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 11:08:57.716 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 11:08:57.874 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-07 11:08:57.890 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 11:08:57.891 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 11:08:59.621 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 11:08:59.624 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 11:08:59.715 +04:00 [INF] {"Username":"bob","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLL2PF203OKC:00000003","TimeStamp":"2019-03-07T07:08:59.0000000Z","ProcessId":15000,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-03-07 11:09:03.422 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 11:09:03.423 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 11:09:03.574 +04:00 [DBG] Augmenting SignInContext
2019-03-07 11:09:03.586 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 11:09:03.586 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 11:09:03.588 +04:00 [DBG] Adding auth_time claim with value: 1551942543
2019-03-07 11:09:03.593 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 11:09:03.600 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 11:09:03.613 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2PF203OKC:00000004","TimeStamp":"2019-03-07T07:09:03.0000000Z","ProcessId":15000,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 11:09:03.631 +04:00 [INF] AuthenticationScheme: Identity.Application was forbidden.
2019-03-07 11:11:04.552 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 11:11:04.603 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 11:11:04.604 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 11:11:04.604 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 11:11:04.604 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 11:11:04.605 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 11:11:04.605 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 11:11:04.831 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:11:04.847 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:11:04.851 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:11:04.929 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 11:11:04.985 +04:00 [DBG] Starting grant removal
2019-03-07 11:11:05.943 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 11:11:05.946 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 11:11:05.948 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 11:11:05.948 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 11:11:05.949 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 11:11:05.950 +04:00 [DBG] Error Url: /home/error
2019-03-07 11:11:05.951 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 11:11:06.009 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 11:11:06.182 +04:00 [INF] AuthenticationScheme: Identity.Application was forbidden.
2019-03-07 11:11:13.931 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-03-07 11:11:13.935 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-03-07 11:11:13.936 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-03-07 11:11:22.425 +04:00 [DBG] Augmenting SignInContext
2019-03-07 11:11:22.437 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 11:11:22.438 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 11:11:22.439 +04:00 [DBG] Adding auth_time claim with value: 1551942682
2019-03-07 11:11:22.449 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 11:11:22.516 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2PG883JHP:00000002","TimeStamp":"2019-03-07T07:11:22.0000000Z","ProcessId":9528,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 11:11:22.645 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentException: Value cannot be null or empty.
Parameter name: url
   at Microsoft.AspNetCore.Mvc.ControllerBase.Redirect(String url)
   at AuthServiceServer.Controllers.AccountController.Login(LoginModel model) in D:\Projects\AuthServiceServer\AuthServiceServer\Controllers\AccountController.cs:line 54
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-03-07 11:11:32.624 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-07 11:11:35.050 +04:00 [DBG] Augmenting SignInContext
2019-03-07 11:11:35.051 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 11:11:35.052 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 11:11:35.053 +04:00 [DBG] Adding auth_time claim with value: 1551942695
2019-03-07 11:11:35.054 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 11:11:35.058 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2PG883JHR:00000007","TimeStamp":"2019-03-07T07:11:35.0000000Z","ProcessId":9528,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 11:11:42.792 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-03-07 11:11:42.793 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-03-07 11:11:42.795 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-03-07 11:11:47.856 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-07 11:11:51.613 +04:00 [DBG] Augmenting SignInContext
2019-03-07 11:11:51.613 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 11:11:51.615 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 11:11:51.615 +04:00 [DBG] Adding auth_time claim with value: 1551942711
2019-03-07 11:11:51.616 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 11:11:51.621 +04:00 [INF] {"Username":"godAdmin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"1002","DisplayName":"godAdmin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2PG883JHR:0000000E","TimeStamp":"2019-03-07T07:11:51.0000000Z","ProcessId":9528,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 11:12:01.918 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 11:12:01.967 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 11:12:01.967 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 11:12:01.968 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 11:12:01.968 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 11:12:01.969 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 11:12:01.969 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 11:12:02.173 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:12:02.188 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:12:02.191 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:12:02.280 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 11:12:02.332 +04:00 [DBG] Starting grant removal
2019-03-07 11:12:03.198 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 11:12:03.201 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 11:12:03.203 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 11:12:03.203 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 11:12:03.205 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 11:12:03.205 +04:00 [DBG] Error Url: /home/error
2019-03-07 11:12:03.206 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 11:12:03.260 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 11:12:32.423 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 11:12:32.428 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 11:12:32.430 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 11:12:32.436 +04:00 [DBG] Start discovery request
2019-03-07 11:12:33.177 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 11:12:33.325 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 11:12:33.328 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 11:12:33.329 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 11:12:33.334 +04:00 [DBG] Start key discovery request
2019-03-07 11:12:33.421 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 11:12:51.421 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 11:12:51.423 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 11:12:51.430 +04:00 [DBG] Start authorize request
2019-03-07 11:12:51.442 +04:00 [DBG] No user present in authorize request
2019-03-07 11:12:51.446 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 11:12:52.154 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:12:52.161 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:12:52.169 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 11:12:52.171 +04:00 [DBG] No PKCE used.
2019-03-07 11:12:52.457 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:12:52.685 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:12:52.929 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:12:52.961 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:12:52.972 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 11:12:52.988 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCAwMy4lFMdw9BJyY8XmEvob2zKq3T_1FM6B2kqXfDYvJHKB66DXo1BlbBzzBI38MvghvbuhaiOR6HE3s0fAWBYuyDvdibQTYMWJoWClGWxJE7pB88HjGdLzPuEexu0JFHcM_HbDehQvi7S_Cf-91BFBZ8DcXwlaMCjVvTL1o-3Ckr0irVEPOzHuDDZjDZ-e12jCADeYbdVcf1UTTJHNbgnzTMQtXaeM1bkYMI7Z1_KvdVlyknYKpadPlC9Qsq2nIA-Jz0bL1RVowLlNOxGY5XroOEP_ewqqYAEZQcSvhJAAP2lbMb79_LohEht-zEBO04","UiLocales":null,"Nonce":"636875395533931907.ZDJhYjcyOGMtNGQxOS00NTE0LTgzZTQtNDYwOTdkZDFlOWQyMGEwMjJjNDktOTliYi00YzRjLTk3ODUtZjhmOWQwZDM0ODU5","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875395533931907.ZDJhYjcyOGMtNGQxOS00NTE0LTgzZTQtNDYwOTdkZDFlOWQyMGEwMjJjNDktOTliYi00YzRjLTk3ODUtZjhmOWQwZDM0ODU5","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCAwMy4lFMdw9BJyY8XmEvob2zKq3T_1FM6B2kqXfDYvJHKB66DXo1BlbBzzBI38MvghvbuhaiOR6HE3s0fAWBYuyDvdibQTYMWJoWClGWxJE7pB88HjGdLzPuEexu0JFHcM_HbDehQvi7S_Cf-91BFBZ8DcXwlaMCjVvTL1o-3Ckr0irVEPOzHuDDZjDZ-e12jCADeYbdVcf1UTTJHNbgnzTMQtXaeM1bkYMI7Z1_KvdVlyknYKpadPlC9Qsq2nIA-Jz0bL1RVowLlNOxGY5XroOEP_ewqqYAEZQcSvhJAAP2lbMb79_LohEht-zEBO04","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 11:12:53.016 +04:00 [INF] Showing login: User is not authenticated
2019-03-07 11:13:02.267 +04:00 [DBG] Augmenting SignInContext
2019-03-07 11:13:02.271 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 11:13:02.271 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 11:13:02.272 +04:00 [DBG] Adding auth_time claim with value: 1551942782
2019-03-07 11:13:02.284 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 11:13:02.310 +04:00 [INF] {"Username":"godAdmin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"1002","DisplayName":"godAdmin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2PGPAC89O:00000001","TimeStamp":"2019-03-07T07:13:02.0000000Z","ProcessId":1204,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 11:13:02.335 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-07 11:13:07.952 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-07 11:13:07.953 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-07 11:13:07.959 +04:00 [DBG] Start authorize callback request
2019-03-07 11:13:07.964 +04:00 [DBG] User in authorize request: 1002
2019-03-07 11:13:07.964 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 11:13:08.008 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:13:08.008 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:13:08.010 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 11:13:08.011 +04:00 [DBG] No PKCE used.
2019-03-07 11:13:08.097 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:13:08.104 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:13:08.114 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:13:08.120 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:13:08.121 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 11:13:08.122 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCAwMy4lFMdw9BJyY8XmEvob2zKq3T_1FM6B2kqXfDYvJHKB66DXo1BlbBzzBI38MvghvbuhaiOR6HE3s0fAWBYuyDvdibQTYMWJoWClGWxJE7pB88HjGdLzPuEexu0JFHcM_HbDehQvi7S_Cf-91BFBZ8DcXwlaMCjVvTL1o-3Ckr0irVEPOzHuDDZjDZ-e12jCADeYbdVcf1UTTJHNbgnzTMQtXaeM1bkYMI7Z1_KvdVlyknYKpadPlC9Qsq2nIA-Jz0bL1RVowLlNOxGY5XroOEP_ewqqYAEZQcSvhJAAP2lbMb79_LohEht-zEBO04","UiLocales":null,"Nonce":"636875395533931907.ZDJhYjcyOGMtNGQxOS00NTE0LTgzZTQtNDYwOTdkZDFlOWQyMGEwMjJjNDktOTliYi00YzRjLTk3ODUtZjhmOWQwZDM0ODU5","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"807633b61eac89d09ac0a2e64d49ed35","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875395533931907.ZDJhYjcyOGMtNGQxOS00NTE0LTgzZTQtNDYwOTdkZDFlOWQyMGEwMjJjNDktOTliYi00YzRjLTk3ODUtZjhmOWQwZDM0ODU5","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCAwMy4lFMdw9BJyY8XmEvob2zKq3T_1FM6B2kqXfDYvJHKB66DXo1BlbBzzBI38MvghvbuhaiOR6HE3s0fAWBYuyDvdibQTYMWJoWClGWxJE7pB88HjGdLzPuEexu0JFHcM_HbDehQvi7S_Cf-91BFBZ8DcXwlaMCjVvTL1o-3Ckr0irVEPOzHuDDZjDZ-e12jCADeYbdVcf1UTTJHNbgnzTMQtXaeM1bkYMI7Z1_KvdVlyknYKpadPlC9Qsq2nIA-Jz0bL1RVowLlNOxGY5XroOEP_ewqqYAEZQcSvhJAAP2lbMb79_LohEht-zEBO04","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 11:13:50.880 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-07 11:13:50.887 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-07 11:13:50.924 +04:00 [DBG] Xd4U1w+Tn1kT05I/V5mdZrvyGHGm23CTrg+OnKMO864= not found in database
2019-03-07 11:13:50.953 +04:00 [DBG] Creating Implicit Flow response.
2019-03-07 11:13:50.964 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 11:13:50.967 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-07 11:13:51.044 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"1002","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****MIpA","$type":"Token"},{"TokenType":"code","TokenValue":"****d8ee","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2PGPAC89O:00000002","TimeStamp":"2019-03-07T07:13:51.0000000Z","ProcessId":1204,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 11:13:51.053 +04:00 [INF] Authorize endpoint response
{"SubjectId":"1002","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCAwMy4lFMdw9BJyY8XmEvob2zKq3T_1FM6B2kqXfDYvJHKB66DXo1BlbBzzBI38MvghvbuhaiOR6HE3s0fAWBYuyDvdibQTYMWJoWClGWxJE7pB88HjGdLzPuEexu0JFHcM_HbDehQvi7S_Cf-91BFBZ8DcXwlaMCjVvTL1o-3Ckr0irVEPOzHuDDZjDZ-e12jCADeYbdVcf1UTTJHNbgnzTMQtXaeM1bkYMI7Z1_KvdVlyknYKpadPlC9Qsq2nIA-Jz0bL1RVowLlNOxGY5XroOEP_ewqqYAEZQcSvhJAAP2lbMb79_LohEht-zEBO04","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-07 11:13:51.078 +04:00 [DBG] Augmenting SignInContext
2019-03-07 11:13:51.080 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 11:13:51.217 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-07 11:13:59.778 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-07 11:13:59.780 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-07 11:13:59.791 +04:00 [DBG] Start token request.
2019-03-07 11:13:59.796 +04:00 [DBG] Start client validation
2019-03-07 11:13:59.801 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-07 11:13:59.808 +04:00 [DBG] Start parsing for secret in post body
2019-03-07 11:13:59.810 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-07 11:13:59.810 +04:00 [DBG] Secret id found: BiLab
2019-03-07 11:13:59.832 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:13:59.832 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:13:59.845 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-07 11:13:59.845 +04:00 [DBG] Client validation success
2019-03-07 11:13:59.847 +04:00 [INF] {"ClientId":"BiLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLL2PGPAC89L:00000003","TimeStamp":"2019-03-07T07:13:59.0000000Z","ProcessId":1204,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-03-07 11:13:59.857 +04:00 [DBG] Start token request validation
2019-03-07 11:13:59.865 +04:00 [DBG] Start validation of authorization code token request
2019-03-07 11:13:59.881 +04:00 [DBG] Xd4U1w+Tn1kT05I/V5mdZrvyGHGm23CTrg+OnKMO864= found in database: true
2019-03-07 11:13:59.900 +04:00 [DBG] removing Xd4U1w+Tn1kT05I/V5mdZrvyGHGm23CTrg+OnKMO864= persisted grant from database
2019-03-07 11:14:13.753 +04:00 [DBG] Validation of authorization code token request success
2019-03-07 11:14:13.759 +04:00 [INF] Token request validation success
{"ClientId":"BiLab","ClientName":"BiLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"10aa7819526f3b491b73d03e3dc13df4aff3aa223f45a3f9e73947266e2ed8ee","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"BiLab","client_secret":"***REDACTED***","code":"10aa7819526f3b491b73d03e3dc13df4aff3aa223f45a3f9e73947266e2ed8ee","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-03-07 11:14:13.800 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:14:13.800 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:14:13.809 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:14:13.816 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:14:13.827 +04:00 [DBG] Getting claims for access token for client: BiLab
2019-03-07 11:14:13.827 +04:00 [DBG] Getting claims for access token for subject: 1002
2019-03-07 11:15:26.600 +04:00 [DBG] Creating refresh token
2019-03-07 11:15:26.601 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-03-07 11:15:26.616 +04:00 [DBG] DL9qSYda5zTp3KQelG29GX8S7dvjC5RbO1L0M/syFow= not found in database
2019-03-07 11:15:26.642 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:15:26.642 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:15:26.653 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:15:26.660 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:15:26.661 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 11:15:26.666 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-07 11:15:26.673 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****lozQ","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****7668","$type":"Token"},{"TokenType":"access_token","TokenValue":"****tktg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2PGPAC89L:00000003","TimeStamp":"2019-03-07T07:15:26.0000000Z","ProcessId":1204,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 11:15:26.680 +04:00 [DBG] Token request success.
2019-03-07 11:16:16.079 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 11:16:20.749 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 11:16:20.751 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 11:16:20.752 +04:00 [DBG] Start authorize request
2019-03-07 11:16:20.753 +04:00 [DBG] User in authorize request: 1002
2019-03-07 11:16:20.753 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 11:16:20.780 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:16:20.781 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:16:20.783 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 11:16:20.784 +04:00 [DBG] No PKCE used.
2019-03-07 11:16:20.792 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:16:20.801 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:16:20.804 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:16:20.807 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:16:20.808 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 11:16:20.812 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAlJubvfrRrwMZHF6T7R_r6aN_R7OABWOuJaj99s_vI5fP2NrOxouIkN8EJW99418IkRK5FDBjP6_68FgxIMZ2fjseY_DhDKKWYio0_jsgQS2pMs3lilnPEDCoYYHVcjgtXNK75JfCn_FmHRXslcn5J8aGbMDpuKv4-fT82y23spPH1aMASXb36tP3bTSaz3IPvKOwBBGdzF31SiqdwydwmytpG-19JLKju_ZjtBsoxoJ_2qJlGiDVX-JsbLxlGiI89iy6c2wG1hGJA8L1WC_w_u_TNJSY-wbv9Bxiu16W1IvHsZOYaagL5S9QmAwvStnA","UiLocales":null,"Nonce":"636875397760619066.OWRiOWFkYTItMWM3Zi00NDdjLTkyOTgtM2E0MTFkMjdkNmY3NDZlMzJjYTctMmJjYy00YmNjLWI4OWItNDIwMWZmODZmMWQ5","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"807633b61eac89d09ac0a2e64d49ed35","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875397760619066.OWRiOWFkYTItMWM3Zi00NDdjLTkyOTgtM2E0MTFkMjdkNmY3NDZlMzJjYTctMmJjYy00YmNjLWI4OWItNDIwMWZmODZmMWQ5","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAlJubvfrRrwMZHF6T7R_r6aN_R7OABWOuJaj99s_vI5fP2NrOxouIkN8EJW99418IkRK5FDBjP6_68FgxIMZ2fjseY_DhDKKWYio0_jsgQS2pMs3lilnPEDCoYYHVcjgtXNK75JfCn_FmHRXslcn5J8aGbMDpuKv4-fT82y23spPH1aMASXb36tP3bTSaz3IPvKOwBBGdzF31SiqdwydwmytpG-19JLKju_ZjtBsoxoJ_2qJlGiDVX-JsbLxlGiI89iy6c2wG1hGJA8L1WC_w_u_TNJSY-wbv9Bxiu16W1IvHsZOYaagL5S9QmAwvStnA","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 11:16:22.706 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-07 11:16:22.708 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-07 11:16:22.712 +04:00 [DBG] zCwnvgCqrKGN/qcviub/ONMvOcOipsv/w1n8dYb6ZKA= not found in database
2019-03-07 11:16:22.718 +04:00 [DBG] Creating Implicit Flow response.
2019-03-07 11:16:22.718 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 11:16:22.720 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-07 11:16:22.726 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"1002","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****T64w","$type":"Token"},{"TokenType":"code","TokenValue":"****ec61","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2PGPAC89O:00000003","TimeStamp":"2019-03-07T07:16:22.0000000Z","ProcessId":1204,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 11:16:22.735 +04:00 [INF] Authorize endpoint response
{"SubjectId":"1002","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAlJubvfrRrwMZHF6T7R_r6aN_R7OABWOuJaj99s_vI5fP2NrOxouIkN8EJW99418IkRK5FDBjP6_68FgxIMZ2fjseY_DhDKKWYio0_jsgQS2pMs3lilnPEDCoYYHVcjgtXNK75JfCn_FmHRXslcn5J8aGbMDpuKv4-fT82y23spPH1aMASXb36tP3bTSaz3IPvKOwBBGdzF31SiqdwydwmytpG-19JLKju_ZjtBsoxoJ_2qJlGiDVX-JsbLxlGiI89iy6c2wG1hGJA8L1WC_w_u_TNJSY-wbv9Bxiu16W1IvHsZOYaagL5S9QmAwvStnA","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-07 11:16:22.835 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-07 11:16:22.838 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-07 11:16:22.839 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-07 11:16:22.840 +04:00 [DBG] Start token request.
2019-03-07 11:16:22.840 +04:00 [DBG] Start client validation
2019-03-07 11:16:22.841 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-07 11:16:22.841 +04:00 [DBG] Start parsing for secret in post body
2019-03-07 11:16:22.842 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-07 11:16:22.842 +04:00 [DBG] Secret id found: BiLab
2019-03-07 11:16:22.848 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:16:22.849 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:16:22.851 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-07 11:16:22.851 +04:00 [DBG] Client validation success
2019-03-07 11:16:22.852 +04:00 [INF] {"ClientId":"BiLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLL2PGPAC89P:00000001","TimeStamp":"2019-03-07T07:16:22.0000000Z","ProcessId":1204,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-03-07 11:16:22.855 +04:00 [DBG] Start token request validation
2019-03-07 11:16:22.856 +04:00 [DBG] Start validation of authorization code token request
2019-03-07 11:16:22.858 +04:00 [DBG] zCwnvgCqrKGN/qcviub/ONMvOcOipsv/w1n8dYb6ZKA= found in database: true
2019-03-07 11:16:22.863 +04:00 [DBG] removing zCwnvgCqrKGN/qcviub/ONMvOcOipsv/w1n8dYb6ZKA= persisted grant from database
2019-03-07 11:16:23.477 +04:00 [DBG] Validation of authorization code token request success
2019-03-07 11:16:23.478 +04:00 [INF] Token request validation success
{"ClientId":"BiLab","ClientName":"BiLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"08601163bf4d1f91ee95d994e2561db74d7e77c5dc9b12828de25c032f2eec61","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"BiLab","client_secret":"***REDACTED***","code":"08601163bf4d1f91ee95d994e2561db74d7e77c5dc9b12828de25c032f2eec61","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-03-07 11:16:23.488 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:16:23.489 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:16:23.497 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:16:23.504 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:16:23.505 +04:00 [DBG] Getting claims for access token for client: BiLab
2019-03-07 11:16:23.506 +04:00 [DBG] Getting claims for access token for subject: 1002
2019-03-07 11:16:56.264 +04:00 [DBG] Creating refresh token
2019-03-07 11:16:56.265 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-03-07 11:16:56.268 +04:00 [DBG] ZMlJ1XJwSnhCQQ684XnfuY5UgOlSXKRx2U/gHn35MVw= not found in database
2019-03-07 11:16:56.294 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:16:56.295 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:16:56.306 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:16:56.312 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:16:56.313 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 11:16:56.316 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-07 11:16:56.319 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****Ufvw","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****7c6d","$type":"Token"},{"TokenType":"access_token","TokenValue":"****T3Aw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2PGPAC89P:00000001","TimeStamp":"2019-03-07T07:16:56.0000000Z","ProcessId":1204,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 11:16:56.327 +04:00 [DBG] Token request success.
2019-03-07 11:16:56.351 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-03-07 11:16:56.359 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-03-07 11:16:56.360 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-03-07 11:16:56.367 +04:00 [DBG] Start userinfo request
2019-03-07 11:16:56.371 +04:00 [DBG] Bearer token found in header
2019-03-07 11:16:56.426 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:16:56.426 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:16:56.437 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:16:56.438 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:16:59.936 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-03-07 11:16:59.942 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1551943016,"exp":1551946616,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"BiLab","sub":"1002","auth_time":1551942782,"idp":"local","given_name":"godAdmin@admin.ru","role":"user","email":"godAdmin@admin.ru","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-03-07 11:17:01.245 +04:00 [DBG] Creating userinfo response
2019-03-07 11:17:01.248 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 11:17:01.252 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 11:17:01.256 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:17:01.259 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-03-07 11:17:01.260 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 11:17:01.262 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:17:12.958 +04:00 [INF] Profile service returned the following claim types: sub preferred_username name given_name role email
2019-03-07 11:17:12.960 +04:00 [DBG] End userinfo request
2019-03-07 11:19:28.166 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 11:19:28.174 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 11:19:28.176 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 11:19:28.180 +04:00 [DBG] Start authorize request
2019-03-07 11:19:28.181 +04:00 [DBG] No user present in authorize request
2019-03-07 11:19:28.181 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 11:19:28.200 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:19:28.201 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:19:28.203 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 11:19:28.204 +04:00 [DBG] No PKCE used.
2019-03-07 11:19:28.212 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:19:28.218 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:19:28.221 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:19:28.224 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:19:28.225 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 11:19:28.226 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBzQX3zI88WTWsh8ZPLzkz0kRcodewTY8UvoLBjgWMizHb_-hLUKc_CyMOjMEPkGbKZ0DTwCRSaT_CmdlMXiVaoOnz2XE5Gb7lOHFOaGmhwnEpLKK_7ut3G3NAZ9o3u2ZumgiegYm9NHzH9cqtTivzgz8YiayZaHIzV_QuERHJuYB8hoVHcIQY9oPvEQ5k7182bboHfdjnCwzgXVPKGAkDmiXcHZgK5vnZiYQ6Ycs-Xe3Cb_grgimBN1CVqTJ_fK2dOKJmK_uFFj8D5a1UeAAWXGlE3X9lVlLSnmW9dezsjcPleySsROVmMOauj6KR0a5c","UiLocales":null,"Nonce":"636875399681556082.OTM3ZDllZjAtMzBmYS00ODZhLTk3YzMtM2Y2YWZlMTg2NTQwODdhZTBkYTAtMTA1My00MzU4LWEwNmMtNzFlZjUzYjVjMjQy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875399681556082.OTM3ZDllZjAtMzBmYS00ODZhLTk3YzMtM2Y2YWZlMTg2NTQwODdhZTBkYTAtMTA1My00MzU4LWEwNmMtNzFlZjUzYjVjMjQy","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBzQX3zI88WTWsh8ZPLzkz0kRcodewTY8UvoLBjgWMizHb_-hLUKc_CyMOjMEPkGbKZ0DTwCRSaT_CmdlMXiVaoOnz2XE5Gb7lOHFOaGmhwnEpLKK_7ut3G3NAZ9o3u2ZumgiegYm9NHzH9cqtTivzgz8YiayZaHIzV_QuERHJuYB8hoVHcIQY9oPvEQ5k7182bboHfdjnCwzgXVPKGAkDmiXcHZgK5vnZiYQ6Ycs-Xe3Cb_grgimBN1CVqTJ_fK2dOKJmK_uFFj8D5a1UeAAWXGlE3X9lVlLSnmW9dezsjcPleySsROVmMOauj6KR0a5c","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 11:19:28.238 +04:00 [INF] Showing login: User is not authenticated
2019-03-07 11:19:33.379 +04:00 [DBG] Augmenting SignInContext
2019-03-07 11:19:33.379 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 11:19:33.381 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 11:19:33.382 +04:00 [DBG] Adding auth_time claim with value: 1551943173
2019-03-07 11:19:33.383 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 11:19:33.386 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2PGPAC89O:00000006","TimeStamp":"2019-03-07T07:19:33.0000000Z","ProcessId":1204,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 11:19:33.394 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-07 11:19:33.395 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-07 11:19:33.396 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-07 11:19:33.397 +04:00 [DBG] Start authorize callback request
2019-03-07 11:19:33.398 +04:00 [DBG] User in authorize request: 2
2019-03-07 11:19:33.398 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 11:19:33.418 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:19:33.419 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:19:33.421 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 11:19:33.421 +04:00 [DBG] No PKCE used.
2019-03-07 11:19:33.430 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:19:33.435 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:19:33.438 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:19:33.441 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:19:33.442 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 11:19:33.443 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBzQX3zI88WTWsh8ZPLzkz0kRcodewTY8UvoLBjgWMizHb_-hLUKc_CyMOjMEPkGbKZ0DTwCRSaT_CmdlMXiVaoOnz2XE5Gb7lOHFOaGmhwnEpLKK_7ut3G3NAZ9o3u2ZumgiegYm9NHzH9cqtTivzgz8YiayZaHIzV_QuERHJuYB8hoVHcIQY9oPvEQ5k7182bboHfdjnCwzgXVPKGAkDmiXcHZgK5vnZiYQ6Ycs-Xe3Cb_grgimBN1CVqTJ_fK2dOKJmK_uFFj8D5a1UeAAWXGlE3X9lVlLSnmW9dezsjcPleySsROVmMOauj6KR0a5c","UiLocales":null,"Nonce":"636875399681556082.OTM3ZDllZjAtMzBmYS00ODZhLTk3YzMtM2Y2YWZlMTg2NTQwODdhZTBkYTAtMTA1My00MzU4LWEwNmMtNzFlZjUzYjVjMjQy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"bbf389116fd1728cb6f7f18dace28cbe","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875399681556082.OTM3ZDllZjAtMzBmYS00ODZhLTk3YzMtM2Y2YWZlMTg2NTQwODdhZTBkYTAtMTA1My00MzU4LWEwNmMtNzFlZjUzYjVjMjQy","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBzQX3zI88WTWsh8ZPLzkz0kRcodewTY8UvoLBjgWMizHb_-hLUKc_CyMOjMEPkGbKZ0DTwCRSaT_CmdlMXiVaoOnz2XE5Gb7lOHFOaGmhwnEpLKK_7ut3G3NAZ9o3u2ZumgiegYm9NHzH9cqtTivzgz8YiayZaHIzV_QuERHJuYB8hoVHcIQY9oPvEQ5k7182bboHfdjnCwzgXVPKGAkDmiXcHZgK5vnZiYQ6Ycs-Xe3Cb_grgimBN1CVqTJ_fK2dOKJmK_uFFj8D5a1UeAAWXGlE3X9lVlLSnmW9dezsjcPleySsROVmMOauj6KR0a5c","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 11:19:36.979 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-07 11:19:36.980 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-07 11:19:36.983 +04:00 [DBG] eukvnA50T7WvvpRq22a1F5dVjL83OfwzHb2J7s+iqb4= not found in database
2019-03-07 11:19:36.988 +04:00 [DBG] Creating Implicit Flow response.
2019-03-07 11:19:36.989 +04:00 [DBG] Getting claims for identity token for subject: 2 and client: BiLab
2019-03-07 11:19:36.992 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-07 11:19:37.000 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"2","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****1uTQ","$type":"Token"},{"TokenType":"code","TokenValue":"****a7de","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2PGPAC89O:00000007","TimeStamp":"2019-03-07T07:19:37.0000000Z","ProcessId":1204,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 11:19:37.007 +04:00 [INF] Authorize endpoint response
{"SubjectId":"2","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBzQX3zI88WTWsh8ZPLzkz0kRcodewTY8UvoLBjgWMizHb_-hLUKc_CyMOjMEPkGbKZ0DTwCRSaT_CmdlMXiVaoOnz2XE5Gb7lOHFOaGmhwnEpLKK_7ut3G3NAZ9o3u2ZumgiegYm9NHzH9cqtTivzgz8YiayZaHIzV_QuERHJuYB8hoVHcIQY9oPvEQ5k7182bboHfdjnCwzgXVPKGAkDmiXcHZgK5vnZiYQ6Ycs-Xe3Cb_grgimBN1CVqTJ_fK2dOKJmK_uFFj8D5a1UeAAWXGlE3X9lVlLSnmW9dezsjcPleySsROVmMOauj6KR0a5c","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-07 11:19:37.016 +04:00 [DBG] Augmenting SignInContext
2019-03-07 11:19:37.016 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 11:19:37.070 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-07 11:19:37.072 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-07 11:19:37.074 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-07 11:19:37.075 +04:00 [DBG] Start token request.
2019-03-07 11:19:37.076 +04:00 [DBG] Start client validation
2019-03-07 11:19:37.077 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-07 11:19:37.078 +04:00 [DBG] Start parsing for secret in post body
2019-03-07 11:19:37.080 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-07 11:19:37.080 +04:00 [DBG] Secret id found: BiLab
2019-03-07 11:19:37.102 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:19:37.103 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:19:37.105 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-07 11:19:37.106 +04:00 [DBG] Client validation success
2019-03-07 11:19:37.107 +04:00 [INF] {"ClientId":"BiLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLL2PGPAC89R:00000001","TimeStamp":"2019-03-07T07:19:37.0000000Z","ProcessId":1204,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-03-07 11:19:37.110 +04:00 [DBG] Start token request validation
2019-03-07 11:19:37.111 +04:00 [DBG] Start validation of authorization code token request
2019-03-07 11:19:37.117 +04:00 [DBG] eukvnA50T7WvvpRq22a1F5dVjL83OfwzHb2J7s+iqb4= found in database: true
2019-03-07 11:19:37.119 +04:00 [DBG] removing eukvnA50T7WvvpRq22a1F5dVjL83OfwzHb2J7s+iqb4= persisted grant from database
2019-03-07 11:19:37.714 +04:00 [DBG] Validation of authorization code token request success
2019-03-07 11:19:37.714 +04:00 [INF] Token request validation success
{"ClientId":"BiLab","ClientName":"BiLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"60cae5d851eecd3b47ec67b1ba6ad3bddd0c12e90d73d0e5960a6008a06aa7de","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"BiLab","client_secret":"***REDACTED***","code":"60cae5d851eecd3b47ec67b1ba6ad3bddd0c12e90d73d0e5960a6008a06aa7de","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-03-07 11:19:37.725 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:19:37.727 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:19:37.736 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:19:37.742 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:19:37.745 +04:00 [DBG] Getting claims for access token for client: BiLab
2019-03-07 11:19:37.749 +04:00 [DBG] Getting claims for access token for subject: 2
2019-03-07 11:20:15.408 +04:00 [DBG] Creating refresh token
2019-03-07 11:20:15.408 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-03-07 11:20:15.412 +04:00 [DBG] a7OxbntvU6Xg4QW8PnDeUvhV+h3kPvAZq/p5SJ6IT/4= not found in database
2019-03-07 11:20:15.434 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:20:15.435 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:20:15.445 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:20:15.452 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:20:15.454 +04:00 [DBG] Getting claims for identity token for subject: 2 and client: BiLab
2019-03-07 11:20:15.455 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-07 11:20:15.463 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****2ALg","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****b889","$type":"Token"},{"TokenType":"access_token","TokenValue":"****QXAQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2PGPAC89R:00000001","TimeStamp":"2019-03-07T07:20:15.0000000Z","ProcessId":1204,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 11:20:15.468 +04:00 [DBG] Token request success.
2019-03-07 11:20:15.471 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-03-07 11:20:15.475 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-03-07 11:20:15.476 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-03-07 11:20:15.477 +04:00 [DBG] Start userinfo request
2019-03-07 11:20:15.478 +04:00 [DBG] Bearer token found in header
2019-03-07 11:20:15.485 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:20:15.485 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:20:15.491 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:20:15.492 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:20:18.679 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-03-07 11:20:18.684 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1551943215,"exp":1551946815,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"BiLab","sub":"2","auth_time":1551943173,"idp":"local","given_name":"test@mail.ru","role":"user","email":"test@mail.ru","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-03-07 11:21:17.859 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 11:21:17.911 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 11:21:17.911 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 11:21:17.912 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 11:21:17.912 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 11:21:17.912 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 11:21:17.912 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 11:21:18.127 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:21:18.140 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:21:18.143 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:21:18.224 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 11:21:18.277 +04:00 [DBG] Starting grant removal
2019-03-07 11:21:19.185 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 11:21:19.190 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 11:21:19.192 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 11:21:19.194 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 11:21:19.195 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 11:21:19.195 +04:00 [DBG] Error Url: /home/error
2019-03-07 11:21:19.196 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 11:21:19.256 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 11:21:19.417 +04:00 [INF] AuthenticationScheme: Identity.Application was forbidden.
2019-03-07 11:21:35.772 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 11:21:35.778 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 11:21:35.779 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 11:21:35.785 +04:00 [DBG] Start discovery request
2019-03-07 11:21:36.276 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 11:21:36.418 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 11:21:36.422 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 11:21:36.423 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 11:21:36.427 +04:00 [DBG] Start key discovery request
2019-03-07 11:21:36.514 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 11:21:36.520 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 11:21:36.522 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 11:21:36.527 +04:00 [DBG] Start authorize request
2019-03-07 11:21:36.537 +04:00 [DBG] User in authorize request: 2
2019-03-07 11:21:36.542 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 11:21:36.847 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:21:36.857 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:21:36.865 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 11:21:36.869 +04:00 [DBG] No PKCE used.
2019-03-07 11:21:36.921 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:21:36.964 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:21:36.979 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:21:36.981 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:21:36.990 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 11:21:37.003 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDc6HAtGGgvAI9w5CoOEUWoOD4Xop3UcuqhLtReJBVDGaR4DbpXV7w8hTrYgXM3vE7ze9MGdDr2bwNjmiTXoD8vphbRNQpfHnh58mlLzthk_F1y6cT97-NyRUFWP4rWeqI6fUufysryLXDaFBLs100XzjAAAn9-2zH5awbs3XmsyidcVMZ9PdRyQ3n_0OH9ZrCwfwGxtjUYdrFdkpRecObLwrTiZM01J3oyqYaq2iH39AxYeq-cmqWDJ7_7Omgli4JTgAVFGc5_A7XUXbhoKzoj-C8A50VUZGxKPYC16SaxJM9dEqZZGLLVL2mNrsn_nQw","UiLocales":null,"Nonce":"636875400964901544.MTZhMmI5NDgtMGY2Ny00YWE0LTg2OTktMTAyMTU3YzI2NzgxMDFkMmEwYWUtMzQ0My00MTFiLTk2YTUtMTYyNDg1ZDI4Mzgz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"bbf389116fd1728cb6f7f18dace28cbe","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875400964901544.MTZhMmI5NDgtMGY2Ny00YWE0LTg2OTktMTAyMTU3YzI2NzgxMDFkMmEwYWUtMzQ0My00MTFiLTk2YTUtMTYyNDg1ZDI4Mzgz","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDc6HAtGGgvAI9w5CoOEUWoOD4Xop3UcuqhLtReJBVDGaR4DbpXV7w8hTrYgXM3vE7ze9MGdDr2bwNjmiTXoD8vphbRNQpfHnh58mlLzthk_F1y6cT97-NyRUFWP4rWeqI6fUufysryLXDaFBLs100XzjAAAn9-2zH5awbs3XmsyidcVMZ9PdRyQ3n_0OH9ZrCwfwGxtjUYdrFdkpRecObLwrTiZM01J3oyqYaq2iH39AxYeq-cmqWDJ7_7Omgli4JTgAVFGc5_A7XUXbhoKzoj-C8A50VUZGxKPYC16SaxJM9dEqZZGLLVL2mNrsn_nQw","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 11:21:40.926 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-07 11:21:40.931 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-07 11:21:40.990 +04:00 [DBG] uq22eSgU5JmM8kp5rbUxPhTYRLf/j74Qt7hs1lxx+4E= not found in database
2019-03-07 11:21:41.055 +04:00 [DBG] Creating Implicit Flow response.
2019-03-07 11:21:41.065 +04:00 [DBG] Getting claims for identity token for subject: 2 and client: BiLab
2019-03-07 11:21:41.068 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-07 11:21:41.168 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"2","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****CqjA","$type":"Token"},{"TokenType":"code","TokenValue":"****8c84","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2PLV149PO:00000004","TimeStamp":"2019-03-07T07:21:41.0000000Z","ProcessId":16796,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 11:21:41.178 +04:00 [INF] Authorize endpoint response
{"SubjectId":"2","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDc6HAtGGgvAI9w5CoOEUWoOD4Xop3UcuqhLtReJBVDGaR4DbpXV7w8hTrYgXM3vE7ze9MGdDr2bwNjmiTXoD8vphbRNQpfHnh58mlLzthk_F1y6cT97-NyRUFWP4rWeqI6fUufysryLXDaFBLs100XzjAAAn9-2zH5awbs3XmsyidcVMZ9PdRyQ3n_0OH9ZrCwfwGxtjUYdrFdkpRecObLwrTiZM01J3oyqYaq2iH39AxYeq-cmqWDJ7_7Omgli4JTgAVFGc5_A7XUXbhoKzoj-C8A50VUZGxKPYC16SaxJM9dEqZZGLLVL2mNrsn_nQw","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-07 11:21:41.307 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-07 11:21:41.313 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-07 11:21:41.314 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-07 11:21:41.323 +04:00 [DBG] Start token request.
2019-03-07 11:21:41.330 +04:00 [DBG] Start client validation
2019-03-07 11:21:41.335 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-07 11:21:41.343 +04:00 [DBG] Start parsing for secret in post body
2019-03-07 11:21:41.363 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-07 11:21:41.364 +04:00 [DBG] Secret id found: BiLab
2019-03-07 11:21:41.388 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:21:41.389 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:21:41.399 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-07 11:21:41.399 +04:00 [DBG] Client validation success
2019-03-07 11:21:41.401 +04:00 [INF] {"ClientId":"BiLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLL2PLV149PQ:00000003","TimeStamp":"2019-03-07T07:21:41.0000000Z","ProcessId":16796,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-03-07 11:21:41.410 +04:00 [DBG] Start token request validation
2019-03-07 11:21:41.419 +04:00 [DBG] Start validation of authorization code token request
2019-03-07 11:21:41.435 +04:00 [DBG] uq22eSgU5JmM8kp5rbUxPhTYRLf/j74Qt7hs1lxx+4E= found in database: true
2019-03-07 11:21:41.452 +04:00 [DBG] removing uq22eSgU5JmM8kp5rbUxPhTYRLf/j74Qt7hs1lxx+4E= persisted grant from database
2019-03-07 11:21:43.935 +04:00 [DBG] Validation of authorization code token request success
2019-03-07 11:21:43.941 +04:00 [INF] Token request validation success
{"ClientId":"BiLab","ClientName":"BiLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"20c2b5d970fac9e0fb0170473844c4cb948286840acfdc8e1fee50c58d0c8c84","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"BiLab","client_secret":"***REDACTED***","code":"20c2b5d970fac9e0fb0170473844c4cb948286840acfdc8e1fee50c58d0c8c84","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-03-07 11:21:43.977 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:21:43.978 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:21:43.987 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:21:43.994 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:21:44.004 +04:00 [DBG] Getting claims for access token for client: BiLab
2019-03-07 11:21:44.005 +04:00 [DBG] Getting claims for access token for subject: 2
2019-03-07 11:21:57.486 +04:00 [DBG] Claim types from profile service that were filtered: ["sub","idp","amr","auth_time"]
2019-03-07 11:21:57.493 +04:00 [DBG] Creating refresh token
2019-03-07 11:21:57.493 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-03-07 11:21:57.507 +04:00 [DBG] kIo48EqUxZ1cBtFl+hS9sr97m0jdHS1JbDTnf/mE82U= not found in database
2019-03-07 11:21:57.535 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:21:57.535 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:21:57.545 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:21:57.553 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:21:57.555 +04:00 [DBG] Getting claims for identity token for subject: 2 and client: BiLab
2019-03-07 11:21:57.557 +04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-03-07 11:21:57.562 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****pKeg","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****5b33","$type":"Token"},{"TokenType":"access_token","TokenValue":"****bYqw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2PLV149PQ:00000003","TimeStamp":"2019-03-07T07:21:57.0000000Z","ProcessId":16796,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 11:21:57.573 +04:00 [DBG] Token request success.
2019-03-07 11:21:57.586 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-03-07 11:21:57.588 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-03-07 11:21:57.591 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-03-07 11:21:57.598 +04:00 [DBG] Start userinfo request
2019-03-07 11:21:57.602 +04:00 [DBG] Bearer token found in header
2019-03-07 11:21:57.659 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:21:57.659 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:21:57.668 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:21:57.668 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:21:57.671 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-03-07 11:21:57.674 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1551943317,"exp":1551946917,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"BiLab","sub":"2","auth_time":1551943173,"idp":"local","AspNet.Identity.SecurityStamp":"RUYKCWHO26U6OEQYLNO7G7V2RE44ETDK","role":"user","preferred_username":"test@mail.ru","name":"test@mail.ru","email":"test@mail.ru","email_verified":false,"scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-03-07 11:21:57.685 +04:00 [DBG] Creating userinfo response
2019-03-07 11:21:57.689 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 11:21:57.693 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 11:21:57.701 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:21:57.703 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-03-07 11:21:57.704 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 11:21:57.707 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:21:58.679 +04:00 [INF] Profile service returned the following claim types: sub auth_time idp AspNet.Identity.SecurityStamp role preferred_username name email email_verified amr
2019-03-07 11:21:58.684 +04:00 [DBG] End userinfo request
2019-03-07 11:28:03.774 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 11:28:03.825 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 11:28:03.826 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 11:28:03.826 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 11:28:03.826 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 11:28:03.827 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 11:28:03.827 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 11:28:04.045 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:28:04.060 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:28:04.063 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:28:04.141 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 11:28:04.205 +04:00 [DBG] Starting grant removal
2019-03-07 11:28:05.236 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 11:28:05.240 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 11:28:05.241 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 11:28:05.242 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 11:28:05.243 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 11:28:05.244 +04:00 [DBG] Error Url: /home/error
2019-03-07 11:28:05.245 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 11:28:05.306 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 11:28:05.475 +04:00 [INF] AuthenticationScheme: Identity.Application was forbidden.
2019-03-07 11:28:12.732 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-03-07 11:28:12.734 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-03-07 11:28:12.736 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-03-07 11:28:17.441 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-07 11:28:20.463 +04:00 [DBG] Augmenting SignInContext
2019-03-07 11:28:20.473 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 11:28:20.473 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 11:28:20.475 +04:00 [DBG] Adding auth_time claim with value: 1551943700
2019-03-07 11:28:20.483 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 11:28:20.524 +04:00 [INF] {"Username":"godAdmin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"1002","DisplayName":"godAdmin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2PPO0VGCH:00000008","TimeStamp":"2019-03-07T07:28:20.0000000Z","ProcessId":12796,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 11:28:28.281 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 11:28:28.402 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 11:28:28.408 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 11:28:28.408 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 11:28:28.409 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 11:28:28.409 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 11:28:28.410 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 11:28:28.670 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:28:28.685 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:28:28.692 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:28:28.774 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 11:28:28.839 +04:00 [DBG] Starting grant removal
2019-03-07 11:28:29.411 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 11:28:29.416 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 11:28:29.418 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 11:28:29.419 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 11:28:29.419 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 11:28:29.420 +04:00 [DBG] Error Url: /home/error
2019-03-07 11:28:29.421 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 11:28:29.496 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 11:35:42.217 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 11:35:42.267 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 11:35:42.268 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 11:35:42.268 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 11:35:42.268 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 11:35:42.269 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 11:35:42.269 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 11:35:42.493 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:35:42.508 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:35:42.514 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:35:42.596 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 11:35:42.657 +04:00 [DBG] Starting grant removal
2019-03-07 11:35:43.730 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 11:35:43.733 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 11:35:43.735 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 11:35:43.736 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 11:35:43.736 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 11:35:43.737 +04:00 [DBG] Error Url: /home/error
2019-03-07 11:35:43.738 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 11:35:43.786 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 11:35:51.636 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 11:35:51.686 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 11:35:51.687 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 11:35:51.688 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 11:35:51.688 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 11:35:51.689 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 11:35:51.689 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 11:35:51.882 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:35:51.896 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:35:51.898 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:35:51.972 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 11:35:52.026 +04:00 [DBG] Starting grant removal
2019-03-07 11:35:52.465 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 11:35:52.471 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 11:35:52.472 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 11:35:52.474 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 11:35:52.475 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 11:35:52.475 +04:00 [DBG] Error Url: /home/error
2019-03-07 11:35:52.476 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 11:35:52.535 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 11:38:58.213 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 11:38:58.272 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 11:38:58.272 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 11:38:58.272 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 11:38:58.273 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 11:38:58.273 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 11:38:58.273 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 11:38:58.525 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:38:58.539 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:38:58.541 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:38:58.620 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 11:38:58.690 +04:00 [DBG] Starting grant removal
2019-03-07 11:38:59.392 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 11:38:59.396 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 11:38:59.398 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 11:38:59.399 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 11:38:59.401 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 11:38:59.402 +04:00 [DBG] Error Url: /home/error
2019-03-07 11:38:59.403 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 11:38:59.456 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 11:40:09.624 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 11:40:09.676 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 11:40:09.677 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 11:40:09.678 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 11:40:09.678 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 11:40:09.678 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 11:40:09.679 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 11:40:09.894 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:40:09.910 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:40:09.913 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:40:09.992 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 11:40:10.050 +04:00 [DBG] Starting grant removal
2019-03-07 11:40:10.817 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 11:40:10.820 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 11:40:10.822 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 11:40:10.823 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 11:40:10.823 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 11:40:10.824 +04:00 [DBG] Error Url: /home/error
2019-03-07 11:40:10.825 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 11:40:10.884 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 11:40:18.416 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 11:40:18.466 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 11:40:18.467 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 11:40:18.467 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 11:40:18.468 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 11:40:18.468 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 11:40:18.468 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 11:40:18.691 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:40:18.739 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:40:18.767 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:40:18.858 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 11:40:18.921 +04:00 [DBG] Starting grant removal
2019-03-07 11:40:19.574 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 11:40:19.579 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 11:40:19.581 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 11:40:19.581 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 11:40:19.582 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 11:40:19.583 +04:00 [DBG] Error Url: /home/error
2019-03-07 11:40:19.584 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 11:40:19.652 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 11:42:29.520 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 11:42:29.575 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 11:42:29.575 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 11:42:29.576 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 11:42:29.576 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 11:42:29.576 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 11:42:29.577 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 11:42:29.806 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:42:29.821 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:42:29.824 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:42:29.904 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 11:42:29.962 +04:00 [DBG] Starting grant removal
2019-03-07 11:42:30.802 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 11:42:30.807 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 11:42:30.808 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 11:42:30.809 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 11:42:30.810 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 11:42:30.810 +04:00 [DBG] Error Url: /home/error
2019-03-07 11:42:30.811 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 11:42:30.866 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 11:43:13.990 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 11:43:14.048 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 11:43:14.049 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 11:43:14.049 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 11:43:14.049 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 11:43:14.049 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 11:43:14.050 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 11:43:14.366 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:43:14.379 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:43:14.391 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:43:14.485 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 11:43:14.550 +04:00 [DBG] Starting grant removal
2019-03-07 11:43:15.198 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 11:43:15.201 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 11:43:15.202 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 11:43:15.203 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 11:43:15.204 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 11:43:15.205 +04:00 [DBG] Error Url: /home/error
2019-03-07 11:43:15.205 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 11:43:15.275 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 11:43:36.677 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 11:43:36.683 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 11:43:36.684 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 11:43:36.690 +04:00 [DBG] Start discovery request
2019-03-07 11:43:37.180 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 11:43:37.335 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 11:43:37.337 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 11:43:37.338 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 11:43:37.343 +04:00 [DBG] Start key discovery request
2019-03-07 11:43:37.437 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 11:43:37.445 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 11:43:37.446 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 11:43:37.452 +04:00 [DBG] Start authorize request
2019-03-07 11:43:37.464 +04:00 [DBG] No user present in authorize request
2019-03-07 11:43:37.468 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 11:43:37.742 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:43:37.749 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:43:37.754 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 11:43:37.756 +04:00 [DBG] No PKCE used.
2019-03-07 11:43:37.801 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:43:37.840 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:43:37.849 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:43:37.852 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:43:37.861 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 11:43:37.875 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCAbLtpzVOweX2wM1V34SCRVwk79G7-w9deHTJ-CXnDTSkTmbBsbY_AESv1Jyp8nK_7xoHQQL2GalNETjqdVOdt_xV7cxQpUokzDDsHRMTsFK3V6HSZE4wTUW22d4SwZsWpzwkAvyBKrO8qdp-77gMwhc-28b9oiBjrRikhLdUAWucypSWDtAnYkhlKycOEtwG8VYXfcnjH5BmNozbJzc60L_y3sxzdd3qUNCAqSbUoJxw7zgG2dcTvWSTQ3unOPYyBs4F88alqTg_cU2z8aJhO554SPQIJfnTS0hU3P1Bkx2eIs2oZPkKUKHN3w0qa77M","UiLocales":null,"Nonce":"636875414174063932.YmEyMTkxODYtZWYwMy00Yjg5LTkxOGUtMjNiZGY4MjdiNWNlYWM5YWM4YTktNWUwMC00OThiLWJhMTgtNjQ4NGNjNjk0YTQx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875414174063932.YmEyMTkxODYtZWYwMy00Yjg5LTkxOGUtMjNiZGY4MjdiNWNlYWM5YWM4YTktNWUwMC00OThiLWJhMTgtNjQ4NGNjNjk0YTQx","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCAbLtpzVOweX2wM1V34SCRVwk79G7-w9deHTJ-CXnDTSkTmbBsbY_AESv1Jyp8nK_7xoHQQL2GalNETjqdVOdt_xV7cxQpUokzDDsHRMTsFK3V6HSZE4wTUW22d4SwZsWpzwkAvyBKrO8qdp-77gMwhc-28b9oiBjrRikhLdUAWucypSWDtAnYkhlKycOEtwG8VYXfcnjH5BmNozbJzc60L_y3sxzdd3qUNCAqSbUoJxw7zgG2dcTvWSTQ3unOPYyBs4F88alqTg_cU2z8aJhO554SPQIJfnTS0hU3P1Bkx2eIs2oZPkKUKHN3w0qa77M","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 11:43:37.902 +04:00 [INF] Showing login: User is not authenticated
2019-03-07 11:43:45.998 +04:00 [DBG] Augmenting SignInContext
2019-03-07 11:43:46.001 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 11:43:46.002 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 11:43:46.003 +04:00 [DBG] Adding auth_time claim with value: 1551944625
2019-03-07 11:43:46.014 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 11:43:46.046 +04:00 [INF] {"Username":"godAdmin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"1002","DisplayName":"godAdmin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2Q276PCUU:00000004","TimeStamp":"2019-03-07T07:43:46.0000000Z","ProcessId":7076,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 11:43:46.089 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-07 11:43:46.091 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-07 11:43:46.093 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-07 11:43:46.103 +04:00 [DBG] Start authorize callback request
2019-03-07 11:43:46.107 +04:00 [DBG] User in authorize request: 1002
2019-03-07 11:43:46.108 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 11:43:46.113 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:43:46.113 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:43:46.115 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 11:43:46.115 +04:00 [DBG] No PKCE used.
2019-03-07 11:43:46.119 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:43:46.122 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:43:46.124 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:43:46.126 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:43:46.127 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 11:43:46.128 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCAbLtpzVOweX2wM1V34SCRVwk79G7-w9deHTJ-CXnDTSkTmbBsbY_AESv1Jyp8nK_7xoHQQL2GalNETjqdVOdt_xV7cxQpUokzDDsHRMTsFK3V6HSZE4wTUW22d4SwZsWpzwkAvyBKrO8qdp-77gMwhc-28b9oiBjrRikhLdUAWucypSWDtAnYkhlKycOEtwG8VYXfcnjH5BmNozbJzc60L_y3sxzdd3qUNCAqSbUoJxw7zgG2dcTvWSTQ3unOPYyBs4F88alqTg_cU2z8aJhO554SPQIJfnTS0hU3P1Bkx2eIs2oZPkKUKHN3w0qa77M","UiLocales":null,"Nonce":"636875414174063932.YmEyMTkxODYtZWYwMy00Yjg5LTkxOGUtMjNiZGY4MjdiNWNlYWM5YWM4YTktNWUwMC00OThiLWJhMTgtNjQ4NGNjNjk0YTQx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"935784b432dcc8f9804af8869920be90","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875414174063932.YmEyMTkxODYtZWYwMy00Yjg5LTkxOGUtMjNiZGY4MjdiNWNlYWM5YWM4YTktNWUwMC00OThiLWJhMTgtNjQ4NGNjNjk0YTQx","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCAbLtpzVOweX2wM1V34SCRVwk79G7-w9deHTJ-CXnDTSkTmbBsbY_AESv1Jyp8nK_7xoHQQL2GalNETjqdVOdt_xV7cxQpUokzDDsHRMTsFK3V6HSZE4wTUW22d4SwZsWpzwkAvyBKrO8qdp-77gMwhc-28b9oiBjrRikhLdUAWucypSWDtAnYkhlKycOEtwG8VYXfcnjH5BmNozbJzc60L_y3sxzdd3qUNCAqSbUoJxw7zgG2dcTvWSTQ3unOPYyBs4F88alqTg_cU2z8aJhO554SPQIJfnTS0hU3P1Bkx2eIs2oZPkKUKHN3w0qa77M","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 11:43:46.166 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-07 11:43:46.173 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-07 11:43:46.209 +04:00 [DBG] YtEBM/lM5MtgsUceJ3/mjm3/UPChcpJxRh5A5getI10= not found in database
2019-03-07 11:43:46.275 +04:00 [DBG] Creating Implicit Flow response.
2019-03-07 11:43:46.286 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 11:45:30.160 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 11:45:30.215 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 11:45:30.216 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 11:45:30.217 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 11:45:30.217 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 11:45:30.217 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 11:45:30.218 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 11:45:30.472 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:45:30.482 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:45:30.484 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:45:30.571 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 11:45:30.630 +04:00 [DBG] Starting grant removal
2019-03-07 11:45:31.359 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 11:45:31.362 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 11:45:31.366 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 11:45:31.366 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 11:45:31.367 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 11:45:31.367 +04:00 [DBG] Error Url: /home/error
2019-03-07 11:45:31.368 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 11:45:31.423 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 11:45:39.039 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 11:45:39.045 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 11:45:39.047 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 11:45:39.053 +04:00 [DBG] Start discovery request
2019-03-07 11:45:39.529 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 11:45:39.666 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 11:45:39.671 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 11:45:39.673 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 11:45:39.677 +04:00 [DBG] Start key discovery request
2019-03-07 11:45:39.761 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 11:45:39.769 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 11:45:39.771 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 11:45:39.777 +04:00 [DBG] Start authorize request
2019-03-07 11:45:39.788 +04:00 [DBG] User in authorize request: 1002
2019-03-07 11:45:39.792 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 11:45:40.076 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:45:40.083 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:45:40.090 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 11:45:40.092 +04:00 [DBG] No PKCE used.
2019-03-07 11:45:40.139 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:45:40.179 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:45:40.190 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:45:40.192 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:45:40.200 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 11:45:40.217 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCBjP1ZiGjdUBw4jSQRSKLMI_syG52EGxINn1Zn_zjaoNoKn_ey0K0DSIwdSIzMmox-W8fId8mcpMWMNQYtodTYz6yEtMKETkTMWfJKP9N5pNkfvJADaRPXiUutM2jGDuCO2Dkar_UenZPt3tVrOyvaOoHqrixd-GKhMB8Vo80ny54k4nkzkFCZb3ktR_mUxfrkA0JZbfh0B4hIfAApKMNds_XoYvoAqaeHpI2hy94B5AErHZGKW_dxZjdFf0aUpEMzKgRFukbN3bRVBbhoPTh2nj0Dv7sYsUTloFOdJfZL3AeYiWjtru26AwI7YCMLV1s","UiLocales":null,"Nonce":"636875415397367660.MWJkZDRkZGItM2UwYy00ZmMyLWIyODktMTU1Y2FjODYyZDYxYzhkMWU1ODctNWVmYi00OWMxLTgwYzAtM2FiZDRkZTY0NGMz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"935784b432dcc8f9804af8869920be90","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875415397367660.MWJkZDRkZGItM2UwYy00ZmMyLWIyODktMTU1Y2FjODYyZDYxYzhkMWU1ODctNWVmYi00OWMxLTgwYzAtM2FiZDRkZTY0NGMz","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCBjP1ZiGjdUBw4jSQRSKLMI_syG52EGxINn1Zn_zjaoNoKn_ey0K0DSIwdSIzMmox-W8fId8mcpMWMNQYtodTYz6yEtMKETkTMWfJKP9N5pNkfvJADaRPXiUutM2jGDuCO2Dkar_UenZPt3tVrOyvaOoHqrixd-GKhMB8Vo80ny54k4nkzkFCZb3ktR_mUxfrkA0JZbfh0B4hIfAApKMNds_XoYvoAqaeHpI2hy94B5AErHZGKW_dxZjdFf0aUpEMzKgRFukbN3bRVBbhoPTh2nj0Dv7sYsUTloFOdJfZL3AeYiWjtru26AwI7YCMLV1s","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 11:45:42.292 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-07 11:45:42.299 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-07 11:45:42.339 +04:00 [DBG] YbXWJvnUlPXV2fEX3SqK8X0jqG2G7/EkVkJ2BhAwaUs= not found in database
2019-03-07 11:45:42.396 +04:00 [DBG] Creating Implicit Flow response.
2019-03-07 11:45:42.405 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 11:46:31.657 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 11:46:31.764 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"1002","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****lneQ","$type":"Token"},{"TokenType":"code","TokenValue":"****4990","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2Q3FPFFHO:00000002","TimeStamp":"2019-03-07T07:46:31.0000000Z","ProcessId":2580,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 11:46:31.772 +04:00 [INF] Authorize endpoint response
{"SubjectId":"1002","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCBjP1ZiGjdUBw4jSQRSKLMI_syG52EGxINn1Zn_zjaoNoKn_ey0K0DSIwdSIzMmox-W8fId8mcpMWMNQYtodTYz6yEtMKETkTMWfJKP9N5pNkfvJADaRPXiUutM2jGDuCO2Dkar_UenZPt3tVrOyvaOoHqrixd-GKhMB8Vo80ny54k4nkzkFCZb3ktR_mUxfrkA0JZbfh0B4hIfAApKMNds_XoYvoAqaeHpI2hy94B5AErHZGKW_dxZjdFf0aUpEMzKgRFukbN3bRVBbhoPTh2nj0Dv7sYsUTloFOdJfZL3AeYiWjtru26AwI7YCMLV1s","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-07 11:46:31.799 +04:00 [DBG] Augmenting SignInContext
2019-03-07 11:46:31.811 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 11:46:31.964 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-07 11:46:31.970 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-07 11:46:31.971 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-07 11:46:31.981 +04:00 [DBG] Start token request.
2019-03-07 11:46:31.987 +04:00 [DBG] Start client validation
2019-03-07 11:46:31.993 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-07 11:46:31.998 +04:00 [DBG] Start parsing for secret in post body
2019-03-07 11:46:32.014 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-07 11:46:32.014 +04:00 [DBG] Secret id found: BiLab
2019-03-07 11:46:32.035 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:46:32.036 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:46:32.046 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-07 11:46:32.047 +04:00 [DBG] Client validation success
2019-03-07 11:46:32.048 +04:00 [INF] {"ClientId":"BiLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLL2Q3FPFFHP:00000003","TimeStamp":"2019-03-07T07:46:32.0000000Z","ProcessId":2580,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-03-07 11:46:32.058 +04:00 [DBG] Start token request validation
2019-03-07 11:46:32.068 +04:00 [DBG] Start validation of authorization code token request
2019-03-07 11:46:32.085 +04:00 [DBG] YbXWJvnUlPXV2fEX3SqK8X0jqG2G7/EkVkJ2BhAwaUs= found in database: true
2019-03-07 11:46:32.105 +04:00 [DBG] removing YbXWJvnUlPXV2fEX3SqK8X0jqG2G7/EkVkJ2BhAwaUs= persisted grant from database
2019-03-07 11:46:52.884 +04:00 [DBG] Validation of authorization code token request success
2019-03-07 11:46:52.893 +04:00 [INF] Token request validation success
{"ClientId":"BiLab","ClientName":"BiLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"a8f9413c7120d34c69b68aa0fad28eb3c61fd1fc136c794c5f7770066bd64990","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"BiLab","client_secret":"***REDACTED***","code":"a8f9413c7120d34c69b68aa0fad28eb3c61fd1fc136c794c5f7770066bd64990","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-03-07 11:46:52.935 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:46:52.935 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:46:52.946 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:46:52.952 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:46:52.964 +04:00 [DBG] Getting claims for access token for client: BiLab
2019-03-07 11:46:52.964 +04:00 [DBG] Getting claims for access token for subject: 1002
2019-03-07 11:47:01.918 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 11:47:01.929 +04:00 [DBG] Creating refresh token
2019-03-07 11:47:01.930 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-03-07 11:47:01.944 +04:00 [DBG] 6i38VdWmNU0q5I1JF3IIekLa4lColTQhs2nluy3v7Nw= not found in database
2019-03-07 11:47:01.957 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:47:01.958 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:47:01.962 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:47:01.967 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:47:01.968 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 11:47:06.709 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 11:47:06.715 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****oAuA","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****9605","$type":"Token"},{"TokenType":"access_token","TokenValue":"****1MMg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2Q3FPFFHP:00000003","TimeStamp":"2019-03-07T07:47:06.0000000Z","ProcessId":2580,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 11:47:06.729 +04:00 [DBG] Token request success.
2019-03-07 11:47:06.744 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-03-07 11:47:06.748 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-03-07 11:47:06.751 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-03-07 11:47:06.761 +04:00 [DBG] Start userinfo request
2019-03-07 11:47:06.764 +04:00 [DBG] Bearer token found in header
2019-03-07 11:47:06.823 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:47:06.824 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:47:06.832 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:47:06.832 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:47:08.374 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-03-07 11:47:08.378 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1551944821,"exp":1551948421,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"BiLab","sub":"1002","auth_time":1551944625,"idp":"local","AspNet.Identity.SecurityStamp":"YRQCMJ4XBHSYAYVIFGH3YHMVNOLY4SL5","role":"GodAdmin","preferred_username":"godAdmin@admin.ru","name":"godAdmin@admin.ru","email":"godAdmin@admin.ru","email_verified":false,"given_name":"godAdmin@admin.ru","BiLab":"GodAdmin","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-03-07 11:47:09.709 +04:00 [DBG] Creating userinfo response
2019-03-07 11:47:09.714 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 11:47:09.718 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 11:47:09.724 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:47:09.725 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-03-07 11:47:09.727 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 11:47:09.730 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:47:11.585 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name BiLab email
2019-03-07 11:47:11.588 +04:00 [DBG] End userinfo request
2019-03-07 11:49:52.426 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 11:49:52.482 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 11:49:52.483 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 11:49:52.483 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 11:49:52.483 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 11:49:52.483 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 11:49:52.484 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 11:49:52.720 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:49:52.740 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:49:52.744 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:49:52.839 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 11:49:52.893 +04:00 [DBG] Starting grant removal
2019-03-07 11:49:53.724 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 11:49:53.727 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 11:49:53.729 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 11:49:53.729 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 11:49:53.730 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 11:49:53.731 +04:00 [DBG] Error Url: /home/error
2019-03-07 11:49:53.732 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 11:49:53.789 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 11:51:39.558 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 11:51:39.565 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 11:51:39.567 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 11:51:39.574 +04:00 [DBG] Start discovery request
2019-03-07 11:51:40.060 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 11:51:40.207 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 11:51:40.211 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 11:51:40.214 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 11:51:40.218 +04:00 [DBG] Start key discovery request
2019-03-07 11:51:40.321 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 11:51:40.328 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 11:51:40.332 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 11:51:40.338 +04:00 [DBG] Start authorize request
2019-03-07 11:51:40.350 +04:00 [DBG] No user present in authorize request
2019-03-07 11:51:40.355 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 11:51:40.640 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:51:40.647 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:51:40.653 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 11:51:40.655 +04:00 [DBG] No PKCE used.
2019-03-07 11:51:40.708 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:51:40.748 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:51:40.758 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:51:40.761 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:51:40.769 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 11:51:40.784 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDfVetL2XC2Qlv9uenAwl-MVmQJYftpIgjyko6S60KPLiIEn08kURZcI6RRyK5gH-fiBYYoQQt3lYepbq67EdlSI-dE0Rr1uav_4VJHXIH7Brqrt8ETqyLAeD9CgS6vaisAiArQFycTfaK7AyNnRas9_W6gUe2beAolZEGnzVIenoNyAOczqKBawmgyCDfXj-Um5gaoqP4qWnwDHLDnnOTiFeJoxqnXOP9YI-FENR4foSlDTTI6WNCLtwnF-wSLxzM0zhj7k3KDD_5ppbdHLO3GQQ4yIgjZPeOmfxVe97o0cQS80_ulznKzx4DTLrUpYAo","UiLocales":null,"Nonce":"636875419002886918.ZGY5YTdhZGItZjI1My00NDdkLWE5YzAtYzc2M2QzZWE5MjZjZWRlNmQxOTctZWIxOS00NzVhLTkzNGItOTc5YTYzYzc2MjEx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875419002886918.ZGY5YTdhZGItZjI1My00NDdkLWE5YzAtYzc2M2QzZWE5MjZjZWRlNmQxOTctZWIxOS00NzVhLTkzNGItOTc5YTYzYzc2MjEx","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDfVetL2XC2Qlv9uenAwl-MVmQJYftpIgjyko6S60KPLiIEn08kURZcI6RRyK5gH-fiBYYoQQt3lYepbq67EdlSI-dE0Rr1uav_4VJHXIH7Brqrt8ETqyLAeD9CgS6vaisAiArQFycTfaK7AyNnRas9_W6gUe2beAolZEGnzVIenoNyAOczqKBawmgyCDfXj-Um5gaoqP4qWnwDHLDnnOTiFeJoxqnXOP9YI-FENR4foSlDTTI6WNCLtwnF-wSLxzM0zhj7k3KDD_5ppbdHLO3GQQ4yIgjZPeOmfxVe97o0cQS80_ulznKzx4DTLrUpYAo","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 11:51:40.809 +04:00 [INF] Showing login: User is not authenticated
2019-03-07 11:51:45.201 +04:00 [DBG] Augmenting SignInContext
2019-03-07 11:51:45.204 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 11:51:45.204 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 11:51:45.205 +04:00 [DBG] Adding auth_time claim with value: 1551945105
2019-03-07 11:51:45.215 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 11:51:45.241 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2Q5U0MQMS:00000004","TimeStamp":"2019-03-07T07:51:45.0000000Z","ProcessId":13732,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 11:51:45.289 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-07 11:51:45.293 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-07 11:51:45.296 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-07 11:51:45.306 +04:00 [DBG] Start authorize callback request
2019-03-07 11:51:45.311 +04:00 [DBG] User in authorize request: 2
2019-03-07 11:51:45.312 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 11:51:45.320 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:51:45.321 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:51:45.322 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 11:51:45.323 +04:00 [DBG] No PKCE used.
2019-03-07 11:51:45.326 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:51:45.329 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:51:45.336 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:51:45.340 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:51:45.341 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 11:51:45.343 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDfVetL2XC2Qlv9uenAwl-MVmQJYftpIgjyko6S60KPLiIEn08kURZcI6RRyK5gH-fiBYYoQQt3lYepbq67EdlSI-dE0Rr1uav_4VJHXIH7Brqrt8ETqyLAeD9CgS6vaisAiArQFycTfaK7AyNnRas9_W6gUe2beAolZEGnzVIenoNyAOczqKBawmgyCDfXj-Um5gaoqP4qWnwDHLDnnOTiFeJoxqnXOP9YI-FENR4foSlDTTI6WNCLtwnF-wSLxzM0zhj7k3KDD_5ppbdHLO3GQQ4yIgjZPeOmfxVe97o0cQS80_ulznKzx4DTLrUpYAo","UiLocales":null,"Nonce":"636875419002886918.ZGY5YTdhZGItZjI1My00NDdkLWE5YzAtYzc2M2QzZWE5MjZjZWRlNmQxOTctZWIxOS00NzVhLTkzNGItOTc5YTYzYzc2MjEx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a5298b56296d0f970950cd24876de930","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875419002886918.ZGY5YTdhZGItZjI1My00NDdkLWE5YzAtYzc2M2QzZWE5MjZjZWRlNmQxOTctZWIxOS00NzVhLTkzNGItOTc5YTYzYzc2MjEx","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDfVetL2XC2Qlv9uenAwl-MVmQJYftpIgjyko6S60KPLiIEn08kURZcI6RRyK5gH-fiBYYoQQt3lYepbq67EdlSI-dE0Rr1uav_4VJHXIH7Brqrt8ETqyLAeD9CgS6vaisAiArQFycTfaK7AyNnRas9_W6gUe2beAolZEGnzVIenoNyAOczqKBawmgyCDfXj-Um5gaoqP4qWnwDHLDnnOTiFeJoxqnXOP9YI-FENR4foSlDTTI6WNCLtwnF-wSLxzM0zhj7k3KDD_5ppbdHLO3GQQ4yIgjZPeOmfxVe97o0cQS80_ulznKzx4DTLrUpYAo","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 11:51:57.210 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-07 11:51:57.216 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-07 11:51:57.251 +04:00 [DBG] d5GXrn57H7Ti56Lxz6nK8AgvpTcMHZTLUk7skRpqH/g= not found in database
2019-03-07 11:51:57.311 +04:00 [DBG] Creating Implicit Flow response.
2019-03-07 11:51:57.320 +04:00 [DBG] Getting claims for identity token for subject: 2 and client: BiLab
2019-03-07 11:54:26.399 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 11:54:26.450 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 11:54:26.451 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 11:54:26.452 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 11:54:26.452 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 11:54:26.452 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 11:54:26.452 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 11:54:26.681 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:54:26.696 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:54:26.699 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:54:26.777 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 11:54:26.833 +04:00 [DBG] Starting grant removal
2019-03-07 11:54:27.697 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 11:54:27.702 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 11:54:27.704 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 11:54:27.704 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 11:54:27.705 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 11:54:27.706 +04:00 [DBG] Error Url: /home/error
2019-03-07 11:54:27.706 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 11:54:27.774 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 11:54:27.959 +04:00 [INF] AuthenticationScheme: Identity.Application was forbidden.
2019-03-07 11:54:39.472 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 11:54:39.478 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 11:54:39.479 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 11:54:39.486 +04:00 [DBG] Start discovery request
2019-03-07 11:54:39.961 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 11:54:40.110 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 11:54:40.113 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 11:54:40.114 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 11:54:40.121 +04:00 [DBG] Start key discovery request
2019-03-07 11:54:40.215 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 11:54:40.226 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 11:54:40.227 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 11:54:40.238 +04:00 [DBG] Start authorize request
2019-03-07 11:54:40.250 +04:00 [DBG] No user present in authorize request
2019-03-07 11:54:40.256 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 11:54:40.599 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:54:40.606 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:54:40.613 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 11:54:40.615 +04:00 [DBG] No PKCE used.
2019-03-07 11:54:40.666 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:54:40.705 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:54:40.714 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:54:40.717 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:54:40.725 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 11:54:40.739 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBApAzSS-XBbDejN0oyZShpiwMqoumzJfz6cCiQ7uwxW8brHyzUcHNxetJvgYWCjfaDmCjrhSK43R8Rsb1o2FquqDxw6OI3J5SWtQFdAMUHkGIaZWQHXpOWab3Z8Akj0GuCUHzvEUuT8XSGeEai7Z2ktcV7Gf_aETbbp64_DOR1f4xUfomp1x8uz_ZETkhmSG4oZdQD6Ln3RFjCaYDj2FReDHR2D31lPVbN9jX3JMrDZK4idA7hrwz4L6YRqGsKPkVNmiPAq5Gj3DoBXJnnUKkwatBj2XLx0R_QmydhdOffMq71Moii3RCuZ_CJ3lvM7Yk","UiLocales":null,"Nonce":"636875420801897545.MDkzYTA3ZDktYTg3My00ZDM2LThlZmEtOWVjNjQzMzk0MTI2MjIzNzNhMWUtMjJkYi00ZjM2LWE4NWYtN2IyZTZhN2I0YTMw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875420801897545.MDkzYTA3ZDktYTg3My00ZDM2LThlZmEtOWVjNjQzMzk0MTI2MjIzNzNhMWUtMjJkYi00ZjM2LWE4NWYtN2IyZTZhN2I0YTMw","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBApAzSS-XBbDejN0oyZShpiwMqoumzJfz6cCiQ7uwxW8brHyzUcHNxetJvgYWCjfaDmCjrhSK43R8Rsb1o2FquqDxw6OI3J5SWtQFdAMUHkGIaZWQHXpOWab3Z8Akj0GuCUHzvEUuT8XSGeEai7Z2ktcV7Gf_aETbbp64_DOR1f4xUfomp1x8uz_ZETkhmSG4oZdQD6Ln3RFjCaYDj2FReDHR2D31lPVbN9jX3JMrDZK4idA7hrwz4L6YRqGsKPkVNmiPAq5Gj3DoBXJnnUKkwatBj2XLx0R_QmydhdOffMq71Moii3RCuZ_CJ3lvM7Yk","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 11:54:40.764 +04:00 [INF] Showing login: User is not authenticated
2019-03-07 11:54:43.807 +04:00 [DBG] Augmenting SignInContext
2019-03-07 11:54:43.810 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 11:54:43.810 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 11:54:43.811 +04:00 [DBG] Adding auth_time claim with value: 1551945283
2019-03-07 11:54:43.820 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 11:54:43.846 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2Q8FKNPPT:00000005","TimeStamp":"2019-03-07T07:54:43.0000000Z","ProcessId":5836,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 11:54:43.873 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-07 11:54:43.876 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-07 11:54:43.877 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-07 11:54:43.887 +04:00 [DBG] Start authorize callback request
2019-03-07 11:54:43.891 +04:00 [DBG] User in authorize request: 2
2019-03-07 11:54:43.891 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 11:54:43.897 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:54:43.898 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:54:43.899 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 11:54:43.900 +04:00 [DBG] No PKCE used.
2019-03-07 11:54:43.904 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:54:43.906 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:54:43.908 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:54:43.910 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:54:43.913 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 11:54:43.915 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBApAzSS-XBbDejN0oyZShpiwMqoumzJfz6cCiQ7uwxW8brHyzUcHNxetJvgYWCjfaDmCjrhSK43R8Rsb1o2FquqDxw6OI3J5SWtQFdAMUHkGIaZWQHXpOWab3Z8Akj0GuCUHzvEUuT8XSGeEai7Z2ktcV7Gf_aETbbp64_DOR1f4xUfomp1x8uz_ZETkhmSG4oZdQD6Ln3RFjCaYDj2FReDHR2D31lPVbN9jX3JMrDZK4idA7hrwz4L6YRqGsKPkVNmiPAq5Gj3DoBXJnnUKkwatBj2XLx0R_QmydhdOffMq71Moii3RCuZ_CJ3lvM7Yk","UiLocales":null,"Nonce":"636875420801897545.MDkzYTA3ZDktYTg3My00ZDM2LThlZmEtOWVjNjQzMzk0MTI2MjIzNzNhMWUtMjJkYi00ZjM2LWE4NWYtN2IyZTZhN2I0YTMw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"2f6ec12908c674086be905cf6cc75e5a","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875420801897545.MDkzYTA3ZDktYTg3My00ZDM2LThlZmEtOWVjNjQzMzk0MTI2MjIzNzNhMWUtMjJkYi00ZjM2LWE4NWYtN2IyZTZhN2I0YTMw","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBApAzSS-XBbDejN0oyZShpiwMqoumzJfz6cCiQ7uwxW8brHyzUcHNxetJvgYWCjfaDmCjrhSK43R8Rsb1o2FquqDxw6OI3J5SWtQFdAMUHkGIaZWQHXpOWab3Z8Akj0GuCUHzvEUuT8XSGeEai7Z2ktcV7Gf_aETbbp64_DOR1f4xUfomp1x8uz_ZETkhmSG4oZdQD6Ln3RFjCaYDj2FReDHR2D31lPVbN9jX3JMrDZK4idA7hrwz4L6YRqGsKPkVNmiPAq5Gj3DoBXJnnUKkwatBj2XLx0R_QmydhdOffMq71Moii3RCuZ_CJ3lvM7Yk","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 11:54:43.954 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-07 11:54:43.963 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-07 11:54:44.000 +04:00 [DBG] zKI4/IrEUsJQZTTWrafDLz0oLgSkl5iyCQJWeGBk21I= not found in database
2019-03-07 11:54:44.060 +04:00 [DBG] Creating Implicit Flow response.
2019-03-07 11:54:44.071 +04:00 [DBG] Getting claims for identity token for subject: 2 and client: BiLab
2019-03-07 11:54:48.385 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 11:54:48.473 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"2","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****5vPA","$type":"Token"},{"TokenType":"code","TokenValue":"****9588","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2Q8FKNPPT:00000006","TimeStamp":"2019-03-07T07:54:48.0000000Z","ProcessId":5836,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 11:54:48.483 +04:00 [INF] Authorize endpoint response
{"SubjectId":"2","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBApAzSS-XBbDejN0oyZShpiwMqoumzJfz6cCiQ7uwxW8brHyzUcHNxetJvgYWCjfaDmCjrhSK43R8Rsb1o2FquqDxw6OI3J5SWtQFdAMUHkGIaZWQHXpOWab3Z8Akj0GuCUHzvEUuT8XSGeEai7Z2ktcV7Gf_aETbbp64_DOR1f4xUfomp1x8uz_ZETkhmSG4oZdQD6Ln3RFjCaYDj2FReDHR2D31lPVbN9jX3JMrDZK4idA7hrwz4L6YRqGsKPkVNmiPAq5Gj3DoBXJnnUKkwatBj2XLx0R_QmydhdOffMq71Moii3RCuZ_CJ3lvM7Yk","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-07 11:54:48.505 +04:00 [DBG] Augmenting SignInContext
2019-03-07 11:54:48.507 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 11:54:48.632 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-07 11:54:48.638 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-07 11:54:48.641 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-07 11:54:48.649 +04:00 [DBG] Start token request.
2019-03-07 11:54:48.656 +04:00 [DBG] Start client validation
2019-03-07 11:54:48.662 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-07 11:54:48.666 +04:00 [DBG] Start parsing for secret in post body
2019-03-07 11:54:48.667 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-07 11:54:48.667 +04:00 [DBG] Secret id found: BiLab
2019-03-07 11:54:48.672 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:54:48.673 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:54:48.685 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-07 11:54:48.685 +04:00 [DBG] Client validation success
2019-03-07 11:54:48.687 +04:00 [INF] {"ClientId":"BiLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLL2Q8FKNPPU:00000003","TimeStamp":"2019-03-07T07:54:48.0000000Z","ProcessId":5836,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-03-07 11:54:48.697 +04:00 [DBG] Start token request validation
2019-03-07 11:54:48.707 +04:00 [DBG] Start validation of authorization code token request
2019-03-07 11:54:48.721 +04:00 [DBG] zKI4/IrEUsJQZTTWrafDLz0oLgSkl5iyCQJWeGBk21I= found in database: true
2019-03-07 11:54:48.739 +04:00 [DBG] removing zKI4/IrEUsJQZTTWrafDLz0oLgSkl5iyCQJWeGBk21I= persisted grant from database
2019-03-07 11:54:48.754 +04:00 [DBG] Validation of authorization code token request success
2019-03-07 11:54:48.760 +04:00 [INF] Token request validation success
{"ClientId":"BiLab","ClientName":"BiLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"28aba3d31075cb8c2be40f651b7909f4956c1db7ab75b03e0c0cac0e3dfd9588","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"BiLab","client_secret":"***REDACTED***","code":"28aba3d31075cb8c2be40f651b7909f4956c1db7ab75b03e0c0cac0e3dfd9588","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-03-07 11:54:48.786 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:54:48.787 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:54:48.800 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:54:48.808 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:54:48.827 +04:00 [DBG] Getting claims for access token for client: BiLab
2019-03-07 11:54:48.828 +04:00 [DBG] Getting claims for access token for subject: 2
2019-03-07 11:54:48.837 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 11:54:48.850 +04:00 [DBG] Creating refresh token
2019-03-07 11:54:48.851 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-03-07 11:54:48.865 +04:00 [DBG] RyowZE96/Wh/FxqQQFexnVoxZP92evsNYT1G723ISmk= not found in database
2019-03-07 11:54:48.873 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:54:48.874 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:54:48.877 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:54:48.879 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:54:48.880 +04:00 [DBG] Getting claims for identity token for subject: 2 and client: BiLab
2019-03-07 11:54:48.889 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 11:54:48.895 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****qxKw","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****9fcd","$type":"Token"},{"TokenType":"access_token","TokenValue":"****1ziA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2Q8FKNPPU:00000003","TimeStamp":"2019-03-07T07:54:48.0000000Z","ProcessId":5836,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 11:54:48.903 +04:00 [DBG] Token request success.
2019-03-07 11:54:48.917 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-03-07 11:54:48.919 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-03-07 11:54:48.919 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-03-07 11:54:48.928 +04:00 [DBG] Start userinfo request
2019-03-07 11:54:48.932 +04:00 [DBG] Bearer token found in header
2019-03-07 11:54:48.987 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:54:48.987 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:54:48.996 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:54:48.997 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:54:49.004 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-03-07 11:54:49.012 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1551945288,"exp":1551948888,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"BiLab","sub":"2","auth_time":1551945283,"idp":"local","AspNet.Identity.SecurityStamp":"RUYKCWHO26U6OEQYLNO7G7V2RE44ETDK","role":"user","preferred_username":"test@mail.ru","name":"test@mail.ru","email":"test@mail.ru","email_verified":false,"given_name":"test@mail.ru","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-03-07 11:54:49.029 +04:00 [DBG] Creating userinfo response
2019-03-07 11:54:49.033 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 11:54:49.037 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 11:54:49.044 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:54:49.046 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-03-07 11:54:49.047 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 11:54:49.051 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:54:49.059 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email
2019-03-07 11:54:49.061 +04:00 [DBG] End userinfo request
2019-03-07 11:55:11.644 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 11:55:11.648 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 11:55:11.649 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 11:55:11.651 +04:00 [DBG] Start authorize request
2019-03-07 11:55:11.652 +04:00 [DBG] No user present in authorize request
2019-03-07 11:55:11.652 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 11:55:11.677 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:55:11.678 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:55:11.680 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 11:55:11.682 +04:00 [DBG] No PKCE used.
2019-03-07 11:55:11.693 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:55:11.699 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:55:11.703 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:55:11.705 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:55:11.706 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 11:55:11.708 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDEuC5o3VkemTizZKA3PB_jSZ6GQppzL-Oi5kmZcJIKLfb--RxOSHNYrwzfhnhGJO3DEPoQAw1puFkp9EToNVwZmOZjM_bW_2m0X2nHv_qaHJ-YqQGoSk-Sxt8TkdBl6mumDXImD0E7XpZ9ov-6TwmtGNn8b8qUULF2yCBqvS7Qy6fkDNCfMgtJp8HUO-PgaElHmoN59Rs15W2uZc6SishFVyjfeZSJecCy-SwnMHY1BFiiDJ0vZ5zI5jkIdJChCMOzw27zfaCpCF8bl2LkPxHtpKx88mlGxzR622dQ3QI5vKKtalFOWzYIwsuyM32XF0Q","UiLocales":null,"Nonce":"636875421116339127.MjRhODExMTQtNWM5Yi00MTMzLTk2NzEtYjliZGQyY2M2Y2JkM2JhNWFmY2MtMDcyMC00NTM3LWJhY2UtMWViMjE1ZjI2NmU2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875421116339127.MjRhODExMTQtNWM5Yi00MTMzLTk2NzEtYjliZGQyY2M2Y2JkM2JhNWFmY2MtMDcyMC00NTM3LWJhY2UtMWViMjE1ZjI2NmU2","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDEuC5o3VkemTizZKA3PB_jSZ6GQppzL-Oi5kmZcJIKLfb--RxOSHNYrwzfhnhGJO3DEPoQAw1puFkp9EToNVwZmOZjM_bW_2m0X2nHv_qaHJ-YqQGoSk-Sxt8TkdBl6mumDXImD0E7XpZ9ov-6TwmtGNn8b8qUULF2yCBqvS7Qy6fkDNCfMgtJp8HUO-PgaElHmoN59Rs15W2uZc6SishFVyjfeZSJecCy-SwnMHY1BFiiDJ0vZ5zI5jkIdJChCMOzw27zfaCpCF8bl2LkPxHtpKx88mlGxzR622dQ3QI5vKKtalFOWzYIwsuyM32XF0Q","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 11:55:11.723 +04:00 [INF] Showing login: User is not authenticated
2019-03-07 11:55:16.397 +04:00 [DBG] Augmenting SignInContext
2019-03-07 11:55:16.397 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 11:55:16.399 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 11:55:16.400 +04:00 [DBG] Adding auth_time claim with value: 1551945316
2019-03-07 11:55:16.401 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 11:55:16.404 +04:00 [INF] {"Username":"godAdmin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"1002","DisplayName":"godAdmin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2Q8FKNPPT:00000009","TimeStamp":"2019-03-07T07:55:16.0000000Z","ProcessId":5836,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 11:55:16.414 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-07 11:55:16.415 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-07 11:55:16.416 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-07 11:55:16.417 +04:00 [DBG] Start authorize callback request
2019-03-07 11:55:16.418 +04:00 [DBG] User in authorize request: 1002
2019-03-07 11:55:16.418 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 11:55:16.423 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:55:16.423 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:55:16.425 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 11:55:16.425 +04:00 [DBG] No PKCE used.
2019-03-07 11:55:16.430 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:55:16.434 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:55:16.437 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:55:16.439 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:55:16.440 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 11:55:16.442 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDEuC5o3VkemTizZKA3PB_jSZ6GQppzL-Oi5kmZcJIKLfb--RxOSHNYrwzfhnhGJO3DEPoQAw1puFkp9EToNVwZmOZjM_bW_2m0X2nHv_qaHJ-YqQGoSk-Sxt8TkdBl6mumDXImD0E7XpZ9ov-6TwmtGNn8b8qUULF2yCBqvS7Qy6fkDNCfMgtJp8HUO-PgaElHmoN59Rs15W2uZc6SishFVyjfeZSJecCy-SwnMHY1BFiiDJ0vZ5zI5jkIdJChCMOzw27zfaCpCF8bl2LkPxHtpKx88mlGxzR622dQ3QI5vKKtalFOWzYIwsuyM32XF0Q","UiLocales":null,"Nonce":"636875421116339127.MjRhODExMTQtNWM5Yi00MTMzLTk2NzEtYjliZGQyY2M2Y2JkM2JhNWFmY2MtMDcyMC00NTM3LWJhY2UtMWViMjE1ZjI2NmU2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"bc29df7eb2d698ede2011301f0745f9a","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875421116339127.MjRhODExMTQtNWM5Yi00MTMzLTk2NzEtYjliZGQyY2M2Y2JkM2JhNWFmY2MtMDcyMC00NTM3LWJhY2UtMWViMjE1ZjI2NmU2","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDEuC5o3VkemTizZKA3PB_jSZ6GQppzL-Oi5kmZcJIKLfb--RxOSHNYrwzfhnhGJO3DEPoQAw1puFkp9EToNVwZmOZjM_bW_2m0X2nHv_qaHJ-YqQGoSk-Sxt8TkdBl6mumDXImD0E7XpZ9ov-6TwmtGNn8b8qUULF2yCBqvS7Qy6fkDNCfMgtJp8HUO-PgaElHmoN59Rs15W2uZc6SishFVyjfeZSJecCy-SwnMHY1BFiiDJ0vZ5zI5jkIdJChCMOzw27zfaCpCF8bl2LkPxHtpKx88mlGxzR622dQ3QI5vKKtalFOWzYIwsuyM32XF0Q","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 11:55:16.458 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-07 11:55:16.458 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-07 11:55:16.464 +04:00 [DBG] +NMLbSxzP60GytJcXOE0eYeWTRpYjfavOeOWc9bmojM= not found in database
2019-03-07 11:55:16.467 +04:00 [DBG] Creating Implicit Flow response.
2019-03-07 11:55:16.468 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 11:55:16.475 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 11:55:16.482 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"1002","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****EOjg","$type":"Token"},{"TokenType":"code","TokenValue":"****f83b","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2Q8FKNPPT:0000000A","TimeStamp":"2019-03-07T07:55:16.0000000Z","ProcessId":5836,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 11:55:16.486 +04:00 [INF] Authorize endpoint response
{"SubjectId":"1002","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDEuC5o3VkemTizZKA3PB_jSZ6GQppzL-Oi5kmZcJIKLfb--RxOSHNYrwzfhnhGJO3DEPoQAw1puFkp9EToNVwZmOZjM_bW_2m0X2nHv_qaHJ-YqQGoSk-Sxt8TkdBl6mumDXImD0E7XpZ9ov-6TwmtGNn8b8qUULF2yCBqvS7Qy6fkDNCfMgtJp8HUO-PgaElHmoN59Rs15W2uZc6SishFVyjfeZSJecCy-SwnMHY1BFiiDJ0vZ5zI5jkIdJChCMOzw27zfaCpCF8bl2LkPxHtpKx88mlGxzR622dQ3QI5vKKtalFOWzYIwsuyM32XF0Q","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-07 11:55:16.489 +04:00 [DBG] Augmenting SignInContext
2019-03-07 11:55:16.490 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 11:55:16.542 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-07 11:55:16.547 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-07 11:55:16.550 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-07 11:55:16.556 +04:00 [DBG] Start token request.
2019-03-07 11:55:16.564 +04:00 [DBG] Start client validation
2019-03-07 11:55:16.578 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-07 11:55:16.579 +04:00 [DBG] Start parsing for secret in post body
2019-03-07 11:55:16.581 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-07 11:55:16.581 +04:00 [DBG] Secret id found: BiLab
2019-03-07 11:55:16.588 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:55:16.588 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:55:16.589 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-07 11:55:16.590 +04:00 [DBG] Client validation success
2019-03-07 11:55:16.591 +04:00 [INF] {"ClientId":"BiLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLL2Q8FKNPPU:00000005","TimeStamp":"2019-03-07T07:55:16.0000000Z","ProcessId":5836,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-03-07 11:55:16.595 +04:00 [DBG] Start token request validation
2019-03-07 11:55:16.596 +04:00 [DBG] Start validation of authorization code token request
2019-03-07 11:55:16.598 +04:00 [DBG] +NMLbSxzP60GytJcXOE0eYeWTRpYjfavOeOWc9bmojM= found in database: true
2019-03-07 11:55:16.599 +04:00 [DBG] removing +NMLbSxzP60GytJcXOE0eYeWTRpYjfavOeOWc9bmojM= persisted grant from database
2019-03-07 11:55:16.606 +04:00 [DBG] Validation of authorization code token request success
2019-03-07 11:55:16.606 +04:00 [INF] Token request validation success
{"ClientId":"BiLab","ClientName":"BiLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"1c7b532874714c66c6097fc480e6577e920937ab8138e695ac50505e10f1f83b","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"BiLab","client_secret":"***REDACTED***","code":"1c7b532874714c66c6097fc480e6577e920937ab8138e695ac50505e10f1f83b","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-03-07 11:55:16.613 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:55:16.613 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:55:16.621 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:55:16.627 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:55:16.628 +04:00 [DBG] Getting claims for access token for client: BiLab
2019-03-07 11:55:16.629 +04:00 [DBG] Getting claims for access token for subject: 1002
2019-03-07 11:55:16.635 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 11:55:16.639 +04:00 [DBG] Creating refresh token
2019-03-07 11:55:16.639 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-03-07 11:55:16.641 +04:00 [DBG] rtwaSyXmQTvBkSwJpMEVImNErON8mPn06OH84g0upuw= not found in database
2019-03-07 11:55:16.648 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:55:16.648 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:55:16.651 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:55:16.653 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:55:16.656 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 11:55:16.662 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 11:55:16.665 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****I-RA","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****e62f","$type":"Token"},{"TokenType":"access_token","TokenValue":"****1WjQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2Q8FKNPPU:00000005","TimeStamp":"2019-03-07T07:55:16.0000000Z","ProcessId":5836,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 11:55:16.672 +04:00 [DBG] Token request success.
2019-03-07 11:55:16.681 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-03-07 11:55:16.682 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-03-07 11:55:16.683 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-03-07 11:55:16.684 +04:00 [DBG] Start userinfo request
2019-03-07 11:55:16.686 +04:00 [DBG] Bearer token found in header
2019-03-07 11:55:16.692 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:55:16.692 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:55:16.697 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:55:16.697 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:55:16.702 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-03-07 11:55:16.703 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1551945316,"exp":1551948916,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"BiLab","sub":"1002","auth_time":1551945316,"idp":"local","AspNet.Identity.SecurityStamp":"YRQCMJ4XBHSYAYVIFGH3YHMVNOLY4SL5","role":"GodAdmin","preferred_username":"godAdmin@admin.ru","name":"godAdmin@admin.ru","email":"godAdmin@admin.ru","email_verified":false,"given_name":"godAdmin@admin.ru","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-03-07 11:55:16.710 +04:00 [DBG] Creating userinfo response
2019-03-07 11:55:16.711 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 11:55:16.712 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 11:55:16.715 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:55:16.718 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-03-07 11:55:16.720 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 11:55:16.722 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:55:16.730 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email
2019-03-07 11:55:16.731 +04:00 [DBG] End userinfo request
2019-03-07 11:56:01.296 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 11:56:01.349 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 11:56:01.350 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 11:56:01.350 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 11:56:01.350 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 11:56:01.351 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 11:56:01.351 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 11:56:01.584 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:56:01.600 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:56:01.603 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:56:01.684 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 11:56:01.741 +04:00 [DBG] Starting grant removal
2019-03-07 11:56:02.550 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 11:56:02.555 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 11:56:02.557 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 11:56:02.557 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 11:56:02.558 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 11:56:02.558 +04:00 [DBG] Error Url: /home/error
2019-03-07 11:56:02.559 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 11:56:02.632 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 11:56:19.622 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 11:56:19.629 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 11:56:19.632 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 11:56:19.636 +04:00 [DBG] Start discovery request
2019-03-07 11:56:20.121 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 11:56:20.254 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 11:56:20.257 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 11:56:20.257 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 11:56:20.264 +04:00 [DBG] Start key discovery request
2019-03-07 11:56:20.356 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 11:56:20.363 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 11:56:20.365 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 11:56:20.370 +04:00 [DBG] Start authorize request
2019-03-07 11:56:20.381 +04:00 [DBG] No user present in authorize request
2019-03-07 11:56:20.385 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 11:56:20.659 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:56:20.667 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:56:20.674 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 11:56:20.676 +04:00 [DBG] No PKCE used.
2019-03-07 11:56:20.732 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:56:20.796 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:56:20.805 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:56:20.807 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:56:20.816 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 11:56:20.832 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDjHCVi6k3EUFrUh2RvxlTb0yI8k4YfH877el89HtwZEpRbrPM6aJijdEXVhx4sbPlNAVTMffuVXNqeXj8QopRwljZORORa5KdZMcN_stBpNDTF9HJDWA-3HSN069dCuOWZZmuOXxCAbmYggD-7dA_DAhJAZu9UmR1X6SYps6JvByG4j9DmSdl8TVJpI5lfdQyxbjxfSiJVpEwLcgxjnkoPOn1yq8PGLJGMMY3kXL6WkHaf8EtrcWGGQzPbFNF6u6ys7yFlTFJz39ngVpc0RujP1zzsM1AyFm30iJeJCTGRqjkcRQcqdrUkmwGQUT0vPZ0","UiLocales":null,"Nonce":"636875421803314384.NzQzZWYxZTItM2NmZC00MjZlLWJmZjgtYWFjNjhlNzZiMTc1OWVhNGE1NzMtNGFmNy00MjFjLWJmMWItNzEzNzlkZGEzZWIx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875421803314384.NzQzZWYxZTItM2NmZC00MjZlLWJmZjgtYWFjNjhlNzZiMTc1OWVhNGE1NzMtNGFmNy00MjFjLWJmMWItNzEzNzlkZGEzZWIx","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDjHCVi6k3EUFrUh2RvxlTb0yI8k4YfH877el89HtwZEpRbrPM6aJijdEXVhx4sbPlNAVTMffuVXNqeXj8QopRwljZORORa5KdZMcN_stBpNDTF9HJDWA-3HSN069dCuOWZZmuOXxCAbmYggD-7dA_DAhJAZu9UmR1X6SYps6JvByG4j9DmSdl8TVJpI5lfdQyxbjxfSiJVpEwLcgxjnkoPOn1yq8PGLJGMMY3kXL6WkHaf8EtrcWGGQzPbFNF6u6ys7yFlTFJz39ngVpc0RujP1zzsM1AyFm30iJeJCTGRqjkcRQcqdrUkmwGQUT0vPZ0","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 11:56:20.857 +04:00 [INF] Showing login: User is not authenticated
2019-03-07 11:56:26.504 +04:00 [DBG] Augmenting SignInContext
2019-03-07 11:56:26.507 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 11:56:26.508 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 11:56:26.509 +04:00 [DBG] Adding auth_time claim with value: 1551945386
2019-03-07 11:56:26.520 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 11:56:26.550 +04:00 [INF] {"Username":"godAdmin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"1002","DisplayName":"godAdmin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2Q9BSVQ9H:00000004","TimeStamp":"2019-03-07T07:56:26.0000000Z","ProcessId":13704,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 11:56:26.589 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-07 11:56:26.592 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-07 11:56:26.593 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-07 11:56:26.600 +04:00 [DBG] Start authorize callback request
2019-03-07 11:56:26.605 +04:00 [DBG] User in authorize request: 1002
2019-03-07 11:56:26.606 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 11:56:26.613 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:56:26.614 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:56:26.617 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 11:56:26.618 +04:00 [DBG] No PKCE used.
2019-03-07 11:56:26.620 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:56:26.623 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:56:26.626 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:56:26.627 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:56:26.628 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 11:56:26.629 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDjHCVi6k3EUFrUh2RvxlTb0yI8k4YfH877el89HtwZEpRbrPM6aJijdEXVhx4sbPlNAVTMffuVXNqeXj8QopRwljZORORa5KdZMcN_stBpNDTF9HJDWA-3HSN069dCuOWZZmuOXxCAbmYggD-7dA_DAhJAZu9UmR1X6SYps6JvByG4j9DmSdl8TVJpI5lfdQyxbjxfSiJVpEwLcgxjnkoPOn1yq8PGLJGMMY3kXL6WkHaf8EtrcWGGQzPbFNF6u6ys7yFlTFJz39ngVpc0RujP1zzsM1AyFm30iJeJCTGRqjkcRQcqdrUkmwGQUT0vPZ0","UiLocales":null,"Nonce":"636875421803314384.NzQzZWYxZTItM2NmZC00MjZlLWJmZjgtYWFjNjhlNzZiMTc1OWVhNGE1NzMtNGFmNy00MjFjLWJmMWItNzEzNzlkZGEzZWIx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"2d6919de290968e2733812b15f90db87","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875421803314384.NzQzZWYxZTItM2NmZC00MjZlLWJmZjgtYWFjNjhlNzZiMTc1OWVhNGE1NzMtNGFmNy00MjFjLWJmMWItNzEzNzlkZGEzZWIx","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDjHCVi6k3EUFrUh2RvxlTb0yI8k4YfH877el89HtwZEpRbrPM6aJijdEXVhx4sbPlNAVTMffuVXNqeXj8QopRwljZORORa5KdZMcN_stBpNDTF9HJDWA-3HSN069dCuOWZZmuOXxCAbmYggD-7dA_DAhJAZu9UmR1X6SYps6JvByG4j9DmSdl8TVJpI5lfdQyxbjxfSiJVpEwLcgxjnkoPOn1yq8PGLJGMMY3kXL6WkHaf8EtrcWGGQzPbFNF6u6ys7yFlTFJz39ngVpc0RujP1zzsM1AyFm30iJeJCTGRqjkcRQcqdrUkmwGQUT0vPZ0","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 11:56:26.666 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-07 11:56:26.673 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-07 11:56:26.708 +04:00 [DBG] ufm0A+E+PU+MBvWTdAXY4G+lSeS7bcfZScqb8Jqj3Gw= not found in database
2019-03-07 11:56:26.769 +04:00 [DBG] Creating Implicit Flow response.
2019-03-07 11:56:26.777 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 11:56:26.796 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 11:56:26.876 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"1002","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****Nbhw","$type":"Token"},{"TokenType":"code","TokenValue":"****4625","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2Q9BSVQ9H:00000005","TimeStamp":"2019-03-07T07:56:26.0000000Z","ProcessId":13704,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 11:56:26.887 +04:00 [INF] Authorize endpoint response
{"SubjectId":"1002","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDjHCVi6k3EUFrUh2RvxlTb0yI8k4YfH877el89HtwZEpRbrPM6aJijdEXVhx4sbPlNAVTMffuVXNqeXj8QopRwljZORORa5KdZMcN_stBpNDTF9HJDWA-3HSN069dCuOWZZmuOXxCAbmYggD-7dA_DAhJAZu9UmR1X6SYps6JvByG4j9DmSdl8TVJpI5lfdQyxbjxfSiJVpEwLcgxjnkoPOn1yq8PGLJGMMY3kXL6WkHaf8EtrcWGGQzPbFNF6u6ys7yFlTFJz39ngVpc0RujP1zzsM1AyFm30iJeJCTGRqjkcRQcqdrUkmwGQUT0vPZ0","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-07 11:56:26.910 +04:00 [DBG] Augmenting SignInContext
2019-03-07 11:56:26.911 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 11:56:27.029 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-07 11:56:27.038 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-07 11:56:27.039 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-07 11:56:27.051 +04:00 [DBG] Start token request.
2019-03-07 11:56:27.059 +04:00 [DBG] Start client validation
2019-03-07 11:56:27.065 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-07 11:56:27.070 +04:00 [DBG] Start parsing for secret in post body
2019-03-07 11:56:27.071 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-07 11:56:27.072 +04:00 [DBG] Secret id found: BiLab
2019-03-07 11:56:27.090 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:56:27.090 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:56:27.104 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-07 11:56:27.105 +04:00 [DBG] Client validation success
2019-03-07 11:56:27.106 +04:00 [INF] {"ClientId":"BiLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLL2Q9BSVQ9I:00000003","TimeStamp":"2019-03-07T07:56:27.0000000Z","ProcessId":13704,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-03-07 11:56:27.114 +04:00 [DBG] Start token request validation
2019-03-07 11:56:27.126 +04:00 [DBG] Start validation of authorization code token request
2019-03-07 11:56:27.150 +04:00 [DBG] ufm0A+E+PU+MBvWTdAXY4G+lSeS7bcfZScqb8Jqj3Gw= found in database: true
2019-03-07 11:56:27.172 +04:00 [DBG] removing ufm0A+E+PU+MBvWTdAXY4G+lSeS7bcfZScqb8Jqj3Gw= persisted grant from database
2019-03-07 11:56:27.188 +04:00 [DBG] Validation of authorization code token request success
2019-03-07 11:56:27.195 +04:00 [INF] Token request validation success
{"ClientId":"BiLab","ClientName":"BiLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"07090431cfb10012657de230790385fb2e54d9c7b0df1246141e1e6278ac4625","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"BiLab","client_secret":"***REDACTED***","code":"07090431cfb10012657de230790385fb2e54d9c7b0df1246141e1e6278ac4625","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-03-07 11:56:27.225 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:56:27.225 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:56:27.236 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:56:27.242 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:56:27.254 +04:00 [DBG] Getting claims for access token for client: BiLab
2019-03-07 11:56:27.254 +04:00 [DBG] Getting claims for access token for subject: 1002
2019-03-07 11:56:27.267 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 11:56:27.277 +04:00 [DBG] Creating refresh token
2019-03-07 11:56:27.277 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-03-07 11:56:27.291 +04:00 [DBG] 6XSBFh/CXU1ksaPsLGvtQZ6ch12/uvulzJRY9o/znaE= not found in database
2019-03-07 11:56:27.300 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:56:27.301 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:56:27.304 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:56:27.306 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:56:27.307 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 11:56:27.317 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 11:56:27.325 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****togA","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****b334","$type":"Token"},{"TokenType":"access_token","TokenValue":"****RKSg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2Q9BSVQ9I:00000003","TimeStamp":"2019-03-07T07:56:27.0000000Z","ProcessId":13704,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 11:56:27.333 +04:00 [DBG] Token request success.
2019-03-07 11:56:27.350 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-03-07 11:56:27.352 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-03-07 11:56:27.353 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-03-07 11:56:27.362 +04:00 [DBG] Start userinfo request
2019-03-07 11:56:27.369 +04:00 [DBG] Bearer token found in header
2019-03-07 11:56:27.426 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:56:27.426 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:56:27.436 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:56:27.437 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:56:27.445 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-03-07 11:56:27.452 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1551945387,"exp":1551948987,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"BiLab","sub":"1002","auth_time":1551945386,"idp":"local","AspNet.Identity.SecurityStamp":"YRQCMJ4XBHSYAYVIFGH3YHMVNOLY4SL5","role":"GodAdmin","preferred_username":"godAdmin@admin.ru","name":"godAdmin@admin.ru","email":"godAdmin@admin.ru","email_verified":false,"given_name":"godAdmin@admin.ru","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-03-07 11:56:27.465 +04:00 [DBG] Creating userinfo response
2019-03-07 11:56:27.469 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 11:56:27.472 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 11:56:27.477 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:56:27.480 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-03-07 11:56:27.481 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 11:56:27.484 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:56:27.498 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email
2019-03-07 11:56:27.499 +04:00 [DBG] End userinfo request
2019-03-07 11:56:50.287 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 11:56:50.394 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 11:56:50.453 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 11:56:50.455 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 11:56:50.455 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 11:56:50.457 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 11:56:50.457 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 11:56:50.728 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:56:50.746 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:56:50.748 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 11:56:50.830 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 11:56:50.920 +04:00 [DBG] Starting grant removal
2019-03-07 11:56:51.526 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 11:56:51.530 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 11:56:51.531 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 11:56:51.532 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 11:56:51.534 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 11:56:51.535 +04:00 [DBG] Error Url: /home/error
2019-03-07 11:56:51.535 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 11:56:51.596 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 11:56:59.729 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 11:56:59.736 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 11:56:59.737 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 11:56:59.742 +04:00 [DBG] Start discovery request
2019-03-07 11:56:59.914 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 11:57:00.046 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 11:57:00.049 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 11:57:00.050 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 11:57:00.054 +04:00 [DBG] Start key discovery request
2019-03-07 11:57:00.140 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 11:57:00.152 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 11:57:00.153 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 11:57:00.160 +04:00 [DBG] Start authorize request
2019-03-07 11:57:00.172 +04:00 [DBG] No user present in authorize request
2019-03-07 11:57:00.178 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 11:57:00.353 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:57:00.361 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:57:00.366 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 11:57:00.369 +04:00 [DBG] No PKCE used.
2019-03-07 11:57:00.418 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:57:00.462 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:57:00.471 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:57:00.475 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:57:00.482 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 11:57:00.497 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNB6rIAg8pxWmORbHMTqYtUHhgjcCCa08H_IPUF5a3xMTJZs6kRxdOixTsMlkUNNm6z9XgtClxS-yyVnVw4L50wVdrJzavuxG9uy0phRA_C20Y_KASq_Yrw59jLs-WVEG3w6pghIn0BwJ4OU5-Fqwhzwu8ruA3OZ3j5A3_fWajULDd7gonKilXattF5P-dy94aUGFbzWthG3kEY_xBRzbHkL5Y57v2zXJ5i59rgA1mIjIpf1Gqb8v3OOyJp-RR573x4UZFNEbQ15ptMrpT3z6M1EhZ8cQym2itw1gU52uz0K6adfw0XelAz3Ep8vKeTB-PQ","UiLocales":null,"Nonce":"636875422201134912.ZjQ2MGZiYTUtNGMyNS00NTQ2LWIxMzUtMDVkMDg3YTkyNmZhN2FjNzY2NDgtOGRiNi00ODE4LTljZTItMDI3ODkwN2Y3Yzg1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875422201134912.ZjQ2MGZiYTUtNGMyNS00NTQ2LWIxMzUtMDVkMDg3YTkyNmZhN2FjNzY2NDgtOGRiNi00ODE4LTljZTItMDI3ODkwN2Y3Yzg1","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNB6rIAg8pxWmORbHMTqYtUHhgjcCCa08H_IPUF5a3xMTJZs6kRxdOixTsMlkUNNm6z9XgtClxS-yyVnVw4L50wVdrJzavuxG9uy0phRA_C20Y_KASq_Yrw59jLs-WVEG3w6pghIn0BwJ4OU5-Fqwhzwu8ruA3OZ3j5A3_fWajULDd7gonKilXattF5P-dy94aUGFbzWthG3kEY_xBRzbHkL5Y57v2zXJ5i59rgA1mIjIpf1Gqb8v3OOyJp-RR573x4UZFNEbQ15ptMrpT3z6M1EhZ8cQym2itw1gU52uz0K6adfw0XelAz3Ep8vKeTB-PQ","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 11:57:00.525 +04:00 [INF] Showing login: User is not authenticated
2019-03-07 11:57:03.769 +04:00 [DBG] Augmenting SignInContext
2019-03-07 11:57:03.771 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 11:57:03.772 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 11:57:03.773 +04:00 [DBG] Adding auth_time claim with value: 1551945423
2019-03-07 11:57:03.785 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 11:57:03.811 +04:00 [INF] {"Username":"godAdmin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"1002","DisplayName":"godAdmin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2Q9QGIAB6:00000004","TimeStamp":"2019-03-07T07:57:03.0000000Z","ProcessId":220,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 11:57:03.854 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-07 11:57:03.857 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-07 11:57:03.860 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-07 11:57:03.868 +04:00 [DBG] Start authorize callback request
2019-03-07 11:57:03.873 +04:00 [DBG] User in authorize request: 1002
2019-03-07 11:57:03.873 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 11:57:03.880 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:57:03.881 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:57:03.882 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 11:57:03.882 +04:00 [DBG] No PKCE used.
2019-03-07 11:57:03.885 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:57:03.886 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:57:03.889 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:57:03.891 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:57:03.891 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 11:57:03.892 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNB6rIAg8pxWmORbHMTqYtUHhgjcCCa08H_IPUF5a3xMTJZs6kRxdOixTsMlkUNNm6z9XgtClxS-yyVnVw4L50wVdrJzavuxG9uy0phRA_C20Y_KASq_Yrw59jLs-WVEG3w6pghIn0BwJ4OU5-Fqwhzwu8ruA3OZ3j5A3_fWajULDd7gonKilXattF5P-dy94aUGFbzWthG3kEY_xBRzbHkL5Y57v2zXJ5i59rgA1mIjIpf1Gqb8v3OOyJp-RR573x4UZFNEbQ15ptMrpT3z6M1EhZ8cQym2itw1gU52uz0K6adfw0XelAz3Ep8vKeTB-PQ","UiLocales":null,"Nonce":"636875422201134912.ZjQ2MGZiYTUtNGMyNS00NTQ2LWIxMzUtMDVkMDg3YTkyNmZhN2FjNzY2NDgtOGRiNi00ODE4LTljZTItMDI3ODkwN2Y3Yzg1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e78ed72184bc2ab9f7e868bb6022b6f4","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875422201134912.ZjQ2MGZiYTUtNGMyNS00NTQ2LWIxMzUtMDVkMDg3YTkyNmZhN2FjNzY2NDgtOGRiNi00ODE4LTljZTItMDI3ODkwN2Y3Yzg1","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNB6rIAg8pxWmORbHMTqYtUHhgjcCCa08H_IPUF5a3xMTJZs6kRxdOixTsMlkUNNm6z9XgtClxS-yyVnVw4L50wVdrJzavuxG9uy0phRA_C20Y_KASq_Yrw59jLs-WVEG3w6pghIn0BwJ4OU5-Fqwhzwu8ruA3OZ3j5A3_fWajULDd7gonKilXattF5P-dy94aUGFbzWthG3kEY_xBRzbHkL5Y57v2zXJ5i59rgA1mIjIpf1Gqb8v3OOyJp-RR573x4UZFNEbQ15ptMrpT3z6M1EhZ8cQym2itw1gU52uz0K6adfw0XelAz3Ep8vKeTB-PQ","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 11:57:03.930 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-07 11:57:03.936 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-07 11:57:03.979 +04:00 [DBG] nrltpPbXSJi1R07L01GMU6uwQrX1zDdoHuK4lg33bdc= not found in database
2019-03-07 11:57:04.006 +04:00 [DBG] Creating Implicit Flow response.
2019-03-07 11:57:04.017 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 11:57:04.038 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 11:57:04.118 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"1002","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****6yPg","$type":"Token"},{"TokenType":"code","TokenValue":"****1343","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2Q9QGIAB6:00000005","TimeStamp":"2019-03-07T07:57:04.0000000Z","ProcessId":220,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 11:57:04.128 +04:00 [INF] Authorize endpoint response
{"SubjectId":"1002","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNB6rIAg8pxWmORbHMTqYtUHhgjcCCa08H_IPUF5a3xMTJZs6kRxdOixTsMlkUNNm6z9XgtClxS-yyVnVw4L50wVdrJzavuxG9uy0phRA_C20Y_KASq_Yrw59jLs-WVEG3w6pghIn0BwJ4OU5-Fqwhzwu8ruA3OZ3j5A3_fWajULDd7gonKilXattF5P-dy94aUGFbzWthG3kEY_xBRzbHkL5Y57v2zXJ5i59rgA1mIjIpf1Gqb8v3OOyJp-RR573x4UZFNEbQ15ptMrpT3z6M1EhZ8cQym2itw1gU52uz0K6adfw0XelAz3Ep8vKeTB-PQ","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-07 11:57:04.157 +04:00 [DBG] Augmenting SignInContext
2019-03-07 11:57:04.160 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 11:57:04.266 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-07 11:57:04.272 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-07 11:57:04.273 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-07 11:57:04.282 +04:00 [DBG] Start token request.
2019-03-07 11:57:04.289 +04:00 [DBG] Start client validation
2019-03-07 11:57:04.295 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-07 11:57:04.299 +04:00 [DBG] Start parsing for secret in post body
2019-03-07 11:57:04.300 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-07 11:57:04.301 +04:00 [DBG] Secret id found: BiLab
2019-03-07 11:57:04.304 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:57:04.305 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:57:04.319 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-07 11:57:04.320 +04:00 [DBG] Client validation success
2019-03-07 11:57:04.322 +04:00 [INF] {"ClientId":"BiLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLL2Q9QGIAB7:00000003","TimeStamp":"2019-03-07T07:57:04.0000000Z","ProcessId":220,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-03-07 11:57:04.335 +04:00 [DBG] Start token request validation
2019-03-07 11:57:04.348 +04:00 [DBG] Start validation of authorization code token request
2019-03-07 11:57:04.367 +04:00 [DBG] nrltpPbXSJi1R07L01GMU6uwQrX1zDdoHuK4lg33bdc= found in database: true
2019-03-07 11:57:04.387 +04:00 [DBG] removing nrltpPbXSJi1R07L01GMU6uwQrX1zDdoHuK4lg33bdc= persisted grant from database
2019-03-07 11:57:04.401 +04:00 [DBG] Validation of authorization code token request success
2019-03-07 11:57:04.405 +04:00 [INF] Token request validation success
{"ClientId":"BiLab","ClientName":"BiLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"97b40cde3a2135bf379e89e0558d9b085754cf2174a01f95ad849d239b421343","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"BiLab","client_secret":"***REDACTED***","code":"97b40cde3a2135bf379e89e0558d9b085754cf2174a01f95ad849d239b421343","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-03-07 11:57:04.432 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:57:04.432 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:57:04.442 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:57:04.449 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:57:04.459 +04:00 [DBG] Getting claims for access token for client: BiLab
2019-03-07 11:57:04.460 +04:00 [DBG] Getting claims for access token for subject: 1002
2019-03-07 11:57:04.469 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 11:57:04.480 +04:00 [DBG] Creating refresh token
2019-03-07 11:57:04.480 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-03-07 11:57:04.491 +04:00 [DBG] 8Ttg40VmWzqoal5egUJ1TO7mamynuBD2GUm4ukNVlRI= not found in database
2019-03-07 11:57:04.504 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:57:04.505 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:57:04.507 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:57:04.511 +04:00 [DBG] Found [] API scopes in database
2019-03-07 11:57:04.512 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 11:57:04.519 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 11:57:04.525 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****pMrA","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****3c26","$type":"Token"},{"TokenType":"access_token","TokenValue":"****wFTQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2Q9QGIAB7:00000003","TimeStamp":"2019-03-07T07:57:04.0000000Z","ProcessId":220,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 11:57:04.535 +04:00 [DBG] Token request success.
2019-03-07 11:57:04.551 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-03-07 11:57:04.553 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-03-07 11:57:04.554 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-03-07 11:57:04.564 +04:00 [DBG] Start userinfo request
2019-03-07 11:57:04.568 +04:00 [DBG] Bearer token found in header
2019-03-07 11:57:04.627 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:57:04.628 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:57:04.636 +04:00 [DBG] BiLab found in database: true
2019-03-07 11:57:04.636 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 11:57:04.647 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-03-07 11:57:04.651 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1551945424,"exp":1551949024,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"BiLab","sub":"1002","auth_time":1551945423,"idp":"local","AspNet.Identity.SecurityStamp":"YRQCMJ4XBHSYAYVIFGH3YHMVNOLY4SL5","role":"GodAdmin","preferred_username":"godAdmin@admin.ru","name":"godAdmin@admin.ru","email":"godAdmin@admin.ru","email_verified":false,"given_name":"godAdmin@admin.ru","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-03-07 11:57:04.665 +04:00 [DBG] Creating userinfo response
2019-03-07 11:57:04.669 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 11:57:04.673 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 11:57:04.679 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:57:04.681 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-03-07 11:57:04.682 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 11:57:04.685 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 11:57:04.694 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email
2019-03-07 11:57:04.695 +04:00 [DBG] End userinfo request
2019-03-07 12:21:25.094 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 12:21:25.161 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 12:21:25.161 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 12:21:25.162 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 12:21:25.162 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 12:21:25.163 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 12:21:25.163 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 12:21:25.505 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:21:25.567 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:21:25.582 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:21:25.826 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 12:21:25.907 +04:00 [DBG] Starting grant removal
2019-03-07 12:21:27.039 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 12:21:27.044 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 12:21:27.046 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 12:21:27.047 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 12:21:27.048 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 12:21:27.049 +04:00 [DBG] Error Url: /home/error
2019-03-07 12:21:27.049 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 12:21:27.132 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 12:21:44.161 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 12:21:44.167 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 12:21:44.168 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 12:21:44.173 +04:00 [DBG] Start discovery request
2019-03-07 12:21:44.709 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 12:21:44.861 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 12:21:44.864 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 12:21:44.865 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 12:21:44.869 +04:00 [DBG] Start key discovery request
2019-03-07 12:21:44.972 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 12:21:44.980 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 12:21:44.981 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 12:21:44.985 +04:00 [DBG] Start authorize request
2019-03-07 12:21:44.999 +04:00 [DBG] No user present in authorize request
2019-03-07 12:21:45.004 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 12:21:45.483 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:21:45.489 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:21:45.498 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 12:21:45.500 +04:00 [DBG] No PKCE used.
2019-03-07 12:21:45.563 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:21:45.608 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:21:45.623 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:21:45.629 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:21:45.637 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 12:21:45.655 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCXpQl3IwU_gALrPjxHG4sifYgjImN4bG5nTH75C3nT-xoZJmL0pTBDBC4-Nfu6ei0UkCHuOpfz1Xoj8iTCxr5p4gKeREu4CybWeCRTH0jnQZQw3uF64xDqllMDN8XjtbOzUqhGWNqZXEZ7pIIYprcP8-9XBKNImG18uIej64YPXDX3aWV8wmex9F-er22sxFXlSHW3rsnlNCuo71GRwcBS4rd_eMCIKW5yCiFI6MWDePQDxAwBInWRMaeguqs6gXFpOaoKBF5w-YpY7U9sIQBYGlLuyQOSigbiSGV5I3rEOJ8LOyq9RiqLmvmVZd38xeQ","UiLocales":null,"Nonce":"636875437049440856.YTZmYmJiNzItN2Y1OC00ODM4LWI1ZmUtZTkzYmRlMDUxZDM4Y2I1MWU5YTYtMjhiNC00MTVlLWE4Y2ItNTViZTI4MjYxOGI2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875437049440856.YTZmYmJiNzItN2Y1OC00ODM4LWI1ZmUtZTkzYmRlMDUxZDM4Y2I1MWU5YTYtMjhiNC00MTVlLWE4Y2ItNTViZTI4MjYxOGI2","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCXpQl3IwU_gALrPjxHG4sifYgjImN4bG5nTH75C3nT-xoZJmL0pTBDBC4-Nfu6ei0UkCHuOpfz1Xoj8iTCxr5p4gKeREu4CybWeCRTH0jnQZQw3uF64xDqllMDN8XjtbOzUqhGWNqZXEZ7pIIYprcP8-9XBKNImG18uIej64YPXDX3aWV8wmex9F-er22sxFXlSHW3rsnlNCuo71GRwcBS4rd_eMCIKW5yCiFI6MWDePQDxAwBInWRMaeguqs6gXFpOaoKBF5w-YpY7U9sIQBYGlLuyQOSigbiSGV5I3rEOJ8LOyq9RiqLmvmVZd38xeQ","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 12:21:45.683 +04:00 [INF] Showing login: User is not authenticated
2019-03-07 12:21:56.016 +04:00 [DBG] Augmenting SignInContext
2019-03-07 12:21:56.019 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 12:21:56.020 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 12:21:56.021 +04:00 [DBG] Adding auth_time claim with value: 1551946916
2019-03-07 12:21:56.032 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 12:21:56.057 +04:00 [INF] {"Username":"godAdmin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"1002","DisplayName":"godAdmin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2QNI64GPC:00000004","TimeStamp":"2019-03-07T08:21:56.0000000Z","ProcessId":9004,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 12:21:56.101 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-07 12:21:56.105 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-07 12:21:56.107 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-07 12:21:56.113 +04:00 [DBG] Start authorize callback request
2019-03-07 12:21:56.123 +04:00 [DBG] User in authorize request: 1002
2019-03-07 12:21:56.124 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 12:21:56.152 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:21:56.153 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:21:56.155 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 12:21:56.156 +04:00 [DBG] No PKCE used.
2019-03-07 12:21:56.164 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:21:56.172 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:21:56.175 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:21:56.177 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:21:56.178 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 12:21:56.180 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCXpQl3IwU_gALrPjxHG4sifYgjImN4bG5nTH75C3nT-xoZJmL0pTBDBC4-Nfu6ei0UkCHuOpfz1Xoj8iTCxr5p4gKeREu4CybWeCRTH0jnQZQw3uF64xDqllMDN8XjtbOzUqhGWNqZXEZ7pIIYprcP8-9XBKNImG18uIej64YPXDX3aWV8wmex9F-er22sxFXlSHW3rsnlNCuo71GRwcBS4rd_eMCIKW5yCiFI6MWDePQDxAwBInWRMaeguqs6gXFpOaoKBF5w-YpY7U9sIQBYGlLuyQOSigbiSGV5I3rEOJ8LOyq9RiqLmvmVZd38xeQ","UiLocales":null,"Nonce":"636875437049440856.YTZmYmJiNzItN2Y1OC00ODM4LWI1ZmUtZTkzYmRlMDUxZDM4Y2I1MWU5YTYtMjhiNC00MTVlLWE4Y2ItNTViZTI4MjYxOGI2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"16e47b77a7eecc56865e79425d0c584b","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875437049440856.YTZmYmJiNzItN2Y1OC00ODM4LWI1ZmUtZTkzYmRlMDUxZDM4Y2I1MWU5YTYtMjhiNC00MTVlLWE4Y2ItNTViZTI4MjYxOGI2","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCXpQl3IwU_gALrPjxHG4sifYgjImN4bG5nTH75C3nT-xoZJmL0pTBDBC4-Nfu6ei0UkCHuOpfz1Xoj8iTCxr5p4gKeREu4CybWeCRTH0jnQZQw3uF64xDqllMDN8XjtbOzUqhGWNqZXEZ7pIIYprcP8-9XBKNImG18uIej64YPXDX3aWV8wmex9F-er22sxFXlSHW3rsnlNCuo71GRwcBS4rd_eMCIKW5yCiFI6MWDePQDxAwBInWRMaeguqs6gXFpOaoKBF5w-YpY7U9sIQBYGlLuyQOSigbiSGV5I3rEOJ8LOyq9RiqLmvmVZd38xeQ","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 12:21:56.222 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-07 12:21:56.229 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-07 12:21:56.275 +04:00 [DBG] MWvbeqH0evcw1plecucibGi8pPmzCUKpb7abiB3iVOw= not found in database
2019-03-07 12:21:56.344 +04:00 [DBG] Creating Implicit Flow response.
2019-03-07 12:21:56.356 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 12:21:56.378 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 12:21:56.474 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"1002","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****biWQ","$type":"Token"},{"TokenType":"code","TokenValue":"****be50","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2QNI64GPC:00000005","TimeStamp":"2019-03-07T08:21:56.0000000Z","ProcessId":9004,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 12:21:56.481 +04:00 [INF] Authorize endpoint response
{"SubjectId":"1002","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCXpQl3IwU_gALrPjxHG4sifYgjImN4bG5nTH75C3nT-xoZJmL0pTBDBC4-Nfu6ei0UkCHuOpfz1Xoj8iTCxr5p4gKeREu4CybWeCRTH0jnQZQw3uF64xDqllMDN8XjtbOzUqhGWNqZXEZ7pIIYprcP8-9XBKNImG18uIej64YPXDX3aWV8wmex9F-er22sxFXlSHW3rsnlNCuo71GRwcBS4rd_eMCIKW5yCiFI6MWDePQDxAwBInWRMaeguqs6gXFpOaoKBF5w-YpY7U9sIQBYGlLuyQOSigbiSGV5I3rEOJ8LOyq9RiqLmvmVZd38xeQ","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-07 12:21:56.504 +04:00 [DBG] Augmenting SignInContext
2019-03-07 12:21:56.504 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 12:21:56.630 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-07 12:21:56.643 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-07 12:21:56.644 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-07 12:21:56.657 +04:00 [DBG] Start token request.
2019-03-07 12:21:56.664 +04:00 [DBG] Start client validation
2019-03-07 12:21:56.674 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-07 12:21:56.678 +04:00 [DBG] Start parsing for secret in post body
2019-03-07 12:21:56.679 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-07 12:21:56.680 +04:00 [DBG] Secret id found: BiLab
2019-03-07 12:21:56.688 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:21:56.689 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:21:56.705 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-07 12:21:56.706 +04:00 [DBG] Client validation success
2019-03-07 12:21:56.707 +04:00 [INF] {"ClientId":"BiLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLL2QNI64GPD:00000003","TimeStamp":"2019-03-07T08:21:56.0000000Z","ProcessId":9004,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-03-07 12:21:56.715 +04:00 [DBG] Start token request validation
2019-03-07 12:21:56.731 +04:00 [DBG] Start validation of authorization code token request
2019-03-07 12:21:56.753 +04:00 [DBG] MWvbeqH0evcw1plecucibGi8pPmzCUKpb7abiB3iVOw= found in database: true
2019-03-07 12:21:56.776 +04:00 [DBG] removing MWvbeqH0evcw1plecucibGi8pPmzCUKpb7abiB3iVOw= persisted grant from database
2019-03-07 12:21:56.795 +04:00 [DBG] Validation of authorization code token request success
2019-03-07 12:21:56.804 +04:00 [INF] Token request validation success
{"ClientId":"BiLab","ClientName":"BiLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"c23d0e4a1b5d7e109c8154a416b2e0a509f2074c388fe770699a29ccca7abe50","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"BiLab","client_secret":"***REDACTED***","code":"c23d0e4a1b5d7e109c8154a416b2e0a509f2074c388fe770699a29ccca7abe50","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-03-07 12:21:56.841 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:21:56.842 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:21:56.856 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:21:56.862 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:21:56.879 +04:00 [DBG] Getting claims for access token for client: BiLab
2019-03-07 12:21:56.879 +04:00 [DBG] Getting claims for access token for subject: 1002
2019-03-07 12:21:56.892 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 12:21:56.906 +04:00 [DBG] Creating refresh token
2019-03-07 12:21:56.907 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-03-07 12:21:56.923 +04:00 [DBG] i74+3X72MkEIKcEpbBNHlZH8rHtIZaqRfXAZIFfsIkQ= not found in database
2019-03-07 12:21:56.953 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:21:56.953 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:21:56.958 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:21:56.960 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:21:56.961 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 12:21:56.972 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 12:21:56.979 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****g4Ew","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****3d4f","$type":"Token"},{"TokenType":"access_token","TokenValue":"****zF7g","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2QNI64GPD:00000003","TimeStamp":"2019-03-07T08:21:56.0000000Z","ProcessId":9004,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 12:21:56.988 +04:00 [DBG] Token request success.
2019-03-07 12:21:57.003 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-03-07 12:21:57.007 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-03-07 12:21:57.008 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-03-07 12:21:57.016 +04:00 [DBG] Start userinfo request
2019-03-07 12:21:57.021 +04:00 [DBG] Bearer token found in header
2019-03-07 12:21:57.088 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:21:57.089 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:21:57.097 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:21:57.097 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:21:57.108 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-03-07 12:21:57.111 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1551946916,"exp":1551950516,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"BiLab","sub":"1002","auth_time":1551946916,"idp":"local","AspNet.Identity.SecurityStamp":"YRQCMJ4XBHSYAYVIFGH3YHMVNOLY4SL5","role":"GodAdmin","preferred_username":"godAdmin@admin.ru","name":"godAdmin@admin.ru","email":"godAdmin@admin.ru","email_verified":false,"given_name":"godAdmin@admin.ru","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-03-07 12:21:57.128 +04:00 [DBG] Creating userinfo response
2019-03-07 12:21:57.138 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 12:21:57.143 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 12:21:57.151 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:21:57.152 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-03-07 12:21:57.153 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 12:21:57.157 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:21:57.177 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email
2019-03-07 12:21:57.179 +04:00 [DBG] End userinfo request
2019-03-07 12:24:20.396 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-07 12:27:00.025 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 12:27:00.028 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 12:27:00.037 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 12:27:00.039 +04:00 [DBG] Start authorize request
2019-03-07 12:27:00.040 +04:00 [DBG] No user present in authorize request
2019-03-07 12:27:00.040 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 12:27:00.075 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:27:00.076 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:27:00.078 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 12:27:00.079 +04:00 [DBG] No PKCE used.
2019-03-07 12:27:00.089 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:27:00.094 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:27:00.097 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:27:00.100 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:27:00.101 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 12:27:00.102 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCQLKiNkK0OQkdpWlPL9ePtVW6OueZPkAW9K0pAHUJpLX4kEXesqOJ6N0tD9guD7h6GNPVKfQRdXJc6o6XU9jPHr0m100H5aOrkrIIbYdDz86bmXQwE27q3hBG4mRrSthA-HcN0gDG056AdkRITjtlJVFnYxxEBS1fUcI1R1SCmEketokUGZzFh1cvxcwnftRupc-qXZi_a-8eKn5gS-cCdey3u9frwLoo0aaKpVR32zfFPSDikPZXnRlQJj76ti5ifGhGQXdmd7BnOk6rgkte8fvd2nOp1WQDmoxXNsZbw4Q9qgiiROkjXliAQL9mnyAM","UiLocales":null,"Nonce":"636875440199999060.Yzk1YTQ5M2MtODJkYi00NTBiLWFiYTktMjJiNDkxZWRkODgxNjk4ZWNmMjEtZTk1OC00NDk0LWIxYzUtYWIzZjUxMGI5NjYy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875440199999060.Yzk1YTQ5M2MtODJkYi00NTBiLWFiYTktMjJiNDkxZWRkODgxNjk4ZWNmMjEtZTk1OC00NDk0LWIxYzUtYWIzZjUxMGI5NjYy","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCQLKiNkK0OQkdpWlPL9ePtVW6OueZPkAW9K0pAHUJpLX4kEXesqOJ6N0tD9guD7h6GNPVKfQRdXJc6o6XU9jPHr0m100H5aOrkrIIbYdDz86bmXQwE27q3hBG4mRrSthA-HcN0gDG056AdkRITjtlJVFnYxxEBS1fUcI1R1SCmEketokUGZzFh1cvxcwnftRupc-qXZi_a-8eKn5gS-cCdey3u9frwLoo0aaKpVR32zfFPSDikPZXnRlQJj76ti5ifGhGQXdmd7BnOk6rgkte8fvd2nOp1WQDmoxXNsZbw4Q9qgiiROkjXliAQL9mnyAM","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 12:27:00.113 +04:00 [INF] Showing login: User is not authenticated
2019-03-07 12:27:03.866 +04:00 [DBG] Augmenting SignInContext
2019-03-07 12:27:03.868 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 12:27:03.869 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 12:27:03.870 +04:00 [DBG] Adding auth_time claim with value: 1551947223
2019-03-07 12:27:03.871 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 12:27:03.878 +04:00 [INF] {"Username":"godAdmin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"1002","DisplayName":"godAdmin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2QNI64GPC:0000000E","TimeStamp":"2019-03-07T08:27:03.0000000Z","ProcessId":9004,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 12:27:03.888 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-07 12:27:03.890 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-07 12:27:03.891 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-07 12:27:03.892 +04:00 [DBG] Start authorize callback request
2019-03-07 12:27:03.893 +04:00 [DBG] User in authorize request: 1002
2019-03-07 12:27:03.893 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 12:27:03.897 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:27:03.900 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:27:03.903 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 12:27:03.904 +04:00 [DBG] No PKCE used.
2019-03-07 12:27:03.908 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:27:03.910 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:27:03.913 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:27:03.916 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:27:03.917 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 12:27:03.918 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCQLKiNkK0OQkdpWlPL9ePtVW6OueZPkAW9K0pAHUJpLX4kEXesqOJ6N0tD9guD7h6GNPVKfQRdXJc6o6XU9jPHr0m100H5aOrkrIIbYdDz86bmXQwE27q3hBG4mRrSthA-HcN0gDG056AdkRITjtlJVFnYxxEBS1fUcI1R1SCmEketokUGZzFh1cvxcwnftRupc-qXZi_a-8eKn5gS-cCdey3u9frwLoo0aaKpVR32zfFPSDikPZXnRlQJj76ti5ifGhGQXdmd7BnOk6rgkte8fvd2nOp1WQDmoxXNsZbw4Q9qgiiROkjXliAQL9mnyAM","UiLocales":null,"Nonce":"636875440199999060.Yzk1YTQ5M2MtODJkYi00NTBiLWFiYTktMjJiNDkxZWRkODgxNjk4ZWNmMjEtZTk1OC00NDk0LWIxYzUtYWIzZjUxMGI5NjYy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e9cd625007f9c657aae7e99bbf455c3e","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875440199999060.Yzk1YTQ5M2MtODJkYi00NTBiLWFiYTktMjJiNDkxZWRkODgxNjk4ZWNmMjEtZTk1OC00NDk0LWIxYzUtYWIzZjUxMGI5NjYy","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCQLKiNkK0OQkdpWlPL9ePtVW6OueZPkAW9K0pAHUJpLX4kEXesqOJ6N0tD9guD7h6GNPVKfQRdXJc6o6XU9jPHr0m100H5aOrkrIIbYdDz86bmXQwE27q3hBG4mRrSthA-HcN0gDG056AdkRITjtlJVFnYxxEBS1fUcI1R1SCmEketokUGZzFh1cvxcwnftRupc-qXZi_a-8eKn5gS-cCdey3u9frwLoo0aaKpVR32zfFPSDikPZXnRlQJj76ti5ifGhGQXdmd7BnOk6rgkte8fvd2nOp1WQDmoxXNsZbw4Q9qgiiROkjXliAQL9mnyAM","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 12:27:03.932 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-07 12:27:03.934 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-07 12:27:03.940 +04:00 [DBG] tyWQdoB9LpiNUBUsgLmapYQu7jGPTumZoGvNU4oQzv4= not found in database
2019-03-07 12:27:03.947 +04:00 [DBG] Creating Implicit Flow response.
2019-03-07 12:27:03.948 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 12:27:03.957 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 12:27:03.960 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"1002","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****p2ww","$type":"Token"},{"TokenType":"code","TokenValue":"****18a8","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2QNI64GPC:0000000F","TimeStamp":"2019-03-07T08:27:03.0000000Z","ProcessId":9004,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 12:27:03.967 +04:00 [INF] Authorize endpoint response
{"SubjectId":"1002","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCQLKiNkK0OQkdpWlPL9ePtVW6OueZPkAW9K0pAHUJpLX4kEXesqOJ6N0tD9guD7h6GNPVKfQRdXJc6o6XU9jPHr0m100H5aOrkrIIbYdDz86bmXQwE27q3hBG4mRrSthA-HcN0gDG056AdkRITjtlJVFnYxxEBS1fUcI1R1SCmEketokUGZzFh1cvxcwnftRupc-qXZi_a-8eKn5gS-cCdey3u9frwLoo0aaKpVR32zfFPSDikPZXnRlQJj76ti5ifGhGQXdmd7BnOk6rgkte8fvd2nOp1WQDmoxXNsZbw4Q9qgiiROkjXliAQL9mnyAM","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-07 12:27:03.970 +04:00 [DBG] Augmenting SignInContext
2019-03-07 12:27:03.971 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 12:27:04.047 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-07 12:27:04.049 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-07 12:27:04.056 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-07 12:27:04.057 +04:00 [DBG] Start token request.
2019-03-07 12:27:04.057 +04:00 [DBG] Start client validation
2019-03-07 12:27:04.058 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-07 12:27:04.060 +04:00 [DBG] Start parsing for secret in post body
2019-03-07 12:27:04.061 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-07 12:27:04.061 +04:00 [DBG] Secret id found: BiLab
2019-03-07 12:27:04.072 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:27:04.073 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:27:04.074 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-07 12:27:04.074 +04:00 [DBG] Client validation success
2019-03-07 12:27:04.075 +04:00 [INF] {"ClientId":"BiLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLL2QNI64GPI:00000001","TimeStamp":"2019-03-07T08:27:04.0000000Z","ProcessId":9004,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-03-07 12:27:04.077 +04:00 [DBG] Start token request validation
2019-03-07 12:27:04.078 +04:00 [DBG] Start validation of authorization code token request
2019-03-07 12:27:04.082 +04:00 [DBG] tyWQdoB9LpiNUBUsgLmapYQu7jGPTumZoGvNU4oQzv4= found in database: true
2019-03-07 12:27:04.084 +04:00 [DBG] removing tyWQdoB9LpiNUBUsgLmapYQu7jGPTumZoGvNU4oQzv4= persisted grant from database
2019-03-07 12:27:04.095 +04:00 [DBG] Validation of authorization code token request success
2019-03-07 12:27:04.096 +04:00 [INF] Token request validation success
{"ClientId":"BiLab","ClientName":"BiLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"c5bc5938e173c3c01ab7c2735cb26a8a5fb98c9f3e75cbf77497121f87f918a8","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"BiLab","client_secret":"***REDACTED***","code":"c5bc5938e173c3c01ab7c2735cb26a8a5fb98c9f3e75cbf77497121f87f918a8","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-03-07 12:27:04.108 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:27:04.109 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:27:04.117 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:27:04.125 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:27:04.126 +04:00 [DBG] Getting claims for access token for client: BiLab
2019-03-07 12:27:04.126 +04:00 [DBG] Getting claims for access token for subject: 1002
2019-03-07 12:27:04.140 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 12:27:04.143 +04:00 [DBG] Creating refresh token
2019-03-07 12:27:04.143 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-03-07 12:27:04.145 +04:00 [DBG] 9BSvsHyij5ed3yo2/kQ5sL+FtejM9+PT5fG5ofrCO58= not found in database
2019-03-07 12:27:04.158 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:27:04.158 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:27:04.163 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:27:04.165 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:27:04.166 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 12:27:04.181 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 12:27:04.188 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****Y7DQ","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****4fe9","$type":"Token"},{"TokenType":"access_token","TokenValue":"****ppzw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2QNI64GPI:00000001","TimeStamp":"2019-03-07T08:27:04.0000000Z","ProcessId":9004,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 12:27:04.194 +04:00 [DBG] Token request success.
2019-03-07 12:27:04.197 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-03-07 12:27:04.199 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-03-07 12:27:04.206 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-03-07 12:27:04.208 +04:00 [DBG] Start userinfo request
2019-03-07 12:27:04.208 +04:00 [DBG] Bearer token found in header
2019-03-07 12:27:04.220 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:27:04.220 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:27:04.230 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:27:04.231 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:27:04.241 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-03-07 12:27:04.242 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1551947224,"exp":1551950824,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"BiLab","sub":"1002","auth_time":1551947223,"idp":"local","AspNet.Identity.SecurityStamp":"YRQCMJ4XBHSYAYVIFGH3YHMVNOLY4SL5","role":"GodAdmin","preferred_username":"godAdmin@admin.ru","name":"godAdmin@admin.ru","email":"godAdmin@admin.ru","email_verified":false,"given_name":"godAdmin@admin.ru","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-03-07 12:27:04.246 +04:00 [DBG] Creating userinfo response
2019-03-07 12:27:04.247 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 12:27:04.248 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 12:27:04.257 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:27:04.258 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-03-07 12:27:04.260 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 12:27:04.262 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:27:04.270 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email
2019-03-07 12:27:04.273 +04:00 [DBG] End userinfo request
2019-03-07 12:27:06.694 +04:00 [ERR] The view 'Index' was not found. Searched locations: ["/Views/Home/Index.cshtml","/Views/Shared/Index.cshtml","/Pages/Shared/Index.cshtml"]
2019-03-07 12:27:06.704 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The view 'Index' was not found. The following locations were searched:
/Views/Home/Index.cshtml
/Views/Shared/Index.cshtml
/Pages/Shared/Index.cshtml
   at Microsoft.AspNetCore.Mvc.ViewEngines.ViewEngineResult.EnsureSuccessful(IEnumerable`1 originalLocations)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-03-07 12:27:19.958 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-07 12:32:24.402 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 12:32:24.406 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 12:32:24.407 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 12:32:24.410 +04:00 [DBG] Start authorize request
2019-03-07 12:32:24.411 +04:00 [DBG] No user present in authorize request
2019-03-07 12:32:24.413 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 12:32:24.450 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:32:24.451 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:32:24.453 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 12:32:24.453 +04:00 [DBG] No PKCE used.
2019-03-07 12:32:24.466 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:32:24.471 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:32:24.474 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:32:24.476 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:32:24.477 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 12:32:24.478 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCYk4Q1Sq5OIz-VmRa0Hn0Fbcxu-THSWowRRuBPrhsAM-IOrbcsXv1eiPija3f68ueuuS-pbtWGabKnzwI-0YRuC6zP0xc13XMpA73N3ht_jgPRAQICqBlgDIvwa9YN8Dg4IZocV2FeL4ZLvq1giUB11MAcFIOGLJaZwJJ_kYnvyKa3PYKDmnBlejp83yuBAwf4PARHrrItG0y5lnNz6NKr6wzXk_EsSqD89h61VVWqFiD7eJCAl_wHn1Pa85i2VMsZ6fpGTGO6uUvOF1BJaYuaBv9ZyOY5MUApW4tWs83uvIjgJUeeUQlWzO3MCj_k7Yc","UiLocales":null,"Nonce":"636875443443742072.ZjcwYzZkZWUtNmMyYi00OGE5LTliOGYtYTRhMGZlNGIzZmYxOWRhOGU3MzYtM2E2Yy00ZDMwLTk4NzUtNzFhNjg4ODlkYTll","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875443443742072.ZjcwYzZkZWUtNmMyYi00OGE5LTliOGYtYTRhMGZlNGIzZmYxOWRhOGU3MzYtM2E2Yy00ZDMwLTk4NzUtNzFhNjg4ODlkYTll","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCYk4Q1Sq5OIz-VmRa0Hn0Fbcxu-THSWowRRuBPrhsAM-IOrbcsXv1eiPija3f68ueuuS-pbtWGabKnzwI-0YRuC6zP0xc13XMpA73N3ht_jgPRAQICqBlgDIvwa9YN8Dg4IZocV2FeL4ZLvq1giUB11MAcFIOGLJaZwJJ_kYnvyKa3PYKDmnBlejp83yuBAwf4PARHrrItG0y5lnNz6NKr6wzXk_EsSqD89h61VVWqFiD7eJCAl_wHn1Pa85i2VMsZ6fpGTGO6uUvOF1BJaYuaBv9ZyOY5MUApW4tWs83uvIjgJUeeUQlWzO3MCj_k7Yc","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 12:32:24.491 +04:00 [INF] Showing login: User is not authenticated
2019-03-07 12:32:51.589 +04:00 [DBG] Augmenting SignInContext
2019-03-07 12:32:51.589 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 12:32:51.592 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 12:32:51.592 +04:00 [DBG] Adding auth_time claim with value: 1551947571
2019-03-07 12:32:51.593 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 12:32:51.602 +04:00 [INF] {"Username":"godAdmin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"1002","DisplayName":"godAdmin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2QNI64GPK:00000003","TimeStamp":"2019-03-07T08:32:51.0000000Z","ProcessId":9004,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 12:32:51.617 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-07 12:32:51.620 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-07 12:32:51.622 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-07 12:32:51.624 +04:00 [DBG] Start authorize callback request
2019-03-07 12:32:51.625 +04:00 [DBG] User in authorize request: 1002
2019-03-07 12:32:51.626 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 12:32:51.654 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:32:51.654 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:32:51.656 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 12:32:51.657 +04:00 [DBG] No PKCE used.
2019-03-07 12:32:51.665 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:32:51.678 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:32:51.680 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:32:51.682 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:32:51.684 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 12:32:51.688 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCYk4Q1Sq5OIz-VmRa0Hn0Fbcxu-THSWowRRuBPrhsAM-IOrbcsXv1eiPija3f68ueuuS-pbtWGabKnzwI-0YRuC6zP0xc13XMpA73N3ht_jgPRAQICqBlgDIvwa9YN8Dg4IZocV2FeL4ZLvq1giUB11MAcFIOGLJaZwJJ_kYnvyKa3PYKDmnBlejp83yuBAwf4PARHrrItG0y5lnNz6NKr6wzXk_EsSqD89h61VVWqFiD7eJCAl_wHn1Pa85i2VMsZ6fpGTGO6uUvOF1BJaYuaBv9ZyOY5MUApW4tWs83uvIjgJUeeUQlWzO3MCj_k7Yc","UiLocales":null,"Nonce":"636875443443742072.ZjcwYzZkZWUtNmMyYi00OGE5LTliOGYtYTRhMGZlNGIzZmYxOWRhOGU3MzYtM2E2Yy00ZDMwLTk4NzUtNzFhNjg4ODlkYTll","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e722789757fe9d229a6e57a65058212b","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875443443742072.ZjcwYzZkZWUtNmMyYi00OGE5LTliOGYtYTRhMGZlNGIzZmYxOWRhOGU3MzYtM2E2Yy00ZDMwLTk4NzUtNzFhNjg4ODlkYTll","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCYk4Q1Sq5OIz-VmRa0Hn0Fbcxu-THSWowRRuBPrhsAM-IOrbcsXv1eiPija3f68ueuuS-pbtWGabKnzwI-0YRuC6zP0xc13XMpA73N3ht_jgPRAQICqBlgDIvwa9YN8Dg4IZocV2FeL4ZLvq1giUB11MAcFIOGLJaZwJJ_kYnvyKa3PYKDmnBlejp83yuBAwf4PARHrrItG0y5lnNz6NKr6wzXk_EsSqD89h61VVWqFiD7eJCAl_wHn1Pa85i2VMsZ6fpGTGO6uUvOF1BJaYuaBv9ZyOY5MUApW4tWs83uvIjgJUeeUQlWzO3MCj_k7Yc","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 12:32:51.705 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-07 12:32:51.706 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-07 12:32:51.708 +04:00 [DBG] 9a/WL3brN7tHGvny6HuLrOp9nERrmInLAIUMyYoQvY4= not found in database
2019-03-07 12:32:51.712 +04:00 [DBG] Creating Implicit Flow response.
2019-03-07 12:32:51.713 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 12:32:51.726 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 12:32:51.731 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"1002","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****J1nw","$type":"Token"},{"TokenType":"code","TokenValue":"****70ad","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2QNI64GPK:00000004","TimeStamp":"2019-03-07T08:32:51.0000000Z","ProcessId":9004,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 12:32:51.742 +04:00 [INF] Authorize endpoint response
{"SubjectId":"1002","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCYk4Q1Sq5OIz-VmRa0Hn0Fbcxu-THSWowRRuBPrhsAM-IOrbcsXv1eiPija3f68ueuuS-pbtWGabKnzwI-0YRuC6zP0xc13XMpA73N3ht_jgPRAQICqBlgDIvwa9YN8Dg4IZocV2FeL4ZLvq1giUB11MAcFIOGLJaZwJJ_kYnvyKa3PYKDmnBlejp83yuBAwf4PARHrrItG0y5lnNz6NKr6wzXk_EsSqD89h61VVWqFiD7eJCAl_wHn1Pa85i2VMsZ6fpGTGO6uUvOF1BJaYuaBv9ZyOY5MUApW4tWs83uvIjgJUeeUQlWzO3MCj_k7Yc","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-07 12:32:51.745 +04:00 [DBG] Augmenting SignInContext
2019-03-07 12:32:51.745 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 12:32:51.812 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-07 12:32:51.815 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-07 12:32:51.822 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-07 12:32:51.826 +04:00 [DBG] Start token request.
2019-03-07 12:32:51.826 +04:00 [DBG] Start client validation
2019-03-07 12:32:51.827 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-07 12:32:51.828 +04:00 [DBG] Start parsing for secret in post body
2019-03-07 12:32:51.829 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-07 12:32:51.829 +04:00 [DBG] Secret id found: BiLab
2019-03-07 12:32:51.837 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:32:51.837 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:32:51.839 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-07 12:32:51.840 +04:00 [DBG] Client validation success
2019-03-07 12:32:51.840 +04:00 [INF] {"ClientId":"BiLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLL2QNI64GPM:00000001","TimeStamp":"2019-03-07T08:32:51.0000000Z","ProcessId":9004,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-03-07 12:32:51.843 +04:00 [DBG] Start token request validation
2019-03-07 12:32:51.844 +04:00 [DBG] Start validation of authorization code token request
2019-03-07 12:32:51.846 +04:00 [DBG] 9a/WL3brN7tHGvny6HuLrOp9nERrmInLAIUMyYoQvY4= found in database: true
2019-03-07 12:32:51.850 +04:00 [DBG] removing 9a/WL3brN7tHGvny6HuLrOp9nERrmInLAIUMyYoQvY4= persisted grant from database
2019-03-07 12:32:51.858 +04:00 [DBG] Validation of authorization code token request success
2019-03-07 12:32:51.858 +04:00 [INF] Token request validation success
{"ClientId":"BiLab","ClientName":"BiLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"611c2f9d9db783f59068421a5748f5491939fd32a0c1a72ffd3e1154863770ad","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"BiLab","client_secret":"***REDACTED***","code":"611c2f9d9db783f59068421a5748f5491939fd32a0c1a72ffd3e1154863770ad","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-03-07 12:32:51.866 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:32:51.869 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:32:51.878 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:32:51.884 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:32:51.885 +04:00 [DBG] Getting claims for access token for client: BiLab
2019-03-07 12:32:51.886 +04:00 [DBG] Getting claims for access token for subject: 1002
2019-03-07 12:32:51.894 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 12:32:51.898 +04:00 [DBG] Creating refresh token
2019-03-07 12:32:51.898 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-03-07 12:32:51.900 +04:00 [DBG] LvUvVeh4bYYi7vC52+0zx/abGuBZ4qNlsiKrDjg75Xw= not found in database
2019-03-07 12:32:51.908 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:32:51.909 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:32:51.912 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:32:51.914 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:32:51.914 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 12:32:51.924 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 12:32:51.928 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****7_lQ","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****ad2c","$type":"Token"},{"TokenType":"access_token","TokenValue":"****K9ow","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2QNI64GPM:00000001","TimeStamp":"2019-03-07T08:32:51.0000000Z","ProcessId":9004,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 12:32:51.933 +04:00 [DBG] Token request success.
2019-03-07 12:32:51.936 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-03-07 12:32:51.939 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-03-07 12:32:51.940 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-03-07 12:32:51.940 +04:00 [DBG] Start userinfo request
2019-03-07 12:32:51.941 +04:00 [DBG] Bearer token found in header
2019-03-07 12:32:51.946 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:32:51.949 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:32:51.956 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:32:51.957 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:32:51.961 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-03-07 12:32:51.962 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1551947571,"exp":1551951171,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"BiLab","sub":"1002","auth_time":1551947571,"idp":"local","AspNet.Identity.SecurityStamp":"YRQCMJ4XBHSYAYVIFGH3YHMVNOLY4SL5","role":"GodAdmin","preferred_username":"godAdmin@admin.ru","name":"godAdmin@admin.ru","email":"godAdmin@admin.ru","email_verified":false,"given_name":"godAdmin@admin.ru","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-03-07 12:32:51.972 +04:00 [DBG] Creating userinfo response
2019-03-07 12:32:51.972 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 12:32:51.973 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 12:32:51.976 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:32:51.977 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-03-07 12:32:51.980 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 12:32:51.988 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:32:51.995 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email
2019-03-07 12:32:51.996 +04:00 [DBG] End userinfo request
2019-03-07 12:39:47.313 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 12:39:47.367 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 12:39:47.369 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 12:39:47.369 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 12:39:47.369 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 12:39:47.370 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 12:39:47.370 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 12:39:47.640 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:39:47.654 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:39:47.658 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:39:47.746 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 12:39:47.806 +04:00 [DBG] Starting grant removal
2019-03-07 12:39:48.732 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 12:39:48.735 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 12:39:48.737 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 12:39:48.738 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 12:39:48.739 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 12:39:48.739 +04:00 [DBG] Error Url: /home/error
2019-03-07 12:39:48.740 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 12:39:48.797 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 12:40:11.490 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 12:40:11.496 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 12:40:11.498 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 12:40:11.503 +04:00 [DBG] Start discovery request
2019-03-07 12:40:12.049 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 12:40:12.208 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 12:40:12.211 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 12:40:12.212 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 12:40:12.217 +04:00 [DBG] Start key discovery request
2019-03-07 12:40:12.316 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 12:40:12.325 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 12:40:12.326 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 12:40:12.331 +04:00 [DBG] Start authorize request
2019-03-07 12:40:12.343 +04:00 [DBG] No user present in authorize request
2019-03-07 12:40:12.348 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 12:40:12.708 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:40:12.730 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:40:12.763 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 12:40:12.766 +04:00 [DBG] No PKCE used.
2019-03-07 12:40:12.840 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:40:12.888 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:40:12.898 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:40:12.900 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:40:12.910 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 12:40:12.927 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAoTOsm7oCESQsFf2OcWfzKiR9EXhViZ-tLyhyzd8qWI1zl9t1C5nDaNq7IgeVlH7DJTHwOGMOpQvZYHNTHdtz0t9GPnMJfxM1YPyrhN17acFGkclflIwYD14dMviuH8_tPp90xRCb6q__vDeQNx7c3Pl4pukc6nviNlHwqUmpDcDZI8CgXDu4lL9yubU91h8dG8asBAT2f6NJg9HJZK0YRGIHw4rWZ2h83Q5YgOHZErYPg_wmoTYUWRPIQhQkEgLt8WPi8aJgULhQqqCIWUFvl4KFU8eJU_-EYhP9SJ_NMQ5B9tsPkh9Q1tGYrR6Trge4","UiLocales":null,"Nonce":"636875448122877210.YTUxOGRiZDItOTQzNS00NmFhLTljMzgtOTAxYTI3MWQ1ZGE2NGE3NGJmYmItNDllMy00MTNlLWE5OTUtM2E3ZjAzZmY0NjAw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875448122877210.YTUxOGRiZDItOTQzNS00NmFhLTljMzgtOTAxYTI3MWQ1ZGE2NGE3NGJmYmItNDllMy00MTNlLWE5OTUtM2E3ZjAzZmY0NjAw","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAoTOsm7oCESQsFf2OcWfzKiR9EXhViZ-tLyhyzd8qWI1zl9t1C5nDaNq7IgeVlH7DJTHwOGMOpQvZYHNTHdtz0t9GPnMJfxM1YPyrhN17acFGkclflIwYD14dMviuH8_tPp90xRCb6q__vDeQNx7c3Pl4pukc6nviNlHwqUmpDcDZI8CgXDu4lL9yubU91h8dG8asBAT2f6NJg9HJZK0YRGIHw4rWZ2h83Q5YgOHZErYPg_wmoTYUWRPIQhQkEgLt8WPi8aJgULhQqqCIWUFvl4KFU8eJU_-EYhP9SJ_NMQ5B9tsPkh9Q1tGYrR6Trge4","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 12:40:12.951 +04:00 [INF] Showing login: User is not authenticated
2019-03-07 12:40:18.585 +04:00 [DBG] Augmenting SignInContext
2019-03-07 12:40:18.587 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 12:40:18.588 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 12:40:18.589 +04:00 [DBG] Adding auth_time claim with value: 1551948018
2019-03-07 12:40:18.602 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 12:40:18.631 +04:00 [INF] {"Username":"godAdmin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"1002","DisplayName":"godAdmin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2R1QGGA28:00000004","TimeStamp":"2019-03-07T08:40:18.0000000Z","ProcessId":4428,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 12:40:18.675 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-07 12:40:18.678 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-07 12:40:18.679 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-07 12:40:18.687 +04:00 [DBG] Start authorize callback request
2019-03-07 12:40:18.694 +04:00 [DBG] User in authorize request: 1002
2019-03-07 12:40:18.695 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 12:40:18.717 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:40:18.718 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:40:18.719 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 12:40:18.720 +04:00 [DBG] No PKCE used.
2019-03-07 12:40:18.722 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:40:18.724 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:40:18.729 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:40:18.731 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:40:18.732 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 12:40:18.734 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAoTOsm7oCESQsFf2OcWfzKiR9EXhViZ-tLyhyzd8qWI1zl9t1C5nDaNq7IgeVlH7DJTHwOGMOpQvZYHNTHdtz0t9GPnMJfxM1YPyrhN17acFGkclflIwYD14dMviuH8_tPp90xRCb6q__vDeQNx7c3Pl4pukc6nviNlHwqUmpDcDZI8CgXDu4lL9yubU91h8dG8asBAT2f6NJg9HJZK0YRGIHw4rWZ2h83Q5YgOHZErYPg_wmoTYUWRPIQhQkEgLt8WPi8aJgULhQqqCIWUFvl4KFU8eJU_-EYhP9SJ_NMQ5B9tsPkh9Q1tGYrR6Trge4","UiLocales":null,"Nonce":"636875448122877210.YTUxOGRiZDItOTQzNS00NmFhLTljMzgtOTAxYTI3MWQ1ZGE2NGE3NGJmYmItNDllMy00MTNlLWE5OTUtM2E3ZjAzZmY0NjAw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"2013f88a58d5e614122e1f08b47dfc70","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875448122877210.YTUxOGRiZDItOTQzNS00NmFhLTljMzgtOTAxYTI3MWQ1ZGE2NGE3NGJmYmItNDllMy00MTNlLWE5OTUtM2E3ZjAzZmY0NjAw","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNAoTOsm7oCESQsFf2OcWfzKiR9EXhViZ-tLyhyzd8qWI1zl9t1C5nDaNq7IgeVlH7DJTHwOGMOpQvZYHNTHdtz0t9GPnMJfxM1YPyrhN17acFGkclflIwYD14dMviuH8_tPp90xRCb6q__vDeQNx7c3Pl4pukc6nviNlHwqUmpDcDZI8CgXDu4lL9yubU91h8dG8asBAT2f6NJg9HJZK0YRGIHw4rWZ2h83Q5YgOHZErYPg_wmoTYUWRPIQhQkEgLt8WPi8aJgULhQqqCIWUFvl4KFU8eJU_-EYhP9SJ_NMQ5B9tsPkh9Q1tGYrR6Trge4","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 12:40:18.773 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-07 12:40:18.783 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-07 12:40:18.822 +04:00 [DBG] NomxwzarxnsqtC4n4Hmrlv8xwFWzSGgcY6GnJmqlO80= not found in database
2019-03-07 12:40:18.888 +04:00 [DBG] Creating Implicit Flow response.
2019-03-07 12:40:18.899 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 12:43:32.060 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 12:43:32.111 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 12:43:32.112 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 12:43:32.112 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 12:43:32.112 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 12:43:32.112 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 12:43:32.113 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 12:43:32.340 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:43:32.354 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:43:32.356 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:43:32.433 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 12:43:32.492 +04:00 [DBG] Starting grant removal
2019-03-07 12:43:33.195 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 12:43:33.197 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 12:43:33.199 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 12:43:33.200 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 12:43:33.200 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 12:43:33.201 +04:00 [DBG] Error Url: /home/error
2019-03-07 12:43:33.201 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 12:43:33.253 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 12:43:43.531 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 12:43:43.538 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 12:43:43.539 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 12:43:43.544 +04:00 [DBG] Start discovery request
2019-03-07 12:43:44.020 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 12:43:44.155 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 12:43:44.158 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 12:43:44.161 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 12:43:44.166 +04:00 [DBG] Start key discovery request
2019-03-07 12:43:44.261 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 12:43:44.267 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 12:43:44.268 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 12:43:44.273 +04:00 [DBG] Start authorize request
2019-03-07 12:43:44.285 +04:00 [DBG] User in authorize request: 1002
2019-03-07 12:43:44.289 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 12:43:44.553 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:43:44.562 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:43:44.569 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 12:43:44.571 +04:00 [DBG] No PKCE used.
2019-03-07 12:43:44.624 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:43:44.664 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:43:44.675 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:43:44.677 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:43:44.686 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 12:43:44.701 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCjs4FsgZVNiD6ZZzbnLPPl-2cyhnRlaqHr4APyK-chwc48vSRkFMBPAA2vVFYys6uE5HbNRd8VElp49RqI3AxBPxZTEDJvSEgbndXjRHgL2sC3VRQQG6-6T0J5l78m1zUiltQxeBxadm-p4WT-kb8bk_anA85c5bJauVstmMOS0Sknrld6nfko-TrgOaxmqHpaj9UxqD1iW7H_LsZioikfQKI4XfBGSGRq8JNOYFEFTv8CCLlEbsUcOM71TgCB9Ir_UzOdBVKZ7JB63B-ZglpPAIKs9zK9uZ47BZ4DrGljRqis5q5sP_lSPUGUHKtxfAs","UiLocales":null,"Nonce":"636875450242382082.ZGY5YTQ3MDQtMzU2Zi00NjczLWE3NDYtNGJkYjc5YTgyOTRmYzBiOWEwOTAtZjcxMy00NDE1LWE3YTctMTRlMTRjOTgyZmRl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"2013f88a58d5e614122e1f08b47dfc70","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875450242382082.ZGY5YTQ3MDQtMzU2Zi00NjczLWE3NDYtNGJkYjc5YTgyOTRmYzBiOWEwOTAtZjcxMy00NDE1LWE3YTctMTRlMTRjOTgyZmRl","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCjs4FsgZVNiD6ZZzbnLPPl-2cyhnRlaqHr4APyK-chwc48vSRkFMBPAA2vVFYys6uE5HbNRd8VElp49RqI3AxBPxZTEDJvSEgbndXjRHgL2sC3VRQQG6-6T0J5l78m1zUiltQxeBxadm-p4WT-kb8bk_anA85c5bJauVstmMOS0Sknrld6nfko-TrgOaxmqHpaj9UxqD1iW7H_LsZioikfQKI4XfBGSGRq8JNOYFEFTv8CCLlEbsUcOM71TgCB9Ir_UzOdBVKZ7JB63B-ZglpPAIKs9zK9uZ47BZ4DrGljRqis5q5sP_lSPUGUHKtxfAs","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 12:43:44.752 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-07 12:43:44.760 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-07 12:43:44.794 +04:00 [DBG] dWx2HFDLnF0E11mLfBIaqqjPQwYGduNdEBMKh/9RWk4= not found in database
2019-03-07 12:43:44.855 +04:00 [DBG] Creating Implicit Flow response.
2019-03-07 12:43:44.865 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 12:43:50.026 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 12:43:50.137 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"1002","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****3DhQ","$type":"Token"},{"TokenType":"code","TokenValue":"****731d","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2R3TFP1ES:00000002","TimeStamp":"2019-03-07T08:43:50.0000000Z","ProcessId":5412,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 12:43:50.145 +04:00 [INF] Authorize endpoint response
{"SubjectId":"1002","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNCjs4FsgZVNiD6ZZzbnLPPl-2cyhnRlaqHr4APyK-chwc48vSRkFMBPAA2vVFYys6uE5HbNRd8VElp49RqI3AxBPxZTEDJvSEgbndXjRHgL2sC3VRQQG6-6T0J5l78m1zUiltQxeBxadm-p4WT-kb8bk_anA85c5bJauVstmMOS0Sknrld6nfko-TrgOaxmqHpaj9UxqD1iW7H_LsZioikfQKI4XfBGSGRq8JNOYFEFTv8CCLlEbsUcOM71TgCB9Ir_UzOdBVKZ7JB63B-ZglpPAIKs9zK9uZ47BZ4DrGljRqis5q5sP_lSPUGUHKtxfAs","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-07 12:43:50.174 +04:00 [DBG] Augmenting SignInContext
2019-03-07 12:43:50.187 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 12:43:50.319 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-07 12:43:50.325 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-07 12:43:50.326 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-07 12:43:50.335 +04:00 [DBG] Start token request.
2019-03-07 12:43:50.342 +04:00 [DBG] Start client validation
2019-03-07 12:43:50.347 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-07 12:43:50.352 +04:00 [DBG] Start parsing for secret in post body
2019-03-07 12:43:50.367 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-07 12:43:50.367 +04:00 [DBG] Secret id found: BiLab
2019-03-07 12:43:50.388 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:43:50.389 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:43:50.398 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-07 12:43:50.399 +04:00 [DBG] Client validation success
2019-03-07 12:43:50.400 +04:00 [INF] {"ClientId":"BiLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLL2R3TFP1ET:00000003","TimeStamp":"2019-03-07T08:43:50.0000000Z","ProcessId":5412,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-03-07 12:43:50.410 +04:00 [DBG] Start token request validation
2019-03-07 12:43:50.423 +04:00 [DBG] Start validation of authorization code token request
2019-03-07 12:43:50.440 +04:00 [DBG] dWx2HFDLnF0E11mLfBIaqqjPQwYGduNdEBMKh/9RWk4= found in database: true
2019-03-07 12:43:50.462 +04:00 [DBG] removing dWx2HFDLnF0E11mLfBIaqqjPQwYGduNdEBMKh/9RWk4= persisted grant from database
2019-03-07 12:43:50.476 +04:00 [DBG] Validation of authorization code token request success
2019-03-07 12:43:50.481 +04:00 [INF] Token request validation success
{"ClientId":"BiLab","ClientName":"BiLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"5a59eb9cf2e25f48eb36d0143d5087012123680fdf592841b969351cecbf731d","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"BiLab","client_secret":"***REDACTED***","code":"5a59eb9cf2e25f48eb36d0143d5087012123680fdf592841b969351cecbf731d","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-03-07 12:43:50.509 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:43:50.509 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:43:50.519 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:43:50.525 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:43:50.538 +04:00 [DBG] Getting claims for access token for client: BiLab
2019-03-07 12:43:50.538 +04:00 [DBG] Getting claims for access token for subject: 1002
2019-03-07 12:43:50.553 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 12:43:50.562 +04:00 [DBG] Creating refresh token
2019-03-07 12:43:50.563 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-03-07 12:43:50.587 +04:00 [DBG] Sd4sbXS0BQbh/hSwnWU+vR+QAAuMNt+YccHhyo00Fzo= not found in database
2019-03-07 12:43:50.608 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:43:50.608 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:43:50.612 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:43:50.613 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:43:50.614 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 12:43:50.623 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 12:43:50.629 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****qSTA","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****0746","$type":"Token"},{"TokenType":"access_token","TokenValue":"****9SvA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2R3TFP1ET:00000003","TimeStamp":"2019-03-07T08:43:50.0000000Z","ProcessId":5412,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 12:43:50.635 +04:00 [DBG] Token request success.
2019-03-07 12:43:50.650 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-03-07 12:43:50.654 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-03-07 12:43:50.655 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-03-07 12:43:50.663 +04:00 [DBG] Start userinfo request
2019-03-07 12:43:50.666 +04:00 [DBG] Bearer token found in header
2019-03-07 12:43:50.723 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:43:50.723 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:43:50.731 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:43:50.731 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:43:50.740 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-03-07 12:43:50.744 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1551948230,"exp":1551951830,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"BiLab","sub":"1002","auth_time":1551948018,"idp":"local","AspNet.Identity.SecurityStamp":"YRQCMJ4XBHSYAYVIFGH3YHMVNOLY4SL5","role":"GodAdmin","preferred_username":"godAdmin@admin.ru","name":"godAdmin@admin.ru","email":"godAdmin@admin.ru","email_verified":false,"given_name":"godAdmin@admin.ru","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-03-07 12:43:50.759 +04:00 [DBG] Creating userinfo response
2019-03-07 12:43:50.762 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 12:43:50.767 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 12:43:50.773 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:43:50.774 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-03-07 12:43:50.777 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 12:43:50.780 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:43:50.790 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email
2019-03-07 12:43:50.791 +04:00 [DBG] End userinfo request
2019-03-07 12:44:08.767 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 12:44:08.772 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 12:44:08.773 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 12:44:08.774 +04:00 [DBG] Start authorize request
2019-03-07 12:44:08.775 +04:00 [DBG] No user present in authorize request
2019-03-07 12:44:08.775 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 12:44:08.780 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:44:08.782 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:44:08.784 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 12:44:08.784 +04:00 [DBG] No PKCE used.
2019-03-07 12:44:08.792 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:44:08.797 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:44:08.801 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:44:08.804 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:44:08.805 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 12:44:08.806 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBJQ1pbJ3yFURKhbxAk2wHbD-mB-xMWpzrKiJwbBUq5CqL0_JE5iTDP2ghA-iaJp6LV3r8ElQvgOh4LcZQjnsMu7iatI-OQdFbfuVnWOIWd_RbFczoQXM9pPqa3GzoZPWSW8OSd7oCq15euOUEQJNMUH_pF3x_VSmkU0pV96GrVlLv4WqVJAH8-_3CxB2RFvKYwlBckmNp7FLiLSvcaxQaHvbsWMKR48AKwEaUlQTRH15ePuftKBPVG9cU004lpKfqXz4NuE7-3bvuC4gHpNTf0YgBdtgiojjnTXczO8BSud3WsSV7rJoNNeDltfip4q5k","UiLocales":null,"Nonce":"636875450487579339.OWUyZTNjZGUtOGZhMy00MjRlLTk3OWQtYWZlZmIxNWExNjAyYjczMWQ1NGQtNjcyNS00ZmRlLTkwOWQtMTc5Yzg2MzFlZDBi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875450487579339.OWUyZTNjZGUtOGZhMy00MjRlLTk3OWQtYWZlZmIxNWExNjAyYjczMWQ1NGQtNjcyNS00ZmRlLTkwOWQtMTc5Yzg2MzFlZDBi","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBJQ1pbJ3yFURKhbxAk2wHbD-mB-xMWpzrKiJwbBUq5CqL0_JE5iTDP2ghA-iaJp6LV3r8ElQvgOh4LcZQjnsMu7iatI-OQdFbfuVnWOIWd_RbFczoQXM9pPqa3GzoZPWSW8OSd7oCq15euOUEQJNMUH_pF3x_VSmkU0pV96GrVlLv4WqVJAH8-_3CxB2RFvKYwlBckmNp7FLiLSvcaxQaHvbsWMKR48AKwEaUlQTRH15ePuftKBPVG9cU004lpKfqXz4NuE7-3bvuC4gHpNTf0YgBdtgiojjnTXczO8BSud3WsSV7rJoNNeDltfip4q5k","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 12:44:08.818 +04:00 [INF] Showing login: User is not authenticated
2019-03-07 12:44:11.943 +04:00 [DBG] Augmenting SignInContext
2019-03-07 12:44:11.944 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 12:44:11.946 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 12:44:11.947 +04:00 [DBG] Adding auth_time claim with value: 1551948251
2019-03-07 12:44:11.949 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 12:44:11.955 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2R3TFP1ES:00000005","TimeStamp":"2019-03-07T08:44:11.0000000Z","ProcessId":5412,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 12:44:11.972 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-07 12:44:11.975 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-07 12:44:11.975 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-07 12:44:11.981 +04:00 [DBG] Start authorize callback request
2019-03-07 12:44:11.985 +04:00 [DBG] User in authorize request: 2
2019-03-07 12:44:11.986 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 12:44:11.991 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:44:11.992 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:44:11.994 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 12:44:11.996 +04:00 [DBG] No PKCE used.
2019-03-07 12:44:11.998 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:44:11.999 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:44:12.001 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:44:12.003 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:44:12.005 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 12:44:12.008 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBJQ1pbJ3yFURKhbxAk2wHbD-mB-xMWpzrKiJwbBUq5CqL0_JE5iTDP2ghA-iaJp6LV3r8ElQvgOh4LcZQjnsMu7iatI-OQdFbfuVnWOIWd_RbFczoQXM9pPqa3GzoZPWSW8OSd7oCq15euOUEQJNMUH_pF3x_VSmkU0pV96GrVlLv4WqVJAH8-_3CxB2RFvKYwlBckmNp7FLiLSvcaxQaHvbsWMKR48AKwEaUlQTRH15ePuftKBPVG9cU004lpKfqXz4NuE7-3bvuC4gHpNTf0YgBdtgiojjnTXczO8BSud3WsSV7rJoNNeDltfip4q5k","UiLocales":null,"Nonce":"636875450487579339.OWUyZTNjZGUtOGZhMy00MjRlLTk3OWQtYWZlZmIxNWExNjAyYjczMWQ1NGQtNjcyNS00ZmRlLTkwOWQtMTc5Yzg2MzFlZDBi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"b9510e749db6d180110a3686a0b04d59","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875450487579339.OWUyZTNjZGUtOGZhMy00MjRlLTk3OWQtYWZlZmIxNWExNjAyYjczMWQ1NGQtNjcyNS00ZmRlLTkwOWQtMTc5Yzg2MzFlZDBi","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBJQ1pbJ3yFURKhbxAk2wHbD-mB-xMWpzrKiJwbBUq5CqL0_JE5iTDP2ghA-iaJp6LV3r8ElQvgOh4LcZQjnsMu7iatI-OQdFbfuVnWOIWd_RbFczoQXM9pPqa3GzoZPWSW8OSd7oCq15euOUEQJNMUH_pF3x_VSmkU0pV96GrVlLv4WqVJAH8-_3CxB2RFvKYwlBckmNp7FLiLSvcaxQaHvbsWMKR48AKwEaUlQTRH15ePuftKBPVG9cU004lpKfqXz4NuE7-3bvuC4gHpNTf0YgBdtgiojjnTXczO8BSud3WsSV7rJoNNeDltfip4q5k","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 12:44:12.025 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-07 12:44:12.026 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-07 12:44:12.030 +04:00 [DBG] p9IvRiemlIXFj/JjQaqNkvqK35TYAlkFyAAvWwNgKMM= not found in database
2019-03-07 12:44:12.034 +04:00 [DBG] Creating Implicit Flow response.
2019-03-07 12:44:12.035 +04:00 [DBG] Getting claims for identity token for subject: 2 and client: BiLab
2019-03-07 12:44:12.045 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 12:44:12.050 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"2","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****a7lQ","$type":"Token"},{"TokenType":"code","TokenValue":"****6cde","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2R3TFP1ES:00000006","TimeStamp":"2019-03-07T08:44:12.0000000Z","ProcessId":5412,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 12:44:12.057 +04:00 [INF] Authorize endpoint response
{"SubjectId":"2","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBJQ1pbJ3yFURKhbxAk2wHbD-mB-xMWpzrKiJwbBUq5CqL0_JE5iTDP2ghA-iaJp6LV3r8ElQvgOh4LcZQjnsMu7iatI-OQdFbfuVnWOIWd_RbFczoQXM9pPqa3GzoZPWSW8OSd7oCq15euOUEQJNMUH_pF3x_VSmkU0pV96GrVlLv4WqVJAH8-_3CxB2RFvKYwlBckmNp7FLiLSvcaxQaHvbsWMKR48AKwEaUlQTRH15ePuftKBPVG9cU004lpKfqXz4NuE7-3bvuC4gHpNTf0YgBdtgiojjnTXczO8BSud3WsSV7rJoNNeDltfip4q5k","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-07 12:44:12.062 +04:00 [DBG] Augmenting SignInContext
2019-03-07 12:44:12.063 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 12:44:12.108 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-07 12:44:12.113 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-07 12:44:12.114 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-07 12:44:12.115 +04:00 [DBG] Start token request.
2019-03-07 12:44:12.116 +04:00 [DBG] Start client validation
2019-03-07 12:44:12.116 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-07 12:44:12.117 +04:00 [DBG] Start parsing for secret in post body
2019-03-07 12:44:12.117 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-07 12:44:12.118 +04:00 [DBG] Secret id found: BiLab
2019-03-07 12:44:12.128 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:44:12.128 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:44:12.129 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-07 12:44:12.130 +04:00 [DBG] Client validation success
2019-03-07 12:44:12.130 +04:00 [INF] {"ClientId":"BiLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLL2R3TFP1ET:00000005","TimeStamp":"2019-03-07T08:44:12.0000000Z","ProcessId":5412,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-03-07 12:44:12.136 +04:00 [DBG] Start token request validation
2019-03-07 12:44:12.137 +04:00 [DBG] Start validation of authorization code token request
2019-03-07 12:44:12.138 +04:00 [DBG] p9IvRiemlIXFj/JjQaqNkvqK35TYAlkFyAAvWwNgKMM= found in database: true
2019-03-07 12:44:12.140 +04:00 [DBG] removing p9IvRiemlIXFj/JjQaqNkvqK35TYAlkFyAAvWwNgKMM= persisted grant from database
2019-03-07 12:44:12.146 +04:00 [DBG] Validation of authorization code token request success
2019-03-07 12:44:12.147 +04:00 [INF] Token request validation success
{"ClientId":"BiLab","ClientName":"BiLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"87d19ded613adb0f0f817b63d4125a065302b11a0559fa2d88d2231d354a6cde","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"BiLab","client_secret":"***REDACTED***","code":"87d19ded613adb0f0f817b63d4125a065302b11a0559fa2d88d2231d354a6cde","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-03-07 12:44:12.156 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:44:12.157 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:44:12.160 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:44:12.162 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:44:12.163 +04:00 [DBG] Getting claims for access token for client: BiLab
2019-03-07 12:44:12.163 +04:00 [DBG] Getting claims for access token for subject: 2
2019-03-07 12:44:12.172 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 12:44:12.175 +04:00 [DBG] Creating refresh token
2019-03-07 12:44:12.176 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-03-07 12:44:12.177 +04:00 [DBG] cvR+bKJhpbGbSvY//2zaQUX6/HZ8NIpkyKWXDa1Zq+w= not found in database
2019-03-07 12:44:12.183 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:44:12.185 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:44:12.191 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:44:12.193 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:44:12.194 +04:00 [DBG] Getting claims for identity token for subject: 2 and client: BiLab
2019-03-07 12:44:12.204 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 12:44:12.207 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****dhyA","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****eb86","$type":"Token"},{"TokenType":"access_token","TokenValue":"****pAvw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2R3TFP1ET:00000005","TimeStamp":"2019-03-07T08:44:12.0000000Z","ProcessId":5412,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 12:44:12.213 +04:00 [DBG] Token request success.
2019-03-07 12:44:12.215 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-03-07 12:44:12.218 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-03-07 12:44:12.219 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-03-07 12:44:12.220 +04:00 [DBG] Start userinfo request
2019-03-07 12:44:12.221 +04:00 [DBG] Bearer token found in header
2019-03-07 12:44:12.226 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:44:12.228 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:44:12.234 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:44:12.234 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:44:12.262 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-03-07 12:44:12.263 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1551948252,"exp":1551951852,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"BiLab","sub":"2","auth_time":1551948251,"idp":"local","AspNet.Identity.SecurityStamp":"RUYKCWHO26U6OEQYLNO7G7V2RE44ETDK","role":"user","preferred_username":"test@mail.ru","name":"test@mail.ru","email":"test@mail.ru","email_verified":false,"given_name":"test@mail.ru","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-03-07 12:44:12.270 +04:00 [DBG] Creating userinfo response
2019-03-07 12:44:12.271 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 12:44:12.275 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 12:44:12.277 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:44:12.279 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-03-07 12:44:12.280 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 12:44:12.283 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:44:12.291 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email
2019-03-07 12:44:12.292 +04:00 [DBG] End userinfo request
2019-03-07 12:44:47.276 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 12:44:47.286 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 12:44:47.287 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 12:44:47.289 +04:00 [DBG] Start authorize request
2019-03-07 12:44:47.291 +04:00 [DBG] No user present in authorize request
2019-03-07 12:44:47.293 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 12:44:47.315 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:44:47.316 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:44:47.318 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 12:44:47.319 +04:00 [DBG] No PKCE used.
2019-03-07 12:44:47.326 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:44:47.333 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:44:47.335 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:44:47.338 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:44:47.340 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 12:44:47.341 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDEcC5hCgWKwGksNT5zWCiSASDQfaueNiTmfK3Qxjmn9HdvmiC3tZwCvZuLIl3SzTBZEiBakwcDmiZ3ZZvhsR2V46CBGeoCyL_B2cfzAG8EnjK_jpJ_QFuffyMmoZ-YrzGS9sbByR5dUTo9t06TXwk_lL3_3w_U22F6BfODtYpn4WKqmxF3ZCi0xg5x93Utz0D-FYLQZZI3TvIaQq_FfD770T72zUIEWBqhSJ6SU89eJZyvk17ABb3y4e9mSv0jZK_C7f_x0SO_eEOP8Uz08-CGf7gbsqzn7f-INRyamCWtu3bQflZQmjyVYBAkeW6mcsM","UiLocales":null,"Nonce":"636875450872688147.ZDRhN2E3NTEtYzg2OC00Y2ZiLWEyNzAtYWZiMDg2ZTVhYTY2ZWQxNjU5MDMtZTY5Yy00NmNmLWEzYzktNjFhMzU4N2M4MDZh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875450872688147.ZDRhN2E3NTEtYzg2OC00Y2ZiLWEyNzAtYWZiMDg2ZTVhYTY2ZWQxNjU5MDMtZTY5Yy00NmNmLWEzYzktNjFhMzU4N2M4MDZh","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDEcC5hCgWKwGksNT5zWCiSASDQfaueNiTmfK3Qxjmn9HdvmiC3tZwCvZuLIl3SzTBZEiBakwcDmiZ3ZZvhsR2V46CBGeoCyL_B2cfzAG8EnjK_jpJ_QFuffyMmoZ-YrzGS9sbByR5dUTo9t06TXwk_lL3_3w_U22F6BfODtYpn4WKqmxF3ZCi0xg5x93Utz0D-FYLQZZI3TvIaQq_FfD770T72zUIEWBqhSJ6SU89eJZyvk17ABb3y4e9mSv0jZK_C7f_x0SO_eEOP8Uz08-CGf7gbsqzn7f-INRyamCWtu3bQflZQmjyVYBAkeW6mcsM","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 12:44:47.352 +04:00 [INF] Showing login: User is not authenticated
2019-03-07 12:45:44.467 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 12:45:44.516 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 12:45:44.516 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 12:45:44.517 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 12:45:44.517 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 12:45:44.517 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 12:45:44.518 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 12:45:44.739 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:45:44.753 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:45:44.756 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:45:44.830 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 12:45:44.885 +04:00 [DBG] Starting grant removal
2019-03-07 12:45:45.955 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 12:45:45.959 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 12:45:45.960 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 12:45:45.961 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 12:45:45.961 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 12:45:45.962 +04:00 [DBG] Error Url: /home/error
2019-03-07 12:45:45.963 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 12:45:45.996 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 12:45:46.177 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-07 12:45:52.640 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 12:45:52.646 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 12:45:52.649 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 12:45:52.653 +04:00 [DBG] Start discovery request
2019-03-07 12:45:53.107 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 12:45:53.237 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 12:45:53.240 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 12:45:53.242 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 12:45:53.248 +04:00 [DBG] Start key discovery request
2019-03-07 12:45:53.332 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 12:45:53.338 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 12:45:53.339 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 12:45:53.344 +04:00 [DBG] Start authorize request
2019-03-07 12:45:53.355 +04:00 [DBG] No user present in authorize request
2019-03-07 12:45:53.360 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 12:45:53.657 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:45:53.666 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:45:53.673 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 12:45:53.674 +04:00 [DBG] No PKCE used.
2019-03-07 12:45:53.722 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:45:53.761 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:45:53.771 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:45:53.774 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:45:53.782 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 12:45:53.796 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDZgICqBgqFItFcmpL1_H2RpFpRnt8FyN3EVD6gRHiGm0ordd4j6ixz4K7zL6CRDzJB-wUgTKG-oC1uXvSaJ9sNXLaDX6N0QVjxC1swmzN5VDBujCpdZdm5JCzY0_gRxGRbI6ODgEkJK_xvnqjs6ziJq6I7ZW-SxsPs7Squ-nVMHxifXhJYEMbD9kiJI5CJOLnG54hcUh-oDEghEN2KOedypOK-c3qC1SEnta_zu_zhEDgvbuSVTbRKmXIRAZNcdRpG5fIXx1alUNm2nuVjNyGTme8r_AKHke5wImuTaaUGSU-FHqjFId-Hm-GeFecN_d0","UiLocales":null,"Nonce":"636875451533084277.ZjE5NGZjMDktY2UyYy00OGJkLThjYTgtZTJlYTY5YjJkMmMwNDcxZmE1YWItZDNmOS00ZWVjLThhYTQtZjMwYWY2MDhmMGNl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875451533084277.ZjE5NGZjMDktY2UyYy00OGJkLThjYTgtZTJlYTY5YjJkMmMwNDcxZmE1YWItZDNmOS00ZWVjLThhYTQtZjMwYWY2MDhmMGNl","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDZgICqBgqFItFcmpL1_H2RpFpRnt8FyN3EVD6gRHiGm0ordd4j6ixz4K7zL6CRDzJB-wUgTKG-oC1uXvSaJ9sNXLaDX6N0QVjxC1swmzN5VDBujCpdZdm5JCzY0_gRxGRbI6ODgEkJK_xvnqjs6ziJq6I7ZW-SxsPs7Squ-nVMHxifXhJYEMbD9kiJI5CJOLnG54hcUh-oDEghEN2KOedypOK-c3qC1SEnta_zu_zhEDgvbuSVTbRKmXIRAZNcdRpG5fIXx1alUNm2nuVjNyGTme8r_AKHke5wImuTaaUGSU-FHqjFId-Hm-GeFecN_d0","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 12:45:53.822 +04:00 [INF] Showing login: User is not authenticated
2019-03-07 12:45:57.956 +04:00 [DBG] Augmenting SignInContext
2019-03-07 12:45:57.959 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 12:45:57.959 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 12:45:57.960 +04:00 [DBG] Adding auth_time claim with value: 1551948357
2019-03-07 12:45:57.974 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 12:45:58.002 +04:00 [INF] {"Username":"godAdmin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"1002","DisplayName":"godAdmin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2R550PQ4Q:00000005","TimeStamp":"2019-03-07T08:45:57.0000000Z","ProcessId":3212,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 12:45:58.047 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-07 12:45:58.051 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-07 12:45:58.052 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-07 12:45:58.059 +04:00 [DBG] Start authorize callback request
2019-03-07 12:45:58.063 +04:00 [DBG] User in authorize request: 1002
2019-03-07 12:45:58.064 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 12:45:58.085 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:45:58.086 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:45:58.088 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 12:45:58.089 +04:00 [DBG] No PKCE used.
2019-03-07 12:45:58.096 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:45:58.103 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:45:58.106 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:45:58.108 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:45:58.109 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 12:45:58.110 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDZgICqBgqFItFcmpL1_H2RpFpRnt8FyN3EVD6gRHiGm0ordd4j6ixz4K7zL6CRDzJB-wUgTKG-oC1uXvSaJ9sNXLaDX6N0QVjxC1swmzN5VDBujCpdZdm5JCzY0_gRxGRbI6ODgEkJK_xvnqjs6ziJq6I7ZW-SxsPs7Squ-nVMHxifXhJYEMbD9kiJI5CJOLnG54hcUh-oDEghEN2KOedypOK-c3qC1SEnta_zu_zhEDgvbuSVTbRKmXIRAZNcdRpG5fIXx1alUNm2nuVjNyGTme8r_AKHke5wImuTaaUGSU-FHqjFId-Hm-GeFecN_d0","UiLocales":null,"Nonce":"636875451533084277.ZjE5NGZjMDktY2UyYy00OGJkLThjYTgtZTJlYTY5YjJkMmMwNDcxZmE1YWItZDNmOS00ZWVjLThhYTQtZjMwYWY2MDhmMGNl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"58952e0c71726eb79288b2520a546c57","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875451533084277.ZjE5NGZjMDktY2UyYy00OGJkLThjYTgtZTJlYTY5YjJkMmMwNDcxZmE1YWItZDNmOS00ZWVjLThhYTQtZjMwYWY2MDhmMGNl","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDZgICqBgqFItFcmpL1_H2RpFpRnt8FyN3EVD6gRHiGm0ordd4j6ixz4K7zL6CRDzJB-wUgTKG-oC1uXvSaJ9sNXLaDX6N0QVjxC1swmzN5VDBujCpdZdm5JCzY0_gRxGRbI6ODgEkJK_xvnqjs6ziJq6I7ZW-SxsPs7Squ-nVMHxifXhJYEMbD9kiJI5CJOLnG54hcUh-oDEghEN2KOedypOK-c3qC1SEnta_zu_zhEDgvbuSVTbRKmXIRAZNcdRpG5fIXx1alUNm2nuVjNyGTme8r_AKHke5wImuTaaUGSU-FHqjFId-Hm-GeFecN_d0","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 12:45:58.146 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-07 12:45:58.154 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-07 12:45:58.193 +04:00 [DBG] WIiOaKplGD54B0guf36d8UED8o0oFHtst+ptQZxHqGY= not found in database
2019-03-07 12:45:58.267 +04:00 [DBG] Creating Implicit Flow response.
2019-03-07 12:45:58.277 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 12:45:58.305 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 12:45:58.387 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"1002","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****6e6A","$type":"Token"},{"TokenType":"code","TokenValue":"****2d71","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2R550PQ4Q:00000006","TimeStamp":"2019-03-07T08:45:58.0000000Z","ProcessId":3212,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 12:45:58.393 +04:00 [INF] Authorize endpoint response
{"SubjectId":"1002","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNDZgICqBgqFItFcmpL1_H2RpFpRnt8FyN3EVD6gRHiGm0ordd4j6ixz4K7zL6CRDzJB-wUgTKG-oC1uXvSaJ9sNXLaDX6N0QVjxC1swmzN5VDBujCpdZdm5JCzY0_gRxGRbI6ODgEkJK_xvnqjs6ziJq6I7ZW-SxsPs7Squ-nVMHxifXhJYEMbD9kiJI5CJOLnG54hcUh-oDEghEN2KOedypOK-c3qC1SEnta_zu_zhEDgvbuSVTbRKmXIRAZNcdRpG5fIXx1alUNm2nuVjNyGTme8r_AKHke5wImuTaaUGSU-FHqjFId-Hm-GeFecN_d0","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-07 12:45:58.417 +04:00 [DBG] Augmenting SignInContext
2019-03-07 12:45:58.418 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 12:45:58.538 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-07 12:45:58.544 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-07 12:45:58.544 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-07 12:45:58.554 +04:00 [DBG] Start token request.
2019-03-07 12:45:58.560 +04:00 [DBG] Start client validation
2019-03-07 12:45:58.565 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-07 12:45:58.571 +04:00 [DBG] Start parsing for secret in post body
2019-03-07 12:45:58.572 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-07 12:45:58.573 +04:00 [DBG] Secret id found: BiLab
2019-03-07 12:45:58.594 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:45:58.595 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:45:58.606 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-07 12:45:58.606 +04:00 [DBG] Client validation success
2019-03-07 12:45:58.607 +04:00 [INF] {"ClientId":"BiLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLL2R550PQ4R:00000003","TimeStamp":"2019-03-07T08:45:58.0000000Z","ProcessId":3212,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-03-07 12:45:58.615 +04:00 [DBG] Start token request validation
2019-03-07 12:45:58.626 +04:00 [DBG] Start validation of authorization code token request
2019-03-07 12:45:58.642 +04:00 [DBG] WIiOaKplGD54B0guf36d8UED8o0oFHtst+ptQZxHqGY= found in database: true
2019-03-07 12:45:58.660 +04:00 [DBG] removing WIiOaKplGD54B0guf36d8UED8o0oFHtst+ptQZxHqGY= persisted grant from database
2019-03-07 12:45:58.672 +04:00 [DBG] Validation of authorization code token request success
2019-03-07 12:45:58.678 +04:00 [INF] Token request validation success
{"ClientId":"BiLab","ClientName":"BiLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"4c0926f3f9b3d06859a209e4f6a9aaac8bb904574b91375e02a4569d5caf2d71","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"BiLab","client_secret":"***REDACTED***","code":"4c0926f3f9b3d06859a209e4f6a9aaac8bb904574b91375e02a4569d5caf2d71","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-03-07 12:45:58.704 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:45:58.705 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:45:58.714 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:45:58.721 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:45:58.732 +04:00 [DBG] Getting claims for access token for client: BiLab
2019-03-07 12:45:58.732 +04:00 [DBG] Getting claims for access token for subject: 1002
2019-03-07 12:45:58.746 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 12:45:58.757 +04:00 [DBG] Creating refresh token
2019-03-07 12:45:58.757 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-03-07 12:45:58.771 +04:00 [DBG] lQj1NIw094MF2b0HkD8gx0LoNAFlI6y64nRvu/X10cE= not found in database
2019-03-07 12:45:58.808 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:45:58.809 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:45:58.819 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:45:58.825 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:45:58.826 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 12:45:58.838 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 12:45:58.845 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****3R-Q","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****53c1","$type":"Token"},{"TokenType":"access_token","TokenValue":"****5n1Q","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2R550PQ4R:00000003","TimeStamp":"2019-03-07T08:45:58.0000000Z","ProcessId":3212,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 12:45:58.853 +04:00 [DBG] Token request success.
2019-03-07 12:45:58.866 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-03-07 12:45:58.869 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-03-07 12:45:58.871 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-03-07 12:45:58.878 +04:00 [DBG] Start userinfo request
2019-03-07 12:45:58.882 +04:00 [DBG] Bearer token found in header
2019-03-07 12:45:58.959 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:45:58.959 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:45:58.967 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:45:58.968 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:45:58.975 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-03-07 12:45:58.978 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1551948358,"exp":1551951958,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"BiLab","sub":"1002","auth_time":1551948357,"idp":"local","AspNet.Identity.SecurityStamp":"YRQCMJ4XBHSYAYVIFGH3YHMVNOLY4SL5","role":"GodAdmin","preferred_username":"godAdmin@admin.ru","name":"godAdmin@admin.ru","email":"godAdmin@admin.ru","email_verified":false,"given_name":"godAdmin@admin.ru","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-03-07 12:45:58.993 +04:00 [DBG] Creating userinfo response
2019-03-07 12:45:58.997 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 12:45:59.002 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 12:45:59.013 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:45:59.015 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-03-07 12:45:59.016 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 12:45:59.025 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:45:59.038 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email
2019-03-07 12:45:59.039 +04:00 [DBG] End userinfo request
2019-03-07 12:46:18.604 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 12:46:18.608 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 12:46:18.609 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 12:46:18.610 +04:00 [DBG] Start authorize request
2019-03-07 12:46:18.611 +04:00 [DBG] No user present in authorize request
2019-03-07 12:46:18.612 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 12:46:18.637 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:46:18.638 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:46:18.640 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 12:46:18.640 +04:00 [DBG] No PKCE used.
2019-03-07 12:46:18.649 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:46:18.658 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:46:18.661 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:46:18.663 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:46:18.666 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 12:46:18.667 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYND548oT0x9JRcTR84H-eeItXe-bwV8iqeCktIvYPLvFY9yqiqWKQNxg34zeXfrAIrrg7YAb3ocwJIaR4Z1rwPr8lo0BITrLbiCrWk9LL8WiV7yjk3Ohh2HxO9PAJ1SF_nP5-3zwh6T8vPRBEsinrmIX3vd1KM3sH037E0YIY898T1aMqz2Sp3PO0hX2Nv3WOmXfFAaFHFMAMs2cE7YlN1TmfyD68havN5lhy43LG4GV9NRrW3JEjyHyxpDs0t9RmCYyAhjrSZiAL03WRbAYg7PFIDK0-42NKQnV_CJ35QBpoQGzhmptr6iJWznlTL4YqW4","UiLocales":null,"Nonce":"636875451785898507.ODMzNjA4NWUtYTFjNi00ODUwLWFmZGItNjRlNjc2NDZlOTRjOGRiNDhhYTgtNGZkYy00OTEyLTg1YjYtZTRhOTVjODZmOTVi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875451785898507.ODMzNjA4NWUtYTFjNi00ODUwLWFmZGItNjRlNjc2NDZlOTRjOGRiNDhhYTgtNGZkYy00OTEyLTg1YjYtZTRhOTVjODZmOTVi","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYND548oT0x9JRcTR84H-eeItXe-bwV8iqeCktIvYPLvFY9yqiqWKQNxg34zeXfrAIrrg7YAb3ocwJIaR4Z1rwPr8lo0BITrLbiCrWk9LL8WiV7yjk3Ohh2HxO9PAJ1SF_nP5-3zwh6T8vPRBEsinrmIX3vd1KM3sH037E0YIY898T1aMqz2Sp3PO0hX2Nv3WOmXfFAaFHFMAMs2cE7YlN1TmfyD68havN5lhy43LG4GV9NRrW3JEjyHyxpDs0t9RmCYyAhjrSZiAL03WRbAYg7PFIDK0-42NKQnV_CJ35QBpoQGzhmptr6iJWznlTL4YqW4","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 12:46:18.679 +04:00 [INF] Showing login: User is not authenticated
2019-03-07 12:46:22.382 +04:00 [DBG] Augmenting SignInContext
2019-03-07 12:46:22.383 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 12:46:22.384 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 12:46:22.386 +04:00 [DBG] Adding auth_time claim with value: 1551948382
2019-03-07 12:46:22.390 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 12:46:22.393 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2R550PQ4Q:00000009","TimeStamp":"2019-03-07T08:46:22.0000000Z","ProcessId":3212,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 12:46:22.407 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-07 12:46:22.409 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-07 12:46:22.410 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-07 12:46:22.412 +04:00 [DBG] Start authorize callback request
2019-03-07 12:46:22.413 +04:00 [DBG] User in authorize request: 2
2019-03-07 12:46:22.414 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 12:46:22.426 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:46:22.427 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:46:22.428 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 12:46:22.428 +04:00 [DBG] No PKCE used.
2019-03-07 12:46:22.430 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:46:22.432 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:46:22.437 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:46:22.439 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:46:22.440 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 12:46:22.442 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYND548oT0x9JRcTR84H-eeItXe-bwV8iqeCktIvYPLvFY9yqiqWKQNxg34zeXfrAIrrg7YAb3ocwJIaR4Z1rwPr8lo0BITrLbiCrWk9LL8WiV7yjk3Ohh2HxO9PAJ1SF_nP5-3zwh6T8vPRBEsinrmIX3vd1KM3sH037E0YIY898T1aMqz2Sp3PO0hX2Nv3WOmXfFAaFHFMAMs2cE7YlN1TmfyD68havN5lhy43LG4GV9NRrW3JEjyHyxpDs0t9RmCYyAhjrSZiAL03WRbAYg7PFIDK0-42NKQnV_CJ35QBpoQGzhmptr6iJWznlTL4YqW4","UiLocales":null,"Nonce":"636875451785898507.ODMzNjA4NWUtYTFjNi00ODUwLWFmZGItNjRlNjc2NDZlOTRjOGRiNDhhYTgtNGZkYy00OTEyLTg1YjYtZTRhOTVjODZmOTVi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"81661e5354876872dd29ea02ca4a9624","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875451785898507.ODMzNjA4NWUtYTFjNi00ODUwLWFmZGItNjRlNjc2NDZlOTRjOGRiNDhhYTgtNGZkYy00OTEyLTg1YjYtZTRhOTVjODZmOTVi","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYND548oT0x9JRcTR84H-eeItXe-bwV8iqeCktIvYPLvFY9yqiqWKQNxg34zeXfrAIrrg7YAb3ocwJIaR4Z1rwPr8lo0BITrLbiCrWk9LL8WiV7yjk3Ohh2HxO9PAJ1SF_nP5-3zwh6T8vPRBEsinrmIX3vd1KM3sH037E0YIY898T1aMqz2Sp3PO0hX2Nv3WOmXfFAaFHFMAMs2cE7YlN1TmfyD68havN5lhy43LG4GV9NRrW3JEjyHyxpDs0t9RmCYyAhjrSZiAL03WRbAYg7PFIDK0-42NKQnV_CJ35QBpoQGzhmptr6iJWznlTL4YqW4","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 12:46:22.458 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-07 12:46:22.458 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-07 12:46:22.461 +04:00 [DBG] LYEA4RuGo+cwJmMfscc5x3NAxCuXOMj7P9pb8pwQKmU= not found in database
2019-03-07 12:46:22.465 +04:00 [DBG] Creating Implicit Flow response.
2019-03-07 12:46:22.466 +04:00 [DBG] Getting claims for identity token for subject: 2 and client: BiLab
2019-03-07 12:46:22.477 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 12:46:22.480 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"2","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****A0Ow","$type":"Token"},{"TokenType":"code","TokenValue":"****c3f6","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2R550PQ4Q:0000000A","TimeStamp":"2019-03-07T08:46:22.0000000Z","ProcessId":3212,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 12:46:22.485 +04:00 [INF] Authorize endpoint response
{"SubjectId":"2","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYND548oT0x9JRcTR84H-eeItXe-bwV8iqeCktIvYPLvFY9yqiqWKQNxg34zeXfrAIrrg7YAb3ocwJIaR4Z1rwPr8lo0BITrLbiCrWk9LL8WiV7yjk3Ohh2HxO9PAJ1SF_nP5-3zwh6T8vPRBEsinrmIX3vd1KM3sH037E0YIY898T1aMqz2Sp3PO0hX2Nv3WOmXfFAaFHFMAMs2cE7YlN1TmfyD68havN5lhy43LG4GV9NRrW3JEjyHyxpDs0t9RmCYyAhjrSZiAL03WRbAYg7PFIDK0-42NKQnV_CJ35QBpoQGzhmptr6iJWznlTL4YqW4","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-07 12:46:22.490 +04:00 [DBG] Augmenting SignInContext
2019-03-07 12:46:22.491 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 12:46:22.528 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-07 12:46:22.530 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-07 12:46:22.531 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-07 12:46:22.532 +04:00 [DBG] Start token request.
2019-03-07 12:46:22.532 +04:00 [DBG] Start client validation
2019-03-07 12:46:22.533 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-07 12:46:22.533 +04:00 [DBG] Start parsing for secret in post body
2019-03-07 12:46:22.534 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-07 12:46:22.534 +04:00 [DBG] Secret id found: BiLab
2019-03-07 12:46:22.542 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:46:22.543 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:46:22.544 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-07 12:46:22.545 +04:00 [DBG] Client validation success
2019-03-07 12:46:22.545 +04:00 [INF] {"ClientId":"BiLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLL2R550PQ4R:00000005","TimeStamp":"2019-03-07T08:46:22.0000000Z","ProcessId":3212,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-03-07 12:46:22.549 +04:00 [DBG] Start token request validation
2019-03-07 12:46:22.550 +04:00 [DBG] Start validation of authorization code token request
2019-03-07 12:46:22.558 +04:00 [DBG] LYEA4RuGo+cwJmMfscc5x3NAxCuXOMj7P9pb8pwQKmU= found in database: true
2019-03-07 12:46:22.561 +04:00 [DBG] removing LYEA4RuGo+cwJmMfscc5x3NAxCuXOMj7P9pb8pwQKmU= persisted grant from database
2019-03-07 12:46:22.567 +04:00 [DBG] Validation of authorization code token request success
2019-03-07 12:46:22.568 +04:00 [INF] Token request validation success
{"ClientId":"BiLab","ClientName":"BiLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"7a0065efd668913d4f3bd5f5aeac9669b35b8c07ab984a809d0419a537a5c3f6","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"BiLab","client_secret":"***REDACTED***","code":"7a0065efd668913d4f3bd5f5aeac9669b35b8c07ab984a809d0419a537a5c3f6","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-03-07 12:46:22.576 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:46:22.576 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:46:22.584 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:46:22.590 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:46:22.591 +04:00 [DBG] Getting claims for access token for client: BiLab
2019-03-07 12:46:22.592 +04:00 [DBG] Getting claims for access token for subject: 2
2019-03-07 12:46:22.603 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 12:46:22.608 +04:00 [DBG] Creating refresh token
2019-03-07 12:46:22.608 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-03-07 12:46:22.609 +04:00 [DBG] tj79P4jVFthV43pgqYYtJo7dXyxTJY4QgZIKD+dBeuc= not found in database
2019-03-07 12:46:22.616 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:46:22.617 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:46:22.622 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:46:22.624 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:46:22.625 +04:00 [DBG] Getting claims for identity token for subject: 2 and client: BiLab
2019-03-07 12:46:22.633 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 12:46:22.638 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****aJgg","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****9c04","$type":"Token"},{"TokenType":"access_token","TokenValue":"****kEhQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2R550PQ4R:00000005","TimeStamp":"2019-03-07T08:46:22.0000000Z","ProcessId":3212,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 12:46:22.643 +04:00 [DBG] Token request success.
2019-03-07 12:46:22.650 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-03-07 12:46:22.651 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-03-07 12:46:22.653 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-03-07 12:46:22.658 +04:00 [DBG] Start userinfo request
2019-03-07 12:46:22.658 +04:00 [DBG] Bearer token found in header
2019-03-07 12:46:22.665 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:46:22.665 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:46:22.671 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:46:22.671 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:46:22.675 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-03-07 12:46:22.676 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1551948382,"exp":1551951982,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"BiLab","sub":"2","auth_time":1551948382,"idp":"local","AspNet.Identity.SecurityStamp":"RUYKCWHO26U6OEQYLNO7G7V2RE44ETDK","role":"user","preferred_username":"test@mail.ru","name":"test@mail.ru","email":"test@mail.ru","email_verified":false,"given_name":"test@mail.ru","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-03-07 12:46:22.683 +04:00 [DBG] Creating userinfo response
2019-03-07 12:46:22.683 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 12:46:22.684 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 12:46:22.687 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:46:22.690 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-03-07 12:46:22.691 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 12:46:22.693 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:46:22.704 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email
2019-03-07 12:46:22.705 +04:00 [DBG] End userinfo request
2019-03-07 12:47:22.860 +04:00 [INF] AuthenticationScheme: Identity.Application was forbidden.
2019-03-07 12:47:31.012 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-03-07 12:47:31.014 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-03-07 12:47:31.015 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-03-07 12:47:34.476 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-07 12:47:37.521 +04:00 [DBG] Augmenting SignInContext
2019-03-07 12:47:37.521 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 12:47:37.523 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 12:47:37.524 +04:00 [DBG] Adding auth_time claim with value: 1551948457
2019-03-07 12:47:37.524 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 12:47:37.528 +04:00 [INF] {"Username":"godAdmin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"1002","DisplayName":"godAdmin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2R550PQ4Q:00000012","TimeStamp":"2019-03-07T08:47:37.0000000Z","ProcessId":3212,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 12:51:43.592 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 12:51:43.644 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 12:51:43.645 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 12:51:43.645 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 12:51:43.646 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 12:51:43.646 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 12:51:43.646 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 12:51:43.882 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:51:43.897 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:51:43.901 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:51:43.980 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 12:51:44.035 +04:00 [DBG] Starting grant removal
2019-03-07 12:51:44.680 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 12:51:44.686 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 12:51:44.690 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 12:51:44.691 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 12:51:44.691 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 12:51:44.692 +04:00 [DBG] Error Url: /home/error
2019-03-07 12:51:44.693 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 12:51:44.761 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 12:51:59.497 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 12:51:59.546 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 12:51:59.547 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 12:51:59.547 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 12:51:59.547 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 12:51:59.547 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 12:51:59.548 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 12:51:59.742 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:51:59.758 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:51:59.761 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:51:59.831 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 12:51:59.886 +04:00 [DBG] Starting grant removal
2019-03-07 12:52:00.763 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 12:52:00.767 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 12:52:00.768 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 12:52:00.769 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 12:52:00.769 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 12:52:00.770 +04:00 [DBG] Error Url: /home/error
2019-03-07 12:52:00.770 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 12:52:00.831 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 12:52:51.615 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 12:52:51.620 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 12:52:51.621 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 12:52:51.627 +04:00 [DBG] Start discovery request
2019-03-07 12:52:51.817 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 12:52:51.960 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 12:52:51.962 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 12:52:51.963 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 12:52:51.969 +04:00 [DBG] Start key discovery request
2019-03-07 12:52:52.046 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 12:52:52.054 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 12:52:52.055 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 12:52:52.061 +04:00 [DBG] Start authorize request
2019-03-07 12:52:52.073 +04:00 [DBG] No user present in authorize request
2019-03-07 12:52:52.078 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 12:52:52.253 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:52:52.260 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:52:52.265 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 12:52:52.267 +04:00 [DBG] No PKCE used.
2019-03-07 12:52:52.315 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:52:52.355 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:52:52.363 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:52:52.365 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:52:52.373 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 12:52:52.389 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBKIRKFl-VlnL6X8ryn3rqEUZSgRtycrxNJ_s3nmlEVF9N1qezrfZ7qvg1zNTc4OB2wQuA8Z56iIymsztCbawuLZy6_E8aS0Et6iyYnXcUqhUBWfEEw4oUbWlAD47lH3amb0DhY3NKTZD91c5E8UTU3OpRE92Zdef_8l5JONOvUlPpddL4nhcl1g8azsL2SiKi_BOjgP595WLHI4H1dD_5r1OuuNvq1dgiCx5bxqyQD_Lo28o3UlpZ0yBjR0RyAyp9E9wPcM8NBMh0VzR3awgNhgLKqZeZvQLG_2TQ6Gfr_fGtvKJHlI0ngEE2pSGrChuo","UiLocales":null,"Nonce":"636875455720242143.OGJlYTk2NGEtOWUxMS00NTFiLTkwOTEtYjlmMWYwMDIzMWQ2NTc2MTMzNmUtZWFmOS00NTQ3LWEzODAtODI1NzM0YTY2NGE1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875455720242143.OGJlYTk2NGEtOWUxMS00NTFiLTkwOTEtYjlmMWYwMDIzMWQ2NTc2MTMzNmUtZWFmOS00NTQ3LWEzODAtODI1NzM0YTY2NGE1","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBKIRKFl-VlnL6X8ryn3rqEUZSgRtycrxNJ_s3nmlEVF9N1qezrfZ7qvg1zNTc4OB2wQuA8Z56iIymsztCbawuLZy6_E8aS0Et6iyYnXcUqhUBWfEEw4oUbWlAD47lH3amb0DhY3NKTZD91c5E8UTU3OpRE92Zdef_8l5JONOvUlPpddL4nhcl1g8azsL2SiKi_BOjgP595WLHI4H1dD_5r1OuuNvq1dgiCx5bxqyQD_Lo28o3UlpZ0yBjR0RyAyp9E9wPcM8NBMh0VzR3awgNhgLKqZeZvQLG_2TQ6Gfr_fGtvKJHlI0ngEE2pSGrChuo","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 12:52:52.412 +04:00 [INF] Showing login: User is not authenticated
2019-03-07 12:53:02.172 +04:00 [DBG] Augmenting SignInContext
2019-03-07 12:53:02.176 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 12:53:02.176 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 12:53:02.178 +04:00 [DBG] Adding auth_time claim with value: 1551948782
2019-03-07 12:53:02.187 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 12:53:02.210 +04:00 [INF] {"Username":"godAdmin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"1002","DisplayName":"godAdmin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2R8KP2Q6S:00000004","TimeStamp":"2019-03-07T08:53:02.0000000Z","ProcessId":220,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 12:53:02.244 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-07 12:53:02.247 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-07 12:53:02.248 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-07 12:53:02.254 +04:00 [DBG] Start authorize callback request
2019-03-07 12:53:02.260 +04:00 [DBG] User in authorize request: 1002
2019-03-07 12:53:02.261 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 12:53:02.266 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:53:02.268 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:53:02.269 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 12:53:02.270 +04:00 [DBG] No PKCE used.
2019-03-07 12:53:02.272 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:53:02.275 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:53:02.278 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:53:02.280 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:53:02.281 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 12:53:02.282 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBKIRKFl-VlnL6X8ryn3rqEUZSgRtycrxNJ_s3nmlEVF9N1qezrfZ7qvg1zNTc4OB2wQuA8Z56iIymsztCbawuLZy6_E8aS0Et6iyYnXcUqhUBWfEEw4oUbWlAD47lH3amb0DhY3NKTZD91c5E8UTU3OpRE92Zdef_8l5JONOvUlPpddL4nhcl1g8azsL2SiKi_BOjgP595WLHI4H1dD_5r1OuuNvq1dgiCx5bxqyQD_Lo28o3UlpZ0yBjR0RyAyp9E9wPcM8NBMh0VzR3awgNhgLKqZeZvQLG_2TQ6Gfr_fGtvKJHlI0ngEE2pSGrChuo","UiLocales":null,"Nonce":"636875455720242143.OGJlYTk2NGEtOWUxMS00NTFiLTkwOTEtYjlmMWYwMDIzMWQ2NTc2MTMzNmUtZWFmOS00NTQ3LWEzODAtODI1NzM0YTY2NGE1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"24637cc52e6a9a05e18df7fabccacedd","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875455720242143.OGJlYTk2NGEtOWUxMS00NTFiLTkwOTEtYjlmMWYwMDIzMWQ2NTc2MTMzNmUtZWFmOS00NTQ3LWEzODAtODI1NzM0YTY2NGE1","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBKIRKFl-VlnL6X8ryn3rqEUZSgRtycrxNJ_s3nmlEVF9N1qezrfZ7qvg1zNTc4OB2wQuA8Z56iIymsztCbawuLZy6_E8aS0Et6iyYnXcUqhUBWfEEw4oUbWlAD47lH3amb0DhY3NKTZD91c5E8UTU3OpRE92Zdef_8l5JONOvUlPpddL4nhcl1g8azsL2SiKi_BOjgP595WLHI4H1dD_5r1OuuNvq1dgiCx5bxqyQD_Lo28o3UlpZ0yBjR0RyAyp9E9wPcM8NBMh0VzR3awgNhgLKqZeZvQLG_2TQ6Gfr_fGtvKJHlI0ngEE2pSGrChuo","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 12:53:02.316 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-07 12:53:02.322 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-07 12:53:02.353 +04:00 [DBG] l/8fzKdd/9tlR8O8YOJE6YYeIpE6Stjkjwq2JAFYWp4= not found in database
2019-03-07 12:53:02.383 +04:00 [DBG] Creating Implicit Flow response.
2019-03-07 12:53:02.395 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 12:53:02.428 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 12:53:02.507 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"1002","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****3vnw","$type":"Token"},{"TokenType":"code","TokenValue":"****c45f","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2R8KP2Q6S:00000005","TimeStamp":"2019-03-07T08:53:02.0000000Z","ProcessId":220,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 12:53:02.518 +04:00 [INF] Authorize endpoint response
{"SubjectId":"1002","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBKIRKFl-VlnL6X8ryn3rqEUZSgRtycrxNJ_s3nmlEVF9N1qezrfZ7qvg1zNTc4OB2wQuA8Z56iIymsztCbawuLZy6_E8aS0Et6iyYnXcUqhUBWfEEw4oUbWlAD47lH3amb0DhY3NKTZD91c5E8UTU3OpRE92Zdef_8l5JONOvUlPpddL4nhcl1g8azsL2SiKi_BOjgP595WLHI4H1dD_5r1OuuNvq1dgiCx5bxqyQD_Lo28o3UlpZ0yBjR0RyAyp9E9wPcM8NBMh0VzR3awgNhgLKqZeZvQLG_2TQ6Gfr_fGtvKJHlI0ngEE2pSGrChuo","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-07 12:53:02.538 +04:00 [DBG] Augmenting SignInContext
2019-03-07 12:53:02.539 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 12:53:02.654 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-07 12:53:02.661 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-07 12:53:02.662 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-07 12:53:02.671 +04:00 [DBG] Start token request.
2019-03-07 12:53:02.677 +04:00 [DBG] Start client validation
2019-03-07 12:53:02.683 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-07 12:53:02.687 +04:00 [DBG] Start parsing for secret in post body
2019-03-07 12:53:02.688 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-07 12:53:02.688 +04:00 [DBG] Secret id found: BiLab
2019-03-07 12:53:02.692 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:53:02.692 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:53:02.707 +04:00 [INF] Secret: no description uses invalid hashing algorithm.
2019-03-07 12:53:02.709 +04:00 [DBG] Secret validators could not validate secret
2019-03-07 12:53:02.710 +04:00 [INF] {"ClientId":"BiLab","Category":"Authentication","Name":"Client Authentication Failure","EventType":"Failure","Id":1011,"Message":"Invalid client secret","ActivityId":"0HLL2R8KP2Q6U:00000003","TimeStamp":"2019-03-07T08:53:02.0000000Z","ProcessId":220,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationFailureEvent"}
2019-03-07 12:53:02.713 +04:00 [ERR] Client secret validation failed for client: BiLab.
2019-03-07 12:56:54.068 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 12:56:54.128 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 12:56:54.129 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 12:56:54.129 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 12:56:54.130 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 12:56:54.130 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 12:56:54.130 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 12:56:54.348 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:56:54.363 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:56:54.365 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:56:54.441 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 12:56:54.493 +04:00 [DBG] Starting grant removal
2019-03-07 12:56:55.342 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 12:56:55.346 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 12:56:55.347 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 12:56:55.348 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 12:56:55.348 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 12:56:55.349 +04:00 [DBG] Error Url: /home/error
2019-03-07 12:56:55.349 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 12:56:55.410 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 12:57:06.214 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 12:57:06.267 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 12:57:06.267 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 12:57:06.268 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 12:57:06.268 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 12:57:06.268 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 12:57:06.268 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 12:57:06.462 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:57:06.476 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:57:06.480 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:57:06.553 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 12:57:06.613 +04:00 [DBG] Starting grant removal
2019-03-07 12:57:07.407 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 12:57:07.411 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 12:57:07.413 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 12:57:07.414 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 12:57:07.415 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 12:57:07.416 +04:00 [DBG] Error Url: /home/error
2019-03-07 12:57:07.416 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 12:57:07.471 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 12:57:46.309 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 12:57:46.315 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 12:57:46.316 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 12:57:46.321 +04:00 [DBG] Start discovery request
2019-03-07 12:57:46.520 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 12:57:46.670 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 12:57:46.673 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 12:57:46.677 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 12:57:46.681 +04:00 [DBG] Start key discovery request
2019-03-07 12:57:46.762 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 12:57:46.768 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 12:57:46.769 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 12:57:46.776 +04:00 [DBG] Start authorize request
2019-03-07 12:57:46.788 +04:00 [DBG] User in authorize request: 1002
2019-03-07 12:57:46.793 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 12:57:46.970 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:57:46.979 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:57:46.985 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 12:57:46.987 +04:00 [DBG] No PKCE used.
2019-03-07 12:57:47.044 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:57:47.092 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:57:47.102 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 12:57:47.105 +04:00 [DBG] Found [] API scopes in database
2019-03-07 12:57:47.114 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 12:57:47.131 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBJzoadwWNx-_muPNGn4l7vJYAQxNrQfIOZmn5cy0oOHUtHApoi-vKe90M7ZPadE99-eTu2xwL9WbZuYrA4VCN-fQzMVNfwARRN5qINc6pavhkcOUEjboKw2DXDVuyU61-QgPKCa50tW1-RfA69osJPBVsWko85KkZPgRXE92qvD-kklebxrjM1Zce6EVUazVUT8p67n5G7M8iTNT_ObxoeBtRnLkijuaNbjUXG7-d2g4udZAhC_nsezMZubSVOkk7MyRXqViA8CyqwLrucX21JiFS6iGGCpqOsB0Mxj3bsNncBSjBdyoZfHidqxTXfiA0","UiLocales":null,"Nonce":"636875458667375423.NjI0Mzk4MmItM2Y3ZS00ZTM1LTk0OTQtYzM4ZGRhYjY0NmMzMzJhMGE0ZjgtMjQyMC00Yzg5LWI2NWQtMjMyMGQxZmY2YTcz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"24637cc52e6a9a05e18df7fabccacedd","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875458667375423.NjI0Mzk4MmItM2Y3ZS00ZTM1LTk0OTQtYzM4ZGRhYjY0NmMzMzJhMGE0ZjgtMjQyMC00Yzg5LWI2NWQtMjMyMGQxZmY2YTcz","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBJzoadwWNx-_muPNGn4l7vJYAQxNrQfIOZmn5cy0oOHUtHApoi-vKe90M7ZPadE99-eTu2xwL9WbZuYrA4VCN-fQzMVNfwARRN5qINc6pavhkcOUEjboKw2DXDVuyU61-QgPKCa50tW1-RfA69osJPBVsWko85KkZPgRXE92qvD-kklebxrjM1Zce6EVUazVUT8p67n5G7M8iTNT_ObxoeBtRnLkijuaNbjUXG7-d2g4udZAhC_nsezMZubSVOkk7MyRXqViA8CyqwLrucX21JiFS6iGGCpqOsB0Mxj3bsNncBSjBdyoZfHidqxTXfiA0","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 12:57:47.183 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-07 12:57:47.190 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-07 12:57:47.229 +04:00 [DBG] d0FzN2+3cO1Kd/tTSsv0oji7ZLAoEVytq2yBtGazOts= not found in database
2019-03-07 12:57:47.260 +04:00 [DBG] Creating Implicit Flow response.
2019-03-07 12:57:47.275 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 12:57:47.386 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 12:57:47.488 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"1002","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****yoOg","$type":"Token"},{"TokenType":"code","TokenValue":"****2d4b","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2RBG510IR:00000002","TimeStamp":"2019-03-07T08:57:47.0000000Z","ProcessId":16940,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 12:57:47.499 +04:00 [INF] Authorize endpoint response
{"SubjectId":"1002","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBJzoadwWNx-_muPNGn4l7vJYAQxNrQfIOZmn5cy0oOHUtHApoi-vKe90M7ZPadE99-eTu2xwL9WbZuYrA4VCN-fQzMVNfwARRN5qINc6pavhkcOUEjboKw2DXDVuyU61-QgPKCa50tW1-RfA69osJPBVsWko85KkZPgRXE92qvD-kklebxrjM1Zce6EVUazVUT8p67n5G7M8iTNT_ObxoeBtRnLkijuaNbjUXG7-d2g4udZAhC_nsezMZubSVOkk7MyRXqViA8CyqwLrucX21JiFS6iGGCpqOsB0Mxj3bsNncBSjBdyoZfHidqxTXfiA0","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-07 12:57:47.646 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-07 12:57:47.653 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-07 12:57:47.654 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-07 12:57:47.664 +04:00 [DBG] Start token request.
2019-03-07 12:57:47.672 +04:00 [DBG] Start client validation
2019-03-07 12:57:47.681 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-07 12:57:47.685 +04:00 [DBG] Start parsing for secret in post body
2019-03-07 12:57:47.702 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-07 12:57:47.703 +04:00 [DBG] Secret id found: BiLab
2019-03-07 12:57:47.710 +04:00 [DBG] BiLab found in database: true
2019-03-07 12:57:47.710 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 12:57:47.720 +04:00 [DBG] No shared secret configured for client.
2019-03-07 12:57:47.721 +04:00 [DBG] Secret validators could not validate secret
2019-03-07 12:57:47.721 +04:00 [INF] {"ClientId":"BiLab","Category":"Authentication","Name":"Client Authentication Failure","EventType":"Failure","Id":1011,"Message":"Invalid client secret","ActivityId":"0HLL2RBG510IS:00000003","TimeStamp":"2019-03-07T08:57:47.0000000Z","ProcessId":16940,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationFailureEvent"}
2019-03-07 12:57:47.727 +04:00 [ERR] Client secret validation failed for client: BiLab.
2019-03-07 12:58:13.053 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 12:58:13.103 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 12:58:13.104 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 12:58:13.105 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 12:58:13.106 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 12:58:13.106 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 12:58:13.106 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 12:58:13.332 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:58:13.347 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:58:13.349 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:58:13.426 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 12:58:13.479 +04:00 [DBG] Starting grant removal
2019-03-07 12:58:14.353 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 12:58:14.356 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 12:58:14.357 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 12:58:14.358 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 12:58:14.359 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 12:58:14.361 +04:00 [DBG] Error Url: /home/error
2019-03-07 12:58:14.362 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 12:58:14.418 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 12:58:23.044 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 12:58:23.100 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 12:58:23.101 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 12:58:23.102 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 12:58:23.103 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 12:58:23.103 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 12:58:23.104 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 12:58:23.314 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:58:23.328 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:58:23.331 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 12:58:23.407 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 12:58:23.467 +04:00 [DBG] Starting grant removal
2019-03-07 12:58:24.342 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 12:58:24.346 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 12:58:24.347 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 12:58:24.348 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 12:58:24.349 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 12:58:24.349 +04:00 [DBG] Error Url: /home/error
2019-03-07 12:58:24.350 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 12:58:24.444 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 12:58:42.376 +04:00 [DBG] TaskCanceledException. Exiting.
2019-03-07 12:58:42.411 +04:00 [DBG] Stopping grant removal
2019-03-07 13:04:32.916 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 13:04:32.966 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 13:04:32.967 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 13:04:32.967 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 13:04:32.968 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 13:04:32.968 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 13:04:32.968 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 13:04:33.190 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 13:04:33.201 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 13:04:33.204 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 13:04:33.286 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 13:04:33.339 +04:00 [DBG] Starting grant removal
2019-03-07 13:04:34.235 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 13:04:34.239 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 13:04:34.240 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 13:04:34.241 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 13:04:34.243 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 13:04:34.243 +04:00 [DBG] Error Url: /home/error
2019-03-07 13:04:34.244 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 13:04:34.304 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 13:05:40.104 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 13:05:40.160 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 13:05:40.161 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 13:05:40.161 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 13:05:40.161 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 13:05:40.162 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 13:05:40.162 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 13:05:40.385 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 13:05:40.402 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 13:05:40.410 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 13:05:40.492 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 13:05:40.546 +04:00 [DBG] Starting grant removal
2019-03-07 13:05:41.060 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 13:05:41.062 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 13:05:41.064 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 13:05:41.064 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 13:05:41.065 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 13:05:41.066 +04:00 [DBG] Error Url: /home/error
2019-03-07 13:05:41.066 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 13:05:41.118 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 13:06:20.112 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 13:06:20.165 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 13:06:20.166 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 13:06:20.166 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 13:06:20.166 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 13:06:20.167 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 13:06:20.167 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 13:06:20.392 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 13:06:20.405 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 13:06:20.408 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 13:06:20.485 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 13:06:20.540 +04:00 [DBG] Starting grant removal
2019-03-07 13:06:21.069 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 13:06:21.072 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 13:06:21.073 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 13:06:21.074 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 13:06:21.074 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 13:06:21.075 +04:00 [DBG] Error Url: /home/error
2019-03-07 13:06:21.075 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 13:06:21.126 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 13:06:30.889 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-07 13:06:30.897 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-07 13:06:30.898 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-07 13:06:30.904 +04:00 [DBG] Start discovery request
2019-03-07 13:06:31.374 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-03-07 13:06:31.517 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-07 13:06:31.520 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-07 13:06:31.521 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-07 13:06:31.525 +04:00 [DBG] Start key discovery request
2019-03-07 13:06:31.603 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 13:06:31.608 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 13:06:31.614 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 13:06:31.623 +04:00 [DBG] Start authorize request
2019-03-07 13:06:31.634 +04:00 [DBG] User in authorize request: 1002
2019-03-07 13:06:31.638 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 13:06:31.908 +04:00 [DBG] BiLab found in database: true
2019-03-07 13:06:31.918 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 13:06:31.923 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 13:06:31.925 +04:00 [DBG] No PKCE used.
2019-03-07 13:06:31.975 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 13:06:32.017 +04:00 [DBG] Found [] API scopes in database
2019-03-07 13:06:32.025 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 13:06:32.029 +04:00 [DBG] Found [] API scopes in database
2019-03-07 13:06:32.037 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 13:06:32.051 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBjmTyCpM_J41pCI2yKGReMOlVOFwU1mG1Ec5yzn181LdfdJBQp598V4m5dyZG5oaAKNIzGIGH8kDPUbzkMOS2BZCsS7yWoBNAmmTNPOTOlLfUq8kEptV-gxyEjEBw6Y5v370zFiWiCLzQaQa-gsFluv1OXCW1NmcUt7-Xr0r-fVL98fa-mMCaiTJOfxPJEpe9v5KOaqI2lTPq0HoIUqhQmyc9aDJ0yRS32KYI8HYbBY5waa2m2feeC6iNzzyFD_kyyR-ClqSpIPqWOfFBnhTfKaAonq722DjF9mymyoT9t5PS8bzCIt2iFF4UZ4xyhNmo","UiLocales":null,"Nonce":"636875463915811596.MjdjYjM0MDUtMjEwZS00ZDBjLWIwNjItM2RhNjA2M2VjZmNmNzBiZDNjMTYtZDE0YS00MGMxLThiMGYtZTJjNWMzNzIxYjVj","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"24637cc52e6a9a05e18df7fabccacedd","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875463915811596.MjdjYjM0MDUtMjEwZS00ZDBjLWIwNjItM2RhNjA2M2VjZmNmNzBiZDNjMTYtZDE0YS00MGMxLThiMGYtZTJjNWMzNzIxYjVj","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBjmTyCpM_J41pCI2yKGReMOlVOFwU1mG1Ec5yzn181LdfdJBQp598V4m5dyZG5oaAKNIzGIGH8kDPUbzkMOS2BZCsS7yWoBNAmmTNPOTOlLfUq8kEptV-gxyEjEBw6Y5v370zFiWiCLzQaQa-gsFluv1OXCW1NmcUt7-Xr0r-fVL98fa-mMCaiTJOfxPJEpe9v5KOaqI2lTPq0HoIUqhQmyc9aDJ0yRS32KYI8HYbBY5waa2m2feeC6iNzzyFD_kyyR-ClqSpIPqWOfFBnhTfKaAonq722DjF9mymyoT9t5PS8bzCIt2iFF4UZ4xyhNmo","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 13:06:32.106 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-07 13:06:32.115 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-07 13:06:32.150 +04:00 [DBG] jBVyAdG6fBBHbI2hK1mqDHJF91zbrhHhtyAyy04ljzY= not found in database
2019-03-07 13:06:32.203 +04:00 [DBG] Creating Implicit Flow response.
2019-03-07 13:06:32.213 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 13:06:32.328 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 13:06:32.427 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"1002","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****syxA","$type":"Token"},{"TokenType":"code","TokenValue":"****1749","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2RGL4UMNC:00000002","TimeStamp":"2019-03-07T09:06:32.0000000Z","ProcessId":15152,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 13:06:32.436 +04:00 [INF] Authorize endpoint response
{"SubjectId":"1002","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNBjmTyCpM_J41pCI2yKGReMOlVOFwU1mG1Ec5yzn181LdfdJBQp598V4m5dyZG5oaAKNIzGIGH8kDPUbzkMOS2BZCsS7yWoBNAmmTNPOTOlLfUq8kEptV-gxyEjEBw6Y5v370zFiWiCLzQaQa-gsFluv1OXCW1NmcUt7-Xr0r-fVL98fa-mMCaiTJOfxPJEpe9v5KOaqI2lTPq0HoIUqhQmyc9aDJ0yRS32KYI8HYbBY5waa2m2feeC6iNzzyFD_kyyR-ClqSpIPqWOfFBnhTfKaAonq722DjF9mymyoT9t5PS8bzCIt2iFF4UZ4xyhNmo","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-07 13:06:32.592 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-07 13:06:32.599 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-07 13:06:32.600 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-07 13:06:32.608 +04:00 [DBG] Start token request.
2019-03-07 13:06:32.615 +04:00 [DBG] Start client validation
2019-03-07 13:06:32.620 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-07 13:06:32.624 +04:00 [DBG] Start parsing for secret in post body
2019-03-07 13:06:32.645 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-07 13:06:32.645 +04:00 [DBG] Secret id found: BiLab
2019-03-07 13:06:32.651 +04:00 [DBG] BiLab found in database: true
2019-03-07 13:06:32.651 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 13:06:32.660 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-07 13:06:32.661 +04:00 [DBG] Client validation success
2019-03-07 13:06:32.662 +04:00 [INF] {"ClientId":"BiLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLL2RGL4UMNE:00000003","TimeStamp":"2019-03-07T09:06:32.0000000Z","ProcessId":15152,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-03-07 13:06:32.669 +04:00 [DBG] Start token request validation
2019-03-07 13:06:32.681 +04:00 [DBG] Start validation of authorization code token request
2019-03-07 13:06:32.696 +04:00 [DBG] jBVyAdG6fBBHbI2hK1mqDHJF91zbrhHhtyAyy04ljzY= found in database: true
2019-03-07 13:06:32.714 +04:00 [DBG] removing jBVyAdG6fBBHbI2hK1mqDHJF91zbrhHhtyAyy04ljzY= persisted grant from database
2019-03-07 13:06:32.727 +04:00 [DBG] Validation of authorization code token request success
2019-03-07 13:06:32.735 +04:00 [INF] Token request validation success
{"ClientId":"BiLab","ClientName":"BiLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"c2cdab10a434b6d4344c8c657645501d694c6fd0135f5e4481ac65348a271749","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"BiLab","client_secret":"***REDACTED***","code":"c2cdab10a434b6d4344c8c657645501d694c6fd0135f5e4481ac65348a271749","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-03-07 13:06:32.759 +04:00 [DBG] BiLab found in database: true
2019-03-07 13:06:32.760 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 13:06:32.768 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 13:06:32.774 +04:00 [DBG] Found [] API scopes in database
2019-03-07 13:06:32.786 +04:00 [DBG] Getting claims for access token for client: BiLab
2019-03-07 13:06:32.786 +04:00 [DBG] Getting claims for access token for subject: 1002
2019-03-07 13:06:32.796 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 13:06:32.806 +04:00 [DBG] Creating refresh token
2019-03-07 13:06:32.806 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-03-07 13:06:32.818 +04:00 [DBG] Mimh+obHjbrCRCFnC9pulIRbQC8rpHfOnhCCoA5SnFI= not found in database
2019-03-07 13:06:32.826 +04:00 [DBG] BiLab found in database: true
2019-03-07 13:06:32.827 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 13:06:32.831 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 13:06:32.833 +04:00 [DBG] Found [] API scopes in database
2019-03-07 13:06:32.834 +04:00 [DBG] Getting claims for identity token for subject: 1002 and client: BiLab
2019-03-07 13:06:32.840 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 13:06:32.847 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****azsw","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****c7f3","$type":"Token"},{"TokenType":"access_token","TokenValue":"****clww","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2RGL4UMNE:00000003","TimeStamp":"2019-03-07T09:06:32.0000000Z","ProcessId":15152,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 13:06:32.854 +04:00 [DBG] Token request success.
2019-03-07 13:06:32.867 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-03-07 13:06:32.869 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-03-07 13:06:32.871 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-03-07 13:06:32.878 +04:00 [DBG] Start userinfo request
2019-03-07 13:06:32.882 +04:00 [DBG] Bearer token found in header
2019-03-07 13:06:32.941 +04:00 [DBG] BiLab found in database: true
2019-03-07 13:06:32.941 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 13:06:32.951 +04:00 [DBG] BiLab found in database: true
2019-03-07 13:06:32.951 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 13:06:32.960 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-03-07 13:06:32.963 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1551949592,"exp":1551953192,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"BiLab","sub":"1002","auth_time":1551948782,"idp":"local","AspNet.Identity.SecurityStamp":"YRQCMJ4XBHSYAYVIFGH3YHMVNOLY4SL5","role":"GodAdmin","preferred_username":"godAdmin@admin.ru","name":"godAdmin@admin.ru","email":"godAdmin@admin.ru","email_verified":false,"given_name":"godAdmin@admin.ru","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-03-07 13:06:32.976 +04:00 [DBG] Creating userinfo response
2019-03-07 13:06:32.981 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 13:06:32.985 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 13:06:32.989 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 13:06:32.991 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-03-07 13:06:32.992 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 13:06:32.995 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 13:06:33.004 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email
2019-03-07 13:06:33.005 +04:00 [DBG] End userinfo request
2019-03-07 13:06:55.997 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-07 13:06:56.004 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-07 13:06:56.005 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-07 13:06:56.007 +04:00 [DBG] Start authorize request
2019-03-07 13:06:56.008 +04:00 [DBG] No user present in authorize request
2019-03-07 13:06:56.008 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 13:06:56.018 +04:00 [DBG] BiLab found in database: true
2019-03-07 13:06:56.018 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 13:06:56.021 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 13:06:56.021 +04:00 [DBG] No PKCE used.
2019-03-07 13:06:56.024 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 13:06:56.027 +04:00 [DBG] Found [] API scopes in database
2019-03-07 13:06:56.036 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 13:06:56.038 +04:00 [DBG] Found [] API scopes in database
2019-03-07 13:06:56.039 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 13:06:56.040 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNA_81N5j3pouEDyrkQqLM1mJKXbvDIT6o6HH-Qkx7oyuzGrmKfemExZNloU3H1OPkqRvOFQxEYjQZAYk-4t_TTSYnMZa0lVemir3iFNU8EPf31apbN7uiMnFmm_RdS0TfCDAm628bzWVNmpoMTZ2-RR6T2huUelzYZbdcf3BuGjofoteuKl0gjJ8apNDi73E1J6vAcPhwZ1x06MrcaV631UrazkfgcOxBWrg7JPFyNtZGU-NWkrOCHJyCMvaibT9Gft5uC-Hj5tc-Cj0K-jkeGgeFFFHGvyARDcnqM4URTYkT-1cFz0UFIX5IB5W3anW9Y","UiLocales":null,"Nonce":"636875464159868474.OWNmZTJjZWItOTI0ZC00ODVjLTgwMTEtYTIzNjEzZTFmMzgzYjZlNDI0ZTctMDQ3Zi00ZmM5LTk0ZGItOWE5MTFkOGFkMTZk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875464159868474.OWNmZTJjZWItOTI0ZC00ODVjLTgwMTEtYTIzNjEzZTFmMzgzYjZlNDI0ZTctMDQ3Zi00ZmM5LTk0ZGItOWE5MTFkOGFkMTZk","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNA_81N5j3pouEDyrkQqLM1mJKXbvDIT6o6HH-Qkx7oyuzGrmKfemExZNloU3H1OPkqRvOFQxEYjQZAYk-4t_TTSYnMZa0lVemir3iFNU8EPf31apbN7uiMnFmm_RdS0TfCDAm628bzWVNmpoMTZ2-RR6T2huUelzYZbdcf3BuGjofoteuKl0gjJ8apNDi73E1J6vAcPhwZ1x06MrcaV631UrazkfgcOxBWrg7JPFyNtZGU-NWkrOCHJyCMvaibT9Gft5uC-Hj5tc-Cj0K-jkeGgeFFFHGvyARDcnqM4URTYkT-1cFz0UFIX5IB5W3anW9Y","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 13:06:56.054 +04:00 [INF] Showing login: User is not authenticated
2019-03-07 13:06:58.448 +04:00 [DBG] Augmenting SignInContext
2019-03-07 13:06:58.451 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 13:06:58.451 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 13:06:58.452 +04:00 [DBG] Adding auth_time claim with value: 1551949618
2019-03-07 13:06:58.460 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 13:06:58.468 +04:00 [INF] {"Username":"test@mail.ru","Provider":null,"ProviderUserId":null,"SubjectId":"2","DisplayName":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2RGL4UMNC:00000005","TimeStamp":"2019-03-07T09:06:58.0000000Z","ProcessId":15152,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-07 13:06:58.496 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-07 13:06:58.500 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-07 13:06:58.501 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-07 13:06:58.507 +04:00 [DBG] Start authorize callback request
2019-03-07 13:06:58.514 +04:00 [DBG] User in authorize request: 2
2019-03-07 13:06:58.515 +04:00 [DBG] Start authorize request protocol validation
2019-03-07 13:06:58.521 +04:00 [DBG] BiLab found in database: true
2019-03-07 13:06:58.521 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 13:06:58.522 +04:00 [DBG] Checking for PKCE parameters
2019-03-07 13:06:58.523 +04:00 [DBG] No PKCE used.
2019-03-07 13:06:58.526 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 13:06:58.528 +04:00 [DBG] Found [] API scopes in database
2019-03-07 13:06:58.532 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 13:06:58.535 +04:00 [DBG] Found [] API scopes in database
2019-03-07 13:06:58.536 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-07 13:06:58.539 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNA_81N5j3pouEDyrkQqLM1mJKXbvDIT6o6HH-Qkx7oyuzGrmKfemExZNloU3H1OPkqRvOFQxEYjQZAYk-4t_TTSYnMZa0lVemir3iFNU8EPf31apbN7uiMnFmm_RdS0TfCDAm628bzWVNmpoMTZ2-RR6T2huUelzYZbdcf3BuGjofoteuKl0gjJ8apNDi73E1J6vAcPhwZ1x06MrcaV631UrazkfgcOxBWrg7JPFyNtZGU-NWkrOCHJyCMvaibT9Gft5uC-Hj5tc-Cj0K-jkeGgeFFFHGvyARDcnqM4URTYkT-1cFz0UFIX5IB5W3anW9Y","UiLocales":null,"Nonce":"636875464159868474.OWNmZTJjZWItOTI0ZC00ODVjLTgwMTEtYTIzNjEzZTFmMzgzYjZlNDI0ZTctMDQ3Zi00ZmM5LTk0ZGItOWE5MTFkOGFkMTZk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"dddc06c7a2ab722681d7ca2d75dfdd10","Raw":{"client_id":"BiLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636875464159868474.OWNmZTJjZWItOTI0ZC00ODVjLTgwMTEtYTIzNjEzZTFmMzgzYjZlNDI0ZTctMDQ3Zi00ZmM5LTk0ZGItOWE5MTFkOGFkMTZk","state":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNA_81N5j3pouEDyrkQqLM1mJKXbvDIT6o6HH-Qkx7oyuzGrmKfemExZNloU3H1OPkqRvOFQxEYjQZAYk-4t_TTSYnMZa0lVemir3iFNU8EPf31apbN7uiMnFmm_RdS0TfCDAm628bzWVNmpoMTZ2-RR6T2huUelzYZbdcf3BuGjofoteuKl0gjJ8apNDi73E1J6vAcPhwZ1x06MrcaV631UrazkfgcOxBWrg7JPFyNtZGU-NWkrOCHJyCMvaibT9Gft5uC-Hj5tc-Cj0K-jkeGgeFFFHGvyARDcnqM4URTYkT-1cFz0UFIX5IB5W3anW9Y","x-client-SKU":"ID_NETSTANDARD1_4","x-client-ver":"5.2.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-03-07 13:06:58.554 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-03-07 13:06:58.555 +04:00 [DBG] Creating Hybrid Flow response.
2019-03-07 13:06:58.557 +04:00 [DBG] 2QUi12APIy2Rc8r+jNg8mwUxrYrH3RQekbIRmdkMjzQ= not found in database
2019-03-07 13:06:58.560 +04:00 [DBG] Creating Implicit Flow response.
2019-03-07 13:06:58.560 +04:00 [DBG] Getting claims for identity token for subject: 2 and client: BiLab
2019-03-07 13:06:58.572 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 13:06:58.576 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"2","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****5RXQ","$type":"Token"},{"TokenType":"code","TokenValue":"****6771","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2RGL4UMNC:00000006","TimeStamp":"2019-03-07T09:06:58.0000000Z","ProcessId":15152,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 13:06:58.580 +04:00 [INF] Authorize endpoint response
{"SubjectId":"2","ClientId":"BiLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8Dkbo3s7kDZCnwNxGjoFYNA_81N5j3pouEDyrkQqLM1mJKXbvDIT6o6HH-Qkx7oyuzGrmKfemExZNloU3H1OPkqRvOFQxEYjQZAYk-4t_TTSYnMZa0lVemir3iFNU8EPf31apbN7uiMnFmm_RdS0TfCDAm628bzWVNmpoMTZ2-RR6T2huUelzYZbdcf3BuGjofoteuKl0gjJ8apNDi73E1J6vAcPhwZ1x06MrcaV631UrazkfgcOxBWrg7JPFyNtZGU-NWkrOCHJyCMvaibT9Gft5uC-Hj5tc-Cj0K-jkeGgeFFFHGvyARDcnqM4URTYkT-1cFz0UFIX5IB5W3anW9Y","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-03-07 13:06:58.590 +04:00 [DBG] Augmenting SignInContext
2019-03-07 13:06:58.591 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 13:06:58.630 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-03-07 13:06:58.632 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-03-07 13:06:58.633 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-03-07 13:06:58.634 +04:00 [DBG] Start token request.
2019-03-07 13:06:58.635 +04:00 [DBG] Start client validation
2019-03-07 13:06:58.635 +04:00 [DBG] Start parsing Basic Authentication secret
2019-03-07 13:06:58.636 +04:00 [DBG] Start parsing for secret in post body
2019-03-07 13:06:58.637 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-07 13:06:58.637 +04:00 [DBG] Secret id found: BiLab
2019-03-07 13:06:58.644 +04:00 [DBG] BiLab found in database: true
2019-03-07 13:06:58.644 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 13:06:58.646 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-07 13:06:58.646 +04:00 [DBG] Client validation success
2019-03-07 13:06:58.647 +04:00 [INF] {"ClientId":"BiLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLL2RGL4UMNE:00000005","TimeStamp":"2019-03-07T09:06:58.0000000Z","ProcessId":15152,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-03-07 13:06:58.651 +04:00 [DBG] Start token request validation
2019-03-07 13:06:58.651 +04:00 [DBG] Start validation of authorization code token request
2019-03-07 13:06:58.655 +04:00 [DBG] 2QUi12APIy2Rc8r+jNg8mwUxrYrH3RQekbIRmdkMjzQ= found in database: true
2019-03-07 13:06:58.658 +04:00 [DBG] removing 2QUi12APIy2Rc8r+jNg8mwUxrYrH3RQekbIRmdkMjzQ= persisted grant from database
2019-03-07 13:06:58.666 +04:00 [DBG] Validation of authorization code token request success
2019-03-07 13:06:58.667 +04:00 [INF] Token request validation success
{"ClientId":"BiLab","ClientName":"BiLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"d98b013914a1b5790d45c5d9e687e63adb75c47c136d50d3d277510238746771","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"BiLab","client_secret":"***REDACTED***","code":"d98b013914a1b5790d45c5d9e687e63adb75c47c136d50d3d277510238746771","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-03-07 13:06:58.675 +04:00 [DBG] BiLab found in database: true
2019-03-07 13:06:58.675 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 13:06:58.678 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 13:06:58.682 +04:00 [DBG] Found [] API scopes in database
2019-03-07 13:06:58.683 +04:00 [DBG] Getting claims for access token for client: BiLab
2019-03-07 13:06:58.683 +04:00 [DBG] Getting claims for access token for subject: 2
2019-03-07 13:06:58.696 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 13:06:58.700 +04:00 [DBG] Creating refresh token
2019-03-07 13:06:58.701 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-03-07 13:06:58.702 +04:00 [DBG] MMcJMRaZNpznvQgbt7bdl9juN4y5Ti62M9Le+v1qAUw= not found in database
2019-03-07 13:06:58.708 +04:00 [DBG] BiLab found in database: true
2019-03-07 13:06:58.708 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 13:06:58.711 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 13:06:58.715 +04:00 [DBG] Found [] API scopes in database
2019-03-07 13:06:58.716 +04:00 [DBG] Getting claims for identity token for subject: 2 and client: BiLab
2019-03-07 13:06:58.723 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-03-07 13:06:58.727 +04:00 [INF] {"ClientId":"BiLab","ClientName":"BiLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****FuFA","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****61a9","$type":"Token"},{"TokenType":"access_token","TokenValue":"****OWoQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLL2RGL4UMNE:00000005","TimeStamp":"2019-03-07T09:06:58.0000000Z","ProcessId":15152,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-03-07 13:06:58.734 +04:00 [DBG] Token request success.
2019-03-07 13:06:58.745 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-03-07 13:06:58.748 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-03-07 13:06:58.750 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-03-07 13:06:58.759 +04:00 [DBG] Start userinfo request
2019-03-07 13:06:58.761 +04:00 [DBG] Bearer token found in header
2019-03-07 13:06:58.771 +04:00 [DBG] BiLab found in database: true
2019-03-07 13:06:58.771 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 13:06:58.778 +04:00 [DBG] BiLab found in database: true
2019-03-07 13:06:58.778 +04:00 [DBG] client configuration validation for client BiLab succeeded.
2019-03-07 13:06:58.785 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-03-07 13:06:58.786 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1551949618,"exp":1551953218,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"BiLab","sub":"2","auth_time":1551949618,"idp":"local","AspNet.Identity.SecurityStamp":"RUYKCWHO26U6OEQYLNO7G7V2RE44ETDK","role":"user","preferred_username":"test@mail.ru","name":"test@mail.ru","email":"test@mail.ru","email_verified":false,"given_name":"test@mail.ru","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-03-07 13:06:58.791 +04:00 [DBG] Creating userinfo response
2019-03-07 13:06:58.791 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 13:06:58.792 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 13:06:58.801 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 13:06:58.802 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-03-07 13:06:58.802 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-03-07 13:06:58.805 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-03-07 13:06:58.812 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email
2019-03-07 13:06:58.814 +04:00 [DBG] End userinfo request
2019-03-07 13:19:18.790 +04:00 [ERR] Failed executing DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResources] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [LastAccessed] datetime2 NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_ApiResources] PRIMARY KEY ([Id])
);
System.Data.SqlClient.SqlException (0x80131904): There is already an object named 'ApiResources' in the database.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean asyncWrite, String methodName)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
ClientConnectionId:36b3590d-424f-4d9b-b959-3ca2672ffdb6
Error Number:2714,State:6,Class:16
2019-03-07 13:24:37.116 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 13:24:37.162 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 13:24:37.162 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 13:24:37.163 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 13:24:37.163 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 13:24:37.164 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 13:24:37.164 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 13:24:37.550 +04:00 [DBG] Starting grant removal
2019-03-07 13:24:38.426 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 13:24:38.429 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 13:24:38.431 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 13:24:38.431 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 13:24:38.432 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 13:24:38.434 +04:00 [DBG] Error Url: /home/error
2019-03-07 13:24:38.435 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 13:24:38.459 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 13:24:38.479 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 13:24:38.501 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 13:24:38.667 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-07 13:24:38.682 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 13:24:38.683 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 13:24:40.750 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 13:24:40.752 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 13:24:40.833 +04:00 [INF] {"Username":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLL2RQS56MAI:00000003","TimeStamp":"2019-03-07T09:24:40.0000000Z","ProcessId":1084,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-03-07 13:26:08.797 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 13:26:08.850 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 13:26:08.851 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 13:26:08.852 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 13:26:08.852 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 13:26:08.852 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 13:26:08.852 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 13:26:09.051 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 13:26:09.096 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 13:26:09.102 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 13:26:09.178 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 13:26:09.348 +04:00 [DBG] Starting grant removal
2019-03-07 13:26:09.353 +04:00 [DBG] CancellationRequested. Exiting.
2019-03-07 13:26:09.367 +04:00 [DBG] Stopping grant removal
2019-03-07 13:28:41.716 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-07 13:28:41.766 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-07 13:28:41.767 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-07 13:28:41.767 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-07 13:28:41.768 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-07 13:28:41.768 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-07 13:28:41.769 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-07 13:28:41.981 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 13:28:42.038 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 13:28:42.043 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-07 13:28:42.127 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 13:28:42.214 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 13:28:42.232 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 13:28:42.243 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 13:28:42.255 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 13:28:42.265 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-07 13:28:42.297 +04:00 [DBG] Starting grant removal
2019-03-07 13:28:42.845 +04:00 [DBG] Login Url: /Account/Login
2019-03-07 13:28:42.848 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-07 13:28:42.849 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-07 13:28:42.850 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-07 13:28:42.850 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-07 13:28:42.851 +04:00 [DBG] Error Url: /home/error
2019-03-07 13:28:42.852 +04:00 [DBG] Error Id Parameter: errorId
2019-03-07 13:28:42.869 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 13:28:42.886 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 13:28:42.900 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-07 13:28:43.044 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-07 13:28:43.059 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 13:28:43.060 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 13:28:44.699 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 13:28:44.701 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 13:28:44.782 +04:00 [INF] {"Username":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLL2RT51A4O1:00000003","TimeStamp":"2019-03-07T09:28:44.0000000Z","ProcessId":12352,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-03-07 13:28:53.106 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 13:28:53.108 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 13:28:53.113 +04:00 [INF] {"Username":"test@mail.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLL2RT51A4O1:00000004","TimeStamp":"2019-03-07T09:28:53.0000000Z","ProcessId":12352,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-03-07 13:29:16.531 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 13:29:16.532 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 13:29:16.543 +04:00 [INF] {"Username":"admin@test.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLL2RT51A4O1:00000005","TimeStamp":"2019-03-07T09:29:16.0000000Z","ProcessId":12352,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-03-07 13:29:19.528 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 13:29:19.530 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 13:29:19.536 +04:00 [INF] {"Username":"admin@test.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLL2RT51A4O1:00000006","TimeStamp":"2019-03-07T09:29:19.0000000Z","ProcessId":12352,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-03-07 13:29:41.210 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 13:29:41.211 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 13:31:21.662 +04:00 [INF] {"Username":"admin@test.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLL2RT51A4O1:00000007","TimeStamp":"2019-03-07T09:31:21.0000000Z","ProcessId":12352,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-03-07 13:31:21.697 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 13:31:21.698 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 13:31:43.863 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 13:31:43.868 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 13:32:10.986 +04:00 [DBG] Augmenting SignInContext
2019-03-07 13:32:10.998 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 13:32:10.998 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 13:32:10.999 +04:00 [DBG] Adding auth_time claim with value: 1551951130
2019-03-07 13:32:11.005 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-03-07 13:32:11.015 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 13:32:16.301 +04:00 [ERR] The view 'Index' was not found. Searched locations: ["/Views/Home/Index.cshtml","/Views/Shared/Index.cshtml","/Pages/Shared/Index.cshtml"]
2019-03-07 13:32:16.312 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The view 'Index' was not found. The following locations were searched:
/Views/Home/Index.cshtml
/Views/Shared/Index.cshtml
/Pages/Shared/Index.cshtml
   at Microsoft.AspNetCore.Mvc.ViewEngines.ViewEngineResult.EnsureSuccessful(IEnumerable`1 originalLocations)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-03-07 13:32:21.047 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-03-07 13:32:21.070 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-03-07 13:32:21.072 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-03-07 13:32:26.038 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-07 13:32:32.016 +04:00 [DBG] Augmenting SignInContext
2019-03-07 13:32:32.017 +04:00 [DBG] Adding idp claim with value: local
2019-03-07 13:32:32.020 +04:00 [DBG] Adding amr claim with value: pwd
2019-03-07 13:32:32.020 +04:00 [DBG] Adding auth_time claim with value: 1551951152
2019-03-07 13:32:32.022 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-07 13:32:34.242 +04:00 [INF] {"Username":"godAdmin@admin.ru","Provider":null,"ProviderUserId":null,"SubjectId":"4","DisplayName":"godAdmin@admin.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLL2RT51A4O6:0000000A","TimeStamp":"2019-03-07T09:32:34.0000000Z","ProcessId":12352,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-03-11 11:14:14.226 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-03-11 11:14:14.304 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-03-11 11:14:14.305 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-03-11 11:14:14.305 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-03-11 11:14:14.305 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-03-11 11:14:14.307 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-03-11 11:14:14.307 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-03-11 11:14:14.629 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-11 11:14:14.640 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-11 11:14:14.650 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-03-11 11:14:14.759 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-11 11:14:14.851 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-11 11:14:14.865 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-11 11:14:14.876 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-11 11:14:14.891 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-11 11:14:14.904 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-03-11 11:14:14.936 +04:00 [DBG] Starting grant removal
2019-03-11 11:14:15.867 +04:00 [DBG] Login Url: /Account/Login
2019-03-11 11:14:15.873 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-03-11 11:14:15.876 +04:00 [DBG] Logout Url: /Account/Logout
2019-03-11 11:14:15.877 +04:00 [DBG] ConsentUrl Url: /consent
2019-03-11 11:14:15.877 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-03-11 11:14:15.878 +04:00 [DBG] Error Url: /home/error
2019-03-11 11:14:15.879 +04:00 [DBG] Error Id Parameter: errorId
2019-03-11 11:14:15.923 +04:00 [WRN] Failed to determine the https port for redirect.
2019-03-11 11:14:16.470 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-04-17 20:37:23.167 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-04-17 20:37:23.466 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-04-17 20:37:23.466 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-04-17 20:37:23.467 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-04-17 20:37:23.467 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-04-17 20:37:23.467 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-04-17 20:37:23.467 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-04-17 20:37:27.642 +04:00 [DBG] Starting grant removal
2019-04-17 20:37:28.739 +04:00 [DBG] Login Url: /Account/Login
2019-04-17 20:37:28.750 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-04-17 20:37:28.751 +04:00 [DBG] Logout Url: /Account/Logout
2019-04-17 20:37:28.751 +04:00 [DBG] ConsentUrl Url: /consent
2019-04-17 20:37:28.751 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-04-17 20:37:28.751 +04:00 [DBG] Error Url: /home/error
2019-04-17 20:37:28.751 +04:00 [DBG] Error Id Parameter: errorId
2019-04-17 20:38:42.935 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-04-17 20:38:43.157 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-04-17 20:38:43.157 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-04-17 20:38:43.157 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-04-17 20:38:43.157 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-04-17 20:38:43.157 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-04-17 20:38:43.158 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-04-17 20:38:44.295 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-04-17 20:38:44.346 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-04-17 20:38:44.353 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-04-17 20:38:44.715 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-17 20:38:45.046 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-17 20:38:45.113 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-17 20:38:45.170 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-17 20:38:45.217 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-17 20:38:45.250 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-17 20:38:45.533 +04:00 [DBG] Starting grant removal
2019-04-17 20:38:46.343 +04:00 [DBG] Login Url: /Account/Login
2019-04-17 20:38:46.363 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-04-17 20:38:46.363 +04:00 [DBG] Logout Url: /Account/Logout
2019-04-17 20:38:46.364 +04:00 [DBG] ConsentUrl Url: /consent
2019-04-17 20:38:46.364 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-04-17 20:38:46.365 +04:00 [DBG] Error Url: /home/error
2019-04-17 20:38:46.366 +04:00 [DBG] Error Id Parameter: errorId
2019-04-17 20:39:50.452 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-04-17 20:39:50.606 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-04-17 20:39:50.608 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-04-17 20:39:50.609 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-04-17 20:39:50.610 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-04-17 20:39:50.610 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-04-17 20:39:50.667 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-04-17 20:39:51.362 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-04-17 20:39:51.395 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-04-17 20:39:51.400 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-04-17 20:39:51.671 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-17 20:39:51.915 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-17 20:39:51.965 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-17 20:39:52.007 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-17 20:39:52.030 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-17 20:39:52.051 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-17 20:39:52.235 +04:00 [DBG] Starting grant removal
2019-04-17 20:48:57.217 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-04-17 20:48:57.407 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-04-17 20:48:57.408 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-04-17 20:48:57.409 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-04-17 20:48:57.410 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-04-17 20:48:57.411 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-04-17 20:48:57.411 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-04-17 20:48:58.428 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-04-17 20:48:58.469 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-04-17 20:48:58.474 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-04-17 20:48:58.741 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-17 20:48:59.052 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-17 20:48:59.107 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-17 20:48:59.136 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-17 20:48:59.163 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-17 20:48:59.187 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-17 20:48:59.388 +04:00 [DBG] Starting grant removal
2019-04-17 20:49:42.877 +04:00 [DBG] Login Url: /Account/Login
2019-04-17 20:49:42.892 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-04-17 20:49:42.902 +04:00 [DBG] Logout Url: /Account/Logout
2019-04-17 20:49:42.907 +04:00 [DBG] ConsentUrl Url: /consent
2019-04-17 20:49:42.909 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-04-17 20:49:42.918 +04:00 [DBG] Error Url: /home/error
2019-04-17 20:49:42.920 +04:00 [DBG] Error Id Parameter: errorId
2019-04-17 20:49:43.043 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-04-17 20:49:43.077 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-04-17 20:49:43.083 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-04-17 20:49:43.106 +04:00 [DBG] Start discovery request
2019-04-17 20:49:45.022 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-04-17 20:49:45.652 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-04-17 20:49:45.673 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-04-17 20:49:45.689 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-04-17 20:49:45.713 +04:00 [DBG] Start key discovery request
2019-04-17 20:49:46.090 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-04-17 20:49:46.117 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-04-17 20:49:46.122 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-04-17 20:49:46.139 +04:00 [DBG] Start authorize request
2019-04-17 20:49:46.183 +04:00 [DBG] No user present in authorize request
2019-04-17 20:49:46.208 +04:00 [DBG] Start authorize request protocol validation
2019-04-17 20:49:47.756 +04:00 [DBG] StudLab found in database: true
2019-04-17 20:49:47.785 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-17 20:49:47.809 +04:00 [DBG] Checking for PKCE parameters
2019-04-17 20:49:47.822 +04:00 [DBG] No PKCE used.
2019-04-17 20:49:48.016 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-17 20:49:48.175 +04:00 [DBG] Found [] API scopes in database
2019-04-17 20:49:48.220 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-17 20:49:48.229 +04:00 [DBG] Found [] API scopes in database
2019-04-17 20:49:48.253 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-04-17 20:49:48.320 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK8-d2kdVLEEcpGyDzNPS6iqSPEs6B0otUdhnUKZ6_OdeRn8QjtVm2uRcNcX1eMFDdSY-4FGsUTZa9iYQr-jkZXDv1I5wfxoGC3BNXTelcWjRmJ5mbAV4nU9KT-SxYTWdygAQ61SnRmImMzMNtRdVjG4orA58IaFnsNLARbLls8BUotjCC13yWPiDbVpxpLm4846lFwMi6ycRpvNBRSjLCSPLHVKzbrra3sAsUVQnY1E7pAP1FrZSrmlcqQQO1Jljk6FGM6dZYhNnT_av6ZR0htaoD09yY4pfU9P2We6qjm3FtoZJAOkhHH2D_QtL2oL3_uftMkKpq0igO6Gk4B0hVJ0P","UiLocales":null,"Nonce":"636911165859573097.NjAwN2ViYmItNjFkZC00Mzk3LTkzNmEtOWZhZDVhZjgzZDZjMzRjOThkYzAtZWNmMi00ZGJmLTk2OGYtMmI0MGQ1Njc0ZTky","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636911165859573097.NjAwN2ViYmItNjFkZC00Mzk3LTkzNmEtOWZhZDVhZjgzZDZjMzRjOThkYzAtZWNmMi00ZGJmLTk2OGYtMmI0MGQ1Njc0ZTky","state":"CfDJ8D73mgAamspIvsbnstRoK8-d2kdVLEEcpGyDzNPS6iqSPEs6B0otUdhnUKZ6_OdeRn8QjtVm2uRcNcX1eMFDdSY-4FGsUTZa9iYQr-jkZXDv1I5wfxoGC3BNXTelcWjRmJ5mbAV4nU9KT-SxYTWdygAQ61SnRmImMzMNtRdVjG4orA58IaFnsNLARbLls8BUotjCC13yWPiDbVpxpLm4846lFwMi6ycRpvNBRSjLCSPLHVKzbrra3sAsUVQnY1E7pAP1FrZSrmlcqQQO1Jljk6FGM6dZYhNnT_av6ZR0htaoD09yY4pfU9P2We6qjm3FtoZJAOkhHH2D_QtL2oL3_uftMkKpq0igO6Gk4B0hVJ0P","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-04-17 20:49:48.406 +04:00 [INF] Showing login: User is not authenticated
2019-04-17 20:49:48.454 +04:00 [WRN] Failed to determine the https port for redirect.
2019-04-17 20:51:31.973 +04:00 [DBG] Augmenting SignInContext
2019-04-17 20:51:31.981 +04:00 [DBG] Adding idp claim with value: local
2019-04-17 20:51:31.984 +04:00 [DBG] Adding amr claim with value: pwd
2019-04-17 20:51:31.989 +04:00 [DBG] Adding auth_time claim with value: 1555519891
2019-04-17 20:51:32.038 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-04-17 20:51:52.376 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-04-17 20:51:52.395 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-04-17 20:51:52.400 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-04-17 20:51:52.413 +04:00 [DBG] Start authorize request
2019-04-17 20:51:52.426 +04:00 [DBG] User in authorize request: 4
2019-04-17 20:51:52.427 +04:00 [DBG] Start authorize request protocol validation
2019-04-17 20:51:52.457 +04:00 [DBG] StudLab found in database: true
2019-04-17 20:51:52.461 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-17 20:51:52.470 +04:00 [DBG] Checking for PKCE parameters
2019-04-17 20:51:52.472 +04:00 [DBG] No PKCE used.
2019-04-17 20:51:52.483 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-17 20:51:52.564 +04:00 [DBG] Found [] API scopes in database
2019-04-17 20:51:52.581 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-17 20:51:52.612 +04:00 [DBG] Found [] API scopes in database
2019-04-17 20:51:52.627 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-04-17 20:51:52.630 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"4","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK8_hy6vjaiwuMbKKtY7m41QVabNHM09eI_6d6PuDAnaDU9bjnfHIWdW0bGD3OBOZy3LCoNhPspiygT8G2uXBcsExtfJ8Zfdw8oM1Ppc3xEoYoY-uae2svNTm9621t1onWjTTrjIraDdWGIdrYryn6fgIRE1e5hU65Gs5BLzyJIo4KTz-MCrWGoAtofjX6ktlmKZgi7jZgfzpXzIKoCLUPKyKGbuiugFpzlSREb-laYE-nO20mWse2ST1xqRcGdFqSCK5LD1gNHXqnzJu8OWHPZXBllgAYLZSIoNNFRYwAJLd3G7uoOojVZWm4RKjyN7GTDQQxLksr-QSMa2Y28jO4NWM","UiLocales":null,"Nonce":"636911167123284569.YWQyZGE4N2EtZWQ1NC00NzEzLWI0YjEtNDlhNjJmMDFjMDEyNjc4OTUwNzItN2ZjNi00MTUwLWEwMzctZDVjMWZhYzY4OTg3","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"1bf485c37014c536c06f1d0ffead7d4e","Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636911167123284569.YWQyZGE4N2EtZWQ1NC00NzEzLWI0YjEtNDlhNjJmMDFjMDEyNjc4OTUwNzItN2ZjNi00MTUwLWEwMzctZDVjMWZhYzY4OTg3","state":"CfDJ8D73mgAamspIvsbnstRoK8_hy6vjaiwuMbKKtY7m41QVabNHM09eI_6d6PuDAnaDU9bjnfHIWdW0bGD3OBOZy3LCoNhPspiygT8G2uXBcsExtfJ8Zfdw8oM1Ppc3xEoYoY-uae2svNTm9621t1onWjTTrjIraDdWGIdrYryn6fgIRE1e5hU65Gs5BLzyJIo4KTz-MCrWGoAtofjX6ktlmKZgi7jZgfzpXzIKoCLUPKyKGbuiugFpzlSREb-laYE-nO20mWse2ST1xqRcGdFqSCK5LD1gNHXqnzJu8OWHPZXBllgAYLZSIoNNFRYwAJLd3G7uoOojVZWm4RKjyN7GTDQQxLksr-QSMa2Y28jO4NWM","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-04-17 20:51:52.843 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-04-17 20:51:52.873 +04:00 [DBG] Creating Hybrid Flow response.
2019-04-17 20:51:53.042 +04:00 [DBG] 9rbrO8EdulGX+vQId/2Y3dfMJHeX8+5ukfI+p4Wug/0= not found in database
2019-04-17 20:51:53.260 +04:00 [DBG] Creating Implicit Flow response.
2019-04-17 20:51:53.325 +04:00 [DBG] Getting claims for identity token for subject: 4 and client: StudLab
2019-04-17 20:51:53.412 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-04-17 20:51:54.225 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"4","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****MM0Q","$type":"Token"},{"TokenType":"code","TokenValue":"****4404","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLM3AIO5ME1V:0000000A","TimeStamp":"2019-04-17T16:51:54.0000000Z","ProcessId":2128,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-04-17 20:51:54.250 +04:00 [INF] Authorize endpoint response
{"SubjectId":"4","ClientId":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8D73mgAamspIvsbnstRoK8_hy6vjaiwuMbKKtY7m41QVabNHM09eI_6d6PuDAnaDU9bjnfHIWdW0bGD3OBOZy3LCoNhPspiygT8G2uXBcsExtfJ8Zfdw8oM1Ppc3xEoYoY-uae2svNTm9621t1onWjTTrjIraDdWGIdrYryn6fgIRE1e5hU65Gs5BLzyJIo4KTz-MCrWGoAtofjX6ktlmKZgi7jZgfzpXzIKoCLUPKyKGbuiugFpzlSREb-laYE-nO20mWse2ST1xqRcGdFqSCK5LD1gNHXqnzJu8OWHPZXBllgAYLZSIoNNFRYwAJLd3G7uoOojVZWm4RKjyN7GTDQQxLksr-QSMa2Y28jO4NWM","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-04-17 20:51:54.349 +04:00 [DBG] Augmenting SignInContext
2019-04-17 20:51:54.357 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-04-17 20:54:52.364 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-04-17 20:54:52.562 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-04-17 20:54:52.564 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-04-17 20:54:52.565 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-04-17 20:54:52.566 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-04-17 20:54:52.567 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-04-17 20:54:52.567 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-04-17 20:54:53.467 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-04-17 20:54:53.515 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-04-17 20:54:53.521 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-04-17 20:54:53.802 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-17 20:54:54.101 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-17 20:54:54.159 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-17 20:54:54.187 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-17 20:54:54.231 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-17 20:54:54.268 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-17 20:54:54.417 +04:00 [DBG] Starting grant removal
2019-04-17 20:55:21.246 +04:00 [DBG] Login Url: /Account/Login
2019-04-17 20:55:21.263 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-04-17 20:55:21.265 +04:00 [DBG] Logout Url: /Account/Logout
2019-04-17 20:55:21.266 +04:00 [DBG] ConsentUrl Url: /consent
2019-04-17 20:55:21.268 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-04-17 20:55:21.270 +04:00 [DBG] Error Url: /home/error
2019-04-17 20:55:21.279 +04:00 [DBG] Error Id Parameter: errorId
2019-04-17 20:55:21.435 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-04-17 20:55:21.492 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-04-17 20:55:21.502 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-04-17 20:55:21.520 +04:00 [DBG] Start discovery request
2019-04-17 20:55:23.527 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-04-17 20:55:24.147 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-04-17 20:55:24.184 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-04-17 20:55:24.191 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-04-17 20:55:24.211 +04:00 [DBG] Start key discovery request
2019-04-17 20:55:24.682 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-04-17 20:55:24.752 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-04-17 20:55:24.761 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-04-17 20:55:24.792 +04:00 [DBG] Start authorize request
2019-04-17 20:55:24.836 +04:00 [DBG] User in authorize request: 4
2019-04-17 20:55:24.868 +04:00 [DBG] Start authorize request protocol validation
2019-04-17 20:55:26.298 +04:00 [DBG] StudLab found in database: true
2019-04-17 20:55:26.329 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-17 20:55:26.364 +04:00 [DBG] Checking for PKCE parameters
2019-04-17 20:55:26.369 +04:00 [DBG] No PKCE used.
2019-04-17 20:55:26.580 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-17 20:55:26.776 +04:00 [DBG] Found [] API scopes in database
2019-04-17 20:55:26.808 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-17 20:55:26.816 +04:00 [DBG] Found [] API scopes in database
2019-04-17 20:55:26.846 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-04-17 20:55:26.932 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"4","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK8-vBQ7ZSDqAwodq-2S8WiZp_zLWJItUorTmeX5QpBTqepmKHRf6NK5Yxjpm3HPybMaEwjfBpqdXYJeg6RofhqNAEnEU1-7LVfPO9kM4Fxsh6ni3chNmGwOVwCDzYtgW7IuE3BJOvmQW4CE4_cIoESPWx-uFeksZkRFCt7HJatYytuF4df1TbH3gxdhefJu7YxLROuSYETkvILPuBDzSnS3m9Cu-mj-lYhj0Nm3lkuf0exvJnhop_4zjEtKeeF87dl_OmXievVi6gyXayzbCKO5lG1_OzRNtBkyUyg2SQzAOE2zx5TLXRlRcEmk7iQLG0HweoeWgTVEXGvw1zSW3jmla","UiLocales":null,"Nonce":"636911169244470277.ZjhiYTEwNzktMGEwNy00Nzk5LWE1YjAtNmNhMTNhMTMzODcyMDliYTVmMGMtNmE2Zi00Yzk2LThjNzctYTYwOTJiNTUxMzg1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"1bf485c37014c536c06f1d0ffead7d4e","Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636911169244470277.ZjhiYTEwNzktMGEwNy00Nzk5LWE1YjAtNmNhMTNhMTMzODcyMDliYTVmMGMtNmE2Zi00Yzk2LThjNzctYTYwOTJiNTUxMzg1","state":"CfDJ8D73mgAamspIvsbnstRoK8-vBQ7ZSDqAwodq-2S8WiZp_zLWJItUorTmeX5QpBTqepmKHRf6NK5Yxjpm3HPybMaEwjfBpqdXYJeg6RofhqNAEnEU1-7LVfPO9kM4Fxsh6ni3chNmGwOVwCDzYtgW7IuE3BJOvmQW4CE4_cIoESPWx-uFeksZkRFCt7HJatYytuF4df1TbH3gxdhefJu7YxLROuSYETkvILPuBDzSnS3m9Cu-mj-lYhj0Nm3lkuf0exvJnhop_4zjEtKeeF87dl_OmXievVi6gyXayzbCKO5lG1_OzRNtBkyUyg2SQzAOE2zx5TLXRlRcEmk7iQLG0HweoeWgTVEXGvw1zSW3jmla","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-04-17 20:55:27.185 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-04-17 20:55:27.249 +04:00 [DBG] Creating Hybrid Flow response.
2019-04-17 20:55:27.436 +04:00 [DBG] S0BaesjtmSU4jxFsz/3BH9cFfBteliQyXpNl9w5c5Xs= not found in database
2019-04-17 20:55:27.749 +04:00 [DBG] Creating Implicit Flow response.
2019-04-17 20:55:27.792 +04:00 [DBG] Getting claims for identity token for subject: 4 and client: StudLab
2019-04-17 20:55:28.361 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-04-17 20:55:28.809 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"4","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****Trng","$type":"Token"},{"TokenType":"code","TokenValue":"****abff","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLM3ALSV7A3K:00000001","TimeStamp":"2019-04-17T16:55:28.0000000Z","ProcessId":6008,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-04-17 20:55:28.862 +04:00 [INF] Authorize endpoint response
{"SubjectId":"4","ClientId":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8D73mgAamspIvsbnstRoK8-vBQ7ZSDqAwodq-2S8WiZp_zLWJItUorTmeX5QpBTqepmKHRf6NK5Yxjpm3HPybMaEwjfBpqdXYJeg6RofhqNAEnEU1-7LVfPO9kM4Fxsh6ni3chNmGwOVwCDzYtgW7IuE3BJOvmQW4CE4_cIoESPWx-uFeksZkRFCt7HJatYytuF4df1TbH3gxdhefJu7YxLROuSYETkvILPuBDzSnS3m9Cu-mj-lYhj0Nm3lkuf0exvJnhop_4zjEtKeeF87dl_OmXievVi6gyXayzbCKO5lG1_OzRNtBkyUyg2SQzAOE2zx5TLXRlRcEmk7iQLG0HweoeWgTVEXGvw1zSW3jmla","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-04-17 20:55:31.186 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-04-17 20:55:31.291 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-04-17 20:55:31.352 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-04-17 20:55:31.517 +04:00 [DBG] Start token request.
2019-04-17 20:55:31.550 +04:00 [DBG] Start client validation
2019-04-17 20:55:31.650 +04:00 [DBG] Start parsing Basic Authentication secret
2019-04-17 20:55:31.756 +04:00 [DBG] Start parsing for secret in post body
2019-04-17 20:55:31.897 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-04-17 20:55:31.898 +04:00 [DBG] Secret id found: StudLab
2019-04-17 20:55:31.916 +04:00 [DBG] StudLab found in database: true
2019-04-17 20:55:31.918 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-17 20:55:31.967 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-04-17 20:55:31.968 +04:00 [DBG] Client validation success
2019-04-17 20:55:31.985 +04:00 [INF] {"ClientId":"StudLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLM3ALSV7A3J:00000003","TimeStamp":"2019-04-17T16:55:31.0000000Z","ProcessId":6008,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-04-17 20:55:32.130 +04:00 [DBG] Start token request validation
2019-04-17 20:55:32.177 +04:00 [DBG] Start validation of authorization code token request
2019-04-17 20:55:32.262 +04:00 [DBG] S0BaesjtmSU4jxFsz/3BH9cFfBteliQyXpNl9w5c5Xs= found in database: true
2019-04-17 20:55:32.387 +04:00 [DBG] removing S0BaesjtmSU4jxFsz/3BH9cFfBteliQyXpNl9w5c5Xs= persisted grant from database
2019-04-17 20:55:32.530 +04:00 [DBG] Validation of authorization code token request success
2019-04-17 20:55:32.563 +04:00 [INF] Token request validation success
{"ClientId":"StudLab","ClientName":"StudLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"93d5a57c03114b597dd5bb58a20943cfd93551cef5d902e256ee6bf6ce82abff","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"StudLab","client_secret":"***REDACTED***","code":"93d5a57c03114b597dd5bb58a20943cfd93551cef5d902e256ee6bf6ce82abff","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-04-17 20:55:32.782 +04:00 [DBG] StudLab found in database: true
2019-04-17 20:55:32.788 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-17 20:55:32.871 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-17 20:55:32.951 +04:00 [DBG] Found [] API scopes in database
2019-04-17 20:55:33.001 +04:00 [DBG] Getting claims for access token for client: StudLab
2019-04-17 20:55:33.002 +04:00 [DBG] Getting claims for access token for subject: 4
2019-04-17 20:55:33.181 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-04-17 20:55:33.275 +04:00 [DBG] Creating refresh token
2019-04-17 20:55:33.276 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-04-17 20:55:33.336 +04:00 [DBG] lMRrqCUYRLucwo5Rozf7DZMce6rYqdT1FUxO7f5mMPk= not found in database
2019-04-17 20:55:33.362 +04:00 [DBG] StudLab found in database: true
2019-04-17 20:55:33.363 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-17 20:55:33.396 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-17 20:55:33.436 +04:00 [DBG] Found [] API scopes in database
2019-04-17 20:55:33.451 +04:00 [DBG] Getting claims for identity token for subject: 4 and client: StudLab
2019-04-17 20:55:33.519 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-04-17 20:55:33.579 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****Q53g","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****7e1f","$type":"Token"},{"TokenType":"access_token","TokenValue":"****MHvg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLM3ALSV7A3J:00000003","TimeStamp":"2019-04-17T16:55:33.0000000Z","ProcessId":6008,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-04-17 20:55:33.627 +04:00 [DBG] Token request success.
2019-04-17 20:55:33.736 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-04-17 20:55:33.751 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-04-17 20:55:33.762 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-04-17 20:55:33.828 +04:00 [DBG] Start userinfo request
2019-04-17 20:55:33.867 +04:00 [DBG] Bearer token found in header
2019-04-17 20:55:34.247 +04:00 [DBG] StudLab found in database: true
2019-04-17 20:55:34.250 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-17 20:55:34.353 +04:00 [DBG] StudLab found in database: true
2019-04-17 20:55:34.358 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-17 20:55:34.438 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-04-17 20:55:34.447 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1555520133,"exp":1555523733,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"StudLab","sub":"4","auth_time":1555519891,"idp":"local","AspNet.Identity.SecurityStamp":"SMEWCFOPKGR2ER6A74KB2DZBDEUNFFQJ","role":"GodAdmin","preferred_username":"dereguzov1@yandex.ru","name":"dereguzov1@yandex.ru","email":"dereguzov1@yandex.ru","email_verified":false,"given_name":"dereguzov1@yandex.ru","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-04-17 20:55:34.577 +04:00 [DBG] Creating userinfo response
2019-04-17 20:55:34.621 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-04-17 20:55:34.681 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-04-17 20:55:34.732 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-17 20:55:34.739 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-04-17 20:55:34.743 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-04-17 20:55:34.779 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-17 20:55:34.839 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email
2019-04-17 20:55:34.907 +04:00 [DBG] End userinfo request
2019-04-18 19:27:58.067 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-04-18 19:27:58.262 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-04-18 19:27:58.264 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-04-18 19:27:58.265 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-04-18 19:27:58.266 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-04-18 19:27:58.266 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-04-18 19:27:58.267 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-04-18 19:27:59.164 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-04-18 19:27:59.208 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-04-18 19:27:59.268 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-04-18 19:27:59.568 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-18 19:27:59.828 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-18 19:27:59.939 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-18 19:27:59.989 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-18 19:28:00.040 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-18 19:28:00.066 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-18 19:28:00.247 +04:00 [DBG] Starting grant removal
2019-04-18 19:28:20.910 +04:00 [DBG] Login Url: /Account/Login
2019-04-18 19:28:20.942 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-04-18 19:28:20.948 +04:00 [DBG] Logout Url: /Account/Logout
2019-04-18 19:28:20.955 +04:00 [DBG] ConsentUrl Url: /consent
2019-04-18 19:28:20.959 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-04-18 19:28:20.963 +04:00 [DBG] Error Url: /home/error
2019-04-18 19:28:20.967 +04:00 [DBG] Error Id Parameter: errorId
2019-04-18 19:28:21.073 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-04-18 19:28:21.100 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-04-18 19:28:21.146 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-04-18 19:28:21.171 +04:00 [DBG] Start discovery request
2019-04-18 19:28:23.589 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-04-18 19:28:24.129 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-04-18 19:28:24.150 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-04-18 19:28:24.156 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-04-18 19:28:24.167 +04:00 [DBG] Start key discovery request
2019-04-18 19:28:27.220 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-04-18 19:28:27.245 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-04-18 19:28:27.257 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-04-18 19:28:27.275 +04:00 [DBG] Start authorize request
2019-04-18 19:28:27.315 +04:00 [DBG] User in authorize request: 4
2019-04-18 19:28:27.333 +04:00 [DBG] Start authorize request protocol validation
2019-04-18 19:28:28.643 +04:00 [DBG] StudLab found in database: true
2019-04-18 19:28:28.665 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-18 19:28:28.687 +04:00 [DBG] Checking for PKCE parameters
2019-04-18 19:28:28.695 +04:00 [DBG] No PKCE used.
2019-04-18 19:28:28.869 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-18 19:28:29.047 +04:00 [DBG] Found [] API scopes in database
2019-04-18 19:28:29.123 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-18 19:28:29.148 +04:00 [DBG] Found [] API scopes in database
2019-04-18 19:28:29.181 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-04-18 19:28:29.237 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"4","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK88RFAlPVpDVAeMpcfwI3oV27C6ItoQh5PyPVn6fFQY6zA6QoqFOe2V1_4WJvwBZtde12FFkuLRVbljpnqoNQHipdlrHZIekPL_t45Dm7l18WZwtlVh4duXmLg7uw159jOlVyjPDM8aCdnaYW0OXXCOqGw4_W69MRFU4EPU_xkhQtgxG3ijMNPUSlNcfRNtnbvgecPfYzVaj-81zpu7PH-_fNDXJrR4cQiAfK0dykv8VydxI-ctGvSaV1QbStIy7ekMOMglra9t0nSlA5NB7Mv0SDPVXavRXm2WJozllFyeLq0uUjpkeaTJme_Sq7X5FcXA","UiLocales":null,"Nonce":"636911981062515590.MjMzOTc2OWYtODFhNi00MTJjLThiODAtMDk1ZWFiYWQxOWNmMDRkM2RmNDMtYzUwNi00OWVjLTlkNTgtMGRjNzNiM2ZhY2Jk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"1bf485c37014c536c06f1d0ffead7d4e","Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636911981062515590.MjMzOTc2OWYtODFhNi00MTJjLThiODAtMDk1ZWFiYWQxOWNmMDRkM2RmNDMtYzUwNi00OWVjLTlkNTgtMGRjNzNiM2ZhY2Jk","state":"CfDJ8D73mgAamspIvsbnstRoK88RFAlPVpDVAeMpcfwI3oV27C6ItoQh5PyPVn6fFQY6zA6QoqFOe2V1_4WJvwBZtde12FFkuLRVbljpnqoNQHipdlrHZIekPL_t45Dm7l18WZwtlVh4duXmLg7uw159jOlVyjPDM8aCdnaYW0OXXCOqGw4_W69MRFU4EPU_xkhQtgxG3ijMNPUSlNcfRNtnbvgecPfYzVaj-81zpu7PH-_fNDXJrR4cQiAfK0dykv8VydxI-ctGvSaV1QbStIy7ekMOMglra9t0nSlA5NB7Mv0SDPVXavRXm2WJozllFyeLq0uUjpkeaTJme_Sq7X5FcXA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-04-18 19:28:29.345 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-04-18 19:28:29.363 +04:00 [DBG] Creating Hybrid Flow response.
2019-04-18 19:28:29.531 +04:00 [DBG] Gojy/eDC1d1Pit4UHlWV/8mEZ0k8FczP5Eauxh/nI0Y= not found in database
2019-04-18 19:28:29.727 +04:00 [DBG] Creating Implicit Flow response.
2019-04-18 19:28:29.757 +04:00 [DBG] Getting claims for identity token for subject: 4 and client: StudLab
2019-04-18 19:28:29.894 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-04-18 19:28:30.383 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"4","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****zEvQ","$type":"Token"},{"TokenType":"code","TokenValue":"****e380","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLM429UED7KS:00000001","TimeStamp":"2019-04-18T15:28:30.0000000Z","ProcessId":18332,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-04-18 19:28:30.520 +04:00 [INF] Authorize endpoint response
{"SubjectId":"4","ClientId":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8D73mgAamspIvsbnstRoK88RFAlPVpDVAeMpcfwI3oV27C6ItoQh5PyPVn6fFQY6zA6QoqFOe2V1_4WJvwBZtde12FFkuLRVbljpnqoNQHipdlrHZIekPL_t45Dm7l18WZwtlVh4duXmLg7uw159jOlVyjPDM8aCdnaYW0OXXCOqGw4_W69MRFU4EPU_xkhQtgxG3ijMNPUSlNcfRNtnbvgecPfYzVaj-81zpu7PH-_fNDXJrR4cQiAfK0dykv8VydxI-ctGvSaV1QbStIy7ekMOMglra9t0nSlA5NB7Mv0SDPVXavRXm2WJozllFyeLq0uUjpkeaTJme_Sq7X5FcXA","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-04-18 19:28:31.766 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-04-18 19:28:31.860 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-04-18 19:28:31.956 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-04-18 19:28:32.128 +04:00 [DBG] Start token request.
2019-04-18 19:28:32.164 +04:00 [DBG] Start client validation
2019-04-18 19:28:32.196 +04:00 [DBG] Start parsing Basic Authentication secret
2019-04-18 19:28:32.210 +04:00 [DBG] Start parsing for secret in post body
2019-04-18 19:28:32.280 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-04-18 19:28:32.282 +04:00 [DBG] Secret id found: StudLab
2019-04-18 19:28:32.404 +04:00 [DBG] StudLab found in database: true
2019-04-18 19:28:32.405 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-18 19:28:32.439 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-04-18 19:28:32.440 +04:00 [DBG] Client validation success
2019-04-18 19:28:32.445 +04:00 [INF] {"ClientId":"StudLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLM429UED7KR:00000003","TimeStamp":"2019-04-18T15:28:32.0000000Z","ProcessId":18332,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-04-18 19:28:32.475 +04:00 [DBG] Start token request validation
2019-04-18 19:28:32.559 +04:00 [DBG] Start validation of authorization code token request
2019-04-18 19:28:32.676 +04:00 [DBG] Gojy/eDC1d1Pit4UHlWV/8mEZ0k8FczP5Eauxh/nI0Y= found in database: true
2019-04-18 19:28:32.746 +04:00 [DBG] removing Gojy/eDC1d1Pit4UHlWV/8mEZ0k8FczP5Eauxh/nI0Y= persisted grant from database
2019-04-18 19:28:32.791 +04:00 [DBG] Validation of authorization code token request success
2019-04-18 19:28:32.814 +04:00 [INF] Token request validation success
{"ClientId":"StudLab","ClientName":"StudLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"59947c3fce3a9db4946c1a381aa5958b0430e8653053449ec22948c755e2e380","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"StudLab","client_secret":"***REDACTED***","code":"59947c3fce3a9db4946c1a381aa5958b0430e8653053449ec22948c755e2e380","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-04-18 19:28:33.143 +04:00 [DBG] StudLab found in database: true
2019-04-18 19:28:33.145 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-18 19:28:33.176 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-18 19:28:33.206 +04:00 [DBG] Found [] API scopes in database
2019-04-18 19:28:33.244 +04:00 [DBG] Getting claims for access token for client: StudLab
2019-04-18 19:28:33.248 +04:00 [DBG] Getting claims for access token for subject: 4
2019-04-18 19:28:33.309 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-04-18 19:28:33.347 +04:00 [DBG] Creating refresh token
2019-04-18 19:28:33.354 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-04-18 19:28:33.410 +04:00 [DBG] nUCsdy6RnyLnRuFZA3aFO6lEB/t4uaJGTQ8fwV0pyLE= not found in database
2019-04-18 19:28:33.514 +04:00 [DBG] StudLab found in database: true
2019-04-18 19:28:33.515 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-18 19:28:33.558 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-18 19:28:33.590 +04:00 [DBG] Found [] API scopes in database
2019-04-18 19:28:33.595 +04:00 [DBG] Getting claims for identity token for subject: 4 and client: StudLab
2019-04-18 19:28:33.676 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-04-18 19:28:33.699 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****m7CA","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****c46f","$type":"Token"},{"TokenType":"access_token","TokenValue":"****e6Ng","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLM429UED7KR:00000003","TimeStamp":"2019-04-18T15:28:33.0000000Z","ProcessId":18332,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-04-18 19:28:33.724 +04:00 [DBG] Token request success.
2019-04-18 19:28:33.770 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-04-18 19:28:33.782 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-04-18 19:28:33.797 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-04-18 19:28:33.828 +04:00 [DBG] Start userinfo request
2019-04-18 19:28:33.844 +04:00 [DBG] Bearer token found in header
2019-04-18 19:28:34.204 +04:00 [DBG] StudLab found in database: true
2019-04-18 19:28:34.205 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-18 19:28:34.242 +04:00 [DBG] StudLab found in database: true
2019-04-18 19:28:34.243 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-18 19:28:34.274 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-04-18 19:28:34.289 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1555601313,"exp":1555604913,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"StudLab","sub":"4","auth_time":1555519891,"idp":"local","AspNet.Identity.SecurityStamp":"SMEWCFOPKGR2ER6A74KB2DZBDEUNFFQJ","role":"GodAdmin","preferred_username":"dereguzov1@yandex.ru","name":"dereguzov1@yandex.ru","email":"dereguzov1@yandex.ru","email_verified":false,"given_name":"dereguzov1@yandex.ru","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-04-18 19:28:34.339 +04:00 [DBG] Creating userinfo response
2019-04-18 19:28:34.358 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-04-18 19:28:34.375 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-04-18 19:28:34.422 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-18 19:28:34.428 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-04-18 19:28:34.431 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-04-18 19:28:34.439 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-18 19:28:34.487 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email
2019-04-18 19:28:34.493 +04:00 [DBG] End userinfo request
2019-04-18 19:32:20.647 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-04-18 19:32:20.811 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-04-18 19:32:20.813 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-04-18 19:32:20.814 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-04-18 19:32:20.814 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-04-18 19:32:20.815 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-04-18 19:32:20.815 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-04-18 19:32:21.730 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-04-18 19:32:21.778 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-04-18 19:32:21.785 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-04-18 19:32:22.102 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-18 19:32:22.354 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-18 19:32:22.401 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-18 19:32:22.429 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-18 19:32:22.458 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-18 19:32:22.480 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-18 19:32:22.953 +04:00 [DBG] Starting grant removal
2019-04-18 19:33:03.757 +04:00 [DBG] Login Url: /Account/Login
2019-04-18 19:33:03.768 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-04-18 19:33:03.783 +04:00 [DBG] Logout Url: /Account/Logout
2019-04-18 19:33:03.785 +04:00 [DBG] ConsentUrl Url: /consent
2019-04-18 19:33:03.787 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-04-18 19:33:03.799 +04:00 [DBG] Error Url: /home/error
2019-04-18 19:33:03.801 +04:00 [DBG] Error Id Parameter: errorId
2019-04-18 19:33:03.949 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-04-18 19:33:04.005 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-04-18 19:33:04.011 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-04-18 19:33:04.034 +04:00 [DBG] Start discovery request
2019-04-18 19:33:07.381 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-04-18 19:33:08.614 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-04-18 19:33:08.845 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-04-18 19:33:08.887 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-04-18 19:33:08.906 +04:00 [DBG] Start key discovery request
2019-04-18 19:33:09.408 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-04-18 19:33:09.439 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-04-18 19:33:09.447 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-04-18 19:33:09.471 +04:00 [DBG] Start authorize request
2019-04-18 19:33:09.530 +04:00 [DBG] User in authorize request: 4
2019-04-18 19:33:09.562 +04:00 [DBG] Start authorize request protocol validation
2019-04-18 19:33:11.236 +04:00 [DBG] StudLab found in database: true
2019-04-18 19:33:11.262 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-18 19:33:11.284 +04:00 [DBG] Checking for PKCE parameters
2019-04-18 19:33:11.296 +04:00 [DBG] No PKCE used.
2019-04-18 19:33:11.517 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-18 19:33:11.683 +04:00 [DBG] Found [] API scopes in database
2019-04-18 19:33:11.736 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-18 19:33:11.762 +04:00 [DBG] Found [] API scopes in database
2019-04-18 19:33:11.793 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-04-18 19:33:11.875 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"4","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK8-GqHwSFDWeQ2-7x7T4Mujitwqi75TlCKqZc1X3UbHnTo1FlmjwVPFqHVy0f2GdSgN2F7lQ493_Q4PHYiXqkpRyw8ZyUHjJFS2G_0h62Lmy-MXCHDZtzieqIdM4RQHUjTJzvHLBeRGlOxNnlIA2zEoiVl2fDTopuRVINfQZ6LXCu-SwPe_wFrywGT4nwXYUE-F7y_81HnJhFfQlvMao_17H8glJ8J_wc3Z5kAMU0VKkJZnvmtnPqejvQOFERsr51MBc6JL30g2IT36XjzfO8bXNtU9fIjk55Yj0dBdE9d8VqSspXXc67ewqZ7uaX2nCbvg","UiLocales":null,"Nonce":"636911983891337313.MjI1MTJkZjQtM2QyMy00MDA2LTllMzUtNzA2MDUyOGMwYzY0MjNiNDBhZmYtNTJiOS00YjEzLWFlNjYtYjkzYjU1YzFhYTU3","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"1bf485c37014c536c06f1d0ffead7d4e","Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636911983891337313.MjI1MTJkZjQtM2QyMy00MDA2LTllMzUtNzA2MDUyOGMwYzY0MjNiNDBhZmYtNTJiOS00YjEzLWFlNjYtYjkzYjU1YzFhYTU3","state":"CfDJ8D73mgAamspIvsbnstRoK8-GqHwSFDWeQ2-7x7T4Mujitwqi75TlCKqZc1X3UbHnTo1FlmjwVPFqHVy0f2GdSgN2F7lQ493_Q4PHYiXqkpRyw8ZyUHjJFS2G_0h62Lmy-MXCHDZtzieqIdM4RQHUjTJzvHLBeRGlOxNnlIA2zEoiVl2fDTopuRVINfQZ6LXCu-SwPe_wFrywGT4nwXYUE-F7y_81HnJhFfQlvMao_17H8glJ8J_wc3Z5kAMU0VKkJZnvmtnPqejvQOFERsr51MBc6JL30g2IT36XjzfO8bXNtU9fIjk55Yj0dBdE9d8VqSspXXc67ewqZ7uaX2nCbvg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-04-18 19:33:12.312 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-04-18 19:33:12.337 +04:00 [DBG] Creating Hybrid Flow response.
2019-04-18 19:33:12.488 +04:00 [DBG] R0PhiyZr3qzZ4VPKGMCFNcCRbmKMpZAhtnuHRPRPxcY= not found in database
2019-04-18 19:33:12.682 +04:00 [DBG] Creating Implicit Flow response.
2019-04-18 19:33:12.720 +04:00 [DBG] Getting claims for identity token for subject: 4 and client: StudLab
2019-04-18 19:33:13.255 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-04-18 19:33:13.813 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"4","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****CyWA","$type":"Token"},{"TokenType":"code","TokenValue":"****3274","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLM42CIM9VDI:00000001","TimeStamp":"2019-04-18T15:33:13.0000000Z","ProcessId":6864,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-04-18 19:33:13.843 +04:00 [INF] Authorize endpoint response
{"SubjectId":"4","ClientId":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8D73mgAamspIvsbnstRoK8-GqHwSFDWeQ2-7x7T4Mujitwqi75TlCKqZc1X3UbHnTo1FlmjwVPFqHVy0f2GdSgN2F7lQ493_Q4PHYiXqkpRyw8ZyUHjJFS2G_0h62Lmy-MXCHDZtzieqIdM4RQHUjTJzvHLBeRGlOxNnlIA2zEoiVl2fDTopuRVINfQZ6LXCu-SwPe_wFrywGT4nwXYUE-F7y_81HnJhFfQlvMao_17H8glJ8J_wc3Z5kAMU0VKkJZnvmtnPqejvQOFERsr51MBc6JL30g2IT36XjzfO8bXNtU9fIjk55Yj0dBdE9d8VqSspXXc67ewqZ7uaX2nCbvg","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-04-18 19:33:14.699 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-04-18 19:33:14.734 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-04-18 19:33:14.772 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-04-18 19:33:14.818 +04:00 [DBG] Start token request.
2019-04-18 19:33:14.876 +04:00 [DBG] Start client validation
2019-04-18 19:33:14.958 +04:00 [DBG] Start parsing Basic Authentication secret
2019-04-18 19:33:14.990 +04:00 [DBG] Start parsing for secret in post body
2019-04-18 19:33:15.076 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-04-18 19:33:15.077 +04:00 [DBG] Secret id found: StudLab
2019-04-18 19:33:15.157 +04:00 [DBG] StudLab found in database: true
2019-04-18 19:33:15.158 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-18 19:33:15.193 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-04-18 19:33:15.194 +04:00 [DBG] Client validation success
2019-04-18 19:33:15.199 +04:00 [INF] {"ClientId":"StudLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLM42CIM9VDH:00000003","TimeStamp":"2019-04-18T15:33:15.0000000Z","ProcessId":6864,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-04-18 19:33:15.237 +04:00 [DBG] Start token request validation
2019-04-18 19:33:15.310 +04:00 [DBG] Start validation of authorization code token request
2019-04-18 19:33:15.372 +04:00 [DBG] R0PhiyZr3qzZ4VPKGMCFNcCRbmKMpZAhtnuHRPRPxcY= found in database: true
2019-04-18 19:33:15.435 +04:00 [DBG] removing R0PhiyZr3qzZ4VPKGMCFNcCRbmKMpZAhtnuHRPRPxcY= persisted grant from database
2019-04-18 19:33:15.569 +04:00 [DBG] Validation of authorization code token request success
2019-04-18 19:33:15.594 +04:00 [INF] Token request validation success
{"ClientId":"StudLab","ClientName":"StudLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"8d1d0d63cc7a7f17fe7f71a7c9ef5e593a1132f96baf681b315860d754a03274","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"StudLab","client_secret":"***REDACTED***","code":"8d1d0d63cc7a7f17fe7f71a7c9ef5e593a1132f96baf681b315860d754a03274","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-04-18 19:33:15.779 +04:00 [DBG] StudLab found in database: true
2019-04-18 19:33:15.780 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-18 19:33:15.819 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-18 19:33:15.841 +04:00 [DBG] Found [] API scopes in database
2019-04-18 19:33:15.880 +04:00 [DBG] Getting claims for access token for client: StudLab
2019-04-18 19:33:15.885 +04:00 [DBG] Getting claims for access token for subject: 4
2019-04-18 19:33:15.977 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-04-18 19:33:16.019 +04:00 [DBG] Creating refresh token
2019-04-18 19:33:16.020 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-04-18 19:33:16.075 +04:00 [DBG] F3KDLMtjVdAoSFjJze1xd/D27NXlxLBinnre55M9cDw= not found in database
2019-04-18 19:33:16.183 +04:00 [DBG] StudLab found in database: true
2019-04-18 19:33:16.184 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-18 19:33:16.213 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-18 19:33:16.232 +04:00 [DBG] Found [] API scopes in database
2019-04-18 19:33:16.238 +04:00 [DBG] Getting claims for identity token for subject: 4 and client: StudLab
2019-04-18 19:33:16.267 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-04-18 19:33:16.291 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****6pMw","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****d317","$type":"Token"},{"TokenType":"access_token","TokenValue":"****rgjg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLM42CIM9VDH:00000003","TimeStamp":"2019-04-18T15:33:16.0000000Z","ProcessId":6864,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-04-18 19:33:16.316 +04:00 [DBG] Token request success.
2019-04-18 19:33:16.369 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-04-18 19:33:16.384 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-04-18 19:33:16.387 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-04-18 19:33:16.430 +04:00 [DBG] Start userinfo request
2019-04-18 19:33:16.446 +04:00 [DBG] Bearer token found in header
2019-04-18 19:33:16.807 +04:00 [DBG] StudLab found in database: true
2019-04-18 19:33:16.808 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-18 19:33:16.934 +04:00 [DBG] StudLab found in database: true
2019-04-18 19:33:16.936 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-18 19:33:16.970 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-04-18 19:33:16.986 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1555601595,"exp":1555605195,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"StudLab","sub":"4","auth_time":1555519891,"idp":"local","AspNet.Identity.SecurityStamp":"SMEWCFOPKGR2ER6A74KB2DZBDEUNFFQJ","role":"GodAdmin","preferred_username":"dereguzov1@yandex.ru","name":"dereguzov1@yandex.ru","email":"dereguzov1@yandex.ru","email_verified":false,"given_name":"dereguzov1@yandex.ru","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-04-18 19:33:17.033 +04:00 [DBG] Creating userinfo response
2019-04-18 19:33:17.053 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-04-18 19:33:17.063 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-04-18 19:33:17.110 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-18 19:33:17.118 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-04-18 19:33:17.126 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-04-18 19:33:17.158 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-18 19:33:17.209 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email
2019-04-18 19:33:17.214 +04:00 [DBG] End userinfo request
2019-04-19 15:37:54.193 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-04-19 15:37:54.393 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-04-19 15:37:54.394 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-04-19 15:37:54.395 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-04-19 15:37:54.396 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-04-19 15:37:54.397 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-04-19 15:37:54.398 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-04-19 15:37:55.132 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-04-19 15:37:55.167 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-04-19 15:37:55.172 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-04-19 15:37:55.416 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-19 15:37:55.619 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-19 15:37:55.655 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-19 15:37:55.678 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-19 15:37:55.703 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-19 15:37:55.721 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-19 15:37:55.891 +04:00 [DBG] Starting grant removal
2019-04-19 15:38:36.886 +04:00 [DBG] Login Url: /Account/Login
2019-04-19 15:38:36.897 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-04-19 15:38:36.903 +04:00 [DBG] Logout Url: /Account/Logout
2019-04-19 15:38:36.904 +04:00 [DBG] ConsentUrl Url: /consent
2019-04-19 15:38:36.907 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-04-19 15:38:36.913 +04:00 [DBG] Error Url: /home/error
2019-04-19 15:38:36.914 +04:00 [DBG] Error Id Parameter: errorId
2019-04-19 15:38:37.008 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-04-19 15:38:37.060 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-04-19 15:38:37.065 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-04-19 15:38:37.081 +04:00 [DBG] Start discovery request
2019-04-19 15:38:38.595 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-04-19 15:38:39.327 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-04-19 15:38:39.337 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-04-19 15:38:39.340 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-04-19 15:38:39.359 +04:00 [DBG] Start key discovery request
2019-04-19 15:38:40.163 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-04-19 15:38:40.179 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-04-19 15:38:40.181 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-04-19 15:38:40.198 +04:00 [DBG] Start authorize request
2019-04-19 15:38:40.244 +04:00 [DBG] User in authorize request: 4
2019-04-19 15:38:40.269 +04:00 [DBG] Start authorize request protocol validation
2019-04-19 15:38:41.305 +04:00 [DBG] StudLab found in database: true
2019-04-19 15:38:41.325 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-19 15:38:41.345 +04:00 [DBG] Checking for PKCE parameters
2019-04-19 15:38:41.354 +04:00 [DBG] No PKCE used.
2019-04-19 15:38:41.492 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-19 15:38:41.625 +04:00 [DBG] Found [] API scopes in database
2019-04-19 15:38:41.654 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-19 15:38:41.661 +04:00 [DBG] Found [] API scopes in database
2019-04-19 15:38:41.684 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-04-19 15:38:41.726 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"4","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK8_vIpks-y3JfPCTv2W_KqlhZyQ0pT3JRK_gE7E4FJgvcxAeASwpOPtx_fjjSnMzYtS9hce2dE3-GXr9F4IrbXqGFNU75CGPq7b2PXPt6uS5v0SNyOtWabCOyHsGbdzgLrq3_jY66JqEJ8NtRXPpho9QEhrG5QAhV1O80Gcq8xLZKswY01kRwveaby03EANwb4vcsV0nQqwtvyxfN8DrFDw3BTkHaO2i2xzaVaGBQGSZ3xV0AumAK94ihhenG1d5wTPy4LwChLdabEMaqLPUf3NFHn7pPwhINuHGzNaIkiQ1jenn6zgCR0GQlHdihIJlWjA","UiLocales":null,"Nonce":"636912707196225911.M2ZiZjQ4OTctYjgzNC00NWUyLTg1NjMtOTQ0OTEwYjMxY2Y0ZGU5NzM0ODktMjE2Ny00OTFkLTgwYTEtZDc1MzkwNDQwZDAx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"1bf485c37014c536c06f1d0ffead7d4e","Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636912707196225911.M2ZiZjQ4OTctYjgzNC00NWUyLTg1NjMtOTQ0OTEwYjMxY2Y0ZGU5NzM0ODktMjE2Ny00OTFkLTgwYTEtZDc1MzkwNDQwZDAx","state":"CfDJ8D73mgAamspIvsbnstRoK8_vIpks-y3JfPCTv2W_KqlhZyQ0pT3JRK_gE7E4FJgvcxAeASwpOPtx_fjjSnMzYtS9hce2dE3-GXr9F4IrbXqGFNU75CGPq7b2PXPt6uS5v0SNyOtWabCOyHsGbdzgLrq3_jY66JqEJ8NtRXPpho9QEhrG5QAhV1O80Gcq8xLZKswY01kRwveaby03EANwb4vcsV0nQqwtvyxfN8DrFDw3BTkHaO2i2xzaVaGBQGSZ3xV0AumAK94ihhenG1d5wTPy4LwChLdabEMaqLPUf3NFHn7pPwhINuHGzNaIkiQ1jenn6zgCR0GQlHdihIJlWjA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-04-19 15:38:41.881 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-04-19 15:38:41.901 +04:00 [DBG] Creating Hybrid Flow response.
2019-04-19 15:38:42.014 +04:00 [DBG] bhxupNstA+45aUzk457+eFGBJGqUZ8MHgoQrldAkhrk= not found in database
2019-04-19 15:38:42.172 +04:00 [DBG] Creating Implicit Flow response.
2019-04-19 15:38:42.199 +04:00 [DBG] Getting claims for identity token for subject: 4 and client: StudLab
2019-04-19 15:38:42.261 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-04-19 15:38:42.632 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"4","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****eFjQ","$type":"Token"},{"TokenType":"code","TokenValue":"****7f7c","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLM4NE7MJ3TD:00000001","TimeStamp":"2019-04-19T11:38:42.0000000Z","ProcessId":9976,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-04-19 15:38:42.665 +04:00 [INF] Authorize endpoint response
{"SubjectId":"4","ClientId":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8D73mgAamspIvsbnstRoK8_vIpks-y3JfPCTv2W_KqlhZyQ0pT3JRK_gE7E4FJgvcxAeASwpOPtx_fjjSnMzYtS9hce2dE3-GXr9F4IrbXqGFNU75CGPq7b2PXPt6uS5v0SNyOtWabCOyHsGbdzgLrq3_jY66JqEJ8NtRXPpho9QEhrG5QAhV1O80Gcq8xLZKswY01kRwveaby03EANwb4vcsV0nQqwtvyxfN8DrFDw3BTkHaO2i2xzaVaGBQGSZ3xV0AumAK94ihhenG1d5wTPy4LwChLdabEMaqLPUf3NFHn7pPwhINuHGzNaIkiQ1jenn6zgCR0GQlHdihIJlWjA","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-04-19 15:38:43.810 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-04-19 15:38:43.860 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-04-19 15:38:43.892 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-04-19 15:38:43.939 +04:00 [DBG] Start token request.
2019-04-19 15:38:43.965 +04:00 [DBG] Start client validation
2019-04-19 15:38:44.030 +04:00 [DBG] Start parsing Basic Authentication secret
2019-04-19 15:38:44.050 +04:00 [DBG] Start parsing for secret in post body
2019-04-19 15:38:44.172 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-04-19 15:38:44.189 +04:00 [DBG] Secret id found: StudLab
2019-04-19 15:38:44.281 +04:00 [DBG] StudLab found in database: true
2019-04-19 15:38:44.282 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-19 15:38:44.314 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-04-19 15:38:44.315 +04:00 [DBG] Client validation success
2019-04-19 15:38:44.320 +04:00 [INF] {"ClientId":"StudLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLM4NE7MJ3TC:00000003","TimeStamp":"2019-04-19T11:38:44.0000000Z","ProcessId":9976,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-04-19 15:38:44.351 +04:00 [DBG] Start token request validation
2019-04-19 15:38:44.389 +04:00 [DBG] Start validation of authorization code token request
2019-04-19 15:38:44.430 +04:00 [DBG] bhxupNstA+45aUzk457+eFGBJGqUZ8MHgoQrldAkhrk= found in database: true
2019-04-19 15:38:44.488 +04:00 [DBG] removing bhxupNstA+45aUzk457+eFGBJGqUZ8MHgoQrldAkhrk= persisted grant from database
2019-04-19 15:38:44.540 +04:00 [DBG] Validation of authorization code token request success
2019-04-19 15:38:44.558 +04:00 [INF] Token request validation success
{"ClientId":"StudLab","ClientName":"StudLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"61253ac526954dd0f995b516c22c28aad97f6af6a24b29f953c00404925f7f7c","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"StudLab","client_secret":"***REDACTED***","code":"61253ac526954dd0f995b516c22c28aad97f6af6a24b29f953c00404925f7f7c","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-04-19 15:38:44.662 +04:00 [DBG] StudLab found in database: true
2019-04-19 15:38:44.663 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-19 15:38:44.705 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-19 15:38:44.724 +04:00 [DBG] Found [] API scopes in database
2019-04-19 15:38:44.762 +04:00 [DBG] Getting claims for access token for client: StudLab
2019-04-19 15:38:44.763 +04:00 [DBG] Getting claims for access token for subject: 4
2019-04-19 15:38:44.792 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-04-19 15:38:44.839 +04:00 [DBG] Creating refresh token
2019-04-19 15:38:44.841 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-04-19 15:38:44.880 +04:00 [DBG] 2VnUZas6msTzwmvv8WQd/7Zl+RrSXex5ws6HmOWSx/s= not found in database
2019-04-19 15:38:44.909 +04:00 [DBG] StudLab found in database: true
2019-04-19 15:38:44.910 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-19 15:38:44.918 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-19 15:38:44.925 +04:00 [DBG] Found [] API scopes in database
2019-04-19 15:38:44.928 +04:00 [DBG] Getting claims for identity token for subject: 4 and client: StudLab
2019-04-19 15:38:44.944 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-04-19 15:38:44.967 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****KGOQ","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****e488","$type":"Token"},{"TokenType":"access_token","TokenValue":"****ed7w","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLM4NE7MJ3TC:00000003","TimeStamp":"2019-04-19T11:38:44.0000000Z","ProcessId":9976,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-04-19 15:38:44.992 +04:00 [DBG] Token request success.
2019-04-19 15:38:45.040 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-04-19 15:38:45.050 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-04-19 15:38:45.052 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-04-19 15:38:45.077 +04:00 [DBG] Start userinfo request
2019-04-19 15:38:45.091 +04:00 [DBG] Bearer token found in header
2019-04-19 15:38:45.263 +04:00 [DBG] StudLab found in database: true
2019-04-19 15:38:45.264 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-19 15:38:45.291 +04:00 [DBG] StudLab found in database: true
2019-04-19 15:38:45.293 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-19 15:38:45.321 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-04-19 15:38:45.333 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1555673924,"exp":1555677524,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"StudLab","sub":"4","auth_time":1555519891,"idp":"local","AspNet.Identity.SecurityStamp":"SMEWCFOPKGR2ER6A74KB2DZBDEUNFFQJ","role":"GodAdmin","preferred_username":"dereguzov1@yandex.ru","name":"dereguzov1@yandex.ru","email":"dereguzov1@yandex.ru","email_verified":false,"given_name":"dereguzov1@yandex.ru","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-04-19 15:38:45.377 +04:00 [DBG] Creating userinfo response
2019-04-19 15:38:45.391 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-04-19 15:38:45.404 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-04-19 15:38:45.423 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-19 15:38:45.429 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-04-19 15:38:45.434 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-04-19 15:38:45.461 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-19 15:38:45.517 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email
2019-04-19 15:38:45.522 +04:00 [DBG] End userinfo request
2019-04-19 15:42:48.263 +04:00 [DBG] TaskCanceledException. Exiting.
2019-04-19 15:42:48.691 +04:00 [DBG] Stopping grant removal
2019-04-20 19:46:48.746 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-04-20 19:46:48.979 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-04-20 19:46:48.981 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-04-20 19:46:48.982 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-04-20 19:46:48.983 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-04-20 19:46:48.984 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-04-20 19:46:48.984 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-04-20 19:46:49.678 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-04-20 19:46:49.715 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-04-20 19:46:49.720 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-04-20 19:46:49.929 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-20 19:46:50.134 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-20 19:46:50.174 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-20 19:46:50.192 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-20 19:46:50.216 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-20 19:46:50.234 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-20 19:46:50.381 +04:00 [DBG] Starting grant removal
2019-04-20 19:48:24.068 +04:00 [DBG] Login Url: /Account/Login
2019-04-20 19:48:24.076 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-04-20 19:48:24.092 +04:00 [DBG] Logout Url: /Account/Logout
2019-04-20 19:48:24.093 +04:00 [DBG] ConsentUrl Url: /consent
2019-04-20 19:48:24.095 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-04-20 19:48:24.096 +04:00 [DBG] Error Url: /home/error
2019-04-20 19:48:24.098 +04:00 [DBG] Error Id Parameter: errorId
2019-04-20 19:48:24.206 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-04-20 19:48:24.250 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-04-20 19:48:24.255 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-04-20 19:48:24.268 +04:00 [DBG] Start discovery request
2019-04-20 19:48:25.928 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-04-20 19:48:26.761 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-04-20 19:48:26.813 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-04-20 19:48:26.841 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-04-20 19:48:26.873 +04:00 [DBG] Start key discovery request
2019-04-20 19:48:27.417 +04:00 [DBG] CORS request made for path: /connect/authorize from origin: https://localhost:5002 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-04-20 19:48:27.423 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-04-20 19:48:27.446 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-04-20 19:48:27.469 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-04-20 19:48:27.487 +04:00 [DBG] Start authorize request
2019-04-20 19:48:48.674 +04:00 [DBG] CORS request made for path: /connect/authorize from origin: https://localhost:5002 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-04-20 19:48:48.684 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-04-20 19:48:48.690 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-04-20 19:48:48.699 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-04-20 19:48:48.720 +04:00 [DBG] Start authorize request
2019-04-20 19:49:17.748 +04:00 [WRN] Failed to determine the https port for redirect.
2019-04-20 19:49:18.740 +04:00 [ERR] The view 'Index' was not found. Searched locations: ["/Views/Home/Index.cshtml","/Views/Shared/Index.cshtml","/Pages/Shared/Index.cshtml"]
2019-04-20 19:49:19.918 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The view 'Index' was not found. The following locations were searched:
/Views/Home/Index.cshtml
/Views/Shared/Index.cshtml
/Pages/Shared/Index.cshtml
   at Microsoft.AspNetCore.Mvc.ViewEngines.ViewEngineResult.EnsureSuccessful(IEnumerable`1 originalLocations)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-04-20 19:49:50.835 +04:00 [WRN] Invalid password for user 4.
2019-04-20 19:49:50.837 +04:00 [WRN] User 4 failed to provide the correct password.
2019-04-20 19:49:50.899 +04:00 [INF] {"Username":"dereguzov1@yandex.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLM5KUFEDQC4:00000001","TimeStamp":"2019-04-20T15:49:50.0000000Z","ProcessId":3924,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-04-20 19:49:56.095 +04:00 [WRN] Invalid password for user 4.
2019-04-20 19:49:56.098 +04:00 [WRN] User 4 failed to provide the correct password.
2019-04-20 19:49:56.104 +04:00 [INF] {"Username":"dereguzov1@yandex.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLM5KUFEDQC4:00000002","TimeStamp":"2019-04-20T15:49:56.0000000Z","ProcessId":3924,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-04-20 19:50:01.351 +04:00 [DBG] Augmenting SignInContext
2019-04-20 19:50:01.360 +04:00 [DBG] Adding idp claim with value: local
2019-04-20 19:50:01.362 +04:00 [DBG] Adding amr claim with value: pwd
2019-04-20 19:50:01.367 +04:00 [DBG] Adding auth_time claim with value: 1555775401
2019-04-20 19:50:01.413 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-04-20 19:50:01.433 +04:00 [INF] {"Username":"dereguzov1@yandex.ru","Provider":null,"ProviderUserId":null,"SubjectId":"4","DisplayName":"dereguzov1@yandex.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLM5KUFEDQC5:00000001","TimeStamp":"2019-04-20T15:50:01.0000000Z","ProcessId":3924,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-04-20 19:50:05.278 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentException: Value cannot be null or empty.
Parameter name: url
   at Microsoft.AspNetCore.Mvc.ControllerBase.Redirect(String url)
   at AuthServiceServer.Controllers.AccountController.Login(LoginModel model) in D:\Projects\AuthService\AuthService\AuthServiceServer\Controllers\AccountController.cs:line 54
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-04-20 19:50:18.981 +04:00 [DBG] CORS request made for path: /connect/authorize from origin: https://localhost:5002 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-04-20 19:50:18.986 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-04-20 19:50:18.989 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-04-20 19:50:18.993 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-04-20 19:50:18.998 +04:00 [DBG] Start authorize request
2019-04-20 19:51:20.209 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-04-20 19:51:20.278 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-04-20 19:51:20.293 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-04-20 19:51:20.457 +04:00 [DBG] Start discovery request
2019-04-20 19:51:20.615 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-04-20 19:51:21.418 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-04-20 19:51:21.429 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-04-20 19:51:21.485 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-04-20 19:51:21.628 +04:00 [DBG] Start key discovery request
2019-04-20 19:51:22.262 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-04-20 19:51:22.278 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-04-20 19:51:22.282 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-04-20 19:51:22.293 +04:00 [DBG] Start authorize request
2019-04-20 19:51:22.317 +04:00 [DBG] No user present in authorize request
2019-04-20 19:51:22.345 +04:00 [DBG] Start authorize request protocol validation
2019-04-20 19:51:25.755 +04:00 [DBG] StudLab found in database: true
2019-04-20 19:51:25.793 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-20 19:51:25.830 +04:00 [DBG] Checking for PKCE parameters
2019-04-20 19:51:25.838 +04:00 [DBG] No PKCE used.
2019-04-20 19:51:26.147 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-20 19:51:26.423 +04:00 [DBG] Found [] API scopes in database
2019-04-20 19:51:26.564 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-20 19:51:26.593 +04:00 [DBG] Found [] API scopes in database
2019-04-20 19:51:26.628 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-04-20 19:51:26.692 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK89whvTjq8-brUSQAFYrItj6pIZEPXHB5oHkr4n87xpWNvaV1zl9nl7vORqRnYTDV5pOpkw8T7anEdEmMLvWNUbtxlKCkW4zzoB6IkbUJBWMwFdF1mQTXbTzQotLgWMDJ57bqmVSSNSdZ0oDfq-9O5j9zFpJacEJT7g55bGYq54h35Ly0jWKtui7GgFvm0CbuqmKmfPK4ifL47sJO1jt-JyOgetqbRR0g7YhNAt5wkFRwAGmfYlnZ1RSGR2v2DpTAsUojLt2F9PMClFmtsUYnsikO0hQyAJu4pXAiEfYwxGkcN9innG0Rxv9SxQX0FMhgTo","UiLocales":null,"Nonce":"636913722817535416.Yjk2ZDgyMjItMjc1Ni00YTJiLWFlYmUtNDQwOTFkNjNhZWZlODcxYjI3YzctOWYxMy00OWQ2LTg1YzctMjZhMjE2NGYyZjdi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636913722817535416.Yjk2ZDgyMjItMjc1Ni00YTJiLWFlYmUtNDQwOTFkNjNhZWZlODcxYjI3YzctOWYxMy00OWQ2LTg1YzctMjZhMjE2NGYyZjdi","state":"CfDJ8D73mgAamspIvsbnstRoK89whvTjq8-brUSQAFYrItj6pIZEPXHB5oHkr4n87xpWNvaV1zl9nl7vORqRnYTDV5pOpkw8T7anEdEmMLvWNUbtxlKCkW4zzoB6IkbUJBWMwFdF1mQTXbTzQotLgWMDJ57bqmVSSNSdZ0oDfq-9O5j9zFpJacEJT7g55bGYq54h35Ly0jWKtui7GgFvm0CbuqmKmfPK4ifL47sJO1jt-JyOgetqbRR0g7YhNAt5wkFRwAGmfYlnZ1RSGR2v2DpTAsUojLt2F9PMClFmtsUYnsikO0hQyAJu4pXAiEfYwxGkcN9innG0Rxv9SxQX0FMhgTo","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-04-20 19:51:26.864 +04:00 [INF] Showing login: User is not authenticated
2019-04-20 19:52:06.884 +04:00 [DBG] Augmenting SignInContext
2019-04-20 19:52:06.885 +04:00 [DBG] Adding idp claim with value: local
2019-04-20 19:52:06.888 +04:00 [DBG] Adding amr claim with value: pwd
2019-04-20 19:52:06.889 +04:00 [DBG] Adding auth_time claim with value: 1555775526
2019-04-20 19:52:06.892 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-04-20 19:52:06.898 +04:00 [INF] {"Username":"dereguzov1@yandex.ru","Provider":null,"ProviderUserId":null,"SubjectId":"4","DisplayName":"dereguzov1@yandex.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLM5KUFEDQCD:00000001","TimeStamp":"2019-04-20T15:52:06.0000000Z","ProcessId":3924,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-04-20 19:52:06.945 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-04-20 19:52:06.953 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-04-20 19:52:06.958 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-04-20 19:52:06.995 +04:00 [DBG] Start authorize callback request
2019-04-20 19:52:07.012 +04:00 [DBG] User in authorize request: 4
2019-04-20 19:52:07.014 +04:00 [DBG] Start authorize request protocol validation
2019-04-20 19:52:07.079 +04:00 [DBG] StudLab found in database: true
2019-04-20 19:52:07.080 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-20 19:52:07.086 +04:00 [DBG] Checking for PKCE parameters
2019-04-20 19:52:07.088 +04:00 [DBG] No PKCE used.
2019-04-20 19:52:07.120 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-20 19:52:07.137 +04:00 [DBG] Found [] API scopes in database
2019-04-20 19:52:07.143 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-20 19:52:07.147 +04:00 [DBG] Found [] API scopes in database
2019-04-20 19:52:07.150 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-04-20 19:52:07.154 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"4","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK89whvTjq8-brUSQAFYrItj6pIZEPXHB5oHkr4n87xpWNvaV1zl9nl7vORqRnYTDV5pOpkw8T7anEdEmMLvWNUbtxlKCkW4zzoB6IkbUJBWMwFdF1mQTXbTzQotLgWMDJ57bqmVSSNSdZ0oDfq-9O5j9zFpJacEJT7g55bGYq54h35Ly0jWKtui7GgFvm0CbuqmKmfPK4ifL47sJO1jt-JyOgetqbRR0g7YhNAt5wkFRwAGmfYlnZ1RSGR2v2DpTAsUojLt2F9PMClFmtsUYnsikO0hQyAJu4pXAiEfYwxGkcN9innG0Rxv9SxQX0FMhgTo","UiLocales":null,"Nonce":"636913722817535416.Yjk2ZDgyMjItMjc1Ni00YTJiLWFlYmUtNDQwOTFkNjNhZWZlODcxYjI3YzctOWYxMy00OWQ2LTg1YzctMjZhMjE2NGYyZjdi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"7d7b761e592d2ad8f9bfa5d20ebc3fd1","Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636913722817535416.Yjk2ZDgyMjItMjc1Ni00YTJiLWFlYmUtNDQwOTFkNjNhZWZlODcxYjI3YzctOWYxMy00OWQ2LTg1YzctMjZhMjE2NGYyZjdi","state":"CfDJ8D73mgAamspIvsbnstRoK89whvTjq8-brUSQAFYrItj6pIZEPXHB5oHkr4n87xpWNvaV1zl9nl7vORqRnYTDV5pOpkw8T7anEdEmMLvWNUbtxlKCkW4zzoB6IkbUJBWMwFdF1mQTXbTzQotLgWMDJ57bqmVSSNSdZ0oDfq-9O5j9zFpJacEJT7g55bGYq54h35Ly0jWKtui7GgFvm0CbuqmKmfPK4ifL47sJO1jt-JyOgetqbRR0g7YhNAt5wkFRwAGmfYlnZ1RSGR2v2DpTAsUojLt2F9PMClFmtsUYnsikO0hQyAJu4pXAiEfYwxGkcN9innG0Rxv9SxQX0FMhgTo","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-04-20 19:52:07.293 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-04-20 19:52:07.315 +04:00 [DBG] Creating Hybrid Flow response.
2019-04-20 19:52:07.440 +04:00 [DBG] CbjHIllzKqHUAYFt8uSfQabySdmEQYPgFXH/DA/s84I= not found in database
2019-04-20 19:52:07.639 +04:00 [DBG] Creating Implicit Flow response.
2019-04-20 19:52:07.693 +04:00 [DBG] Getting claims for identity token for subject: 4 and client: StudLab
2019-04-20 19:52:07.788 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-04-20 19:52:08.063 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"4","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****QDRQ","$type":"Token"},{"TokenType":"code","TokenValue":"****f66b","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLM5KUFEDQCD:00000002","TimeStamp":"2019-04-20T15:52:08.0000000Z","ProcessId":3924,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-04-20 19:52:08.145 +04:00 [INF] Authorize endpoint response
{"SubjectId":"4","ClientId":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8D73mgAamspIvsbnstRoK89whvTjq8-brUSQAFYrItj6pIZEPXHB5oHkr4n87xpWNvaV1zl9nl7vORqRnYTDV5pOpkw8T7anEdEmMLvWNUbtxlKCkW4zzoB6IkbUJBWMwFdF1mQTXbTzQotLgWMDJ57bqmVSSNSdZ0oDfq-9O5j9zFpJacEJT7g55bGYq54h35Ly0jWKtui7GgFvm0CbuqmKmfPK4ifL47sJO1jt-JyOgetqbRR0g7YhNAt5wkFRwAGmfYlnZ1RSGR2v2DpTAsUojLt2F9PMClFmtsUYnsikO0hQyAJu4pXAiEfYwxGkcN9innG0Rxv9SxQX0FMhgTo","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-04-20 19:52:08.222 +04:00 [DBG] Augmenting SignInContext
2019-04-20 19:52:08.223 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-04-20 19:52:08.985 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-04-20 19:52:09.023 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-04-20 19:52:09.053 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-04-20 19:52:09.113 +04:00 [DBG] Start token request.
2019-04-20 19:52:09.139 +04:00 [DBG] Start client validation
2019-04-20 19:52:09.156 +04:00 [DBG] Start parsing Basic Authentication secret
2019-04-20 19:52:09.171 +04:00 [DBG] Start parsing for secret in post body
2019-04-20 19:52:09.173 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-04-20 19:52:09.176 +04:00 [DBG] Secret id found: StudLab
2019-04-20 19:52:09.194 +04:00 [DBG] StudLab found in database: true
2019-04-20 19:52:09.196 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-20 19:52:09.235 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-04-20 19:52:09.238 +04:00 [DBG] Client validation success
2019-04-20 19:52:09.244 +04:00 [INF] {"ClientId":"StudLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLM5KUFEDQCA:00000003","TimeStamp":"2019-04-20T15:52:09.0000000Z","ProcessId":3924,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-04-20 19:52:09.295 +04:00 [DBG] Start token request validation
2019-04-20 19:52:09.357 +04:00 [DBG] Start validation of authorization code token request
2019-04-20 19:52:09.415 +04:00 [DBG] CbjHIllzKqHUAYFt8uSfQabySdmEQYPgFXH/DA/s84I= found in database: true
2019-04-20 19:52:09.511 +04:00 [DBG] removing CbjHIllzKqHUAYFt8uSfQabySdmEQYPgFXH/DA/s84I= persisted grant from database
2019-04-20 19:52:09.565 +04:00 [DBG] Validation of authorization code token request success
2019-04-20 19:52:09.588 +04:00 [INF] Token request validation success
{"ClientId":"StudLab","ClientName":"StudLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"d3dcb22a7a311dae6281b76a27b7e24a0660b3747cf9f40e039e339f4f78f66b","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"StudLab","client_secret":"***REDACTED***","code":"d3dcb22a7a311dae6281b76a27b7e24a0660b3747cf9f40e039e339f4f78f66b","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-04-20 19:52:09.728 +04:00 [DBG] StudLab found in database: true
2019-04-20 19:52:09.729 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-20 19:52:09.757 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-20 19:52:09.779 +04:00 [DBG] Found [] API scopes in database
2019-04-20 19:52:09.827 +04:00 [DBG] Getting claims for access token for client: StudLab
2019-04-20 19:52:09.828 +04:00 [DBG] Getting claims for access token for subject: 4
2019-04-20 19:52:09.848 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-04-20 19:52:09.890 +04:00 [DBG] Creating refresh token
2019-04-20 19:52:09.891 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-04-20 19:52:09.949 +04:00 [DBG] tV+k0yN+XbDC9nI13Gq1Zs+Soa5qBfK9MhqUOqqqVKA= not found in database
2019-04-20 19:52:09.976 +04:00 [DBG] StudLab found in database: true
2019-04-20 19:52:09.977 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-20 19:52:09.994 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-20 19:52:10.002 +04:00 [DBG] Found [] API scopes in database
2019-04-20 19:52:10.007 +04:00 [DBG] Getting claims for identity token for subject: 4 and client: StudLab
2019-04-20 19:52:10.072 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-04-20 19:52:10.094 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****nDcg","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****f180","$type":"Token"},{"TokenType":"access_token","TokenValue":"****WY9A","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLM5KUFEDQCA:00000003","TimeStamp":"2019-04-20T15:52:10.0000000Z","ProcessId":3924,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-04-20 19:52:10.121 +04:00 [DBG] Token request success.
2019-04-20 19:52:10.192 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-04-20 19:52:10.213 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-04-20 19:52:10.240 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-04-20 19:52:10.288 +04:00 [DBG] Start userinfo request
2019-04-20 19:52:10.303 +04:00 [DBG] Bearer token found in header
2019-04-20 19:52:10.557 +04:00 [DBG] StudLab found in database: true
2019-04-20 19:52:10.558 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-20 19:52:10.582 +04:00 [DBG] StudLab found in database: true
2019-04-20 19:52:10.586 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-20 19:52:10.614 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-04-20 19:52:10.624 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1555775529,"exp":1555779129,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"StudLab","sub":"4","auth_time":1555775526,"idp":"local","AspNet.Identity.SecurityStamp":"SMEWCFOPKGR2ER6A74KB2DZBDEUNFFQJ","role":"GodAdmin","preferred_username":"dereguzov1@yandex.ru","name":"dereguzov1@yandex.ru","email":"dereguzov1@yandex.ru","email_verified":false,"given_name":"dereguzov1@yandex.ru","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-04-20 19:52:10.668 +04:00 [DBG] Creating userinfo response
2019-04-20 19:52:10.680 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-04-20 19:52:10.707 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-04-20 19:52:10.721 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-20 19:52:10.725 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-04-20 19:52:10.727 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-04-20 19:52:10.743 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-20 19:52:10.769 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email
2019-04-20 19:52:10.773 +04:00 [DBG] End userinfo request
2019-04-20 20:46:54.889 +04:00 [INF] Removing 1 grants
2019-04-20 21:46:57.421 +04:00 [INF] Removing 0 grants
2019-04-20 22:46:59.550 +04:00 [INF] Removing 0 grants
2019-04-21 11:51:17.311 +04:00 [INF] Removing 0 grants
2019-04-21 12:51:08.187 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-04-21 12:51:08.345 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-04-21 12:51:08.361 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-04-21 12:51:08.363 +04:00 [DBG] Start discovery request
2019-04-21 12:51:13.725 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-04-21 12:51:14.528 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-04-21 12:51:14.534 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-04-21 12:51:14.543 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-04-21 12:51:14.549 +04:00 [DBG] Start key discovery request
2019-04-21 12:51:14.793 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-04-21 12:51:14.853 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-04-21 12:51:14.863 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-04-21 12:51:14.864 +04:00 [DBG] Start authorize request
2019-04-21 12:51:14.904 +04:00 [DBG] No user present in authorize request
2019-04-21 12:51:14.944 +04:00 [DBG] Start authorize request protocol validation
2019-04-21 12:51:15.326 +04:00 [DBG] StudLab found in database: true
2019-04-21 12:51:15.327 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-21 12:51:15.330 +04:00 [DBG] Checking for PKCE parameters
2019-04-21 12:51:15.331 +04:00 [DBG] No PKCE used.
2019-04-21 12:51:15.552 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-21 12:51:15.629 +04:00 [DBG] Found [] API scopes in database
2019-04-21 12:51:15.682 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-21 12:51:15.690 +04:00 [DBG] Found [] API scopes in database
2019-04-21 12:51:15.703 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-04-21 12:51:15.739 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK8_aYkD5eyvGbJedYfaqweezXzV-zdgthx7sDgzY8fTUeeMdpVAAoeKFxfCHsLlVqNopfjxcFT1DwxeBS0o-KeSiJTOr5vo6Z4GZg2RiZWkJz1C_1fgGZDbDutka0EovualZinhiGsZ6jl1dPtMAmfhV3CIHx4Xemo8BnUgy7N_3VpWW6fJ-3ZBnPQm4sWo7X22OujAVhpWqeTbDEqXT4oqjUHL17y9OgkqIV3kLlr89EkrBoXCwEeWgyoIcZ3kaZ-aKw1FKD16CB3PdxP9owUQ3c6fk6csQH1vCGE96NdMuRjMWL9bSh4EzbTjYmgUEAq8","UiLocales":null,"Nonce":"636914334746145354.NWNhZmI5ZGItN2NiMS00OTQzLWI5NDMtNzE4YWFjZGE0M2RmZTFlNGFiMGQtYmVhOS00NmNlLWIwOGEtMDA4ZDk3ODg4Y2Y5","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636914334746145354.NWNhZmI5ZGItN2NiMS00OTQzLWI5NDMtNzE4YWFjZGE0M2RmZTFlNGFiMGQtYmVhOS00NmNlLWIwOGEtMDA4ZDk3ODg4Y2Y5","state":"CfDJ8D73mgAamspIvsbnstRoK8_aYkD5eyvGbJedYfaqweezXzV-zdgthx7sDgzY8fTUeeMdpVAAoeKFxfCHsLlVqNopfjxcFT1DwxeBS0o-KeSiJTOr5vo6Z4GZg2RiZWkJz1C_1fgGZDbDutka0EovualZinhiGsZ6jl1dPtMAmfhV3CIHx4Xemo8BnUgy7N_3VpWW6fJ-3ZBnPQm4sWo7X22OujAVhpWqeTbDEqXT4oqjUHL17y9OgkqIV3kLlr89EkrBoXCwEeWgyoIcZ3kaZ-aKw1FKD16CB3PdxP9owUQ3c6fk6csQH1vCGE96NdMuRjMWL9bSh4EzbTjYmgUEAq8","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-04-21 12:51:15.806 +04:00 [INF] Showing login: User is not authenticated
2019-04-21 12:51:17.535 +04:00 [INF] Removing 0 grants
2019-04-21 12:52:47.052 +04:00 [DBG] Augmenting SignInContext
2019-04-21 12:52:47.053 +04:00 [DBG] Adding idp claim with value: local
2019-04-21 12:52:47.055 +04:00 [DBG] Adding amr claim with value: pwd
2019-04-21 12:52:47.056 +04:00 [DBG] Adding auth_time claim with value: 1555836767
2019-04-21 12:52:47.060 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-04-21 12:52:47.101 +04:00 [INF] {"Username":"dereguzov1@yandex.ru","Provider":null,"ProviderUserId":null,"SubjectId":"4","DisplayName":"dereguzov1@yandex.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLM5KUFEDQCJ:00000004","TimeStamp":"2019-04-21T08:52:47.0000000Z","ProcessId":3924,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-04-21 12:52:47.277 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-04-21 12:52:47.302 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-04-21 12:52:47.305 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-04-21 12:52:47.306 +04:00 [DBG] Start authorize callback request
2019-04-21 12:52:47.326 +04:00 [DBG] User in authorize request: 4
2019-04-21 12:52:47.327 +04:00 [DBG] Start authorize request protocol validation
2019-04-21 12:52:47.409 +04:00 [DBG] StudLab found in database: true
2019-04-21 12:52:47.410 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-21 12:52:47.412 +04:00 [DBG] Checking for PKCE parameters
2019-04-21 12:52:47.416 +04:00 [DBG] No PKCE used.
2019-04-21 12:52:47.426 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-21 12:52:47.456 +04:00 [DBG] Found [] API scopes in database
2019-04-21 12:52:47.469 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-21 12:52:47.498 +04:00 [DBG] Found [] API scopes in database
2019-04-21 12:52:47.505 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-04-21 12:52:47.507 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"4","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK8_aYkD5eyvGbJedYfaqweezXzV-zdgthx7sDgzY8fTUeeMdpVAAoeKFxfCHsLlVqNopfjxcFT1DwxeBS0o-KeSiJTOr5vo6Z4GZg2RiZWkJz1C_1fgGZDbDutka0EovualZinhiGsZ6jl1dPtMAmfhV3CIHx4Xemo8BnUgy7N_3VpWW6fJ-3ZBnPQm4sWo7X22OujAVhpWqeTbDEqXT4oqjUHL17y9OgkqIV3kLlr89EkrBoXCwEeWgyoIcZ3kaZ-aKw1FKD16CB3PdxP9owUQ3c6fk6csQH1vCGE96NdMuRjMWL9bSh4EzbTjYmgUEAq8","UiLocales":null,"Nonce":"636914334746145354.NWNhZmI5ZGItN2NiMS00OTQzLWI5NDMtNzE4YWFjZGE0M2RmZTFlNGFiMGQtYmVhOS00NmNlLWIwOGEtMDA4ZDk3ODg4Y2Y5","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"5f34af04e8f3268f221c7f5cf41fa37b","Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636914334746145354.NWNhZmI5ZGItN2NiMS00OTQzLWI5NDMtNzE4YWFjZGE0M2RmZTFlNGFiMGQtYmVhOS00NmNlLWIwOGEtMDA4ZDk3ODg4Y2Y5","state":"CfDJ8D73mgAamspIvsbnstRoK8_aYkD5eyvGbJedYfaqweezXzV-zdgthx7sDgzY8fTUeeMdpVAAoeKFxfCHsLlVqNopfjxcFT1DwxeBS0o-KeSiJTOr5vo6Z4GZg2RiZWkJz1C_1fgGZDbDutka0EovualZinhiGsZ6jl1dPtMAmfhV3CIHx4Xemo8BnUgy7N_3VpWW6fJ-3ZBnPQm4sWo7X22OujAVhpWqeTbDEqXT4oqjUHL17y9OgkqIV3kLlr89EkrBoXCwEeWgyoIcZ3kaZ-aKw1FKD16CB3PdxP9owUQ3c6fk6csQH1vCGE96NdMuRjMWL9bSh4EzbTjYmgUEAq8","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-04-21 12:52:47.605 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-04-21 12:52:47.608 +04:00 [DBG] Creating Hybrid Flow response.
2019-04-21 12:52:47.651 +04:00 [DBG] YpsCYrBeB8jlqNg9xjhGmckuhMgbY8kyxJkHdTakbK8= not found in database
2019-04-21 12:52:47.715 +04:00 [DBG] Creating Implicit Flow response.
2019-04-21 12:52:47.716 +04:00 [DBG] Getting claims for identity token for subject: 4 and client: StudLab
2019-04-21 12:52:47.773 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-04-21 12:52:47.841 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"4","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****wL-w","$type":"Token"},{"TokenType":"code","TokenValue":"****dd38","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLM5KUFEDQCJ:00000005","TimeStamp":"2019-04-21T08:52:47.0000000Z","ProcessId":3924,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-04-21 12:52:47.852 +04:00 [INF] Authorize endpoint response
{"SubjectId":"4","ClientId":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8D73mgAamspIvsbnstRoK8_aYkD5eyvGbJedYfaqweezXzV-zdgthx7sDgzY8fTUeeMdpVAAoeKFxfCHsLlVqNopfjxcFT1DwxeBS0o-KeSiJTOr5vo6Z4GZg2RiZWkJz1C_1fgGZDbDutka0EovualZinhiGsZ6jl1dPtMAmfhV3CIHx4Xemo8BnUgy7N_3VpWW6fJ-3ZBnPQm4sWo7X22OujAVhpWqeTbDEqXT4oqjUHL17y9OgkqIV3kLlr89EkrBoXCwEeWgyoIcZ3kaZ-aKw1FKD16CB3PdxP9owUQ3c6fk6csQH1vCGE96NdMuRjMWL9bSh4EzbTjYmgUEAq8","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-04-21 12:52:47.859 +04:00 [DBG] Augmenting SignInContext
2019-04-21 12:52:47.860 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-04-21 12:52:48.756 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-04-21 12:52:48.796 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-04-21 12:52:48.845 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-04-21 12:52:48.888 +04:00 [DBG] Start discovery request
2019-04-21 12:52:49.058 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-04-21 12:52:49.567 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-04-21 12:52:49.575 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-04-21 12:52:49.590 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-04-21 12:52:49.604 +04:00 [DBG] Start key discovery request
2019-04-21 12:52:50.275 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-04-21 12:52:50.361 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-04-21 12:52:50.365 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-04-21 12:52:50.372 +04:00 [DBG] Start token request.
2019-04-21 12:52:50.374 +04:00 [DBG] Start client validation
2019-04-21 12:52:50.377 +04:00 [DBG] Start parsing Basic Authentication secret
2019-04-21 12:52:50.380 +04:00 [DBG] Start parsing for secret in post body
2019-04-21 12:52:50.396 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-04-21 12:52:50.399 +04:00 [DBG] Secret id found: StudLab
2019-04-21 12:52:50.439 +04:00 [DBG] StudLab found in database: true
2019-04-21 12:52:50.440 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-21 12:52:50.456 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-04-21 12:52:50.457 +04:00 [DBG] Client validation success
2019-04-21 12:52:50.459 +04:00 [INF] {"ClientId":"StudLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLM5KUFEDQCK:00000003","TimeStamp":"2019-04-21T08:52:50.0000000Z","ProcessId":3924,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-04-21 12:52:50.468 +04:00 [DBG] Start token request validation
2019-04-21 12:52:50.469 +04:00 [DBG] Start validation of authorization code token request
2019-04-21 12:52:50.490 +04:00 [DBG] YpsCYrBeB8jlqNg9xjhGmckuhMgbY8kyxJkHdTakbK8= found in database: true
2019-04-21 12:52:50.590 +04:00 [DBG] removing YpsCYrBeB8jlqNg9xjhGmckuhMgbY8kyxJkHdTakbK8= persisted grant from database
2019-04-21 12:52:50.742 +04:00 [DBG] Validation of authorization code token request success
2019-04-21 12:52:50.752 +04:00 [INF] Token request validation success
{"ClientId":"StudLab","ClientName":"StudLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"874f08a52bdad74b1e45b5678968378d2118bd48d7a312232b8850bf0f22dd38","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"StudLab","client_secret":"***REDACTED***","code":"874f08a52bdad74b1e45b5678968378d2118bd48d7a312232b8850bf0f22dd38","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-04-21 12:52:50.852 +04:00 [DBG] StudLab found in database: true
2019-04-21 12:52:50.854 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-21 12:52:50.996 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-21 12:52:51.025 +04:00 [DBG] Found [] API scopes in database
2019-04-21 12:52:51.027 +04:00 [DBG] Getting claims for access token for client: StudLab
2019-04-21 12:52:51.028 +04:00 [DBG] Getting claims for access token for subject: 4
2019-04-21 12:52:51.056 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-04-21 12:52:51.080 +04:00 [DBG] Creating refresh token
2019-04-21 12:52:51.086 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-04-21 12:52:51.090 +04:00 [DBG] yoHaAo/pt5YvF228LVfTcGS4zykxcAo9WGOJk42ncI0= not found in database
2019-04-21 12:52:51.263 +04:00 [DBG] StudLab found in database: true
2019-04-21 12:52:51.264 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-21 12:52:51.286 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-21 12:52:51.299 +04:00 [DBG] Found [] API scopes in database
2019-04-21 12:52:51.301 +04:00 [DBG] Getting claims for identity token for subject: 4 and client: StudLab
2019-04-21 12:52:51.365 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-04-21 12:52:51.378 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****jqxA","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****e54b","$type":"Token"},{"TokenType":"access_token","TokenValue":"****IJ3Q","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLM5KUFEDQCK:00000003","TimeStamp":"2019-04-21T08:52:51.0000000Z","ProcessId":3924,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-04-21 12:52:51.390 +04:00 [DBG] Token request success.
2019-04-21 12:52:51.410 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-04-21 12:52:51.437 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-04-21 12:52:51.439 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-04-21 12:52:51.441 +04:00 [DBG] Start userinfo request
2019-04-21 12:52:51.443 +04:00 [DBG] Bearer token found in header
2019-04-21 12:52:51.549 +04:00 [DBG] StudLab found in database: true
2019-04-21 12:52:51.552 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-21 12:52:51.677 +04:00 [DBG] StudLab found in database: true
2019-04-21 12:52:51.684 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-21 12:52:51.706 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-04-21 12:52:51.714 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1555836771,"exp":1555840371,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"StudLab","sub":"4","auth_time":1555836767,"idp":"local","AspNet.Identity.SecurityStamp":"SMEWCFOPKGR2ER6A74KB2DZBDEUNFFQJ","role":"GodAdmin","preferred_username":"dereguzov1@yandex.ru","name":"dereguzov1@yandex.ru","email":"dereguzov1@yandex.ru","email_verified":false,"given_name":"dereguzov1@yandex.ru","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-04-21 12:52:51.728 +04:00 [DBG] Creating userinfo response
2019-04-21 12:52:51.730 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-04-21 12:52:51.732 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-04-21 12:52:51.743 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-21 12:52:51.746 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-04-21 12:52:51.749 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-04-21 12:52:51.760 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-21 12:52:51.805 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email
2019-04-21 12:52:51.850 +04:00 [DBG] End userinfo request
2019-04-21 13:51:21.597 +04:00 [INF] Removing 0 grants
2019-04-21 14:51:24.266 +04:00 [INF] Removing 0 grants
2019-04-21 15:51:33.578 +04:00 [INF] Removing 0 grants
2019-04-22 13:38:03.008 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-04-22 13:38:03.183 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-04-22 13:38:03.185 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-04-22 13:38:03.186 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-04-22 13:38:03.187 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-04-22 13:38:03.187 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-04-22 13:38:03.188 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-04-22 13:38:03.771 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-04-22 13:38:03.791 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-04-22 13:38:03.795 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-04-22 13:38:03.979 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-22 13:38:04.143 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-22 13:38:04.178 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-22 13:38:04.195 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-22 13:38:04.216 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-22 13:38:04.233 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-04-22 13:38:04.364 +04:00 [DBG] Starting grant removal
2019-04-22 13:38:30.930 +04:00 [DBG] Login Url: /Account/Login
2019-04-22 13:38:30.936 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-04-22 13:38:30.939 +04:00 [DBG] Logout Url: /Account/Logout
2019-04-22 13:38:30.940 +04:00 [DBG] ConsentUrl Url: /consent
2019-04-22 13:38:30.942 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-04-22 13:38:30.943 +04:00 [DBG] Error Url: /home/error
2019-04-22 13:38:30.944 +04:00 [DBG] Error Id Parameter: errorId
2019-04-22 13:38:31.043 +04:00 [WRN] Failed to determine the https port for redirect.
2019-04-22 13:38:33.996 +04:00 [DBG] Augmenting SignInContext
2019-04-22 13:38:34.092 +04:00 [DBG] Adding idp claim with value: local
2019-04-22 13:38:34.093 +04:00 [DBG] Adding amr claim with value: pwd
2019-04-22 13:38:34.098 +04:00 [DBG] Adding auth_time claim with value: 1555925913
2019-04-22 13:38:34.132 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-04-22 13:38:34.233 +04:00 [INF] {"Username":"dereguzov1@yandex.ru","Provider":null,"ProviderUserId":null,"SubjectId":"4","DisplayName":"dereguzov1@yandex.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLM70OVHOI1O:00000002","TimeStamp":"2019-04-22T09:38:34.0000000Z","ProcessId":14004,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-04-22 13:38:37.469 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentException: Value cannot be null or empty.
Parameter name: url
   at Microsoft.AspNetCore.Mvc.ControllerBase.Redirect(String url)
   at AuthServiceServer.Controllers.AccountController.Login(LoginModel model) in D:\Projects\AuthService\AuthService\AuthServiceServer\Controllers\AccountController.cs:line 54
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-04-22 13:39:12.495 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-04-22 13:39:12.507 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-04-22 13:39:12.511 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-04-22 13:39:12.522 +04:00 [DBG] Start discovery request
2019-04-22 13:39:13.539 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-04-22 13:39:13.848 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-04-22 13:39:13.853 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-04-22 13:39:13.854 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-04-22 13:39:13.865 +04:00 [DBG] Start key discovery request
2019-04-22 13:39:13.995 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-04-22 13:39:14.017 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-04-22 13:39:14.022 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-04-22 13:39:14.040 +04:00 [DBG] Start authorize request
2019-04-22 13:39:14.059 +04:00 [DBG] No user present in authorize request
2019-04-22 13:39:14.072 +04:00 [DBG] Start authorize request protocol validation
2019-04-22 13:39:14.747 +04:00 [DBG] StudLab found in database: true
2019-04-22 13:39:14.760 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-22 13:39:14.772 +04:00 [DBG] Checking for PKCE parameters
2019-04-22 13:39:14.778 +04:00 [DBG] No PKCE used.
2019-04-22 13:39:14.883 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-22 13:39:14.979 +04:00 [DBG] Found [] API scopes in database
2019-04-22 13:39:15.000 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-22 13:39:15.006 +04:00 [DBG] Found [] API scopes in database
2019-04-22 13:39:15.023 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-04-22 13:39:15.046 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK8-yczC1gSKjQi1qQSabhIWkWTr0tXTTQm-MrNwid1omJXPMvqWoYmGUCJZ0iwfKtnYswjT3elsbnGIO17jk--8GVnRB4sM_KKveyvCQGVh9ECE9w1pkzTbXJWtAbQvo0hHwnzYVkzBCzlRcZs9erAcg5g3SLbrmjenT-u-i7QRsPf_A27JSHW54A69zosMH_BOIHc298FDR8a73vxIpqkfdc2I9QgmvrSCdcuzZa8-EeC0nW7nwGkv4DVQcnevi6NMB-2pLSfyhOH2Q0a8699QtJOJuPGVESzw_kW7MKSP52f8g8LIK4p9JpmgvHny9gnM","UiLocales":null,"Nonce":"636915227539345161.ZWFjZjJhOWEtZDRkMS00ZmNkLWFmNWItZmZlYmM2ZThmMDk5MDNjNDUyOWYtYTBkOC00NDhiLTkwMmQtZmEzODdkYTNlODNi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636915227539345161.ZWFjZjJhOWEtZDRkMS00ZmNkLWFmNWItZmZlYmM2ZThmMDk5MDNjNDUyOWYtYTBkOC00NDhiLTkwMmQtZmEzODdkYTNlODNi","state":"CfDJ8D73mgAamspIvsbnstRoK8-yczC1gSKjQi1qQSabhIWkWTr0tXTTQm-MrNwid1omJXPMvqWoYmGUCJZ0iwfKtnYswjT3elsbnGIO17jk--8GVnRB4sM_KKveyvCQGVh9ECE9w1pkzTbXJWtAbQvo0hHwnzYVkzBCzlRcZs9erAcg5g3SLbrmjenT-u-i7QRsPf_A27JSHW54A69zosMH_BOIHc298FDR8a73vxIpqkfdc2I9QgmvrSCdcuzZa8-EeC0nW7nwGkv4DVQcnevi6NMB-2pLSfyhOH2Q0a8699QtJOJuPGVESzw_kW7MKSP52f8g8LIK4p9JpmgvHny9gnM","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-04-22 13:39:15.090 +04:00 [INF] Showing login: User is not authenticated
2019-04-22 13:39:17.765 +04:00 [DBG] Augmenting SignInContext
2019-04-22 13:39:17.766 +04:00 [DBG] Adding idp claim with value: local
2019-04-22 13:39:17.770 +04:00 [DBG] Adding amr claim with value: pwd
2019-04-22 13:39:17.772 +04:00 [DBG] Adding auth_time claim with value: 1555925957
2019-04-22 13:39:17.779 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-04-22 13:39:17.786 +04:00 [INF] {"Username":"dereguzov1@yandex.ru","Provider":null,"ProviderUserId":null,"SubjectId":"4","DisplayName":"dereguzov1@yandex.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLM70OVHOI1U:00000003","TimeStamp":"2019-04-22T09:39:17.0000000Z","ProcessId":14004,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-04-22 13:39:17.859 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-04-22 13:39:17.866 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-04-22 13:39:17.869 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-04-22 13:39:17.898 +04:00 [DBG] Start authorize callback request
2019-04-22 13:39:17.916 +04:00 [DBG] User in authorize request: 4
2019-04-22 13:39:17.917 +04:00 [DBG] Start authorize request protocol validation
2019-04-22 13:39:17.930 +04:00 [DBG] StudLab found in database: true
2019-04-22 13:39:17.931 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-22 13:39:17.936 +04:00 [DBG] Checking for PKCE parameters
2019-04-22 13:39:17.939 +04:00 [DBG] No PKCE used.
2019-04-22 13:39:17.969 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-22 13:39:17.979 +04:00 [DBG] Found [] API scopes in database
2019-04-22 13:39:17.988 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-22 13:39:17.996 +04:00 [DBG] Found [] API scopes in database
2019-04-22 13:39:17.998 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-04-22 13:39:18.001 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"4","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK8-yczC1gSKjQi1qQSabhIWkWTr0tXTTQm-MrNwid1omJXPMvqWoYmGUCJZ0iwfKtnYswjT3elsbnGIO17jk--8GVnRB4sM_KKveyvCQGVh9ECE9w1pkzTbXJWtAbQvo0hHwnzYVkzBCzlRcZs9erAcg5g3SLbrmjenT-u-i7QRsPf_A27JSHW54A69zosMH_BOIHc298FDR8a73vxIpqkfdc2I9QgmvrSCdcuzZa8-EeC0nW7nwGkv4DVQcnevi6NMB-2pLSfyhOH2Q0a8699QtJOJuPGVESzw_kW7MKSP52f8g8LIK4p9JpmgvHny9gnM","UiLocales":null,"Nonce":"636915227539345161.ZWFjZjJhOWEtZDRkMS00ZmNkLWFmNWItZmZlYmM2ZThmMDk5MDNjNDUyOWYtYTBkOC00NDhiLTkwMmQtZmEzODdkYTNlODNi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"cf56a08cec2d8ecf8135bc1f2f08c8ac","Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636915227539345161.ZWFjZjJhOWEtZDRkMS00ZmNkLWFmNWItZmZlYmM2ZThmMDk5MDNjNDUyOWYtYTBkOC00NDhiLTkwMmQtZmEzODdkYTNlODNi","state":"CfDJ8D73mgAamspIvsbnstRoK8-yczC1gSKjQi1qQSabhIWkWTr0tXTTQm-MrNwid1omJXPMvqWoYmGUCJZ0iwfKtnYswjT3elsbnGIO17jk--8GVnRB4sM_KKveyvCQGVh9ECE9w1pkzTbXJWtAbQvo0hHwnzYVkzBCzlRcZs9erAcg5g3SLbrmjenT-u-i7QRsPf_A27JSHW54A69zosMH_BOIHc298FDR8a73vxIpqkfdc2I9QgmvrSCdcuzZa8-EeC0nW7nwGkv4DVQcnevi6NMB-2pLSfyhOH2Q0a8699QtJOJuPGVESzw_kW7MKSP52f8g8LIK4p9JpmgvHny9gnM","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-04-22 13:39:18.100 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-04-22 13:39:18.117 +04:00 [DBG] Creating Hybrid Flow response.
2019-04-22 13:39:18.194 +04:00 [DBG] aiS8Tyn4YnAawKnWsqdMHTk75ocflVBQyZT7uOkk/W8= not found in database
2019-04-22 13:39:18.307 +04:00 [DBG] Creating Implicit Flow response.
2019-04-22 13:39:18.331 +04:00 [DBG] Getting claims for identity token for subject: 4 and client: StudLab
2019-04-22 13:39:18.365 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-04-22 13:39:18.559 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"4","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****AVXw","$type":"Token"},{"TokenType":"code","TokenValue":"****934b","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLM70OVHOI1U:00000004","TimeStamp":"2019-04-22T09:39:18.0000000Z","ProcessId":14004,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-04-22 13:39:18.573 +04:00 [INF] Authorize endpoint response
{"SubjectId":"4","ClientId":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8D73mgAamspIvsbnstRoK8-yczC1gSKjQi1qQSabhIWkWTr0tXTTQm-MrNwid1omJXPMvqWoYmGUCJZ0iwfKtnYswjT3elsbnGIO17jk--8GVnRB4sM_KKveyvCQGVh9ECE9w1pkzTbXJWtAbQvo0hHwnzYVkzBCzlRcZs9erAcg5g3SLbrmjenT-u-i7QRsPf_A27JSHW54A69zosMH_BOIHc298FDR8a73vxIpqkfdc2I9QgmvrSCdcuzZa8-EeC0nW7nwGkv4DVQcnevi6NMB-2pLSfyhOH2Q0a8699QtJOJuPGVESzw_kW7MKSP52f8g8LIK4p9JpmgvHny9gnM","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-04-22 13:39:18.618 +04:00 [DBG] Augmenting SignInContext
2019-04-22 13:39:18.619 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-04-22 13:39:19.066 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-04-22 13:39:19.091 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-04-22 13:39:19.099 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-04-22 13:39:19.126 +04:00 [DBG] Start token request.
2019-04-22 13:39:19.146 +04:00 [DBG] Start client validation
2019-04-22 13:39:19.164 +04:00 [DBG] Start parsing Basic Authentication secret
2019-04-22 13:39:19.177 +04:00 [DBG] Start parsing for secret in post body
2019-04-22 13:39:19.178 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-04-22 13:39:19.181 +04:00 [DBG] Secret id found: StudLab
2019-04-22 13:39:19.190 +04:00 [DBG] StudLab found in database: true
2019-04-22 13:39:19.191 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-22 13:39:19.218 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-04-22 13:39:19.219 +04:00 [DBG] Client validation success
2019-04-22 13:39:19.223 +04:00 [INF] {"ClientId":"StudLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLM70OVHOI1Q:00000003","TimeStamp":"2019-04-22T09:39:19.0000000Z","ProcessId":14004,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-04-22 13:39:19.249 +04:00 [DBG] Start token request validation
2019-04-22 13:39:19.279 +04:00 [DBG] Start validation of authorization code token request
2019-04-22 13:39:19.319 +04:00 [DBG] aiS8Tyn4YnAawKnWsqdMHTk75ocflVBQyZT7uOkk/W8= found in database: true
2019-04-22 13:39:19.360 +04:00 [DBG] removing aiS8Tyn4YnAawKnWsqdMHTk75ocflVBQyZT7uOkk/W8= persisted grant from database
2019-04-22 13:39:19.398 +04:00 [DBG] Validation of authorization code token request success
2019-04-22 13:39:19.412 +04:00 [INF] Token request validation success
{"ClientId":"StudLab","ClientName":"StudLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"d7c11933ea6ce30ab12ea5821f407c3f32978aa3769d18b739a88a0a20a8934b","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"StudLab","client_secret":"***REDACTED***","code":"d7c11933ea6ce30ab12ea5821f407c3f32978aa3769d18b739a88a0a20a8934b","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-04-22 13:39:19.482 +04:00 [DBG] StudLab found in database: true
2019-04-22 13:39:19.483 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-22 13:39:19.504 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-22 13:39:19.519 +04:00 [DBG] Found [] API scopes in database
2019-04-22 13:39:19.546 +04:00 [DBG] Getting claims for access token for client: StudLab
2019-04-22 13:39:19.547 +04:00 [DBG] Getting claims for access token for subject: 4
2019-04-22 13:39:19.565 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-04-22 13:39:19.594 +04:00 [DBG] Creating refresh token
2019-04-22 13:39:19.595 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-04-22 13:39:19.621 +04:00 [DBG] Nqho2st0VLiuXyK7gh9JDlObNDTrnRv4J3FOYRj93YU= not found in database
2019-04-22 13:39:19.638 +04:00 [DBG] StudLab found in database: true
2019-04-22 13:39:19.639 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-22 13:39:19.645 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-22 13:39:19.649 +04:00 [DBG] Found [] API scopes in database
2019-04-22 13:39:19.651 +04:00 [DBG] Getting claims for identity token for subject: 4 and client: StudLab
2019-04-22 13:39:19.665 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-04-22 13:39:19.680 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****kEsA","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****22c4","$type":"Token"},{"TokenType":"access_token","TokenValue":"****0Tdw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLM70OVHOI1Q:00000003","TimeStamp":"2019-04-22T09:39:19.0000000Z","ProcessId":14004,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-04-22 13:39:19.695 +04:00 [DBG] Token request success.
2019-04-22 13:39:19.729 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-04-22 13:39:19.737 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-04-22 13:39:19.739 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-04-22 13:39:19.760 +04:00 [DBG] Start userinfo request
2019-04-22 13:39:19.767 +04:00 [DBG] Bearer token found in header
2019-04-22 13:39:19.900 +04:00 [DBG] StudLab found in database: true
2019-04-22 13:39:19.901 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-22 13:39:19.921 +04:00 [DBG] StudLab found in database: true
2019-04-22 13:39:19.922 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-04-22 13:39:19.940 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-04-22 13:39:19.948 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1555925959,"exp":1555929559,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"StudLab","sub":"4","auth_time":1555925957,"idp":"local","AspNet.Identity.SecurityStamp":"SMEWCFOPKGR2ER6A74KB2DZBDEUNFFQJ","role":"GodAdmin","preferred_username":"dereguzov1@yandex.ru","name":"dereguzov1@yandex.ru","email":"dereguzov1@yandex.ru","email_verified":false,"given_name":"dereguzov1@yandex.ru","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-04-22 13:39:19.980 +04:00 [DBG] Creating userinfo response
2019-04-22 13:39:19.990 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-04-22 13:39:20.000 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-04-22 13:39:20.011 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-22 13:39:20.014 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-04-22 13:39:20.017 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-04-22 13:39:20.022 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-04-22 13:39:20.040 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email
2019-04-22 13:39:20.043 +04:00 [DBG] End userinfo request
2019-05-06 17:12:46.558 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-06 17:12:46.796 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-06 17:12:46.798 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-06 17:12:46.799 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-06 17:12:46.800 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-06 17:12:46.801 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-06 17:12:46.802 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-06 17:12:47.659 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-06 17:12:47.691 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-06 17:12:47.696 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-06 17:12:47.941 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-06 17:12:48.140 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-06 17:12:48.176 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-06 17:12:48.200 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-06 17:12:48.232 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-06 17:12:48.250 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-06 17:12:48.474 +04:00 [DBG] Starting grant removal
2019-05-06 17:13:25.496 +04:00 [DBG] Login Url: /Account/Login
2019-05-06 17:13:25.504 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-06 17:13:25.507 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-06 17:13:25.509 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-06 17:13:25.510 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-06 17:13:25.511 +04:00 [DBG] Error Url: /home/error
2019-05-06 17:13:25.512 +04:00 [DBG] Error Id Parameter: errorId
2019-05-06 17:13:25.585 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-06 17:13:25.617 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-06 17:13:25.621 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-06 17:13:25.631 +04:00 [DBG] Start discovery request
2019-05-06 17:13:26.840 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-05-06 17:13:27.272 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-06 17:13:27.328 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-06 17:13:27.330 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-06 17:13:27.343 +04:00 [DBG] Start key discovery request
2019-05-06 17:13:27.753 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-05-06 17:13:27.758 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-05-06 17:13:27.768 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-06 17:13:27.781 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-06 17:13:27.787 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-06 17:13:27.801 +04:00 [DBG] Start authorize request
2019-05-06 17:13:27.822 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-05-06 17:13:27.840 +04:00 [DBG] No user present in authorize request
2019-05-06 17:13:27.856 +04:00 [DBG] Start authorize request protocol validation
2019-05-06 17:13:28.652 +04:00 [DBG] StudLab found in database: true
2019-05-06 17:13:28.668 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-06 17:13:28.684 +04:00 [DBG] Checking for PKCE parameters
2019-05-06 17:13:28.689 +04:00 [DBG] No PKCE used.
2019-05-06 17:13:29.030 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-06 17:13:29.409 +04:00 [DBG] Found [] API scopes in database
2019-05-06 17:13:29.590 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-06 17:13:29.597 +04:00 [DBG] Found [] API scopes in database
2019-05-06 17:13:29.622 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-06 17:13:29.717 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK880UqAcv_PG_XsZyavpFhWg-9ShJMUozBhOLLuCtm9zV7g-jWsELUZRJiXzDoIQ7CHRawEugLXOKa13IF88m97Py32JtxUcK_KM2DZaq5zlhZ2_RsVUDgyI2taUvmy_T2T0bqJ-RiokIdXxVV86iC0G06W0OV1yN878mVdMY21E4CNM_LuUw-o1nj46J_ZM-UM4tWCTxTpdD85r8rpVU6ua2wA0HZGSQPyQ-o9Lkus-3FMOiaymwnDIk7nQfYZz_2eec68wS5HcJzU5FL_zaeYz7akZ1vgaK_2VjlGfRerXl_63mt24jgcfjKI3OXes64Q","UiLocales":null,"Nonce":"636927452075622855.ZGZmOTg5YjYtNDM3Zi00NmY3LWE3ZmUtYTBlOGQ4NTBmYzM4MjQ2NmYwYjAtZjBhNi00MDUyLWEzYTgtNjQyNTM4NmU4Y2Q2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636927452075622855.ZGZmOTg5YjYtNDM3Zi00NmY3LWE3ZmUtYTBlOGQ4NTBmYzM4MjQ2NmYwYjAtZjBhNi00MDUyLWEzYTgtNjQyNTM4NmU4Y2Q2","state":"CfDJ8D73mgAamspIvsbnstRoK880UqAcv_PG_XsZyavpFhWg-9ShJMUozBhOLLuCtm9zV7g-jWsELUZRJiXzDoIQ7CHRawEugLXOKa13IF88m97Py32JtxUcK_KM2DZaq5zlhZ2_RsVUDgyI2taUvmy_T2T0bqJ-RiokIdXxVV86iC0G06W0OV1yN878mVdMY21E4CNM_LuUw-o1nj46J_ZM-UM4tWCTxTpdD85r8rpVU6ua2wA0HZGSQPyQ-o9Lkus-3FMOiaymwnDIk7nQfYZz_2eec68wS5HcJzU5FL_zaeYz7akZ1vgaK_2VjlGfRerXl_63mt24jgcfjKI3OXes64Q","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-06 17:13:29.824 +04:00 [INF] Showing login: User is not authenticated
2019-05-06 17:13:29.904 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-05-06 17:13:29.910 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-05-06 17:13:29.942 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-06 17:13:34.866 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-05-06 17:13:34.870 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-05-06 17:13:35.370 +04:00 [DBG] Augmenting SignInContext
2019-05-06 17:13:35.379 +04:00 [DBG] Adding idp claim with value: local
2019-05-06 17:13:35.380 +04:00 [DBG] Adding amr claim with value: pwd
2019-05-06 17:13:35.384 +04:00 [DBG] Adding auth_time claim with value: 1557148415
2019-05-06 17:13:35.391 +04:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2019-05-06 17:13:35.413 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-06 17:13:35.472 +04:00 [INF] {"Username":"dereguzov1@yandex.ru","Provider":null,"ProviderUserId":null,"SubjectId":"4","DisplayName":"dereguzov1@yandex.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLMI4IFJJ67M:00000003","TimeStamp":"2019-05-06T13:13:35.0000000Z","ProcessId":13604,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-06 17:13:35.568 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-05-06 17:13:35.576 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-05-06 17:13:35.579 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-05-06 17:13:35.601 +04:00 [DBG] Start authorize callback request
2019-05-06 17:13:35.611 +04:00 [DBG] User in authorize request: 4
2019-05-06 17:13:35.612 +04:00 [DBG] Start authorize request protocol validation
2019-05-06 17:13:35.625 +04:00 [DBG] StudLab found in database: true
2019-05-06 17:13:35.626 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-06 17:13:35.629 +04:00 [DBG] Checking for PKCE parameters
2019-05-06 17:13:35.630 +04:00 [DBG] No PKCE used.
2019-05-06 17:13:35.637 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-06 17:13:35.642 +04:00 [DBG] Found [] API scopes in database
2019-05-06 17:13:35.651 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-06 17:13:35.656 +04:00 [DBG] Found [] API scopes in database
2019-05-06 17:13:35.660 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-06 17:13:35.663 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"4","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK880UqAcv_PG_XsZyavpFhWg-9ShJMUozBhOLLuCtm9zV7g-jWsELUZRJiXzDoIQ7CHRawEugLXOKa13IF88m97Py32JtxUcK_KM2DZaq5zlhZ2_RsVUDgyI2taUvmy_T2T0bqJ-RiokIdXxVV86iC0G06W0OV1yN878mVdMY21E4CNM_LuUw-o1nj46J_ZM-UM4tWCTxTpdD85r8rpVU6ua2wA0HZGSQPyQ-o9Lkus-3FMOiaymwnDIk7nQfYZz_2eec68wS5HcJzU5FL_zaeYz7akZ1vgaK_2VjlGfRerXl_63mt24jgcfjKI3OXes64Q","UiLocales":null,"Nonce":"636927452075622855.ZGZmOTg5YjYtNDM3Zi00NmY3LWE3ZmUtYTBlOGQ4NTBmYzM4MjQ2NmYwYjAtZjBhNi00MDUyLWEzYTgtNjQyNTM4NmU4Y2Q2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d8f4615f19b76226662e597341ea9666","Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636927452075622855.ZGZmOTg5YjYtNDM3Zi00NmY3LWE3ZmUtYTBlOGQ4NTBmYzM4MjQ2NmYwYjAtZjBhNi00MDUyLWEzYTgtNjQyNTM4NmU4Y2Q2","state":"CfDJ8D73mgAamspIvsbnstRoK880UqAcv_PG_XsZyavpFhWg-9ShJMUozBhOLLuCtm9zV7g-jWsELUZRJiXzDoIQ7CHRawEugLXOKa13IF88m97Py32JtxUcK_KM2DZaq5zlhZ2_RsVUDgyI2taUvmy_T2T0bqJ-RiokIdXxVV86iC0G06W0OV1yN878mVdMY21E4CNM_LuUw-o1nj46J_ZM-UM4tWCTxTpdD85r8rpVU6ua2wA0HZGSQPyQ-o9Lkus-3FMOiaymwnDIk7nQfYZz_2eec68wS5HcJzU5FL_zaeYz7akZ1vgaK_2VjlGfRerXl_63mt24jgcfjKI3OXes64Q","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-06 17:13:35.772 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-05-06 17:13:35.805 +04:00 [DBG] Creating Hybrid Flow response.
2019-05-06 17:13:35.900 +04:00 [DBG] RfYOWySvwfUfhs+zhLU6crJEpbvDkGVDyNlPZt5qoYk= not found in database
2019-05-06 17:13:36.050 +04:00 [DBG] Creating Implicit Flow response.
2019-05-06 17:13:36.072 +04:00 [DBG] Getting claims for identity token for subject: 4 and client: StudLab
2019-05-06 17:13:36.110 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-06 17:13:36.360 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"4","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****y0VQ","$type":"Token"},{"TokenType":"code","TokenValue":"****f4cd","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLMI4IFJJ67M:00000004","TimeStamp":"2019-05-06T13:13:36.0000000Z","ProcessId":13604,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-06 17:13:36.381 +04:00 [INF] Authorize endpoint response
{"SubjectId":"4","ClientId":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8D73mgAamspIvsbnstRoK880UqAcv_PG_XsZyavpFhWg-9ShJMUozBhOLLuCtm9zV7g-jWsELUZRJiXzDoIQ7CHRawEugLXOKa13IF88m97Py32JtxUcK_KM2DZaq5zlhZ2_RsVUDgyI2taUvmy_T2T0bqJ-RiokIdXxVV86iC0G06W0OV1yN878mVdMY21E4CNM_LuUw-o1nj46J_ZM-UM4tWCTxTpdD85r8rpVU6ua2wA0HZGSQPyQ-o9Lkus-3FMOiaymwnDIk7nQfYZz_2eec68wS5HcJzU5FL_zaeYz7akZ1vgaK_2VjlGfRerXl_63mt24jgcfjKI3OXes64Q","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-06 17:13:36.457 +04:00 [DBG] Augmenting SignInContext
2019-05-06 17:13:36.459 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-06 17:13:37.023 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-06 17:13:37.049 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-06 17:13:37.062 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-06 17:13:37.119 +04:00 [DBG] Start token request.
2019-05-06 17:13:37.170 +04:00 [DBG] Start client validation
2019-05-06 17:13:37.193 +04:00 [DBG] Start parsing Basic Authentication secret
2019-05-06 17:13:37.219 +04:00 [DBG] Start parsing for secret in post body
2019-05-06 17:13:37.243 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-06 17:13:37.246 +04:00 [DBG] Secret id found: StudLab
2019-05-06 17:13:37.279 +04:00 [DBG] StudLab found in database: true
2019-05-06 17:13:37.280 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-06 17:13:37.317 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-06 17:13:37.318 +04:00 [DBG] Client validation success
2019-05-06 17:13:37.323 +04:00 [INF] {"ClientId":"StudLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLMI4IFJJ67I:00000003","TimeStamp":"2019-05-06T13:13:37.0000000Z","ProcessId":13604,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-06 17:13:37.355 +04:00 [DBG] Start token request validation
2019-05-06 17:13:37.404 +04:00 [DBG] Start validation of authorization code token request
2019-05-06 17:13:37.442 +04:00 [DBG] RfYOWySvwfUfhs+zhLU6crJEpbvDkGVDyNlPZt5qoYk= found in database: true
2019-05-06 17:13:37.486 +04:00 [DBG] removing RfYOWySvwfUfhs+zhLU6crJEpbvDkGVDyNlPZt5qoYk= persisted grant from database
2019-05-06 17:13:37.517 +04:00 [DBG] Validation of authorization code token request success
2019-05-06 17:13:37.532 +04:00 [INF] Token request validation success
{"ClientId":"StudLab","ClientName":"StudLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"1a6caefa7e4845fcc1c491318f62339cc4ba2270194660e70e82aa07ea6ef4cd","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"StudLab","client_secret":"***REDACTED***","code":"1a6caefa7e4845fcc1c491318f62339cc4ba2270194660e70e82aa07ea6ef4cd","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-05-06 17:13:37.603 +04:00 [DBG] StudLab found in database: true
2019-05-06 17:13:37.604 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-06 17:13:37.624 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-06 17:13:37.637 +04:00 [DBG] Found [] API scopes in database
2019-05-06 17:13:37.663 +04:00 [DBG] Getting claims for access token for client: StudLab
2019-05-06 17:13:37.664 +04:00 [DBG] Getting claims for access token for subject: 4
2019-05-06 17:13:37.695 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-06 17:13:37.737 +04:00 [DBG] Creating refresh token
2019-05-06 17:13:37.738 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-05-06 17:13:37.774 +04:00 [DBG] MuYdZmRSS/8Rk4NNMwsQATR1UMZjsd0CgKw6NBDHqGo= not found in database
2019-05-06 17:13:37.796 +04:00 [DBG] StudLab found in database: true
2019-05-06 17:13:37.797 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-06 17:13:37.806 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-06 17:13:37.810 +04:00 [DBG] Found [] API scopes in database
2019-05-06 17:13:37.813 +04:00 [DBG] Getting claims for identity token for subject: 4 and client: StudLab
2019-05-06 17:13:37.829 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-06 17:13:37.849 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****a39A","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****a393","$type":"Token"},{"TokenType":"access_token","TokenValue":"****scjA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLMI4IFJJ67I:00000003","TimeStamp":"2019-05-06T13:13:37.0000000Z","ProcessId":13604,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-06 17:13:37.866 +04:00 [DBG] Token request success.
2019-05-06 17:13:37.901 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-05-06 17:13:37.914 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-05-06 17:13:37.919 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-05-06 17:13:37.940 +04:00 [DBG] Start userinfo request
2019-05-06 17:13:37.950 +04:00 [DBG] Bearer token found in header
2019-05-06 17:13:38.108 +04:00 [DBG] StudLab found in database: true
2019-05-06 17:13:38.109 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-06 17:13:38.127 +04:00 [DBG] StudLab found in database: true
2019-05-06 17:13:38.128 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-06 17:13:38.149 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-05-06 17:13:38.156 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1557148417,"exp":1557152017,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"StudLab","sub":"4","auth_time":1557148415,"idp":"local","AspNet.Identity.SecurityStamp":"SMEWCFOPKGR2ER6A74KB2DZBDEUNFFQJ","role":"GodAdmin","preferred_username":"dereguzov1@yandex.ru","name":"dereguzov1@yandex.ru","email":"dereguzov1@yandex.ru","email_verified":false,"given_name":"dereguzov1@yandex.ru","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-05-06 17:13:38.192 +04:00 [DBG] Creating userinfo response
2019-05-06 17:13:38.208 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-06 17:13:38.230 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-06 17:13:38.243 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-06 17:13:38.246 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-05-06 17:13:38.249 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-06 17:13:38.255 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-06 17:13:38.275 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email
2019-05-06 17:13:38.279 +04:00 [DBG] End userinfo request
2019-05-06 17:19:29.651 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-06 17:19:29.661 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-06 17:19:29.684 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-06 17:19:29.688 +04:00 [DBG] Start authorize request
2019-05-06 17:19:29.689 +04:00 [DBG] No user present in authorize request
2019-05-06 17:19:29.691 +04:00 [DBG] Start authorize request protocol validation
2019-05-06 17:19:29.799 +04:00 [DBG] StudLab found in database: true
2019-05-06 17:19:29.800 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-06 17:19:29.805 +04:00 [DBG] Checking for PKCE parameters
2019-05-06 17:19:29.806 +04:00 [DBG] No PKCE used.
2019-05-06 17:19:29.839 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-06 17:19:29.858 +04:00 [DBG] Found [] API scopes in database
2019-05-06 17:19:29.864 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-06 17:19:29.869 +04:00 [DBG] Found [] API scopes in database
2019-05-06 17:19:29.871 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-06 17:19:29.877 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK8_ZtyD7ZkGcSMJCCISUmMuWBNyyzXCRr7RMNitpQluOKRlxC8TGO50u4TNmtoDRRrvyQg9UMyFRKkU4Mlib9zRpHdXJJ9En3Q8YnWxWhksAIOU6kf1yPGegVBxk1KrBqbKMWzhBwk81DqVLMXcheYJj5JcSfRdf2xY7vG-GHSO_hIzdDvy5ywMl500CZbXwO5JTiku-yK8pgxKx_bd4Hq1pVBbNkuw8mvWsV-OdpoNcmVeQB3EpX80aPEkdR2y-fHkXDBDwlFmN-iLqJcH02jnADeZawMKDQbsMKI2pmRcZ3TV0Fb0yD8Ph2Rr-wAgDdjY","UiLocales":null,"Nonce":"636927455696169602.MmUxMjc0YTMtNWQ5Zi00Yjk2LTg1OWUtYmM3NWZkOTI4NThmMGIxYTliNTUtNTliYi00NGM4LWJkN2ItODFkMjYxODEwYmJm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636927455696169602.MmUxMjc0YTMtNWQ5Zi00Yjk2LTg1OWUtYmM3NWZkOTI4NThmMGIxYTliNTUtNTliYi00NGM4LWJkN2ItODFkMjYxODEwYmJm","state":"CfDJ8D73mgAamspIvsbnstRoK8_ZtyD7ZkGcSMJCCISUmMuWBNyyzXCRr7RMNitpQluOKRlxC8TGO50u4TNmtoDRRrvyQg9UMyFRKkU4Mlib9zRpHdXJJ9En3Q8YnWxWhksAIOU6kf1yPGegVBxk1KrBqbKMWzhBwk81DqVLMXcheYJj5JcSfRdf2xY7vG-GHSO_hIzdDvy5ywMl500CZbXwO5JTiku-yK8pgxKx_bd4Hq1pVBbNkuw8mvWsV-OdpoNcmVeQB3EpX80aPEkdR2y-fHkXDBDwlFmN-iLqJcH02jnADeZawMKDQbsMKI2pmRcZ3TV0Fb0yD8Ph2Rr-wAgDdjY","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-06 17:19:29.914 +04:00 [INF] Showing login: User is not authenticated
2019-05-06 17:27:39.402 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-06 17:27:39.568 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-06 17:27:39.570 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-06 17:27:39.571 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-06 17:27:39.573 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-06 17:27:39.575 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-06 17:27:39.578 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-06 17:27:41.028 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-06 17:27:41.072 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-06 17:27:41.091 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-06 17:27:41.370 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-06 17:27:41.622 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-06 17:27:41.667 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-06 17:27:41.730 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-06 17:27:41.767 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-06 17:27:41.788 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-06 17:27:41.955 +04:00 [DBG] Starting grant removal
2019-05-06 17:27:46.597 +04:00 [DBG] Login Url: /Account/Login
2019-05-06 17:27:46.605 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-06 17:27:46.610 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-06 17:27:46.611 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-06 17:27:46.613 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-06 17:27:46.614 +04:00 [DBG] Error Url: /home/error
2019-05-06 17:27:46.616 +04:00 [DBG] Error Id Parameter: errorId
2019-05-06 17:27:46.692 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-06 17:27:46.711 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-06 17:27:46.714 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-06 17:27:46.729 +04:00 [DBG] Start discovery request
2019-05-06 17:27:48.185 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-05-06 17:27:48.863 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-06 17:27:48.883 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-06 17:27:48.887 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-06 17:27:48.901 +04:00 [DBG] Start key discovery request
2019-05-06 17:27:49.153 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-06 17:27:49.168 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-06 17:27:49.171 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-06 17:27:49.188 +04:00 [DBG] Start authorize request
2019-05-06 17:27:49.224 +04:00 [DBG] No user present in authorize request
2019-05-06 17:27:49.248 +04:00 [DBG] Start authorize request protocol validation
2019-05-06 17:27:50.191 +04:00 [DBG] StudLab found in database: true
2019-05-06 17:27:50.212 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-06 17:27:50.238 +04:00 [DBG] Checking for PKCE parameters
2019-05-06 17:27:50.249 +04:00 [DBG] No PKCE used.
2019-05-06 17:27:50.418 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-06 17:27:50.697 +04:00 [DBG] Found [] API scopes in database
2019-05-06 17:27:50.869 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-06 17:27:50.928 +04:00 [DBG] Found [] API scopes in database
2019-05-06 17:27:50.950 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-06 17:27:51.010 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK89BJd6MmGkb9JAaxBkxc5bEJwCS8D2V9zyUYQcDm4tdkiDtx8qFR_42-wW2tcbL0EelgysXVFiiP9JzR4gg24gROLsPiTiAMUMdn7u88lZnGbn2NZKyy3Fv57EKMzXhzF5eDz6hgixbj3fh7-kU6bEkiyyiIJ5gN6fiddVeDpPRq825wttXc1z-wAl8yrIV42pe8QjnbeaO7UwareLDaUjefoLw-bXKBw25WnFqqnkBcy-B6_CMm9cJTnLg9Y9U4wDmLv0VFZIIaMPT9lZz9izMEn_UUcgpzeB_x6q6JASSO0B6WsSXZquf8_n2JyZjRMw","UiLocales":null,"Nonce":"636927460690449573.NDkyNTE2NTctNjZiMi00OTVkLTliNmItYWI0MGEwNzZjY2VhOTRhNzkxZWMtZDdhZC00ZmYwLWJlMDYtMmI3YzRkZTEzN2Ji","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636927460690449573.NDkyNTE2NTctNjZiMi00OTVkLTliNmItYWI0MGEwNzZjY2VhOTRhNzkxZWMtZDdhZC00ZmYwLWJlMDYtMmI3YzRkZTEzN2Ji","state":"CfDJ8D73mgAamspIvsbnstRoK89BJd6MmGkb9JAaxBkxc5bEJwCS8D2V9zyUYQcDm4tdkiDtx8qFR_42-wW2tcbL0EelgysXVFiiP9JzR4gg24gROLsPiTiAMUMdn7u88lZnGbn2NZKyy3Fv57EKMzXhzF5eDz6hgixbj3fh7-kU6bEkiyyiIJ5gN6fiddVeDpPRq825wttXc1z-wAl8yrIV42pe8QjnbeaO7UwareLDaUjefoLw-bXKBw25WnFqqnkBcy-B6_CMm9cJTnLg9Y9U4wDmLv0VFZIIaMPT9lZz9izMEn_UUcgpzeB_x6q6JASSO0B6WsSXZquf8_n2JyZjRMw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-06 17:27:51.335 +04:00 [INF] Showing login: User is not authenticated
2019-05-06 17:27:51.482 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-06 17:27:54.796 +04:00 [DBG] Augmenting SignInContext
2019-05-06 17:27:54.804 +04:00 [DBG] Adding idp claim with value: local
2019-05-06 17:27:54.805 +04:00 [DBG] Adding amr claim with value: pwd
2019-05-06 17:27:54.812 +04:00 [DBG] Adding auth_time claim with value: 1557149274
2019-05-06 17:27:54.850 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-06 17:27:54.908 +04:00 [INF] {"Username":"dereguzov1@yandex.ru","Provider":null,"ProviderUserId":null,"SubjectId":"4","DisplayName":"dereguzov1@yandex.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLMI4QG6D922:00000003","TimeStamp":"2019-05-06T13:27:54.0000000Z","ProcessId":3124,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-06 17:27:54.993 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-05-06 17:27:55.003 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-05-06 17:27:55.013 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-05-06 17:27:55.035 +04:00 [DBG] Start authorize callback request
2019-05-06 17:27:55.050 +04:00 [DBG] User in authorize request: 4
2019-05-06 17:27:55.051 +04:00 [DBG] Start authorize request protocol validation
2019-05-06 17:27:55.073 +04:00 [DBG] StudLab found in database: true
2019-05-06 17:27:55.075 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-06 17:27:55.081 +04:00 [DBG] Checking for PKCE parameters
2019-05-06 17:27:55.083 +04:00 [DBG] No PKCE used.
2019-05-06 17:27:55.088 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-06 17:27:55.095 +04:00 [DBG] Found [] API scopes in database
2019-05-06 17:27:55.104 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-06 17:27:55.112 +04:00 [DBG] Found [] API scopes in database
2019-05-06 17:27:55.115 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-06 17:27:55.119 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"4","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK89BJd6MmGkb9JAaxBkxc5bEJwCS8D2V9zyUYQcDm4tdkiDtx8qFR_42-wW2tcbL0EelgysXVFiiP9JzR4gg24gROLsPiTiAMUMdn7u88lZnGbn2NZKyy3Fv57EKMzXhzF5eDz6hgixbj3fh7-kU6bEkiyyiIJ5gN6fiddVeDpPRq825wttXc1z-wAl8yrIV42pe8QjnbeaO7UwareLDaUjefoLw-bXKBw25WnFqqnkBcy-B6_CMm9cJTnLg9Y9U4wDmLv0VFZIIaMPT9lZz9izMEn_UUcgpzeB_x6q6JASSO0B6WsSXZquf8_n2JyZjRMw","UiLocales":null,"Nonce":"636927460690449573.NDkyNTE2NTctNjZiMi00OTVkLTliNmItYWI0MGEwNzZjY2VhOTRhNzkxZWMtZDdhZC00ZmYwLWJlMDYtMmI3YzRkZTEzN2Ji","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"c4f211063f7a1be2d88d48ed6516c4da","Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636927460690449573.NDkyNTE2NTctNjZiMi00OTVkLTliNmItYWI0MGEwNzZjY2VhOTRhNzkxZWMtZDdhZC00ZmYwLWJlMDYtMmI3YzRkZTEzN2Ji","state":"CfDJ8D73mgAamspIvsbnstRoK89BJd6MmGkb9JAaxBkxc5bEJwCS8D2V9zyUYQcDm4tdkiDtx8qFR_42-wW2tcbL0EelgysXVFiiP9JzR4gg24gROLsPiTiAMUMdn7u88lZnGbn2NZKyy3Fv57EKMzXhzF5eDz6hgixbj3fh7-kU6bEkiyyiIJ5gN6fiddVeDpPRq825wttXc1z-wAl8yrIV42pe8QjnbeaO7UwareLDaUjefoLw-bXKBw25WnFqqnkBcy-B6_CMm9cJTnLg9Y9U4wDmLv0VFZIIaMPT9lZz9izMEn_UUcgpzeB_x6q6JASSO0B6WsSXZquf8_n2JyZjRMw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-06 17:27:55.269 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-05-06 17:27:55.298 +04:00 [DBG] Creating Hybrid Flow response.
2019-05-06 17:27:55.427 +04:00 [DBG] T1OsxBYdZzbCKMiov5RbPyOMRguDqQ6CG4qRPtnO7BI= not found in database
2019-05-06 17:27:55.596 +04:00 [DBG] Creating Implicit Flow response.
2019-05-06 17:27:55.623 +04:00 [DBG] Getting claims for identity token for subject: 4 and client: StudLab
2019-05-06 17:27:55.680 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-06 17:27:55.929 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"4","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****ib_A","$type":"Token"},{"TokenType":"code","TokenValue":"****6131","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLMI4QG6D922:00000004","TimeStamp":"2019-05-06T13:27:55.0000000Z","ProcessId":3124,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-06 17:27:55.949 +04:00 [INF] Authorize endpoint response
{"SubjectId":"4","ClientId":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8D73mgAamspIvsbnstRoK89BJd6MmGkb9JAaxBkxc5bEJwCS8D2V9zyUYQcDm4tdkiDtx8qFR_42-wW2tcbL0EelgysXVFiiP9JzR4gg24gROLsPiTiAMUMdn7u88lZnGbn2NZKyy3Fv57EKMzXhzF5eDz6hgixbj3fh7-kU6bEkiyyiIJ5gN6fiddVeDpPRq825wttXc1z-wAl8yrIV42pe8QjnbeaO7UwareLDaUjefoLw-bXKBw25WnFqqnkBcy-B6_CMm9cJTnLg9Y9U4wDmLv0VFZIIaMPT9lZz9izMEn_UUcgpzeB_x6q6JASSO0B6WsSXZquf8_n2JyZjRMw","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-06 17:27:56.021 +04:00 [DBG] Augmenting SignInContext
2019-05-06 17:27:56.035 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-06 17:27:56.541 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-06 17:27:56.565 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-06 17:27:56.573 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-06 17:27:56.621 +04:00 [DBG] Start token request.
2019-05-06 17:27:56.658 +04:00 [DBG] Start client validation
2019-05-06 17:27:56.680 +04:00 [DBG] Start parsing Basic Authentication secret
2019-05-06 17:27:56.698 +04:00 [DBG] Start parsing for secret in post body
2019-05-06 17:27:56.702 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-06 17:27:56.705 +04:00 [DBG] Secret id found: StudLab
2019-05-06 17:27:56.716 +04:00 [DBG] StudLab found in database: true
2019-05-06 17:27:56.726 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-06 17:27:56.774 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-06 17:27:56.775 +04:00 [DBG] Client validation success
2019-05-06 17:27:56.780 +04:00 [INF] {"ClientId":"StudLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLMI4QG6D921:00000003","TimeStamp":"2019-05-06T13:27:56.0000000Z","ProcessId":3124,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-06 17:27:56.818 +04:00 [DBG] Start token request validation
2019-05-06 17:27:56.859 +04:00 [DBG] Start validation of authorization code token request
2019-05-06 17:27:56.909 +04:00 [DBG] T1OsxBYdZzbCKMiov5RbPyOMRguDqQ6CG4qRPtnO7BI= found in database: true
2019-05-06 17:27:56.969 +04:00 [DBG] removing T1OsxBYdZzbCKMiov5RbPyOMRguDqQ6CG4qRPtnO7BI= persisted grant from database
2019-05-06 17:27:57.008 +04:00 [DBG] Validation of authorization code token request success
2019-05-06 17:27:57.029 +04:00 [INF] Token request validation success
{"ClientId":"StudLab","ClientName":"StudLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"8799fd65e0ec78bca6d81ffb96b2b9a0991a00d5f2c4bd3f6b31ef86e90d6131","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"StudLab","client_secret":"***REDACTED***","code":"8799fd65e0ec78bca6d81ffb96b2b9a0991a00d5f2c4bd3f6b31ef86e90d6131","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-05-06 17:27:57.152 +04:00 [DBG] StudLab found in database: true
2019-05-06 17:27:57.153 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-06 17:27:57.178 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-06 17:27:57.198 +04:00 [DBG] Found [] API scopes in database
2019-05-06 17:27:57.244 +04:00 [DBG] Getting claims for access token for client: StudLab
2019-05-06 17:27:57.246 +04:00 [DBG] Getting claims for access token for subject: 4
2019-05-06 17:27:57.279 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-06 17:27:57.328 +04:00 [DBG] Creating refresh token
2019-05-06 17:27:57.329 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-05-06 17:27:57.377 +04:00 [DBG] 9UCP6N9r8txfSzupVy0U5CMD+CqqzRhV5A3c4ZjazfM= not found in database
2019-05-06 17:27:57.415 +04:00 [DBG] StudLab found in database: true
2019-05-06 17:27:57.416 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-06 17:27:57.427 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-06 17:27:57.434 +04:00 [DBG] Found [] API scopes in database
2019-05-06 17:27:57.438 +04:00 [DBG] Getting claims for identity token for subject: 4 and client: StudLab
2019-05-06 17:27:57.464 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-06 17:27:57.488 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****scOw","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****9120","$type":"Token"},{"TokenType":"access_token","TokenValue":"****7ALg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLMI4QG6D921:00000003","TimeStamp":"2019-05-06T13:27:57.0000000Z","ProcessId":3124,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-06 17:27:57.517 +04:00 [DBG] Token request success.
2019-05-06 17:27:57.560 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-05-06 17:27:57.570 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-05-06 17:27:57.573 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-05-06 17:27:57.608 +04:00 [DBG] Start userinfo request
2019-05-06 17:27:57.619 +04:00 [DBG] Bearer token found in header
2019-05-06 17:27:57.835 +04:00 [DBG] StudLab found in database: true
2019-05-06 17:27:57.836 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-06 17:27:57.860 +04:00 [DBG] StudLab found in database: true
2019-05-06 17:27:57.861 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-06 17:27:57.905 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-05-06 17:27:57.918 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1557149277,"exp":1557152877,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"StudLab","sub":"4","auth_time":1557149274,"idp":"local","AspNet.Identity.SecurityStamp":"SMEWCFOPKGR2ER6A74KB2DZBDEUNFFQJ","role":"GodAdmin","preferred_username":"dereguzov1@yandex.ru","name":"dereguzov1@yandex.ru","email":"dereguzov1@yandex.ru","email_verified":false,"given_name":"dereguzov1@yandex.ru","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-05-06 17:27:57.977 +04:00 [DBG] Creating userinfo response
2019-05-06 17:27:57.992 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-06 17:27:58.004 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-06 17:27:58.023 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-06 17:27:58.030 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-05-06 17:27:58.033 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-06 17:27:58.041 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-06 17:27:58.060 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email
2019-05-06 17:27:58.064 +04:00 [DBG] End userinfo request
2019-05-10 22:04:15.805 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-10 22:04:16.041 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-10 22:04:16.043 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-10 22:04:16.045 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-10 22:04:16.046 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-10 22:04:16.047 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-10 22:04:16.047 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-10 22:04:16.918 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 22:04:17.505 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 22:04:17.627 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 22:04:17.887 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 22:04:18.085 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 22:04:18.131 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 22:04:18.160 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 22:04:18.188 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 22:04:18.213 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 22:04:18.425 +04:00 [DBG] Starting grant removal
2019-05-10 22:10:26.830 +04:00 [DBG] Login Url: /Account/Login
2019-05-10 22:10:26.855 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-10 22:10:26.862 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-10 22:10:26.864 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-10 22:10:26.866 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-10 22:10:26.873 +04:00 [DBG] Error Url: /home/error
2019-05-10 22:10:26.878 +04:00 [DBG] Error Id Parameter: errorId
2019-05-10 22:10:28.083 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-10 22:10:29.487 +04:00 [ERR] The view 'Index' was not found. Searched locations: ["/Views/Home/Index.cshtml","/Views/Shared/Index.cshtml","/Pages/Shared/Index.cshtml"]
2019-05-10 22:10:34.075 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The view 'Index' was not found. The following locations were searched:
/Views/Home/Index.cshtml
/Views/Shared/Index.cshtml
/Pages/Shared/Index.cshtml
   at Microsoft.AspNetCore.Mvc.ViewEngines.ViewEngineResult.EnsureSuccessful(IEnumerable`1 originalLocations)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-05-10 22:10:51.659 +04:00 [ERR] The view 'Index' was not found. Searched locations: ["/Views/Home/Index.cshtml","/Views/Shared/Index.cshtml","/Pages/Shared/Index.cshtml"]
2019-05-10 22:10:53.602 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The view 'Index' was not found. The following locations were searched:
/Views/Home/Index.cshtml
/Views/Shared/Index.cshtml
/Pages/Shared/Index.cshtml
   at Microsoft.AspNetCore.Mvc.ViewEngines.ViewEngineResult.EnsureSuccessful(IEnumerable`1 originalLocations)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-05-10 22:11:03.979 +04:00 [ERR] The view 'Index' was not found. Searched locations: ["/Views/Home/Index.cshtml","/Views/Shared/Index.cshtml","/Pages/Shared/Index.cshtml"]
2019-05-10 22:11:05.454 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The view 'Index' was not found. The following locations were searched:
/Views/Home/Index.cshtml
/Views/Shared/Index.cshtml
/Pages/Shared/Index.cshtml
   at Microsoft.AspNetCore.Mvc.ViewEngines.ViewEngineResult.EnsureSuccessful(IEnumerable`1 originalLocations)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-05-10 22:11:22.761 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-05-10 22:11:22.767 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-05-10 22:11:22.773 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-05-10 22:32:20.290 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-10 22:32:20.482 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-10 22:32:20.484 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-10 22:32:20.485 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-10 22:32:20.486 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-10 22:32:20.487 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-10 22:32:20.489 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-10 22:32:21.417 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 22:32:21.456 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 22:32:21.463 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 22:32:21.751 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 22:32:22.008 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 22:32:22.055 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 22:32:22.080 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 22:32:22.109 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 22:32:22.128 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 22:32:22.464 +04:00 [DBG] Starting grant removal
2019-05-10 22:32:53.542 +04:00 [DBG] Login Url: /Account/Login
2019-05-10 22:32:53.574 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-10 22:32:53.576 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-10 22:32:53.578 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-10 22:32:53.580 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-10 22:32:53.584 +04:00 [DBG] Error Url: /home/error
2019-05-10 22:32:53.589 +04:00 [DBG] Error Id Parameter: errorId
2019-05-10 22:32:53.753 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-10 22:33:04.175 +04:00 [DBG] Augmenting SignInContext
2019-05-10 22:33:04.308 +04:00 [DBG] Adding idp claim with value: local
2019-05-10 22:33:04.309 +04:00 [DBG] Adding amr claim with value: pwd
2019-05-10 22:33:04.315 +04:00 [DBG] Adding auth_time claim with value: 1557513184
2019-05-10 22:33:04.372 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-10 22:33:04.519 +04:00 [INF] {"Username":"dereguzov1@yandex.ru","Provider":null,"ProviderUserId":null,"SubjectId":"4","DisplayName":"dereguzov1@yandex.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLMLENKTLC9C:00000003","TimeStamp":"2019-05-10T18:33:04.0000000Z","ProcessId":10608,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-10 22:33:08.639 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentException: Value cannot be null or empty.
Parameter name: url
   at Microsoft.AspNetCore.Mvc.ControllerBase.Redirect(String url)
   at AuthServiceServer.Controllers.AccountController.Login(LoginModel model) in D:\Projects\StudLab\AuthServiceServer\Controllers\AccountController.cs:line 54
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-05-10 22:47:40.148 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-10 22:47:40.347 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-10 22:47:40.350 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-10 22:47:40.351 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-10 22:47:40.352 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-10 22:47:40.354 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-10 22:47:40.356 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-10 22:47:41.148 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 22:47:41.180 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 22:47:41.186 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 22:47:41.401 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 22:47:41.572 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 22:47:41.611 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 22:47:41.629 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 22:47:41.650 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 22:47:41.667 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 22:47:41.806 +04:00 [DBG] Starting grant removal
2019-05-10 22:47:45.305 +04:00 [DBG] Login Url: /Account/Login
2019-05-10 22:47:45.323 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-10 22:47:45.327 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-10 22:47:45.329 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-10 22:47:45.331 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-10 22:47:45.332 +04:00 [DBG] Error Url: /home/error
2019-05-10 22:47:45.333 +04:00 [DBG] Error Id Parameter: errorId
2019-05-10 22:47:45.468 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-10 22:48:02.844 +04:00 [DBG] Augmenting SignInContext
2019-05-10 22:48:02.875 +04:00 [DBG] Adding idp claim with value: local
2019-05-10 22:48:02.876 +04:00 [DBG] Adding amr claim with value: pwd
2019-05-10 22:48:02.878 +04:00 [DBG] Adding auth_time claim with value: 1557514082
2019-05-10 22:48:02.909 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-10 22:48:03.003 +04:00 [INF] {"Username":"dereguzov1@yandex.ru","Provider":null,"ProviderUserId":null,"SubjectId":"4","DisplayName":"dereguzov1@yandex.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLMLEVUM37UO:00000003","TimeStamp":"2019-05-10T18:48:02.0000000Z","ProcessId":2776,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-10 22:48:07.280 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentException: Value cannot be null or empty.
Parameter name: url
   at Microsoft.AspNetCore.Mvc.ControllerBase.Redirect(String url)
   at AuthServiceServer.Controllers.AccountController.Login(LoginModel model) in D:\Projects\StudLab\AuthServiceServer\Controllers\AccountController.cs:line 54
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-05-10 23:16:19.792 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-10 23:16:19.926 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-10 23:16:19.929 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-10 23:16:19.930 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-10 23:16:19.931 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-10 23:16:19.933 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-10 23:16:19.934 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-10 23:16:20.676 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 23:16:20.707 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 23:16:20.712 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 23:16:20.953 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:16:21.153 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:16:21.194 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:16:21.220 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:16:21.250 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:16:21.268 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:16:21.392 +04:00 [DBG] Starting grant removal
2019-05-10 23:17:16.464 +04:00 [DBG] Login Url: /Account/Login
2019-05-10 23:17:16.470 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-10 23:17:16.474 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-10 23:17:16.477 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-10 23:17:16.478 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-10 23:17:16.479 +04:00 [DBG] Error Url: /home/error
2019-05-10 23:17:16.481 +04:00 [DBG] Error Id Parameter: errorId
2019-05-10 23:17:16.566 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-10 23:17:17.675 +04:00 [DBG] Augmenting SignInContext
2019-05-10 23:17:17.705 +04:00 [DBG] Adding idp claim with value: local
2019-05-10 23:17:17.706 +04:00 [DBG] Adding amr claim with value: pwd
2019-05-10 23:17:17.710 +04:00 [DBG] Adding auth_time claim with value: 1557515837
2019-05-10 23:17:17.748 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-10 23:17:17.868 +04:00 [INF] {"Username":"dereguzov1@yandex.ru","Provider":null,"ProviderUserId":null,"SubjectId":"4","DisplayName":"dereguzov1@yandex.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLMLFGEIFAI7:00000001","TimeStamp":"2019-05-10T19:17:17.0000000Z","ProcessId":5608,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-10 23:17:21.702 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentException: Value cannot be null or empty.
Parameter name: url
   at Microsoft.AspNetCore.Mvc.ControllerBase.Redirect(String url)
   at AuthServiceServer.Controllers.AccountController.Login(LoginModel model) in D:\Projects\StudLab\AuthServiceServer\Controllers\AccountController.cs:line 73
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-05-10 23:17:49.721 +04:00 [DBG] Augmenting SignInContext
2019-05-10 23:17:49.722 +04:00 [DBG] Adding idp claim with value: local
2019-05-10 23:17:49.725 +04:00 [DBG] Adding amr claim with value: pwd
2019-05-10 23:17:49.727 +04:00 [DBG] Adding auth_time claim with value: 1557515869
2019-05-10 23:17:49.730 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-10 23:17:49.739 +04:00 [INF] {"Username":"dereguzov1@yandex.ru","Provider":null,"ProviderUserId":null,"SubjectId":"4","DisplayName":"dereguzov1@yandex.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLMLFGEIFAI7:00000005","TimeStamp":"2019-05-10T19:17:49.0000000Z","ProcessId":5608,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-10 23:17:53.890 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentException: Value cannot be null or empty.
Parameter name: url
   at Microsoft.AspNetCore.Mvc.ControllerBase.Redirect(String url)
   at AuthServiceServer.Controllers.AccountController.Login(LoginModel model) in D:\Projects\StudLab\AuthServiceServer\Controllers\AccountController.cs:line 73
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-05-10 23:18:04.383 +04:00 [DBG] Augmenting SignInContext
2019-05-10 23:18:04.384 +04:00 [DBG] Adding idp claim with value: local
2019-05-10 23:18:04.387 +04:00 [DBG] Adding amr claim with value: pwd
2019-05-10 23:18:04.389 +04:00 [DBG] Adding auth_time claim with value: 1557515884
2019-05-10 23:18:04.391 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-10 23:19:42.688 +04:00 [INF] {"Username":"dereguzov1@yandex.ru","Provider":null,"ProviderUserId":null,"SubjectId":"4","DisplayName":"dereguzov1@yandex.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLMLFGEIFAI7:00000006","TimeStamp":"2019-05-10T19:19:42.0000000Z","ProcessId":5608,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-10 23:20:29.404 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-10 23:20:29.560 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-10 23:20:29.562 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-10 23:20:29.563 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-10 23:20:29.564 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-10 23:20:29.565 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-10 23:20:29.566 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-10 23:20:30.377 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 23:20:30.410 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 23:20:30.417 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 23:20:30.647 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:20:30.866 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:20:30.925 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:20:30.968 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:20:31.004 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:20:31.036 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:20:31.267 +04:00 [DBG] Starting grant removal
2019-05-10 23:20:39.668 +04:00 [DBG] Login Url: /Account/Login
2019-05-10 23:20:39.675 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-10 23:20:39.679 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-10 23:20:39.681 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-10 23:20:39.682 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-10 23:20:39.684 +04:00 [DBG] Error Url: /home/error
2019-05-10 23:20:39.685 +04:00 [DBG] Error Id Parameter: errorId
2019-05-10 23:20:39.820 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-10 23:26:06.516 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-10 23:26:06.668 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-10 23:26:06.669 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-10 23:26:06.671 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-10 23:26:06.672 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-10 23:26:06.673 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-10 23:26:06.674 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-10 23:26:07.508 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 23:26:07.540 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 23:26:07.544 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 23:26:07.765 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:26:07.963 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:26:07.999 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:26:08.024 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:26:08.059 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:26:08.083 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:26:08.253 +04:00 [DBG] Starting grant removal
2019-05-10 23:27:47.196 +04:00 [DBG] Login Url: /Account/Login
2019-05-10 23:27:47.203 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-10 23:27:47.207 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-10 23:27:47.209 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-10 23:27:47.210 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-10 23:27:47.212 +04:00 [DBG] Error Url: /home/error
2019-05-10 23:27:47.214 +04:00 [DBG] Error Id Parameter: errorId
2019-05-10 23:27:47.397 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-10 23:36:55.650 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-10 23:36:55.781 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-10 23:36:55.783 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-10 23:36:55.783 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-10 23:36:55.784 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-10 23:36:55.785 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-10 23:36:55.785 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-10 23:36:56.447 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 23:36:56.478 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 23:36:56.485 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 23:36:56.674 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:36:56.860 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:36:56.901 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:36:56.934 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:36:56.960 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:36:56.978 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:36:57.107 +04:00 [DBG] Starting grant removal
2019-05-10 23:37:13.985 +04:00 [DBG] Login Url: /Account/Login
2019-05-10 23:37:13.991 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-10 23:37:13.994 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-10 23:37:13.995 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-10 23:37:13.996 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-10 23:37:13.998 +04:00 [DBG] Error Url: /home/error
2019-05-10 23:37:14.000 +04:00 [DBG] Error Id Parameter: errorId
2019-05-10 23:37:14.165 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-10 23:37:28.734 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-05-10 23:37:28.739 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-05-10 23:37:28.743 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-05-10 23:38:51.839 +04:00 [DBG] Augmenting SignInContext
2019-05-10 23:38:51.875 +04:00 [DBG] Adding idp claim with value: local
2019-05-10 23:38:51.876 +04:00 [DBG] Adding amr claim with value: pwd
2019-05-10 23:38:51.880 +04:00 [DBG] Adding auth_time claim with value: 1557517131
2019-05-10 23:38:51.903 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-10 23:38:56.416 +04:00 [INF] {"Username":"dereguzov1@yandex.ru","Provider":null,"ProviderUserId":null,"SubjectId":"4","DisplayName":"dereguzov1@yandex.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLMLFRJE834G:00000014","TimeStamp":"2019-05-10T19:38:56.0000000Z","ProcessId":14260,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-10 23:39:03.255 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-05-10 23:39:03.264 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-05-10 23:39:03.271 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-05-10 23:46:31.213 +04:00 [DBG] Augmenting SignInContext
2019-05-10 23:46:31.214 +04:00 [DBG] Adding idp claim with value: local
2019-05-10 23:46:31.218 +04:00 [DBG] Adding amr claim with value: pwd
2019-05-10 23:46:31.220 +04:00 [DBG] Adding auth_time claim with value: 1557517591
2019-05-10 23:46:31.224 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-10 23:46:31.234 +04:00 [INF] {"Username":"dereguzov1@yandex.ru","Provider":null,"ProviderUserId":null,"SubjectId":"4","DisplayName":"dereguzov1@yandex.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLMLFRJE834H:00000021","TimeStamp":"2019-05-10T19:46:31.0000000Z","ProcessId":14260,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-10 23:49:10.176 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-10 23:49:10.341 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-10 23:49:10.343 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-10 23:49:10.344 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-10 23:49:10.345 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-10 23:49:10.345 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-10 23:49:10.346 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-10 23:49:11.321 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 23:49:11.371 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 23:49:11.377 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 23:49:11.623 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:49:11.853 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:49:11.893 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:49:11.919 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:49:11.950 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:49:11.980 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:49:12.219 +04:00 [DBG] Starting grant removal
2019-05-10 23:49:20.820 +04:00 [DBG] Login Url: /Account/Login
2019-05-10 23:49:20.831 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-10 23:49:20.837 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-10 23:49:20.840 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-10 23:49:20.841 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-10 23:49:20.848 +04:00 [DBG] Error Url: /home/error
2019-05-10 23:49:20.849 +04:00 [DBG] Error Id Parameter: errorId
2019-05-10 23:49:21.118 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-10 23:49:26.164 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-05-10 23:49:26.170 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-05-10 23:49:26.176 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-05-10 23:49:50.163 +04:00 [WRN] User null password validation failed: PasswordTooShort;PasswordRequiresDigit.
2019-05-10 23:49:55.288 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentException: Value cannot be null or empty.
Parameter name: url
   at Microsoft.AspNetCore.Mvc.ControllerBase.Redirect(String url)
   at AuthServiceServer.Controllers.AccountController.Registration(RegisterModel model) in D:\Projects\StudLab\AuthServiceServer\Controllers\AccountController.cs:line 114
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-05-10 23:50:52.886 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-10 23:50:53.079 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-10 23:50:53.081 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-10 23:50:53.083 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-10 23:50:53.084 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-10 23:50:53.085 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-10 23:50:53.086 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-10 23:50:54.215 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 23:50:54.252 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 23:50:54.257 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 23:50:54.488 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:50:54.690 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:50:54.731 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:50:54.751 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:50:54.778 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:50:54.796 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:50:54.951 +04:00 [DBG] Starting grant removal
2019-05-10 23:50:57.050 +04:00 [DBG] Login Url: /Account/Login
2019-05-10 23:50:57.061 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-10 23:50:57.065 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-10 23:50:57.066 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-10 23:50:57.068 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-10 23:50:57.073 +04:00 [DBG] Error Url: /home/error
2019-05-10 23:50:57.078 +04:00 [DBG] Error Id Parameter: errorId
2019-05-10 23:50:57.188 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-10 23:51:15.096 +04:00 [INF] {"Username":"test@test.test","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLMLG388PE1C:00000007","TimeStamp":"2019-05-10T19:51:15.0000000Z","ProcessId":6288,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-05-10 23:51:29.994 +04:00 [WRN] User null password validation failed: PasswordTooShort;PasswordRequiresDigit.
2019-05-10 23:51:58.111 +04:00 [INF] {"Username":"test@test.test","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLMLG388PE1C:0000000E","TimeStamp":"2019-05-10T19:51:58.0000000Z","ProcessId":6288,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-05-10 23:52:37.606 +04:00 [WRN] User null password validation failed: PasswordTooShort;PasswordRequiresDigit.
2019-05-10 23:53:26.909 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at AuthServiceServer.Controllers.AccountController.Registration(RegisterModel model)
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-05-10 23:53:30.931 +04:00 [WRN] User null password validation failed: PasswordTooShort;PasswordRequiresDigit.
2019-05-10 23:53:35.277 +04:00 [WRN] User null password validation failed: PasswordTooShort;PasswordRequiresDigit.
2019-05-10 23:57:13.453 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-10 23:57:13.590 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-10 23:57:13.592 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-10 23:57:13.593 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-10 23:57:13.593 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-10 23:57:13.594 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-10 23:57:13.595 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-10 23:57:14.358 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 23:57:14.390 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 23:57:14.402 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 23:57:15.317 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:57:15.539 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:57:15.586 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:57:15.611 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:57:15.641 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:57:15.699 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:57:15.901 +04:00 [DBG] Starting grant removal
2019-05-10 23:57:29.984 +04:00 [DBG] Login Url: /Account/Login
2019-05-10 23:57:29.993 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-10 23:57:29.995 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-10 23:57:30.007 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-10 23:57:30.010 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-10 23:57:30.013 +04:00 [DBG] Error Url: /home/error
2019-05-10 23:57:30.014 +04:00 [DBG] Error Id Parameter: errorId
2019-05-10 23:57:30.110 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-10 23:57:49.909 +04:00 [DBG] Augmenting SignInContext
2019-05-10 23:57:49.942 +04:00 [DBG] Adding idp claim with value: local
2019-05-10 23:57:49.943 +04:00 [DBG] Adding amr claim with value: pwd
2019-05-10 23:57:49.948 +04:00 [DBG] Adding auth_time claim with value: 1557518269
2019-05-10 23:57:50.271 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-10 23:57:57.687 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-05-10 23:57:57.694 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-05-10 23:57:57.698 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-05-10 23:58:13.161 +04:00 [DBG] Augmenting SignInContext
2019-05-10 23:58:13.162 +04:00 [DBG] Adding idp claim with value: local
2019-05-10 23:58:13.165 +04:00 [DBG] Adding amr claim with value: pwd
2019-05-10 23:58:13.167 +04:00 [DBG] Adding auth_time claim with value: 1557518293
2019-05-10 23:58:13.169 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-10 23:58:13.601 +04:00 [INF] {"Username":"test@test.test","Provider":null,"ProviderUserId":null,"SubjectId":"1002","DisplayName":"test@test.test","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLMLG6TR92OC:0000000B","TimeStamp":"2019-05-10T19:58:13.0000000Z","ProcessId":9848,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-10 23:59:25.562 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-10 23:59:25.929 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-10 23:59:25.947 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-10 23:59:25.952 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-10 23:59:25.954 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-10 23:59:25.960 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-10 23:59:25.961 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-10 23:59:27.364 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 23:59:27.421 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 23:59:27.427 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-10 23:59:27.745 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:59:27.993 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:59:28.037 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:59:28.059 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:59:28.083 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:59:28.101 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-10 23:59:28.284 +04:00 [DBG] Starting grant removal
2019-05-10 23:59:29.366 +04:00 [DBG] Login Url: /Account/Login
2019-05-10 23:59:29.377 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-10 23:59:29.381 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-10 23:59:29.383 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-10 23:59:29.384 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-10 23:59:29.388 +04:00 [DBG] Error Url: /home/error
2019-05-10 23:59:29.394 +04:00 [DBG] Error Id Parameter: errorId
2019-05-10 23:59:29.557 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-10 23:59:32.242 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-05-10 23:59:32.246 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-05-10 23:59:32.251 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-05-10 23:59:58.529 +04:00 [DBG] Augmenting SignInContext
2019-05-10 23:59:58.562 +04:00 [DBG] Adding idp claim with value: local
2019-05-10 23:59:58.563 +04:00 [DBG] Adding amr claim with value: pwd
2019-05-10 23:59:58.570 +04:00 [DBG] Adding auth_time claim with value: 1557518398
2019-05-10 23:59:58.599 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-12 13:36:49.176 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-12 13:36:50.016 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-12 13:36:50.024 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-12 13:36:50.037 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-12 13:36:50.046 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-12 13:36:50.053 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-12 13:36:50.064 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-12 13:36:53.306 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-12 13:36:53.400 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-12 13:36:53.429 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-12 13:36:53.962 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 13:36:54.593 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 13:36:54.683 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 13:36:54.740 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 13:36:54.823 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 13:36:54.908 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 13:36:55.361 +04:00 [DBG] Starting grant removal
2019-05-12 13:37:08.324 +04:00 [DBG] Login Url: /Account/Login
2019-05-12 13:37:08.342 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-12 13:37:08.421 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-12 13:37:08.431 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-12 13:37:08.439 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-12 13:37:08.454 +04:00 [DBG] Error Url: /home/error
2019-05-12 13:37:08.463 +04:00 [DBG] Error Id Parameter: errorId
2019-05-12 13:37:09.619 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-12 13:37:19.595 +04:00 [DBG] Augmenting SignInContext
2019-05-12 13:37:19.931 +04:00 [DBG] Adding idp claim with value: local
2019-05-12 13:37:19.936 +04:00 [DBG] Adding amr claim with value: pwd
2019-05-12 13:37:19.942 +04:00 [DBG] Adding auth_time claim with value: 1557653839
2019-05-12 13:37:20.034 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-12 13:37:20.320 +04:00 [INF] {"Username":"test@test.test.test","Provider":null,"ProviderUserId":null,"SubjectId":"1003","DisplayName":"test@test.test.test","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLMMNLJ07CJT:00000003","TimeStamp":"2019-05-12T09:37:20.0000000Z","ProcessId":14432,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-12 13:45:39.112 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-12 13:45:39.420 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-12 13:45:39.423 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-12 13:45:39.425 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-12 13:45:39.426 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-12 13:45:39.428 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-12 13:45:39.429 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-12 13:45:40.826 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-12 13:45:40.900 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-12 13:45:40.912 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-12 13:45:41.370 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 13:45:42.076 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 13:45:42.161 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 13:45:42.194 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 13:45:42.235 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 13:45:42.281 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 13:45:42.621 +04:00 [DBG] Starting grant removal
2019-05-12 13:49:13.647 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-12 13:49:14.062 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-12 13:49:14.076 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-12 13:49:14.080 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-12 13:49:14.083 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-12 13:49:14.084 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-12 13:49:14.089 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-12 13:49:15.525 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-12 13:49:15.603 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-12 13:49:15.613 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-12 13:49:16.180 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 13:49:16.583 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 13:49:16.671 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 13:49:16.720 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 13:49:16.765 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 13:49:16.797 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 13:49:17.048 +04:00 [DBG] Starting grant removal
2019-05-12 13:50:15.431 +04:00 [DBG] Login Url: /Account/Login
2019-05-12 13:50:15.447 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-12 13:50:15.452 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-12 13:50:15.455 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-12 13:50:15.461 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-12 13:50:15.464 +04:00 [DBG] Error Url: /home/error
2019-05-12 13:50:15.466 +04:00 [DBG] Error Id Parameter: errorId
2019-05-12 13:50:15.729 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-12 13:50:15.787 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-12 13:50:15.828 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-12 13:50:15.915 +04:00 [DBG] Start discovery request
2019-05-12 13:50:18.211 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-05-12 13:50:19.031 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-12 13:50:19.067 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-12 13:50:19.080 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-12 13:50:19.148 +04:00 [DBG] Start key discovery request
2019-05-12 13:50:19.604 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-12 13:50:19.628 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-12 13:50:19.633 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-12 13:50:19.653 +04:00 [DBG] Start authorize request
2019-05-12 13:50:19.708 +04:00 [DBG] User in authorize request: 1003
2019-05-12 13:50:19.731 +04:00 [DBG] Start authorize request protocol validation
2019-05-12 13:50:21.487 +04:00 [DBG] StudLab found in database: true
2019-05-12 13:50:21.519 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-12 13:50:21.547 +04:00 [DBG] Checking for PKCE parameters
2019-05-12 13:50:21.554 +04:00 [DBG] No PKCE used.
2019-05-12 13:50:21.776 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-12 13:50:21.990 +04:00 [DBG] Found [] API scopes in database
2019-05-12 13:50:22.026 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-12 13:50:22.035 +04:00 [DBG] Found [] API scopes in database
2019-05-12 13:50:22.070 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-12 13:50:22.148 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1003","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK89hGzrLO7Fd8EW4yvrjNgGPRp7VZ4fyUBm_1bbF-lvEvB6mYot88jAuGUDUwtvjjndnXucIUFiJ6P5LB179tDMJhlLlTyS44RCSwuVJ-4rYptjWOcA2kADmwRhRMyp3LibXxzjZiXMOShnuJv_si2onREEAGOH3zdlHNohuDdu70FMBfgqoLs5FkDmBGFxecqhbCO-N7s6EBqJO0XuiqmWPPJOXa75abSHMta64ivFeK01JpcZAGo4-ed7tN1FBL2a2mA_hw03sEEDMwSSHPUM9nMoQDLLEvrA8VHU1V0kQccP--8SYKaSE8cX62g24k3A","UiLocales":null,"Nonce":"636932514193963631.MWEzOWU1MGEtZTBkMC00YWQwLWFhN2UtNWQwMGRmZTViZTE0NWEzNTkxZDYtZWM4MC00NGJjLWEwMjYtOWY0NzJiYjkyN2E5","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a08fadb72d1792c6c27bf7b668a14b39","Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636932514193963631.MWEzOWU1MGEtZTBkMC00YWQwLWFhN2UtNWQwMGRmZTViZTE0NWEzNTkxZDYtZWM4MC00NGJjLWEwMjYtOWY0NzJiYjkyN2E5","state":"CfDJ8D73mgAamspIvsbnstRoK89hGzrLO7Fd8EW4yvrjNgGPRp7VZ4fyUBm_1bbF-lvEvB6mYot88jAuGUDUwtvjjndnXucIUFiJ6P5LB179tDMJhlLlTyS44RCSwuVJ-4rYptjWOcA2kADmwRhRMyp3LibXxzjZiXMOShnuJv_si2onREEAGOH3zdlHNohuDdu70FMBfgqoLs5FkDmBGFxecqhbCO-N7s6EBqJO0XuiqmWPPJOXa75abSHMta64ivFeK01JpcZAGo4-ed7tN1FBL2a2mA_hw03sEEDMwSSHPUM9nMoQDLLEvrA8VHU1V0kQccP--8SYKaSE8cX62g24k3A","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-12 13:50:22.409 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-05-12 13:50:22.444 +04:00 [DBG] Creating Hybrid Flow response.
2019-05-12 13:50:22.623 +04:00 [DBG] Djv8JqMdL7APMDsLT7HWPcAZmnoUPNy32aDLN4h/o7s= not found in database
2019-05-12 13:50:22.869 +04:00 [DBG] Creating Implicit Flow response.
2019-05-12 13:50:22.920 +04:00 [DBG] Getting claims for identity token for subject: 1003 and client: StudLab
2019-05-12 13:50:23.473 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-12 13:50:24.039 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"1003","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****uJrw","$type":"Token"},{"TokenType":"code","TokenValue":"****1c17","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLMMNSTOEB95:00000001","TimeStamp":"2019-05-12T09:50:23.0000000Z","ProcessId":15820,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-12 13:50:24.116 +04:00 [INF] Authorize endpoint response
{"SubjectId":"1003","ClientId":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8D73mgAamspIvsbnstRoK89hGzrLO7Fd8EW4yvrjNgGPRp7VZ4fyUBm_1bbF-lvEvB6mYot88jAuGUDUwtvjjndnXucIUFiJ6P5LB179tDMJhlLlTyS44RCSwuVJ-4rYptjWOcA2kADmwRhRMyp3LibXxzjZiXMOShnuJv_si2onREEAGOH3zdlHNohuDdu70FMBfgqoLs5FkDmBGFxecqhbCO-N7s6EBqJO0XuiqmWPPJOXa75abSHMta64ivFeK01JpcZAGo4-ed7tN1FBL2a2mA_hw03sEEDMwSSHPUM9nMoQDLLEvrA8VHU1V0kQccP--8SYKaSE8cX62g24k3A","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-12 13:50:24.348 +04:00 [DBG] Augmenting SignInContext
2019-05-12 13:50:24.490 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-12 13:50:25.700 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-12 13:50:25.730 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-12 13:50:25.738 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-12 13:50:25.793 +04:00 [DBG] Start token request.
2019-05-12 13:50:25.849 +04:00 [DBG] Start client validation
2019-05-12 13:50:25.901 +04:00 [DBG] Start parsing Basic Authentication secret
2019-05-12 13:50:25.930 +04:00 [DBG] Start parsing for secret in post body
2019-05-12 13:50:26.052 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-12 13:50:26.058 +04:00 [DBG] Secret id found: StudLab
2019-05-12 13:50:26.090 +04:00 [DBG] StudLab found in database: true
2019-05-12 13:50:26.092 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-12 13:50:26.144 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-12 13:50:26.146 +04:00 [DBG] Client validation success
2019-05-12 13:50:26.153 +04:00 [INF] {"ClientId":"StudLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLMMNSTOEB94:00000003","TimeStamp":"2019-05-12T09:50:26.0000000Z","ProcessId":15820,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-12 13:50:26.201 +04:00 [DBG] Start token request validation
2019-05-12 13:50:26.254 +04:00 [DBG] Start validation of authorization code token request
2019-05-12 13:50:26.343 +04:00 [DBG] Djv8JqMdL7APMDsLT7HWPcAZmnoUPNy32aDLN4h/o7s= found in database: true
2019-05-12 13:50:26.430 +04:00 [DBG] removing Djv8JqMdL7APMDsLT7HWPcAZmnoUPNy32aDLN4h/o7s= persisted grant from database
2019-05-12 13:50:26.480 +04:00 [DBG] Validation of authorization code token request success
2019-05-12 13:50:26.509 +04:00 [INF] Token request validation success
{"ClientId":"StudLab","ClientName":"StudLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"9d707209ef2d7a616c4e7a827e3a371e234d6a842f8af8d240ae5f27d6b91c17","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"StudLab","client_secret":"***REDACTED***","code":"9d707209ef2d7a616c4e7a827e3a371e234d6a842f8af8d240ae5f27d6b91c17","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-05-12 13:50:26.639 +04:00 [DBG] StudLab found in database: true
2019-05-12 13:50:26.641 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-12 13:50:26.680 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-12 13:50:26.715 +04:00 [DBG] Found [] API scopes in database
2019-05-12 13:50:26.771 +04:00 [DBG] Getting claims for access token for client: StudLab
2019-05-12 13:50:26.773 +04:00 [DBG] Getting claims for access token for subject: 1003
2019-05-12 13:50:26.864 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-12 13:50:26.919 +04:00 [DBG] Creating refresh token
2019-05-12 13:50:26.921 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-05-12 13:50:26.998 +04:00 [DBG] THEWHAch4Y2UWJjjTQ18dMc08eNO3ew94++Crk/Zv7o= not found in database
2019-05-12 13:50:27.028 +04:00 [DBG] StudLab found in database: true
2019-05-12 13:50:27.029 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-12 13:50:27.042 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-12 13:50:27.050 +04:00 [DBG] Found [] API scopes in database
2019-05-12 13:50:27.057 +04:00 [DBG] Getting claims for identity token for subject: 1003 and client: StudLab
2019-05-12 13:50:27.086 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-12 13:50:27.123 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****rASg","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****29fe","$type":"Token"},{"TokenType":"access_token","TokenValue":"****YGVQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLMMNSTOEB94:00000003","TimeStamp":"2019-05-12T09:50:27.0000000Z","ProcessId":15820,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-12 13:50:27.190 +04:00 [DBG] Token request success.
2019-05-12 13:50:27.250 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-05-12 13:50:27.261 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-05-12 13:50:27.269 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-05-12 13:50:27.303 +04:00 [DBG] Start userinfo request
2019-05-12 13:50:27.326 +04:00 [DBG] Bearer token found in header
2019-05-12 13:50:27.675 +04:00 [DBG] StudLab found in database: true
2019-05-12 13:50:27.677 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-12 13:50:27.711 +04:00 [DBG] StudLab found in database: true
2019-05-12 13:50:27.713 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-12 13:50:27.745 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-05-12 13:50:27.764 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1557654626,"exp":1557658226,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"StudLab","sub":"1003","auth_time":1557653839,"idp":"local","AspNet.Identity.SecurityStamp":"KNG546POTRFIIVZGWYKZ62ARWCVYTBVN","role":"user","preferred_username":"test@test.test.test","name":"test@test.test.test","email":"test@test.test.test","email_verified":false,"given_name":"test@test.test.test","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-05-12 13:50:27.864 +04:00 [DBG] Creating userinfo response
2019-05-12 13:50:27.884 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-12 13:50:27.900 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-12 13:50:27.923 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-12 13:50:27.930 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-05-12 13:50:27.934 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-12 13:50:27.947 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-12 13:50:27.990 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email
2019-05-12 13:50:28.000 +04:00 [DBG] End userinfo request
2019-05-12 13:58:09.978 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-12 13:58:20.927 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-12 13:58:20.933 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-12 13:58:20.937 +04:00 [DBG] Start authorize request
2019-05-12 13:58:20.944 +04:00 [DBG] User in authorize request: 1003
2019-05-12 13:58:20.947 +04:00 [DBG] Start authorize request protocol validation
2019-05-12 13:58:20.951 +04:00 [ERR] client_id is missing or too long
{"ClientId":null,"ClientName":null,"RedirectUri":null,"AllowedRedirectUris":null,"SubjectId":"1003","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{},"$type":"AuthorizeRequestValidationLog"}
2019-05-12 13:58:21.001 +04:00 [ERR] Request validation failed
2019-05-12 13:58:21.002 +04:00 [INF] {"ClientId":null,"ClientName":null,"RedirectUri":null,"AllowedRedirectUris":null,"SubjectId":"1003","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{},"$type":"AuthorizeRequestValidationLog"}
2019-05-12 13:58:21.036 +04:00 [INF] {"ClientId":null,"ClientName":null,"RedirectUri":null,"Endpoint":"Authorize","SubjectId":"1003","Scopes":"","GrantType":null,"Error":"invalid_request","ErrorDescription":"Invalid client_id","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLMMNSTOEB97:00000001","TimeStamp":"2019-05-12T09:58:21.0000000Z","ProcessId":15820,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-05-12 13:58:21.254 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-12 14:06:00.509 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-12 14:06:00.838 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-12 14:06:00.848 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-12 14:06:00.851 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-12 14:06:00.853 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-12 14:06:00.870 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-12 14:06:00.881 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-12 14:06:02.552 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-12 14:06:02.615 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-12 14:06:02.624 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-12 14:06:03.091 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 14:06:03.575 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 14:06:03.656 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 14:06:03.694 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 14:06:03.748 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 14:06:03.803 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 14:06:04.065 +04:00 [DBG] Starting grant removal
2019-05-12 14:07:09.654 +04:00 [DBG] Login Url: /Account/Login
2019-05-12 14:07:09.676 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-12 14:07:09.685 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-12 14:07:09.702 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-12 14:07:09.712 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-12 14:07:09.715 +04:00 [DBG] Error Url: /home/error
2019-05-12 14:07:09.722 +04:00 [DBG] Error Id Parameter: errorId
2019-05-12 14:07:09.985 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-12 14:07:16.131 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-05-12 14:07:16.140 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-05-12 14:07:16.151 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-05-12 14:08:38.174 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-12 14:08:38.222 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-12 14:08:38.240 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-12 14:08:38.273 +04:00 [DBG] Start discovery request
2019-05-12 14:08:40.576 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-05-12 14:08:41.184 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-12 14:08:41.192 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-12 14:08:41.196 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-12 14:08:41.221 +04:00 [DBG] Start key discovery request
2019-05-12 14:08:41.671 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-12 14:08:41.735 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-12 14:08:41.742 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-12 14:08:41.770 +04:00 [DBG] Start authorize request
2019-05-12 14:08:41.826 +04:00 [DBG] No user present in authorize request
2019-05-12 14:08:41.853 +04:00 [DBG] Start authorize request protocol validation
2019-05-12 14:08:43.404 +04:00 [DBG] StudLab found in database: true
2019-05-12 14:08:43.437 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-12 14:08:43.473 +04:00 [DBG] Checking for PKCE parameters
2019-05-12 14:08:43.487 +04:00 [DBG] No PKCE used.
2019-05-12 14:08:43.716 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-12 14:08:43.908 +04:00 [DBG] Found [] API scopes in database
2019-05-12 14:08:43.950 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-12 14:08:43.960 +04:00 [DBG] Found [] API scopes in database
2019-05-12 14:08:43.993 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-12 14:08:44.051 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK88s5Gg6jCZ07M6loMppYjcdG6wQu9-Fzj7H0Hko6jXBvMg8PX7XfYgCQQFDqRm9VEJEeOV20htKqcyE_Lp8GNhq9PvCEIoGcJG0y75ujBmBvbVmmw_8KZ0gVPK0F7tadUEpubduXe_07PFuAGv4tCNMofEhYj4TYAFmIAFN30AKvvGvt3-fM-PWFxxQQuB2DGohqkaTqirK0_BWGU2itakSOrTZZl3LqqsMcT2boJ2oTeo9LouAWPaIVuaKgFV4Ujham0bC42dGU3nTAqfLAcy5JjyCsMIyoo8-GNQxJKWll1BVrw1ng3kMaYSOHdcYGGA","UiLocales":null,"Nonce":"636932525214576769.ZjUxMDhhNWMtYzYzOC00ZWU4LWIzNmQtMTEyNjE4YmQyZTA0MGEyODgxNTctM2Y5NS00NTFjLTkxMmQtNmE1ZGZjZDRiZDhl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636932525214576769.ZjUxMDhhNWMtYzYzOC00ZWU4LWIzNmQtMTEyNjE4YmQyZTA0MGEyODgxNTctM2Y5NS00NTFjLTkxMmQtNmE1ZGZjZDRiZDhl","state":"CfDJ8D73mgAamspIvsbnstRoK88s5Gg6jCZ07M6loMppYjcdG6wQu9-Fzj7H0Hko6jXBvMg8PX7XfYgCQQFDqRm9VEJEeOV20htKqcyE_Lp8GNhq9PvCEIoGcJG0y75ujBmBvbVmmw_8KZ0gVPK0F7tadUEpubduXe_07PFuAGv4tCNMofEhYj4TYAFmIAFN30AKvvGvt3-fM-PWFxxQQuB2DGohqkaTqirK0_BWGU2itakSOrTZZl3LqqsMcT2boJ2oTeo9LouAWPaIVuaKgFV4Ujham0bC42dGU3nTAqfLAcy5JjyCsMIyoo8-GNQxJKWll1BVrw1ng3kMaYSOHdcYGGA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-12 14:08:44.161 +04:00 [INF] Showing login: User is not authenticated
2019-05-12 14:09:57.560 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-12 14:09:57.582 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-12 14:09:57.587 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-12 14:09:57.592 +04:00 [DBG] Start authorize request
2019-05-12 14:09:57.600 +04:00 [DBG] No user present in authorize request
2019-05-12 14:09:57.602 +04:00 [DBG] Start authorize request protocol validation
2019-05-12 14:09:57.800 +04:00 [DBG] StudLab found in database: true
2019-05-12 14:09:57.802 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-12 14:09:57.809 +04:00 [DBG] Checking for PKCE parameters
2019-05-12 14:09:57.812 +04:00 [DBG] No PKCE used.
2019-05-12 14:09:57.856 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-12 14:09:57.896 +04:00 [DBG] Found [] API scopes in database
2019-05-12 14:09:57.921 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-12 14:09:57.934 +04:00 [DBG] Found [] API scopes in database
2019-05-12 14:09:57.939 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-12 14:09:57.950 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK89l8xYULq5aWUvC1NqbwQ-mCy6H2_lwqwi5FTv8MSL2mDuUYqob8KSm5dWrZYzyL4DA4CH9qo5ntA6TKmLZHwGnIIJJ-IptB7gOcGD4nYiq6OBzXFo3hbHZ3YVfZ0GpEdKEkpBLu0CZpcztQyUPsFdYfURW6kzMIBep6_djyvHipD65VgmmgxSC9ttMsa755Ih6dUmgD1FIj60FMZ5AAgADqlvUhZL1xPj0P7AdScRiF_tuk4yCrDBj98ZCTgL0GtPj17KpTk-q9qDscuqSC960wlTrZk9vocLAQjQpG2YS2f2ezx4e6mr79NHPRTKyVLg","UiLocales":null,"Nonce":"636932525974621182.YWY5NzFkYTctZWNkOS00MDIwLWEzOGQtMjhlODA2MWFiZGE4M2I5ZGIyOTEtZTRjZS00Y2YwLWI0MmUtMmUyZmI4ZTUxODNm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636932525974621182.YWY5NzFkYTctZWNkOS00MDIwLWEzOGQtMjhlODA2MWFiZGE4M2I5ZGIyOTEtZTRjZS00Y2YwLWI0MmUtMmUyZmI4ZTUxODNm","state":"CfDJ8D73mgAamspIvsbnstRoK89l8xYULq5aWUvC1NqbwQ-mCy6H2_lwqwi5FTv8MSL2mDuUYqob8KSm5dWrZYzyL4DA4CH9qo5ntA6TKmLZHwGnIIJJ-IptB7gOcGD4nYiq6OBzXFo3hbHZ3YVfZ0GpEdKEkpBLu0CZpcztQyUPsFdYfURW6kzMIBep6_djyvHipD65VgmmgxSC9ttMsa755Ih6dUmgD1FIj60FMZ5AAgADqlvUhZL1xPj0P7AdScRiF_tuk4yCrDBj98ZCTgL0GtPj17KpTk-q9qDscuqSC960wlTrZk9vocLAQjQpG2YS2f2ezx4e6mr79NHPRTKyVLg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-12 14:09:58.025 +04:00 [INF] Showing login: User is not authenticated
2019-05-12 14:12:27.659 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-12 14:12:27.972 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-12 14:12:27.975 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-12 14:12:27.977 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-12 14:12:27.979 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-12 14:12:27.981 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-12 14:12:27.982 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-12 14:12:29.821 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-12 14:12:29.869 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-12 14:12:29.893 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-12 14:12:30.320 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 14:12:30.956 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 14:12:31.037 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 14:12:31.097 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 14:12:31.139 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 14:12:31.176 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-12 14:12:31.713 +04:00 [DBG] Starting grant removal
2019-05-12 14:16:23.095 +04:00 [DBG] Login Url: /Account/Login
2019-05-12 14:16:23.113 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-12 14:16:23.137 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-12 14:16:23.173 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-12 14:16:23.193 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-12 14:16:23.207 +04:00 [DBG] Error Url: /home/error
2019-05-12 14:16:23.212 +04:00 [DBG] Error Id Parameter: errorId
2019-05-12 14:16:23.405 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-12 14:16:23.487 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-12 14:16:23.493 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-12 14:16:23.516 +04:00 [DBG] Start discovery request
2019-05-12 14:16:26.619 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-05-12 14:16:27.719 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-12 14:16:27.794 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-12 14:16:27.803 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-12 14:16:27.831 +04:00 [DBG] Start key discovery request
2019-05-12 14:16:28.295 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-12 14:16:28.331 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-12 14:16:28.338 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-12 14:16:28.365 +04:00 [DBG] Start authorize request
2019-05-12 14:16:28.420 +04:00 [DBG] No user present in authorize request
2019-05-12 14:16:28.444 +04:00 [DBG] Start authorize request protocol validation
2019-05-12 14:16:30.657 +04:00 [DBG] StudLab found in database: true
2019-05-12 14:16:30.690 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-12 14:16:30.723 +04:00 [DBG] Checking for PKCE parameters
2019-05-12 14:16:30.744 +04:00 [DBG] No PKCE used.
2019-05-12 14:16:31.021 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-12 14:16:31.361 +04:00 [DBG] Found [] API scopes in database
2019-05-12 14:16:31.488 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-12 14:16:31.512 +04:00 [DBG] Found [] API scopes in database
2019-05-12 14:16:31.572 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-12 14:16:31.688 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK8_HWHZo2TmEAFAlVolMSj7qqtEDH1YMmd-tSsVUfHzAJBSkkSMCiAMbNGBfJh2Y5G3BlWSeYmL8vW6T_X3lWe5efwpOGeidayACYMfFu8ofTty8oqWnCqD1PCrwr9pmPOKtaAaM4BUMz4t9vnZ08aa5mFrwOrHK6IJ5T-xwanSdc8r7eX_ZEb4egQzJsKsZoBThGcy4F883zjS9l8ibIoQP3tj6FUr2AxbpYKwN3OHGXkt9389N5Zd5h0kSZZdMEIrp26PqJ4B4S4HhCtieWlkfVWSQg0_ZlKW3NPvQJVkHX9w0xIxT39DB7WNYjGTSCAvPptdXa02sWejBDMqdkWwY","UiLocales":null,"Nonce":"636932529881049447.ZTQ2YjgyOGUtYTM5NC00M2NmLWJlMjctMjBkMGE3YjRkMTc2MGIzODMwY2MtYzYxNi00NGM4LWE0YzItZGY5MDMzNTkyMmEw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636932529881049447.ZTQ2YjgyOGUtYTM5NC00M2NmLWJlMjctMjBkMGE3YjRkMTc2MGIzODMwY2MtYzYxNi00NGM4LWE0YzItZGY5MDMzNTkyMmEw","state":"CfDJ8D73mgAamspIvsbnstRoK8_HWHZo2TmEAFAlVolMSj7qqtEDH1YMmd-tSsVUfHzAJBSkkSMCiAMbNGBfJh2Y5G3BlWSeYmL8vW6T_X3lWe5efwpOGeidayACYMfFu8ofTty8oqWnCqD1PCrwr9pmPOKtaAaM4BUMz4t9vnZ08aa5mFrwOrHK6IJ5T-xwanSdc8r7eX_ZEb4egQzJsKsZoBThGcy4F883zjS9l8ibIoQP3tj6FUr2AxbpYKwN3OHGXkt9389N5Zd5h0kSZZdMEIrp26PqJ4B4S4HhCtieWlkfVWSQg0_ZlKW3NPvQJVkHX9w0xIxT39DB7WNYjGTSCAvPptdXa02sWejBDMqdkWwY","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-12 14:16:31.823 +04:00 [INF] Showing login: User is not authenticated
2019-05-12 14:16:31.918 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-12 14:16:40.328 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-12 14:16:40.339 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-12 14:16:40.344 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-12 14:16:40.352 +04:00 [DBG] Start authorize request
2019-05-12 14:16:40.359 +04:00 [DBG] No user present in authorize request
2019-05-12 14:16:40.360 +04:00 [DBG] Start authorize request protocol validation
2019-05-12 14:16:40.386 +04:00 [DBG] StudLab found in database: true
2019-05-12 14:16:40.389 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-12 14:16:40.397 +04:00 [DBG] Checking for PKCE parameters
2019-05-12 14:16:40.399 +04:00 [DBG] No PKCE used.
2019-05-12 14:16:40.434 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-12 14:16:40.448 +04:00 [DBG] Found [] API scopes in database
2019-05-12 14:16:40.464 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-12 14:16:40.474 +04:00 [DBG] Found [] API scopes in database
2019-05-12 14:16:40.480 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-12 14:16:40.488 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK887JMnmPzYhysh9v7AC_5gYquE2VoJWpLd4NQMDCeCNo3qpOoBUozQTuBwUblDj_diX2tKTQQ10mSY2LSOJ2qGNRC0vKpGb_XgYL0ICIKJo3Kr8ufpcjjUf52jYCGq9Kwx7T5X_YcvV1SsVFiQUo8Oa7P9VPAZGqmXzcYli-Jj_k7EAEiywoJx5TiURX3MbCZVDdN1iA9VdyJ-6xOin817zzJCBKpLBujSV3z-bklR1iHU2nFYLQxo9WmvYV2f06bFKF_-gXglvcdpYcU0d4IEbsRMs8sq-CGBdXoNICMuTqKe65jPhWt26_cEmdNEQV0C54CgfdgO1XKkoJaJosG5z","UiLocales":null,"Nonce":"636932530002736808.NTQ4MzNkNzYtN2FjMy00YmZlLWJiNjUtNzQwZDUxZWE5NTU3N2M2ZTA5YzAtOWIwOC00YWQ1LTllZGItNzU3MDg4Mzc0MWMw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636932530002736808.NTQ4MzNkNzYtN2FjMy00YmZlLWJiNjUtNzQwZDUxZWE5NTU3N2M2ZTA5YzAtOWIwOC00YWQ1LTllZGItNzU3MDg4Mzc0MWMw","state":"CfDJ8D73mgAamspIvsbnstRoK887JMnmPzYhysh9v7AC_5gYquE2VoJWpLd4NQMDCeCNo3qpOoBUozQTuBwUblDj_diX2tKTQQ10mSY2LSOJ2qGNRC0vKpGb_XgYL0ICIKJo3Kr8ufpcjjUf52jYCGq9Kwx7T5X_YcvV1SsVFiQUo8Oa7P9VPAZGqmXzcYli-Jj_k7EAEiywoJx5TiURX3MbCZVDdN1iA9VdyJ-6xOin817zzJCBKpLBujSV3z-bklR1iHU2nFYLQxo9WmvYV2f06bFKF_-gXglvcdpYcU0d4IEbsRMs8sq-CGBdXoNICMuTqKe65jPhWt26_cEmdNEQV0C54CgfdgO1XKkoJaJosG5z","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-12 14:16:40.545 +04:00 [INF] Showing login: User is not authenticated
2019-05-12 14:16:45.043 +04:00 [DBG] Augmenting SignInContext
2019-05-12 14:16:45.056 +04:00 [DBG] Adding idp claim with value: local
2019-05-12 14:16:45.057 +04:00 [DBG] Adding amr claim with value: pwd
2019-05-12 14:16:45.061 +04:00 [DBG] Adding auth_time claim with value: 1557656205
2019-05-12 14:16:45.128 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-12 14:16:45.265 +04:00 [INF] {"Username":"test@test.test.test","Provider":null,"ProviderUserId":null,"SubjectId":"1003","DisplayName":"test@test.test.test","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLMMOBGVL1CE:00000005","TimeStamp":"2019-05-12T10:16:45.0000000Z","ProcessId":9192,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-12 14:16:45.425 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-05-12 14:16:45.444 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-05-12 14:16:45.454 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-05-12 14:16:45.494 +04:00 [DBG] Start authorize callback request
2019-05-12 14:16:45.518 +04:00 [DBG] User in authorize request: 1003
2019-05-12 14:16:45.522 +04:00 [DBG] Start authorize request protocol validation
2019-05-12 14:16:45.542 +04:00 [DBG] StudLab found in database: true
2019-05-12 14:16:45.543 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-12 14:16:45.552 +04:00 [DBG] Checking for PKCE parameters
2019-05-12 14:16:45.555 +04:00 [DBG] No PKCE used.
2019-05-12 14:16:45.563 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-12 14:16:45.573 +04:00 [DBG] Found [] API scopes in database
2019-05-12 14:16:45.585 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-12 14:16:45.598 +04:00 [DBG] Found [] API scopes in database
2019-05-12 14:16:45.604 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-12 14:16:45.613 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1003","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK887JMnmPzYhysh9v7AC_5gYquE2VoJWpLd4NQMDCeCNo3qpOoBUozQTuBwUblDj_diX2tKTQQ10mSY2LSOJ2qGNRC0vKpGb_XgYL0ICIKJo3Kr8ufpcjjUf52jYCGq9Kwx7T5X_YcvV1SsVFiQUo8Oa7P9VPAZGqmXzcYli-Jj_k7EAEiywoJx5TiURX3MbCZVDdN1iA9VdyJ-6xOin817zzJCBKpLBujSV3z-bklR1iHU2nFYLQxo9WmvYV2f06bFKF_-gXglvcdpYcU0d4IEbsRMs8sq-CGBdXoNICMuTqKe65jPhWt26_cEmdNEQV0C54CgfdgO1XKkoJaJosG5z","UiLocales":null,"Nonce":"636932530002736808.NTQ4MzNkNzYtN2FjMy00YmZlLWJiNjUtNzQwZDUxZWE5NTU3N2M2ZTA5YzAtOWIwOC00YWQ1LTllZGItNzU3MDg4Mzc0MWMw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"64f7e5672b9157720754585e7b2c012d","Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636932530002736808.NTQ4MzNkNzYtN2FjMy00YmZlLWJiNjUtNzQwZDUxZWE5NTU3N2M2ZTA5YzAtOWIwOC00YWQ1LTllZGItNzU3MDg4Mzc0MWMw","state":"CfDJ8D73mgAamspIvsbnstRoK887JMnmPzYhysh9v7AC_5gYquE2VoJWpLd4NQMDCeCNo3qpOoBUozQTuBwUblDj_diX2tKTQQ10mSY2LSOJ2qGNRC0vKpGb_XgYL0ICIKJo3Kr8ufpcjjUf52jYCGq9Kwx7T5X_YcvV1SsVFiQUo8Oa7P9VPAZGqmXzcYli-Jj_k7EAEiywoJx5TiURX3MbCZVDdN1iA9VdyJ-6xOin817zzJCBKpLBujSV3z-bklR1iHU2nFYLQxo9WmvYV2f06bFKF_-gXglvcdpYcU0d4IEbsRMs8sq-CGBdXoNICMuTqKe65jPhWt26_cEmdNEQV0C54CgfdgO1XKkoJaJosG5z","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-12 14:16:45.819 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-05-12 14:16:45.864 +04:00 [DBG] Creating Hybrid Flow response.
2019-05-12 14:16:46.055 +04:00 [DBG] fAckkLnoh2L2deiSihvLeEVoLx4aEvIXi66aSWvhrXQ= not found in database
2019-05-12 14:16:46.321 +04:00 [DBG] Creating Implicit Flow response.
2019-05-12 14:16:46.372 +04:00 [DBG] Getting claims for identity token for subject: 1003 and client: StudLab
2019-05-12 14:16:46.560 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-12 14:16:46.976 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"1003","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****WS0w","$type":"Token"},{"TokenType":"code","TokenValue":"****d2e0","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLMMOBGVL1CE:00000006","TimeStamp":"2019-05-12T10:16:46.0000000Z","ProcessId":9192,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-12 14:16:47.019 +04:00 [INF] Authorize endpoint response
{"SubjectId":"1003","ClientId":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8D73mgAamspIvsbnstRoK887JMnmPzYhysh9v7AC_5gYquE2VoJWpLd4NQMDCeCNo3qpOoBUozQTuBwUblDj_diX2tKTQQ10mSY2LSOJ2qGNRC0vKpGb_XgYL0ICIKJo3Kr8ufpcjjUf52jYCGq9Kwx7T5X_YcvV1SsVFiQUo8Oa7P9VPAZGqmXzcYli-Jj_k7EAEiywoJx5TiURX3MbCZVDdN1iA9VdyJ-6xOin817zzJCBKpLBujSV3z-bklR1iHU2nFYLQxo9WmvYV2f06bFKF_-gXglvcdpYcU0d4IEbsRMs8sq-CGBdXoNICMuTqKe65jPhWt26_cEmdNEQV0C54CgfdgO1XKkoJaJosG5z","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-12 14:16:47.130 +04:00 [DBG] Augmenting SignInContext
2019-05-12 14:16:47.138 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-12 14:16:48.164 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-12 14:16:48.282 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-12 14:16:48.341 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-12 14:16:48.418 +04:00 [DBG] Start token request.
2019-05-12 14:16:48.495 +04:00 [DBG] Start client validation
2019-05-12 14:16:48.538 +04:00 [DBG] Start parsing Basic Authentication secret
2019-05-12 14:16:48.574 +04:00 [DBG] Start parsing for secret in post body
2019-05-12 14:16:48.592 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-12 14:16:48.605 +04:00 [DBG] Secret id found: StudLab
2019-05-12 14:16:48.675 +04:00 [DBG] StudLab found in database: true
2019-05-12 14:16:48.677 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-12 14:16:48.753 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-12 14:16:48.759 +04:00 [DBG] Client validation success
2019-05-12 14:16:48.777 +04:00 [INF] {"ClientId":"StudLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLMMOBGVL1CD:00000003","TimeStamp":"2019-05-12T10:16:48.0000000Z","ProcessId":9192,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-12 14:16:48.831 +04:00 [DBG] Start token request validation
2019-05-12 14:16:48.910 +04:00 [DBG] Start validation of authorization code token request
2019-05-12 14:16:48.997 +04:00 [DBG] fAckkLnoh2L2deiSihvLeEVoLx4aEvIXi66aSWvhrXQ= found in database: true
2019-05-12 14:16:49.127 +04:00 [DBG] removing fAckkLnoh2L2deiSihvLeEVoLx4aEvIXi66aSWvhrXQ= persisted grant from database
2019-05-12 14:16:49.206 +04:00 [DBG] Validation of authorization code token request success
2019-05-12 14:16:49.240 +04:00 [INF] Token request validation success
{"ClientId":"StudLab","ClientName":"StudLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"089614800a72c7a4c5dacd4be9352581e1a95913dfbabfb57dcb0013504bd2e0","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"StudLab","client_secret":"***REDACTED***","code":"089614800a72c7a4c5dacd4be9352581e1a95913dfbabfb57dcb0013504bd2e0","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-05-12 14:16:49.521 +04:00 [DBG] StudLab found in database: true
2019-05-12 14:16:49.526 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-12 14:16:49.577 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-12 14:16:49.622 +04:00 [DBG] Found [] API scopes in database
2019-05-12 14:16:49.681 +04:00 [DBG] Getting claims for access token for client: StudLab
2019-05-12 14:16:49.684 +04:00 [DBG] Getting claims for access token for subject: 1003
2019-05-12 14:16:49.754 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-12 14:16:49.886 +04:00 [DBG] Creating refresh token
2019-05-12 14:16:49.888 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-05-12 14:16:49.968 +04:00 [DBG] C9O2gtcGkq/d6Gb736rHvlqjYlNC8CvXiXw4axYGNpQ= not found in database
2019-05-12 14:16:50.000 +04:00 [DBG] StudLab found in database: true
2019-05-12 14:16:50.001 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-12 14:16:50.013 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-12 14:16:50.024 +04:00 [DBG] Found [] API scopes in database
2019-05-12 14:16:50.029 +04:00 [DBG] Getting claims for identity token for subject: 1003 and client: StudLab
2019-05-12 14:16:50.055 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-12 14:16:50.088 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****096w","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****a49c","$type":"Token"},{"TokenType":"access_token","TokenValue":"****XCDw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLMMOBGVL1CD:00000003","TimeStamp":"2019-05-12T10:16:50.0000000Z","ProcessId":9192,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-12 14:16:50.128 +04:00 [DBG] Token request success.
2019-05-12 14:16:50.231 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-05-12 14:16:50.246 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-05-12 14:16:50.251 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-05-12 14:16:50.307 +04:00 [DBG] Start userinfo request
2019-05-12 14:16:50.326 +04:00 [DBG] Bearer token found in header
2019-05-12 14:16:50.618 +04:00 [DBG] StudLab found in database: true
2019-05-12 14:16:50.619 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-12 14:16:50.647 +04:00 [DBG] StudLab found in database: true
2019-05-12 14:16:50.649 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-12 14:16:50.684 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-05-12 14:16:50.697 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1557656209,"exp":1557659809,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"StudLab","sub":"1003","auth_time":1557656205,"idp":"local","AspNet.Identity.SecurityStamp":"KNG546POTRFIIVZGWYKZ62ARWCVYTBVN","role":"user","preferred_username":"test@test.test.test","name":"test@test.test.test","email":"test@test.test.test","email_verified":false,"given_name":"test@test.test.test","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-05-12 14:16:50.768 +04:00 [DBG] Creating userinfo response
2019-05-12 14:16:50.790 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-12 14:16:50.811 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-12 14:16:50.847 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-12 14:16:50.855 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-05-12 14:16:50.858 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-12 14:16:50.879 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-12 14:16:50.922 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email
2019-05-12 14:16:50.930 +04:00 [DBG] End userinfo request
2019-05-13 15:28:22.757 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-13 15:28:23.024 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-13 15:28:23.031 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-13 15:28:23.034 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-13 15:28:23.036 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-13 15:28:23.038 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-13 15:28:23.045 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-13 15:28:24.375 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-13 15:28:24.411 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-13 15:28:24.417 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-13 15:28:24.917 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-13 15:28:25.819 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-13 15:28:25.912 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-13 15:28:26.120 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-13 15:28:26.184 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-13 15:28:26.249 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-13 15:28:26.578 +04:00 [DBG] Starting grant removal
2019-05-13 16:03:38.250 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-13 16:03:38.574 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-13 16:03:38.584 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-13 16:03:38.590 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-13 16:03:38.593 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-13 16:03:38.596 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-13 16:03:38.613 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-13 16:03:39.968 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-13 16:03:40.124 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-13 16:03:40.133 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-13 16:03:40.563 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-13 16:03:40.992 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-13 16:03:41.077 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-13 16:03:41.109 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-13 16:03:41.154 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-13 16:03:41.186 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-13 16:03:41.467 +04:00 [DBG] Starting grant removal
2019-05-13 16:03:50.033 +04:00 [DBG] Login Url: /Account/Login
2019-05-13 16:03:50.053 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-13 16:03:50.057 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-13 16:03:50.060 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-13 16:03:50.062 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-13 16:03:50.064 +04:00 [DBG] Error Url: /home/error
2019-05-13 16:03:50.074 +04:00 [DBG] Error Id Parameter: errorId
2019-05-13 16:03:50.254 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-13 16:03:50.282 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-13 16:03:50.290 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-13 16:03:50.309 +04:00 [DBG] Start discovery request
2019-05-13 16:03:52.843 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-05-13 16:03:53.722 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-13 16:03:53.752 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-13 16:03:53.759 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-13 16:03:53.785 +04:00 [DBG] Start key discovery request
2019-05-13 16:03:55.289 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-13 16:03:55.321 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-13 16:03:55.330 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-13 16:03:55.360 +04:00 [DBG] Start authorize request
2019-05-13 16:03:55.411 +04:00 [DBG] User in authorize request: 1003
2019-05-13 16:03:55.433 +04:00 [DBG] Start authorize request protocol validation
2019-05-13 16:03:57.151 +04:00 [DBG] StudLab found in database: true
2019-05-13 16:03:57.183 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-13 16:03:57.214 +04:00 [DBG] Checking for PKCE parameters
2019-05-13 16:03:57.226 +04:00 [DBG] No PKCE used.
2019-05-13 16:03:57.455 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-13 16:03:57.669 +04:00 [DBG] Found [] API scopes in database
2019-05-13 16:03:57.711 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-13 16:03:57.730 +04:00 [DBG] Found [] API scopes in database
2019-05-13 16:03:57.774 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-13 16:03:57.889 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"1003","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK88rN0fqoco4Kb3HdB6M03FmjIQO-SjXSmA6hu54BCtkoBFm5bZSQQEsrYS6t5FWw8pv0jueMtLHNhyLT8j2k7PGZAJYnfxveZMpfk_Nv-Hm66yiZfSKG8VgaBuQMyaSeLa3-BnlOWXUxVvIiZtn8KbJO5t7GNWwB5HnG4xVQFpDST-cQO4jo5-FFnG6joQFnmSQjFuUkv_gftuKtXSOR5RMStx1_bFul3bInT28HU7_QDhjYbWiKVPf0g0ZD1KQ2Q1GyU8WCpfVRhD4Bv_q1IKF","UiLocales":null,"Nonce":"636933458342805605.NGM5MzlmZTUtYWRkMS00N2MzLWEwZTEtZWRkNDVjMDlmMGE3ZTk4YjY1ZjYtOTJlNy00YWEwLTkzNjQtYzg2MTgwNDU0OWNm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"64f7e5672b9157720754585e7b2c012d","Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636933458342805605.NGM5MzlmZTUtYWRkMS00N2MzLWEwZTEtZWRkNDVjMDlmMGE3ZTk4YjY1ZjYtOTJlNy00YWEwLTkzNjQtYzg2MTgwNDU0OWNm","state":"CfDJ8D73mgAamspIvsbnstRoK88rN0fqoco4Kb3HdB6M03FmjIQO-SjXSmA6hu54BCtkoBFm5bZSQQEsrYS6t5FWw8pv0jueMtLHNhyLT8j2k7PGZAJYnfxveZMpfk_Nv-Hm66yiZfSKG8VgaBuQMyaSeLa3-BnlOWXUxVvIiZtn8KbJO5t7GNWwB5HnG4xVQFpDST-cQO4jo5-FFnG6joQFnmSQjFuUkv_gftuKtXSOR5RMStx1_bFul3bInT28HU7_QDhjYbWiKVPf0g0ZD1KQ2Q1GyU8WCpfVRhD4Bv_q1IKF","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-13 16:03:58.112 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-05-13 16:03:58.142 +04:00 [DBG] Creating Hybrid Flow response.
2019-05-13 16:03:58.342 +04:00 [DBG] rwhbm8AFEJ9tOpG58H8S+sO9cLSpaiMHuVwsOvg0niA= not found in database
2019-05-13 16:03:58.613 +04:00 [DBG] Creating Implicit Flow response.
2019-05-13 16:03:58.678 +04:00 [DBG] Getting claims for identity token for subject: 1003 and client: StudLab
2019-05-13 16:03:58.808 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-13 16:03:59.463 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"1003","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****FViw","$type":"Token"},{"TokenType":"code","TokenValue":"****1b8b","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLMNJC7HFJFL:00000001","TimeStamp":"2019-05-13T12:03:59.0000000Z","ProcessId":9320,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-13 16:03:59.507 +04:00 [INF] Authorize endpoint response
{"SubjectId":"1003","ClientId":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8D73mgAamspIvsbnstRoK88rN0fqoco4Kb3HdB6M03FmjIQO-SjXSmA6hu54BCtkoBFm5bZSQQEsrYS6t5FWw8pv0jueMtLHNhyLT8j2k7PGZAJYnfxveZMpfk_Nv-Hm66yiZfSKG8VgaBuQMyaSeLa3-BnlOWXUxVvIiZtn8KbJO5t7GNWwB5HnG4xVQFpDST-cQO4jo5-FFnG6joQFnmSQjFuUkv_gftuKtXSOR5RMStx1_bFul3bInT28HU7_QDhjYbWiKVPf0g0ZD1KQ2Q1GyU8WCpfVRhD4Bv_q1IKF","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-13 16:04:00.767 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-13 16:04:00.826 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-13 16:04:00.845 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-13 16:04:00.921 +04:00 [DBG] Start token request.
2019-05-13 16:04:00.988 +04:00 [DBG] Start client validation
2019-05-13 16:04:01.019 +04:00 [DBG] Start parsing Basic Authentication secret
2019-05-13 16:04:01.050 +04:00 [DBG] Start parsing for secret in post body
2019-05-13 16:04:01.146 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-13 16:04:01.155 +04:00 [DBG] Secret id found: StudLab
2019-05-13 16:04:01.203 +04:00 [DBG] StudLab found in database: true
2019-05-13 16:04:01.205 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-13 16:04:01.262 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-13 16:04:01.264 +04:00 [DBG] Client validation success
2019-05-13 16:04:01.271 +04:00 [INF] {"ClientId":"StudLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLMNJC7HFJFK:00000003","TimeStamp":"2019-05-13T12:04:01.0000000Z","ProcessId":9320,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-13 16:04:01.315 +04:00 [DBG] Start token request validation
2019-05-13 16:04:01.406 +04:00 [DBG] Start validation of authorization code token request
2019-05-13 16:04:01.491 +04:00 [DBG] rwhbm8AFEJ9tOpG58H8S+sO9cLSpaiMHuVwsOvg0niA= found in database: true
2019-05-13 16:04:01.604 +04:00 [DBG] removing rwhbm8AFEJ9tOpG58H8S+sO9cLSpaiMHuVwsOvg0niA= persisted grant from database
2019-05-13 16:04:01.672 +04:00 [DBG] Validation of authorization code token request success
2019-05-13 16:04:01.705 +04:00 [INF] Token request validation success
{"ClientId":"StudLab","ClientName":"StudLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"d3ccba9ec0457fb54cc782827bf5fff93d41dbdbb0be6e051f5942f8d8831b8b","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"StudLab","client_secret":"***REDACTED***","code":"d3ccba9ec0457fb54cc782827bf5fff93d41dbdbb0be6e051f5942f8d8831b8b","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-05-13 16:04:01.857 +04:00 [DBG] StudLab found in database: true
2019-05-13 16:04:01.858 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-13 16:04:01.893 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-13 16:04:01.920 +04:00 [DBG] Found [] API scopes in database
2019-05-13 16:04:01.975 +04:00 [DBG] Getting claims for access token for client: StudLab
2019-05-13 16:04:01.977 +04:00 [DBG] Getting claims for access token for subject: 1003
2019-05-13 16:04:02.059 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-13 16:04:02.112 +04:00 [DBG] Creating refresh token
2019-05-13 16:04:02.114 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-05-13 16:04:02.188 +04:00 [DBG] gVcAvMsEjPFN5FyE0HMz0g1uCasQMjCwMNCmH/I5nl4= not found in database
2019-05-13 16:04:02.224 +04:00 [DBG] StudLab found in database: true
2019-05-13 16:04:02.226 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-13 16:04:02.265 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-13 16:04:02.275 +04:00 [DBG] Found [] API scopes in database
2019-05-13 16:04:02.279 +04:00 [DBG] Getting claims for identity token for subject: 1003 and client: StudLab
2019-05-13 16:04:02.306 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-13 16:04:02.341 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****euIg","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****a6ce","$type":"Token"},{"TokenType":"access_token","TokenValue":"****_JBg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLMNJC7HFJFK:00000003","TimeStamp":"2019-05-13T12:04:02.0000000Z","ProcessId":9320,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-13 16:04:02.467 +04:00 [DBG] Token request success.
2019-05-13 16:04:02.642 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-05-13 16:04:02.738 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-05-13 16:04:02.864 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-05-13 16:04:02.989 +04:00 [DBG] Start userinfo request
2019-05-13 16:04:03.056 +04:00 [DBG] Bearer token found in header
2019-05-13 16:04:03.578 +04:00 [DBG] StudLab found in database: true
2019-05-13 16:04:03.580 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-13 16:04:03.622 +04:00 [DBG] StudLab found in database: true
2019-05-13 16:04:03.624 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-13 16:04:03.663 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-05-13 16:04:03.677 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1557749042,"exp":1557752642,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"StudLab","sub":"1003","auth_time":1557656205,"idp":"local","AspNet.Identity.SecurityStamp":"KNG546POTRFIIVZGWYKZ62ARWCVYTBVN","role":"user","preferred_username":"test@test.test.test","name":"test@test.test.test","email":"test@test.test.test","email_verified":false,"given_name":"test@test.test.test","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-05-13 16:04:03.759 +04:00 [DBG] Creating userinfo response
2019-05-13 16:04:03.789 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-13 16:04:03.890 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-13 16:04:03.942 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-13 16:04:03.952 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-05-13 16:04:03.956 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-13 16:04:03.975 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-13 16:04:04.029 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email
2019-05-13 16:04:04.043 +04:00 [DBG] End userinfo request
2019-05-13 16:04:20.723 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-13 16:04:31.341 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-05-13 16:04:31.350 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-05-13 16:04:31.356 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-05-13 16:05:28.471 +04:00 [DBG] Augmenting SignInContext
2019-05-13 16:05:28.484 +04:00 [DBG] Adding idp claim with value: local
2019-05-13 16:05:28.485 +04:00 [DBG] Adding amr claim with value: pwd
2019-05-13 16:05:28.490 +04:00 [DBG] Adding auth_time claim with value: 1557749128
2019-05-13 16:05:28.518 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-13 16:06:28.129 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-13 16:06:28.150 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-13 16:06:28.154 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-13 16:06:28.163 +04:00 [DBG] Start authorize request
2019-05-13 16:06:28.166 +04:00 [DBG] User in authorize request: 2002
2019-05-13 16:06:28.171 +04:00 [DBG] Start authorize request protocol validation
2019-05-13 16:06:28.262 +04:00 [DBG] StudLab found in database: true
2019-05-13 16:06:28.264 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-13 16:06:28.270 +04:00 [DBG] Checking for PKCE parameters
2019-05-13 16:06:28.273 +04:00 [DBG] No PKCE used.
2019-05-13 16:06:28.316 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-13 16:06:28.352 +04:00 [DBG] Found [] API scopes in database
2019-05-13 16:06:28.365 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-13 16:06:28.372 +04:00 [DBG] Found [] API scopes in database
2019-05-13 16:06:28.380 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-13 16:06:28.384 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"2002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK88u8FJ0u6qoKvS-IRvSgD_RZoQu16Vs6ERMdkEV8Z3AXQXxWxz9P9Lt5Gr9UnjjqQj_T1PMd563id1STlfzOWUoCeW5dsl5u_6Ye3t6s1fb0vhhLb-a0Rh3m4G4dp9edlU0WmxPpCf-nub_hNIKNgPwjA-LQX1VQZDSXTj14yspNVQVGUj37Mlj15lxdCVMlvhpxV6LG2G_P88jcO5RhKH6LxejmJbp9vxWtHhYK68Jgy5spksyzsOijp86W45u0JXrlbPt9BHc_4LoOajAkG5A","UiLocales":null,"Nonce":"636933459880499661.NTAyYmFmZTgtMDliYi00N2NlLWI2MzctYjExN2VjNTU2YjM3YTI5MDdhZDEtZDIyOC00MTMyLWFhNzQtNTc1MDE1MGQ5NzI0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"046237990910fd1411a8b7306f0953e9","Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636933459880499661.NTAyYmFmZTgtMDliYi00N2NlLWI2MzctYjExN2VjNTU2YjM3YTI5MDdhZDEtZDIyOC00MTMyLWFhNzQtNTc1MDE1MGQ5NzI0","state":"CfDJ8D73mgAamspIvsbnstRoK88u8FJ0u6qoKvS-IRvSgD_RZoQu16Vs6ERMdkEV8Z3AXQXxWxz9P9Lt5Gr9UnjjqQj_T1PMd563id1STlfzOWUoCeW5dsl5u_6Ye3t6s1fb0vhhLb-a0Rh3m4G4dp9edlU0WmxPpCf-nub_hNIKNgPwjA-LQX1VQZDSXTj14yspNVQVGUj37Mlj15lxdCVMlvhpxV6LG2G_P88jcO5RhKH6LxejmJbp9vxWtHhYK68Jgy5spksyzsOijp86W45u0JXrlbPt9BHc_4LoOajAkG5A","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-13 16:06:28.512 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-05-13 16:06:28.514 +04:00 [DBG] Creating Hybrid Flow response.
2019-05-13 16:06:28.531 +04:00 [DBG] A7uATkGaAssvDKDDsg6wFFS2X9w1ro+VvNGtSlToE0w= not found in database
2019-05-13 16:06:28.548 +04:00 [DBG] Creating Implicit Flow response.
2019-05-13 16:06:28.551 +04:00 [DBG] Getting claims for identity token for subject: 2002 and client: StudLab
2019-05-13 16:06:28.599 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-13 16:06:28.622 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"2002","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****43cg","$type":"Token"},{"TokenType":"code","TokenValue":"****b009","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLMNJC7HFJFQ:00000003","TimeStamp":"2019-05-13T12:06:28.0000000Z","ProcessId":9320,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-13 16:06:28.651 +04:00 [INF] Authorize endpoint response
{"SubjectId":"2002","ClientId":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8D73mgAamspIvsbnstRoK88u8FJ0u6qoKvS-IRvSgD_RZoQu16Vs6ERMdkEV8Z3AXQXxWxz9P9Lt5Gr9UnjjqQj_T1PMd563id1STlfzOWUoCeW5dsl5u_6Ye3t6s1fb0vhhLb-a0Rh3m4G4dp9edlU0WmxPpCf-nub_hNIKNgPwjA-LQX1VQZDSXTj14yspNVQVGUj37Mlj15lxdCVMlvhpxV6LG2G_P88jcO5RhKH6LxejmJbp9vxWtHhYK68Jgy5spksyzsOijp86W45u0JXrlbPt9BHc_4LoOajAkG5A","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-13 16:06:28.700 +04:00 [DBG] Augmenting SignInContext
2019-05-13 16:06:28.702 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-13 16:06:29.122 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-13 16:06:29.133 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-13 16:06:29.152 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-13 16:06:29.169 +04:00 [DBG] Start token request.
2019-05-13 16:06:29.179 +04:00 [DBG] Start client validation
2019-05-13 16:06:29.188 +04:00 [DBG] Start parsing Basic Authentication secret
2019-05-13 16:06:29.195 +04:00 [DBG] Start parsing for secret in post body
2019-05-13 16:06:29.213 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-13 16:06:29.220 +04:00 [DBG] Secret id found: StudLab
2019-05-13 16:06:29.245 +04:00 [DBG] StudLab found in database: true
2019-05-13 16:06:29.247 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-13 16:06:29.254 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-13 16:06:29.256 +04:00 [DBG] Client validation success
2019-05-13 16:06:29.259 +04:00 [INF] {"ClientId":"StudLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLMNJC7HFJFS:00000001","TimeStamp":"2019-05-13T12:06:29.0000000Z","ProcessId":9320,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-13 16:06:29.280 +04:00 [DBG] Start token request validation
2019-05-13 16:06:29.283 +04:00 [DBG] Start validation of authorization code token request
2019-05-13 16:06:29.300 +04:00 [DBG] A7uATkGaAssvDKDDsg6wFFS2X9w1ro+VvNGtSlToE0w= found in database: true
2019-05-13 16:06:29.317 +04:00 [DBG] removing A7uATkGaAssvDKDDsg6wFFS2X9w1ro+VvNGtSlToE0w= persisted grant from database
2019-05-13 16:06:29.417 +04:00 [DBG] Validation of authorization code token request success
2019-05-13 16:06:29.490 +04:00 [INF] Token request validation success
{"ClientId":"StudLab","ClientName":"StudLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"59f115c01d0b7236b6d85d56dcddc485e4d86e1a358c54b503ec1e8851e1b009","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"StudLab","client_secret":"***REDACTED***","code":"59f115c01d0b7236b6d85d56dcddc485e4d86e1a358c54b503ec1e8851e1b009","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-05-13 16:06:29.553 +04:00 [DBG] StudLab found in database: true
2019-05-13 16:06:29.554 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-13 16:06:29.618 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-13 16:06:29.653 +04:00 [DBG] Found [] API scopes in database
2019-05-13 16:06:29.660 +04:00 [DBG] Getting claims for access token for client: StudLab
2019-05-13 16:06:29.663 +04:00 [DBG] Getting claims for access token for subject: 2002
2019-05-13 16:06:29.699 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-13 16:06:29.723 +04:00 [DBG] Creating refresh token
2019-05-13 16:06:29.726 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-05-13 16:06:29.737 +04:00 [DBG] YNIZ9As6E8aItq6Cox7s6RvGPlMmGomrZRZ8Yg2mw3k= not found in database
2019-05-13 16:06:29.785 +04:00 [DBG] StudLab found in database: true
2019-05-13 16:06:29.787 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-13 16:06:29.822 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-13 16:06:29.845 +04:00 [DBG] Found [] API scopes in database
2019-05-13 16:06:29.851 +04:00 [DBG] Getting claims for identity token for subject: 2002 and client: StudLab
2019-05-13 16:06:29.883 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-13 16:06:29.907 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****Voiw","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****5494","$type":"Token"},{"TokenType":"access_token","TokenValue":"****KIbg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLMNJC7HFJFS:00000001","TimeStamp":"2019-05-13T12:06:29.0000000Z","ProcessId":9320,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-13 16:06:29.947 +04:00 [DBG] Token request success.
2019-05-13 16:06:29.963 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-05-13 16:06:29.973 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-05-13 16:06:30.039 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-05-13 16:06:30.099 +04:00 [DBG] Start userinfo request
2019-05-13 16:06:30.114 +04:00 [DBG] Bearer token found in header
2019-05-13 16:06:30.331 +04:00 [DBG] StudLab found in database: true
2019-05-13 16:06:30.336 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-13 16:06:30.422 +04:00 [DBG] StudLab found in database: true
2019-05-13 16:06:30.429 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-13 16:06:30.457 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-05-13 16:06:30.470 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1557749189,"exp":1557752789,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"StudLab","sub":"2002","auth_time":1557749128,"idp":"local","AspNet.Identity.SecurityStamp":"TB5X65M34EL2T5G3DBBZ6XCM35NZOHWC","role":"user","preferred_username":"wachergarcia@gmail.com","name":"wachergarcia@gmail.com","email":"wachergarcia@gmail.com","email_verified":false,"given_name":"wachergarcia@gmail.com","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-05-13 16:06:30.550 +04:00 [DBG] Creating userinfo response
2019-05-13 16:06:30.559 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-13 16:06:30.568 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-13 16:06:30.607 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-13 16:06:30.619 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-05-13 16:06:30.625 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-13 16:06:30.649 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-13 16:06:30.687 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email
2019-05-13 16:06:30.696 +04:00 [DBG] End userinfo request
2019-05-13 16:06:58.716 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-05-13 16:06:58.747 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-05-13 16:06:58.757 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-05-13 16:07:01.400 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-13 16:07:01.413 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-13 16:07:01.419 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-13 16:07:01.429 +04:00 [DBG] Start authorize request
2019-05-13 16:07:01.432 +04:00 [DBG] No user present in authorize request
2019-05-13 16:07:01.434 +04:00 [DBG] Start authorize request protocol validation
2019-05-13 16:07:01.459 +04:00 [DBG] StudLab found in database: true
2019-05-13 16:07:01.461 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-13 16:07:01.467 +04:00 [DBG] Checking for PKCE parameters
2019-05-13 16:07:01.469 +04:00 [DBG] No PKCE used.
2019-05-13 16:07:01.480 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-13 16:07:01.493 +04:00 [DBG] Found [] API scopes in database
2019-05-13 16:07:01.508 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-13 16:07:01.516 +04:00 [DBG] Found [] API scopes in database
2019-05-13 16:07:01.521 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-13 16:07:01.529 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK88P_fV-SFy33JeasRSfST8_fzDSufQ8JhjQf6x04B3lXJsZA4TMxq2pjSru3mu7F9BM2e2DNxA2zo3gGYn2bpqLJmZKNmvULJbr6_UYjZPLAlelEtcNqbsGcVyO0MYb-Vhs9sM3tE4_MIHmXCdnbRv7Pjrxh54s_hLRl1hMM38iEnTIedyn2XrnRariRJUOE8e1i5lQ2khCcPF16RL5oV5m-dXS00OwxZLomKOU8aaCgHZ4Yy4Ke8xzd3YtjKwvspJ3vbREPTKqfGx67G2877qH","UiLocales":null,"Nonce":"636933460213486412.MDY4OGNlOTItMGQyNS00ODU1LTgxZjktYWM4MjAxMGVlM2FmMDg0NjgwNmEtYjU0Yy00OGI3LTlmNWUtNmRkNzQ1YmEzN2Y3","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636933460213486412.MDY4OGNlOTItMGQyNS00ODU1LTgxZjktYWM4MjAxMGVlM2FmMDg0NjgwNmEtYjU0Yy00OGI3LTlmNWUtNmRkNzQ1YmEzN2Y3","state":"CfDJ8D73mgAamspIvsbnstRoK88P_fV-SFy33JeasRSfST8_fzDSufQ8JhjQf6x04B3lXJsZA4TMxq2pjSru3mu7F9BM2e2DNxA2zo3gGYn2bpqLJmZKNmvULJbr6_UYjZPLAlelEtcNqbsGcVyO0MYb-Vhs9sM3tE4_MIHmXCdnbRv7Pjrxh54s_hLRl1hMM38iEnTIedyn2XrnRariRJUOE8e1i5lQ2khCcPF16RL5oV5m-dXS00OwxZLomKOU8aaCgHZ4Yy4Ke8xzd3YtjKwvspJ3vbREPTKqfGx67G2877qH","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-13 16:07:01.575 +04:00 [INF] Showing login: User is not authenticated
2019-05-13 16:08:00.474 +04:00 [WRN] User null password validation failed: PasswordRequiresDigit.
2019-05-13 16:08:21.183 +04:00 [DBG] Augmenting SignInContext
2019-05-13 16:08:21.184 +04:00 [DBG] Adding idp claim with value: local
2019-05-13 16:08:21.190 +04:00 [DBG] Adding amr claim with value: pwd
2019-05-13 16:08:21.192 +04:00 [DBG] Adding auth_time claim with value: 1557749301
2019-05-13 16:08:21.195 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-13 16:08:47.746 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-13 16:08:47.760 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-13 16:08:47.765 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-13 16:08:47.774 +04:00 [DBG] Start authorize request
2019-05-13 16:08:47.776 +04:00 [DBG] User in authorize request: 2003
2019-05-13 16:08:47.780 +04:00 [DBG] Start authorize request protocol validation
2019-05-13 16:08:47.802 +04:00 [DBG] StudLab found in database: true
2019-05-13 16:08:47.804 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-13 16:08:47.811 +04:00 [DBG] Checking for PKCE parameters
2019-05-13 16:08:47.813 +04:00 [DBG] No PKCE used.
2019-05-13 16:08:47.830 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-13 16:08:47.843 +04:00 [DBG] Found [] API scopes in database
2019-05-13 16:08:47.855 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-13 16:08:47.870 +04:00 [DBG] Found [] API scopes in database
2019-05-13 16:08:47.875 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-13 16:08:47.880 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"2003","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK88jw0OQF4zaDL2CwxhaHrp2cLn24yrARxb1FI-C3ObOARL7rGgUjT4cNwOBKIVpRwneeaYjUyx9ssT1nTXQegIn9niHriwdfppLIHpnPZaoSs_y2BZpjc1HDojphE4fUIUonnjXc14S2EDkTN5oPAbHPPxJCBY94kVKWd0OiZouXaoaeQn68Bp7g9jIN4sPHXI7d5jkqwEqyYjJGLL6LMamfwa7_qTgxtuilxyPo6c0GgtSScWQUfebKZCjBoAuNB0Aea86m_wDnr38hKeZTNvA","UiLocales":null,"Nonce":"636933461276858868.OGI4NGY2OTEtMDI2Ni00NWQ1LWE1ODQtMzQ4MjFkZTY0Mjg3NWQ5NTM2YTctZDE3Ny00ZmM0LWJlYTYtZGU2ZGQ0ODQzZDY1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"213967d9753575ce76fd82d1e7964d4e","Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636933461276858868.OGI4NGY2OTEtMDI2Ni00NWQ1LWE1ODQtMzQ4MjFkZTY0Mjg3NWQ5NTM2YTctZDE3Ny00ZmM0LWJlYTYtZGU2ZGQ0ODQzZDY1","state":"CfDJ8D73mgAamspIvsbnstRoK88jw0OQF4zaDL2CwxhaHrp2cLn24yrARxb1FI-C3ObOARL7rGgUjT4cNwOBKIVpRwneeaYjUyx9ssT1nTXQegIn9niHriwdfppLIHpnPZaoSs_y2BZpjc1HDojphE4fUIUonnjXc14S2EDkTN5oPAbHPPxJCBY94kVKWd0OiZouXaoaeQn68Bp7g9jIN4sPHXI7d5jkqwEqyYjJGLL6LMamfwa7_qTgxtuilxyPo6c0GgtSScWQUfebKZCjBoAuNB0Aea86m_wDnr38hKeZTNvA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-13 16:08:47.979 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-05-13 16:08:47.980 +04:00 [DBG] Creating Hybrid Flow response.
2019-05-13 16:08:47.991 +04:00 [DBG] ZUh1T7HmpQ0xUphkOXzKnGCaPR2eVVTonC++nEJgZgU= not found in database
2019-05-13 16:08:48.016 +04:00 [DBG] Creating Implicit Flow response.
2019-05-13 16:08:48.018 +04:00 [DBG] Getting claims for identity token for subject: 2003 and client: StudLab
2019-05-13 16:08:48.104 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-13 16:08:48.143 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"2003","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****obOg","$type":"Token"},{"TokenType":"code","TokenValue":"****856e","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLMNJC7HFJFQ:00000010","TimeStamp":"2019-05-13T12:08:48.0000000Z","ProcessId":9320,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-13 16:08:48.203 +04:00 [INF] Authorize endpoint response
{"SubjectId":"2003","ClientId":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8D73mgAamspIvsbnstRoK88jw0OQF4zaDL2CwxhaHrp2cLn24yrARxb1FI-C3ObOARL7rGgUjT4cNwOBKIVpRwneeaYjUyx9ssT1nTXQegIn9niHriwdfppLIHpnPZaoSs_y2BZpjc1HDojphE4fUIUonnjXc14S2EDkTN5oPAbHPPxJCBY94kVKWd0OiZouXaoaeQn68Bp7g9jIN4sPHXI7d5jkqwEqyYjJGLL6LMamfwa7_qTgxtuilxyPo6c0GgtSScWQUfebKZCjBoAuNB0Aea86m_wDnr38hKeZTNvA","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-13 16:08:48.227 +04:00 [DBG] Augmenting SignInContext
2019-05-13 16:08:48.231 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-13 16:08:48.620 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-13 16:08:48.633 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-13 16:08:48.644 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-13 16:08:48.659 +04:00 [DBG] Start token request.
2019-05-13 16:08:48.662 +04:00 [DBG] Start client validation
2019-05-13 16:08:48.664 +04:00 [DBG] Start parsing Basic Authentication secret
2019-05-13 16:08:48.679 +04:00 [DBG] Start parsing for secret in post body
2019-05-13 16:08:48.687 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-13 16:08:48.692 +04:00 [DBG] Secret id found: StudLab
2019-05-13 16:08:48.718 +04:00 [DBG] StudLab found in database: true
2019-05-13 16:08:48.720 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-13 16:08:48.731 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-13 16:08:48.736 +04:00 [DBG] Client validation success
2019-05-13 16:08:48.740 +04:00 [INF] {"ClientId":"StudLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLMNJC7HFJG2:00000001","TimeStamp":"2019-05-13T12:08:48.0000000Z","ProcessId":9320,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-13 16:08:48.770 +04:00 [DBG] Start token request validation
2019-05-13 16:08:48.775 +04:00 [DBG] Start validation of authorization code token request
2019-05-13 16:08:48.791 +04:00 [DBG] ZUh1T7HmpQ0xUphkOXzKnGCaPR2eVVTonC++nEJgZgU= found in database: true
2019-05-13 16:08:48.805 +04:00 [DBG] removing ZUh1T7HmpQ0xUphkOXzKnGCaPR2eVVTonC++nEJgZgU= persisted grant from database
2019-05-13 16:08:48.831 +04:00 [DBG] Validation of authorization code token request success
2019-05-13 16:08:48.834 +04:00 [INF] Token request validation success
{"ClientId":"StudLab","ClientName":"StudLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"275a1c17b71d3dc12d1b0b09f31912b67950f182688aede083406397d3aa856e","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"StudLab","client_secret":"***REDACTED***","code":"275a1c17b71d3dc12d1b0b09f31912b67950f182688aede083406397d3aa856e","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-05-13 16:08:48.896 +04:00 [DBG] StudLab found in database: true
2019-05-13 16:08:48.901 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-13 16:08:48.939 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-13 16:08:48.953 +04:00 [DBG] Found [] API scopes in database
2019-05-13 16:08:48.958 +04:00 [DBG] Getting claims for access token for client: StudLab
2019-05-13 16:08:48.961 +04:00 [DBG] Getting claims for access token for subject: 2003
2019-05-13 16:08:48.993 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-13 16:08:49.018 +04:00 [DBG] Creating refresh token
2019-05-13 16:08:49.020 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-05-13 16:08:49.029 +04:00 [DBG] 8huX478uQ40KHJVPyf7k99o4QpBatGFbsFJmfU1pxKU= not found in database
2019-05-13 16:08:49.058 +04:00 [DBG] StudLab found in database: true
2019-05-13 16:08:49.060 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-13 16:08:49.082 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-13 16:08:49.094 +04:00 [DBG] Found [] API scopes in database
2019-05-13 16:08:49.104 +04:00 [DBG] Getting claims for identity token for subject: 2003 and client: StudLab
2019-05-13 16:08:49.169 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-13 16:08:49.191 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****DJEg","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****3359","$type":"Token"},{"TokenType":"access_token","TokenValue":"****FSdg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLMNJC7HFJG2:00000001","TimeStamp":"2019-05-13T12:08:49.0000000Z","ProcessId":9320,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-13 16:08:49.235 +04:00 [DBG] Token request success.
2019-05-13 16:08:49.260 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-05-13 16:08:49.272 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-05-13 16:08:49.306 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-05-13 16:08:49.338 +04:00 [DBG] Start userinfo request
2019-05-13 16:08:49.343 +04:00 [DBG] Bearer token found in header
2019-05-13 16:08:49.393 +04:00 [DBG] StudLab found in database: true
2019-05-13 16:08:49.394 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-13 16:08:49.430 +04:00 [DBG] StudLab found in database: true
2019-05-13 16:08:49.434 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-13 16:08:49.458 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-05-13 16:08:49.467 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1557749329,"exp":1557752929,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"StudLab","sub":"2003","auth_time":1557749301,"idp":"local","AspNet.Identity.SecurityStamp":"KFUWEVYEB3IO7646C3QRFKYSKYXGIUKB","role":"user","preferred_username":"sashkacosmonaut@gmail.com","name":"sashkacosmonaut@gmail.com","email":"sashkacosmonaut@gmail.com","email_verified":false,"given_name":"sashkacosmonaut@gmail.com","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-05-13 16:08:49.509 +04:00 [DBG] Creating userinfo response
2019-05-13 16:08:49.511 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-13 16:08:49.521 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-13 16:08:49.540 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-13 16:08:49.544 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-05-13 16:08:49.551 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-13 16:08:49.597 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-13 16:08:49.668 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email
2019-05-13 16:08:49.675 +04:00 [DBG] End userinfo request
2019-05-16 21:24:07.416 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-16 21:24:07.621 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-16 21:24:07.623 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-16 21:24:07.624 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-16 21:24:07.625 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-16 21:24:07.626 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-16 21:24:07.627 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-16 21:24:08.672 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 21:24:08.743 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 21:24:08.790 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 21:24:09.206 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 21:24:09.606 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 21:24:09.682 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 21:24:09.717 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 21:24:09.751 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 21:24:09.773 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 21:24:10.029 +04:00 [DBG] Starting grant removal
2019-05-16 21:24:35.056 +04:00 [DBG] Login Url: /Account/Login
2019-05-16 21:24:35.105 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-16 21:24:35.119 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-16 21:24:35.133 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-16 21:24:35.140 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-16 21:24:35.169 +04:00 [DBG] Error Url: /home/error
2019-05-16 21:24:35.261 +04:00 [DBG] Error Id Parameter: errorId
2019-05-16 21:24:36.423 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-16 23:24:02.889 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-16 23:24:03.155 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-16 23:24:03.157 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-16 23:24:03.158 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-16 23:24:03.159 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-16 23:24:03.160 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-16 23:24:03.161 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-16 23:24:03.932 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 23:24:03.969 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 23:24:03.976 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 23:24:04.214 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:24:04.395 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:24:04.431 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:24:04.456 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:24:04.484 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:24:04.507 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:24:04.700 +04:00 [DBG] Starting grant removal
2019-05-16 23:27:01.055 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-16 23:27:01.182 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-16 23:27:01.184 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-16 23:27:01.185 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-16 23:27:01.185 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-16 23:27:01.186 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-16 23:27:01.187 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-16 23:27:01.880 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 23:27:01.908 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 23:27:01.915 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 23:27:02.120 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:27:02.311 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:27:02.364 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:27:02.384 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:27:02.407 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:27:02.424 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:27:02.559 +04:00 [DBG] Starting grant removal
2019-05-16 23:27:09.530 +04:00 [DBG] Login Url: /Account/Login
2019-05-16 23:27:09.537 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-16 23:27:09.540 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-16 23:27:09.542 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-16 23:27:09.543 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-16 23:27:09.544 +04:00 [DBG] Error Url: /home/error
2019-05-16 23:27:09.545 +04:00 [DBG] Error Id Parameter: errorId
2019-05-16 23:27:10.098 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-16 23:27:17.493 +04:00 [ERR] Request matched multiple actions resulting in ambiguity. Matching actions: AuthServiceServer.Controllers.AccountController.Edit (AuthServiceServer)
AuthServiceServer.Controllers.AccountController.Login (AuthServiceServer)
AuthServiceServer.Controllers.AccountController.Registration (AuthServiceServer)
AuthServiceServer.Controllers.AccountController.Logout (AuthServiceServer)
2019-05-16 23:27:18.149 +04:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.AspNetCore.Mvc.Internal.AmbiguousActionException: Multiple actions matched. The following actions matched route data and had all constraints satisfied:

AuthServiceServer.Controllers.AccountController.Edit (AuthServiceServer)
AuthServiceServer.Controllers.AccountController.Login (AuthServiceServer)
AuthServiceServer.Controllers.AccountController.Registration (AuthServiceServer)
AuthServiceServer.Controllers.AccountController.Logout (AuthServiceServer)
   at Microsoft.AspNetCore.Mvc.Internal.ActionSelector.SelectBestCandidate(RouteContext context, IReadOnlyList`1 candidates)
   at Microsoft.AspNetCore.Mvc.Internal.MvcAttributeRouteHandler.RouteAsync(RouteContext context)
   at Microsoft.AspNetCore.Routing.Tree.TreeRouter.RouteAsync(RouteContext context)
   at Microsoft.AspNetCore.Routing.RouteCollection.RouteAsync(RouteContext context)
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-05-16 23:28:10.563 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-16 23:28:10.683 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-16 23:28:10.685 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-16 23:28:10.686 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-16 23:28:10.686 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-16 23:28:10.687 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-16 23:28:10.687 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-16 23:28:11.420 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 23:28:11.452 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 23:28:11.457 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 23:28:11.665 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:28:11.834 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:28:11.869 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:28:11.890 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:28:11.912 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:28:11.929 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:28:12.058 +04:00 [DBG] Starting grant removal
2019-05-16 23:28:15.381 +04:00 [DBG] Login Url: /Account/Login
2019-05-16 23:28:15.391 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-16 23:28:15.395 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-16 23:28:15.399 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-16 23:28:15.400 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-16 23:28:15.401 +04:00 [DBG] Error Url: /home/error
2019-05-16 23:28:15.406 +04:00 [DBG] Error Id Parameter: errorId
2019-05-16 23:28:15.548 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-16 23:28:16.404 +04:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.AspNetCore.Routing.RouteCreationException: The following errors occurred with attribute routing information:

For action: 'AuthServiceServer.Controllers.AccountController.Index (AuthServiceServer)'
Error: The attribute route 'Account/{action}/Edit' cannot contain a parameter named '{action}'. Use '[action]' in the route template to insert the value 'Index'.

For action: 'AuthServiceServer.Controllers.AccountController.Index (AuthServiceServer)'
Error: The attribute route 'Account/{action}/Profile' cannot contain a parameter named '{action}'. Use '[action]' in the route template to insert the value 'Index'.

For action: 'AuthServiceServer.Controllers.AccountController.Edit (AuthServiceServer)'
Error: The attribute route 'Account/{action}' cannot contain a parameter named '{action}'. Use '[action]' in the route template to insert the value 'Edit'.

For action: 'AuthServiceServer.Controllers.AccountController.Edit (AuthServiceServer)'
Error: The attribute route 'Account/{action}' cannot contain a parameter named '{action}'. Use '[action]' in the route template to insert the value 'Edit'.

For action: 'AuthServiceServer.Controllers.AccountController.Login (AuthServiceServer)'
Error: The attribute route 'Account/{action}' cannot contain a parameter named '{action}'. Use '[action]' in the route template to insert the value 'Login'.

For action: 'AuthServiceServer.Controllers.AccountController.Login (AuthServiceServer)'
Error: The attribute route 'Account/{action}' cannot contain a parameter named '{action}'. Use '[action]' in the route template to insert the value 'Login'.

For action: 'AuthServiceServer.Controllers.AccountController.Registration (AuthServiceServer)'
Error: The attribute route 'Account/{action}' cannot contain a parameter named '{action}'. Use '[action]' in the route template to insert the value 'Registration'.

For action: 'AuthServiceServer.Controllers.AccountController.Registration (AuthServiceServer)'
Error: The attribute route 'Account/{action}' cannot contain a parameter named '{action}'. Use '[action]' in the route template to insert the value 'Registration'.

For action: 'AuthServiceServer.Controllers.AccountController.Logout (AuthServiceServer)'
Error: The attribute route 'Account/{action}' cannot contain a parameter named '{action}'. Use '[action]' in the route template to insert the value 'Logout'.

For action: 'AuthServiceServer.Controllers.AccountController.Logout (AuthServiceServer)'
Error: The attribute route 'Account/{action}' cannot contain a parameter named '{action}'. Use '[action]' in the route template to insert the value 'Logout'.

For action: 'AuthServiceServer.Controllers.AccountController.TestAuth (AuthServiceServer)'
Error: The attribute route 'Account/{action}' cannot contain a parameter named '{action}'. Use '[action]' in the route template to insert the value 'TestAuth'.
   at Microsoft.AspNetCore.Mvc.Internal.AttributeRoute.GetRouteInfos(IReadOnlyList`1 actions)
   at Microsoft.AspNetCore.Mvc.Internal.AttributeRoute.AddEntries(TreeRouteBuilder builder, ActionDescriptorCollection actions)
   at Microsoft.AspNetCore.Mvc.Internal.AttributeRoute.GetTreeRouter()
   at Microsoft.AspNetCore.Mvc.Internal.AttributeRoute.RouteAsync(RouteContext context)
   at Microsoft.AspNetCore.Routing.RouteCollection.RouteAsync(RouteContext context)
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-05-16 23:29:18.052 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-16 23:29:18.186 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-16 23:29:18.187 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-16 23:29:18.189 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-16 23:29:18.189 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-16 23:29:18.190 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-16 23:29:18.191 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-16 23:29:18.880 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 23:29:18.910 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 23:29:18.915 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 23:29:19.129 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:29:19.318 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:29:19.368 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:29:19.386 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:29:19.409 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:29:19.429 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:29:19.587 +04:00 [DBG] Starting grant removal
2019-05-16 23:29:20.055 +04:00 [DBG] Login Url: /Account/Login
2019-05-16 23:29:20.062 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-16 23:29:20.067 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-16 23:29:20.069 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-16 23:29:20.071 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-16 23:29:20.073 +04:00 [DBG] Error Url: /home/error
2019-05-16 23:29:20.079 +04:00 [DBG] Error Id Parameter: errorId
2019-05-16 23:29:20.235 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-16 23:29:35.113 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-05-16 23:29:35.120 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-05-16 23:29:35.124 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-05-16 23:29:35.500 +04:00 [ERR] An exception occurred in the database while iterating the results of a query for context type 'AuthServiceServer.Models.Data.UsersDbContext'.
System.InvalidOperationException: Sequence contains no elements
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
System.InvalidOperationException: Sequence contains no elements
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
2019-05-16 23:29:35.606 +04:00 [ERR] An exception occurred in the database while iterating the results of a query for context type 'AuthServiceServer.Models.Data.UsersDbContext'.
System.InvalidOperationException: Sequence contains no elements
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
System.InvalidOperationException: Sequence contains no elements
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
2019-05-16 23:29:36.738 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: Sequence contains no elements
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.Execute[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.Execute[TResult](Expression expression)
   at System.Linq.Queryable.First[TSource](IQueryable`1 source, Expression`1 predicate)
   at AuthServiceServer.Controllers.AccountController.Index() in D:\Projects\StudLab\AuthServiceServer\Controllers\AccountController.cs:line 46
   at lambda_method(Closure , Object , Object[] )
   at Microsoft.Extensions.Internal.ObjectMethodExecutor.Execute(Object target, Object[] parameters)
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.SyncActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-05-16 23:31:16.706 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-16 23:31:16.857 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-16 23:31:16.859 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-16 23:31:16.860 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-16 23:31:16.861 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-16 23:31:16.862 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-16 23:31:16.863 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-16 23:31:17.780 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 23:31:17.809 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 23:31:17.815 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 23:31:18.033 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:31:18.237 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:31:18.325 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:31:18.370 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:31:18.396 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:31:18.413 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:31:18.576 +04:00 [DBG] Starting grant removal
2019-05-16 23:31:19.718 +04:00 [DBG] Login Url: /Account/Login
2019-05-16 23:31:19.726 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-16 23:31:19.732 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-16 23:31:19.733 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-16 23:31:19.736 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-16 23:31:19.741 +04:00 [DBG] Error Url: /home/error
2019-05-16 23:31:19.743 +04:00 [DBG] Error Id Parameter: errorId
2019-05-16 23:31:19.855 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-16 23:31:20.815 +04:00 [ERR] An exception occurred in the database while iterating the results of a query for context type 'AuthServiceServer.Models.Data.UsersDbContext'.
System.InvalidOperationException: Sequence contains no elements
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
System.InvalidOperationException: Sequence contains no elements
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
2019-05-16 23:31:20.946 +04:00 [ERR] An exception occurred in the database while iterating the results of a query for context type 'AuthServiceServer.Models.Data.UsersDbContext'.
System.InvalidOperationException: Sequence contains no elements
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
System.InvalidOperationException: Sequence contains no elements
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
2019-05-16 23:31:22.515 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: Sequence contains no elements
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.Execute[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.Execute[TResult](Expression expression)
   at System.Linq.Queryable.First[TSource](IQueryable`1 source, Expression`1 predicate)
   at AuthServiceServer.Controllers.AccountController.Index() in D:\Projects\StudLab\AuthServiceServer\Controllers\AccountController.cs:line 46
   at lambda_method(Closure , Object , Object[] )
   at Microsoft.Extensions.Internal.ObjectMethodExecutor.Execute(Object target, Object[] parameters)
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.SyncActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-05-16 23:31:28.940 +04:00 [ERR] An exception occurred in the database while iterating the results of a query for context type 'AuthServiceServer.Models.Data.UsersDbContext'.
System.InvalidOperationException: Sequence contains no elements
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
System.InvalidOperationException: Sequence contains no elements
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
2019-05-16 23:31:29.046 +04:00 [ERR] An exception occurred in the database while iterating the results of a query for context type 'AuthServiceServer.Models.Data.UsersDbContext'.
System.InvalidOperationException: Sequence contains no elements
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
System.InvalidOperationException: Sequence contains no elements
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
2019-05-16 23:31:30.187 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: Sequence contains no elements
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.Execute[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.Execute[TResult](Expression expression)
   at System.Linq.Queryable.First[TSource](IQueryable`1 source, Expression`1 predicate)
   at AuthServiceServer.Controllers.AccountController.Index() in D:\Projects\StudLab\AuthServiceServer\Controllers\AccountController.cs:line 46
   at lambda_method(Closure , Object , Object[] )
   at Microsoft.Extensions.Internal.ObjectMethodExecutor.Execute(Object target, Object[] parameters)
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.SyncActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-05-16 23:33:58.502 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-16 23:33:58.637 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-16 23:33:58.639 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-16 23:33:58.639 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-16 23:33:58.640 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-16 23:33:58.641 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-16 23:33:58.641 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-16 23:33:59.289 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 23:33:59.318 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 23:33:59.323 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 23:33:59.516 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:33:59.693 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:33:59.730 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:33:59.753 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:33:59.777 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:33:59.797 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:33:59.941 +04:00 [DBG] Starting grant removal
2019-05-16 23:34:00.866 +04:00 [DBG] Login Url: /Account/Login
2019-05-16 23:34:00.875 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-16 23:34:00.878 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-16 23:34:00.880 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-16 23:34:00.882 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-16 23:34:00.884 +04:00 [DBG] Error Url: /home/error
2019-05-16 23:34:00.885 +04:00 [DBG] Error Id Parameter: errorId
2019-05-16 23:34:00.984 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-16 23:34:01.589 +04:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-05-16 23:38:12.468 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-16 23:38:12.592 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-16 23:38:12.594 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-16 23:38:12.595 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-16 23:38:12.596 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-16 23:38:12.596 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-16 23:38:12.597 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-16 23:38:13.229 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 23:38:13.258 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 23:38:13.263 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 23:38:13.470 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:38:13.639 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:38:13.675 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:38:13.693 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:38:13.717 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:38:13.735 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:38:13.852 +04:00 [DBG] Starting grant removal
2019-05-16 23:38:17.426 +04:00 [DBG] Login Url: /Account/Login
2019-05-16 23:38:17.438 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-16 23:38:17.441 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-16 23:38:17.442 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-16 23:38:17.444 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-16 23:38:17.445 +04:00 [DBG] Error Url: /home/error
2019-05-16 23:38:17.446 +04:00 [DBG] Error Id Parameter: errorId
2019-05-16 23:38:17.527 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-16 23:40:54.332 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-16 23:40:54.466 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-16 23:40:54.468 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-16 23:40:54.469 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-16 23:40:54.469 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-16 23:40:54.470 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-16 23:40:54.471 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-16 23:40:55.166 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 23:40:55.195 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 23:40:55.200 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 23:40:55.395 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:40:55.589 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:40:55.624 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:40:55.643 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:40:56.169 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:40:56.292 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:40:56.435 +04:00 [DBG] Starting grant removal
2019-05-16 23:41:09.586 +04:00 [DBG] Login Url: /Account/Login
2019-05-16 23:41:09.594 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-16 23:41:09.598 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-16 23:41:09.599 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-16 23:41:09.600 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-16 23:41:09.601 +04:00 [DBG] Error Url: /home/error
2019-05-16 23:41:09.606 +04:00 [DBG] Error Id Parameter: errorId
2019-05-16 23:41:09.698 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-16 23:41:38.954 +04:00 [DBG] Augmenting SignInContext
2019-05-16 23:41:39.195 +04:00 [DBG] Adding idp claim with value: local
2019-05-16 23:41:39.196 +04:00 [DBG] Adding amr claim with value: pwd
2019-05-16 23:41:39.208 +04:00 [DBG] Adding auth_time claim with value: 1558035698
2019-05-16 23:41:39.295 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-16 23:54:52.393 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-05-16 23:54:52.400 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-05-16 23:54:52.404 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-05-16 23:55:30.781 +04:00 [DBG] Augmenting SignInContext
2019-05-16 23:55:30.782 +04:00 [DBG] Adding idp claim with value: local
2019-05-16 23:55:30.785 +04:00 [DBG] Adding amr claim with value: pwd
2019-05-16 23:55:30.787 +04:00 [DBG] Adding auth_time claim with value: 1558036530
2019-05-16 23:55:30.792 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-16 23:55:34.858 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at AuthServiceServer.Controllers.AccountController.Login(LoginModel model)
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-05-16 23:57:11.508 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-16 23:57:11.662 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-16 23:57:11.663 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-16 23:57:11.664 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-16 23:57:11.664 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-16 23:57:11.665 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-16 23:57:11.666 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-16 23:57:12.404 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 23:57:12.432 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 23:57:12.437 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-16 23:57:12.630 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:57:12.794 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:57:12.834 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:57:12.862 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:57:12.886 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:57:12.902 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-16 23:57:13.024 +04:00 [DBG] Starting grant removal
2019-05-16 23:57:16.200 +04:00 [DBG] Login Url: /Account/Login
2019-05-16 23:57:16.215 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-16 23:57:16.232 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-16 23:57:16.238 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-16 23:57:16.242 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-16 23:57:16.245 +04:00 [DBG] Error Url: /home/error
2019-05-16 23:57:16.248 +04:00 [DBG] Error Id Parameter: errorId
2019-05-16 23:57:16.411 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-16 23:57:26.987 +04:00 [DBG] Augmenting SignInContext
2019-05-16 23:57:27.017 +04:00 [DBG] Adding idp claim with value: local
2019-05-16 23:57:27.018 +04:00 [DBG] Adding amr claim with value: pwd
2019-05-16 23:57:27.024 +04:00 [DBG] Adding auth_time claim with value: 1558036646
2019-05-16 23:57:27.062 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-16 23:57:30.294 +04:00 [INF] {"Username":"dereguzov1123@yandex.ru","Provider":null,"ProviderUserId":null,"SubjectId":"3002","DisplayName":"dereguzov1123@yandex.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLMQ72OVEL1U:00000005","TimeStamp":"2019-05-16T19:57:30.0000000Z","ProcessId":7312,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-16 23:57:45.467 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-05-16 23:57:45.472 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-05-16 23:57:45.478 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-05-16 23:57:52.827 +04:00 [DBG] Augmenting SignInContext
2019-05-16 23:57:52.828 +04:00 [DBG] Adding idp claim with value: local
2019-05-16 23:57:52.833 +04:00 [DBG] Adding amr claim with value: pwd
2019-05-16 23:57:52.833 +04:00 [DBG] Adding auth_time claim with value: 1558036672
2019-05-16 23:57:52.838 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-16 23:57:52.846 +04:00 [INF] {"Username":"dereguzov1123@yandex.ru","Provider":null,"ProviderUserId":null,"SubjectId":"3002","DisplayName":"dereguzov1123@yandex.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLMQ72OVEL1U:0000000C","TimeStamp":"2019-05-16T19:57:52.0000000Z","ProcessId":7312,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-17 00:03:43.237 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-17 00:03:43.369 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-17 00:03:43.370 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-17 00:03:43.371 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-17 00:03:43.372 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-17 00:03:43.372 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-17 00:03:43.373 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-17 00:03:44.200 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 00:03:44.227 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 00:03:44.235 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 00:03:44.473 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 00:03:44.670 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 00:03:44.706 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 00:03:44.736 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 00:03:44.768 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 00:03:44.790 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 00:03:44.967 +04:00 [DBG] Starting grant removal
2019-05-17 00:03:58.526 +04:00 [DBG] Login Url: /Account/Login
2019-05-17 00:03:58.535 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-17 00:03:58.537 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-17 00:03:58.541 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-17 00:03:58.543 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-17 00:03:58.545 +04:00 [DBG] Error Url: /home/error
2019-05-17 00:03:58.551 +04:00 [DBG] Error Id Parameter: errorId
2019-05-17 00:03:58.730 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-17 00:04:49.611 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-17 00:04:49.638 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-17 00:04:49.643 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-17 00:04:49.660 +04:00 [DBG] Start discovery request
2019-05-17 00:04:50.311 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-05-17 00:04:50.711 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-17 00:04:50.723 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-17 00:04:50.726 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-17 00:04:50.740 +04:00 [DBG] Start authorize request
2019-05-17 00:04:50.772 +04:00 [DBG] User in authorize request: 3002
2019-05-17 00:04:50.806 +04:00 [DBG] Start authorize request protocol validation
2019-05-17 00:04:51.646 +04:00 [DBG] StudLab found in database: true
2019-05-17 00:04:51.662 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 00:04:51.680 +04:00 [DBG] Checking for PKCE parameters
2019-05-17 00:04:51.685 +04:00 [DBG] No PKCE used.
2019-05-17 00:04:51.815 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 00:04:51.930 +04:00 [DBG] Found [] API scopes in database
2019-05-17 00:04:51.956 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 00:04:51.961 +04:00 [DBG] Found [] API scopes in database
2019-05-17 00:04:51.982 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-17 00:04:52.022 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"3002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK8-R0H1SVX57ZovuJu5VtPdUUUcazykzErzXtLXtDrmIBA-OzHuG4MX2OJywwTZWFWm9z5DOOEk29Zw2P6LAXqXPH4y7V2juuhuHgBsPkT5JEICjbANOg4tb2fvp6teP57T5MxyYF36KThFuR89U92JZ1wihDbfyYlOXP49ko4IKIWCvQY9KfWpok2cv5VPyY4ZjI9LQbJXRiVQ2o_9_5ZollpAU2b5H1e-Y7zGZ3RHqTe1GpJTIUsQdWDHWVQO5rjNEp8kfx1_vLqmTTRaxwnXG","UiLocales":null,"Nonce":"636936338906465202.ODcwMzc1ZDgtMjM3Ny00YzUyLThiZWMtNjE1YWEyOGJkOTgwNzVmNjNmYzQtNzg0Ny00YTJhLTkwYWUtYWFiYjVmMTI3MzJi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a2ba5ab1fe85d7012348fb2d0e10cb6e","Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636936338906465202.ODcwMzc1ZDgtMjM3Ny00YzUyLThiZWMtNjE1YWEyOGJkOTgwNzVmNjNmYzQtNzg0Ny00YTJhLTkwYWUtYWFiYjVmMTI3MzJi","state":"CfDJ8D73mgAamspIvsbnstRoK8-R0H1SVX57ZovuJu5VtPdUUUcazykzErzXtLXtDrmIBA-OzHuG4MX2OJywwTZWFWm9z5DOOEk29Zw2P6LAXqXPH4y7V2juuhuHgBsPkT5JEICjbANOg4tb2fvp6teP57T5MxyYF36KThFuR89U92JZ1wihDbfyYlOXP49ko4IKIWCvQY9KfWpok2cv5VPyY4ZjI9LQbJXRiVQ2o_9_5ZollpAU2b5H1e-Y7zGZ3RHqTe1GpJTIUsQdWDHWVQO5rjNEp8kfx1_vLqmTTRaxwnXG","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-17 00:04:52.150 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-05-17 00:04:52.169 +04:00 [DBG] Creating Hybrid Flow response.
2019-05-17 00:04:52.282 +04:00 [DBG] LSk/56OWs0PINCFsVavC3GirR9yhVquULA/gzfVUKIw= not found in database
2019-05-17 00:04:52.431 +04:00 [DBG] Creating Implicit Flow response.
2019-05-17 00:04:52.457 +04:00 [DBG] Getting claims for identity token for subject: 3002 and client: StudLab
2019-05-17 00:04:52.769 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-17 00:04:53.825 +04:00 [INF] {"Details":"System.InvalidOperationException: No signing credential is configured. Can't create JWT token\r\n   at IdentityServer4.Services.DefaultTokenCreationService.CreateHeaderAsync(Token token) in C:\\local\\identity\\server4\\IdentityServer4\\src\\Services\\Default\\DefaultTokenCreationService.cs:line 73\r\n   at IdentityServer4.Services.DefaultTokenCreationService.CreateTokenAsync(Token token) in C:\\local\\identity\\server4\\IdentityServer4\\src\\Services\\Default\\DefaultTokenCreationService.cs:line 60\r\n   at IdentityServer4.Services.DefaultTokenService.CreateSecurityTokenAsync(Token token) in C:\\local\\identity\\server4\\IdentityServer4\\src\\Services\\Default\\DefaultTokenService.cs:line 225\r\n   at IdentityServer4.ResponseHandling.AuthorizeResponseGenerator.CreateImplicitFlowResponseAsync(ValidatedAuthorizeRequest request, String authorizationCode) in C:\\local\\identity\\server4\\IdentityServer4\\src\\ResponseHandling\\Default\\AuthorizeResponseGenerator.cs:line 177\r\n   at IdentityServer4.ResponseHandling.AuthorizeResponseGenerator.CreateHybridFlowResponseAsync(ValidatedAuthorizeRequest request) in C:\\local\\identity\\server4\\IdentityServer4\\src\\ResponseHandling\\Default\\AuthorizeResponseGenerator.cs:line 102\r\n   at IdentityServer4.ResponseHandling.AuthorizeResponseGenerator.CreateResponseAsync(ValidatedAuthorizeRequest request) in C:\\local\\identity\\server4\\IdentityServer4\\src\\ResponseHandling\\Default\\AuthorizeResponseGenerator.cs:line 85\r\n   at IdentityServer4.Endpoints.AuthorizeEndpointBase.ProcessAuthorizeRequestAsync(NameValueCollection parameters, ClaimsPrincipal user, ConsentResponse consent) in C:\\local\\identity\\server4\\IdentityServer4\\src\\Endpoints\\AuthorizeEndpointBase.cs:line 99\r\n   at IdentityServer4.Endpoints.AuthorizeEndpoint.ProcessAsync(HttpContext context) in C:\\local\\identity\\server4\\IdentityServer4\\src\\Endpoints\\AuthorizeEndpoint.cs:line 55\r\n   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\\local\\identity\\server4\\IdentityServer4\\src\\Hosting\\IdentityServerMiddleware.cs:line 54","Category":"Error","Name":"Unhandled Exception","EventType":"Error","Id":3000,"Message":"No signing credential is configured. Can't create JWT token","ActivityId":"0HLMQ76GR7QCH:00000003","TimeStamp":"2019-05-16T20:04:53.0000000Z","ProcessId":4324,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UnhandledExceptionEvent"}
2019-05-17 00:04:53.853 +04:00 [FTL] Unhandled exception: No signing credential is configured. Can't create JWT token
System.InvalidOperationException: No signing credential is configured. Can't create JWT token
   at IdentityServer4.Services.DefaultTokenCreationService.CreateHeaderAsync(Token token) in C:\local\identity\server4\IdentityServer4\src\Services\Default\DefaultTokenCreationService.cs:line 73
   at IdentityServer4.Services.DefaultTokenCreationService.CreateTokenAsync(Token token) in C:\local\identity\server4\IdentityServer4\src\Services\Default\DefaultTokenCreationService.cs:line 60
   at IdentityServer4.Services.DefaultTokenService.CreateSecurityTokenAsync(Token token) in C:\local\identity\server4\IdentityServer4\src\Services\Default\DefaultTokenService.cs:line 225
   at IdentityServer4.ResponseHandling.AuthorizeResponseGenerator.CreateImplicitFlowResponseAsync(ValidatedAuthorizeRequest request, String authorizationCode) in C:\local\identity\server4\IdentityServer4\src\ResponseHandling\Default\AuthorizeResponseGenerator.cs:line 177
   at IdentityServer4.ResponseHandling.AuthorizeResponseGenerator.CreateHybridFlowResponseAsync(ValidatedAuthorizeRequest request) in C:\local\identity\server4\IdentityServer4\src\ResponseHandling\Default\AuthorizeResponseGenerator.cs:line 102
   at IdentityServer4.ResponseHandling.AuthorizeResponseGenerator.CreateResponseAsync(ValidatedAuthorizeRequest request) in C:\local\identity\server4\IdentityServer4\src\ResponseHandling\Default\AuthorizeResponseGenerator.cs:line 85
   at IdentityServer4.Endpoints.AuthorizeEndpointBase.ProcessAuthorizeRequestAsync(NameValueCollection parameters, ClaimsPrincipal user, ConsentResponse consent) in C:\local\identity\server4\IdentityServer4\src\Endpoints\AuthorizeEndpointBase.cs:line 99
   at IdentityServer4.Endpoints.AuthorizeEndpoint.ProcessAsync(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Endpoints\AuthorizeEndpoint.cs:line 55
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 54
2019-05-17 00:04:55.183 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: No signing credential is configured. Can't create JWT token
   at IdentityServer4.Services.DefaultTokenCreationService.CreateHeaderAsync(Token token) in C:\local\identity\server4\IdentityServer4\src\Services\Default\DefaultTokenCreationService.cs:line 73
   at IdentityServer4.Services.DefaultTokenCreationService.CreateTokenAsync(Token token) in C:\local\identity\server4\IdentityServer4\src\Services\Default\DefaultTokenCreationService.cs:line 60
   at IdentityServer4.Services.DefaultTokenService.CreateSecurityTokenAsync(Token token) in C:\local\identity\server4\IdentityServer4\src\Services\Default\DefaultTokenService.cs:line 225
   at IdentityServer4.ResponseHandling.AuthorizeResponseGenerator.CreateImplicitFlowResponseAsync(ValidatedAuthorizeRequest request, String authorizationCode) in C:\local\identity\server4\IdentityServer4\src\ResponseHandling\Default\AuthorizeResponseGenerator.cs:line 177
   at IdentityServer4.ResponseHandling.AuthorizeResponseGenerator.CreateHybridFlowResponseAsync(ValidatedAuthorizeRequest request) in C:\local\identity\server4\IdentityServer4\src\ResponseHandling\Default\AuthorizeResponseGenerator.cs:line 102
   at IdentityServer4.ResponseHandling.AuthorizeResponseGenerator.CreateResponseAsync(ValidatedAuthorizeRequest request) in C:\local\identity\server4\IdentityServer4\src\ResponseHandling\Default\AuthorizeResponseGenerator.cs:line 85
   at IdentityServer4.Endpoints.AuthorizeEndpointBase.ProcessAuthorizeRequestAsync(NameValueCollection parameters, ClaimsPrincipal user, ConsentResponse consent) in C:\local\identity\server4\IdentityServer4\src\Endpoints\AuthorizeEndpointBase.cs:line 99
   at IdentityServer4.Endpoints.AuthorizeEndpoint.ProcessAsync(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Endpoints\AuthorizeEndpoint.cs:line 55
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 54
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 69
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-05-17 00:17:09.677 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-17 00:17:09.833 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-17 00:17:09.835 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-17 00:17:09.836 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-17 00:17:09.837 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-17 00:17:09.837 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-17 00:17:09.838 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-17 00:17:10.527 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 00:17:10.561 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 00:17:10.567 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 00:17:10.825 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 00:17:11.077 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 00:17:11.119 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 00:17:11.144 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 00:17:11.177 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 00:17:11.202 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 00:17:11.366 +04:00 [DBG] Starting grant removal
2019-05-17 00:17:42.304 +04:00 [DBG] Login Url: /Account/Login
2019-05-17 00:17:42.312 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-17 00:17:42.315 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-17 00:17:42.316 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-17 00:17:42.317 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-17 00:17:42.319 +04:00 [DBG] Error Url: /home/error
2019-05-17 00:17:42.320 +04:00 [DBG] Error Id Parameter: errorId
2019-05-17 00:17:42.387 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-17 00:17:42.404 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-17 00:17:42.407 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-17 00:17:42.419 +04:00 [DBG] Start discovery request
2019-05-17 00:17:43.062 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-05-17 00:17:43.297 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-17 00:17:43.307 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-17 00:17:43.309 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-17 00:17:43.325 +04:00 [DBG] Start key discovery request
2019-05-17 00:17:43.538 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-17 00:17:43.562 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-17 00:17:43.567 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-17 00:17:43.581 +04:00 [DBG] Start authorize request
2019-05-17 00:17:43.635 +04:00 [DBG] User in authorize request: 3002
2019-05-17 00:17:43.661 +04:00 [DBG] Start authorize request protocol validation
2019-05-17 00:17:44.545 +04:00 [DBG] StudLab found in database: true
2019-05-17 00:17:44.563 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 00:17:44.577 +04:00 [DBG] Checking for PKCE parameters
2019-05-17 00:17:44.583 +04:00 [DBG] No PKCE used.
2019-05-17 00:17:44.733 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 00:17:44.943 +04:00 [DBG] Found [] API scopes in database
2019-05-17 00:17:44.967 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 00:17:44.976 +04:00 [DBG] Found [] API scopes in database
2019-05-17 00:17:45.002 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-17 00:17:45.075 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"3002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK89p6CcenpfNSDnc8r7_AohtjDgAHDyP9MsMb6lI0nLXQInkvESp2NqZjW9khuSfAv5SSWnDTYxYgPGKwFKJmwGKWJPXbjdUoyRDot7UMFOvY8DQg8y34-obuIHDQtb3iRkBaBivLGSFUd3Puitd9fcADB2gLTxrezG6J0WrABySO81C3mVsvQQ9DaRetO-EWEdZchp2Mjbig8TF89vp5itWb3oamj9wlxw4wk8rHWtQOu-_nWleg1bJqE8EW_lI505c02zFRG_iyjqW2sTYA7-U","UiLocales":null,"Nonce":"636936346634421546.YmNlMDYxMjYtOTIxZC00YTFjLWJjZjctZTlmYTEzMThjMGVhYmY4OTkxZTMtZGViOS00MDIxLTliM2UtMDE2NDc1ZDg5YTgx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a2ba5ab1fe85d7012348fb2d0e10cb6e","Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636936346634421546.YmNlMDYxMjYtOTIxZC00YTFjLWJjZjctZTlmYTEzMThjMGVhYmY4OTkxZTMtZGViOS00MDIxLTliM2UtMDE2NDc1ZDg5YTgx","state":"CfDJ8D73mgAamspIvsbnstRoK89p6CcenpfNSDnc8r7_AohtjDgAHDyP9MsMb6lI0nLXQInkvESp2NqZjW9khuSfAv5SSWnDTYxYgPGKwFKJmwGKWJPXbjdUoyRDot7UMFOvY8DQg8y34-obuIHDQtb3iRkBaBivLGSFUd3Puitd9fcADB2gLTxrezG6J0WrABySO81C3mVsvQQ9DaRetO-EWEdZchp2Mjbig8TF89vp5itWb3oamj9wlxw4wk8rHWtQOu-_nWleg1bJqE8EW_lI505c02zFRG_iyjqW2sTYA7-U","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-17 00:17:45.231 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-05-17 00:17:45.257 +04:00 [DBG] Creating Hybrid Flow response.
2019-05-17 00:17:45.502 +04:00 [DBG] gG6H0Ats5l2FKWJwJwYPDLeipx6Jufe5yK1sFoBCkH8= not found in database
2019-05-17 00:17:45.968 +04:00 [DBG] Creating Implicit Flow response.
2019-05-17 00:17:46.028 +04:00 [DBG] Getting claims for identity token for subject: 3002 and client: StudLab
2019-05-17 00:17:46.441 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-17 00:17:46.748 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"3002","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****L_xQ","$type":"Token"},{"TokenType":"code","TokenValue":"****efa0","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLMQ7E2IN17U:00000001","TimeStamp":"2019-05-16T20:17:46.0000000Z","ProcessId":12832,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-17 00:17:46.778 +04:00 [INF] Authorize endpoint response
{"SubjectId":"3002","ClientId":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8D73mgAamspIvsbnstRoK89p6CcenpfNSDnc8r7_AohtjDgAHDyP9MsMb6lI0nLXQInkvESp2NqZjW9khuSfAv5SSWnDTYxYgPGKwFKJmwGKWJPXbjdUoyRDot7UMFOvY8DQg8y34-obuIHDQtb3iRkBaBivLGSFUd3Puitd9fcADB2gLTxrezG6J0WrABySO81C3mVsvQQ9DaRetO-EWEdZchp2Mjbig8TF89vp5itWb3oamj9wlxw4wk8rHWtQOu-_nWleg1bJqE8EW_lI505c02zFRG_iyjqW2sTYA7-U","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-17 00:17:46.863 +04:00 [DBG] Augmenting SignInContext
2019-05-17 00:17:46.909 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-17 00:17:47.409 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-17 00:17:47.460 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-17 00:17:47.477 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-17 00:17:47.520 +04:00 [DBG] Start token request.
2019-05-17 00:17:47.547 +04:00 [DBG] Start client validation
2019-05-17 00:17:47.569 +04:00 [DBG] Start parsing Basic Authentication secret
2019-05-17 00:17:47.592 +04:00 [DBG] Start parsing for secret in post body
2019-05-17 00:17:47.653 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-17 00:17:47.655 +04:00 [DBG] Secret id found: StudLab
2019-05-17 00:17:47.674 +04:00 [DBG] StudLab found in database: true
2019-05-17 00:17:47.675 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 00:17:47.711 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-17 00:17:47.712 +04:00 [DBG] Client validation success
2019-05-17 00:17:47.716 +04:00 [INF] {"ClientId":"StudLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLMQ7E2IN17V:00000003","TimeStamp":"2019-05-16T20:17:47.0000000Z","ProcessId":12832,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-17 00:17:47.747 +04:00 [DBG] Start token request validation
2019-05-17 00:17:47.783 +04:00 [DBG] Start validation of authorization code token request
2019-05-17 00:17:47.840 +04:00 [DBG] gG6H0Ats5l2FKWJwJwYPDLeipx6Jufe5yK1sFoBCkH8= found in database: true
2019-05-17 00:17:47.895 +04:00 [DBG] removing gG6H0Ats5l2FKWJwJwYPDLeipx6Jufe5yK1sFoBCkH8= persisted grant from database
2019-05-17 00:17:47.928 +04:00 [DBG] Validation of authorization code token request success
2019-05-17 00:17:47.944 +04:00 [INF] Token request validation success
{"ClientId":"StudLab","ClientName":"StudLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"520515841244c63bc7ef957a916211d86f90f12c82d73b04242a03277239efa0","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"StudLab","client_secret":"***REDACTED***","code":"520515841244c63bc7ef957a916211d86f90f12c82d73b04242a03277239efa0","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-05-17 00:17:48.036 +04:00 [DBG] StudLab found in database: true
2019-05-17 00:17:48.037 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 00:17:48.064 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 00:17:48.081 +04:00 [DBG] Found [] API scopes in database
2019-05-17 00:17:48.114 +04:00 [DBG] Getting claims for access token for client: StudLab
2019-05-17 00:17:48.115 +04:00 [DBG] Getting claims for access token for subject: 3002
2019-05-17 00:17:48.135 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-17 00:17:48.175 +04:00 [DBG] Creating refresh token
2019-05-17 00:17:48.176 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-05-17 00:17:48.217 +04:00 [DBG] qWyJHgBH6XyjY1zIX0y3VWP077s5Mxf9tUPe6MTxR48= not found in database
2019-05-17 00:17:48.233 +04:00 [DBG] StudLab found in database: true
2019-05-17 00:17:48.234 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 00:17:48.243 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 00:17:48.248 +04:00 [DBG] Found [] API scopes in database
2019-05-17 00:17:48.250 +04:00 [DBG] Getting claims for identity token for subject: 3002 and client: StudLab
2019-05-17 00:17:48.274 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-17 00:17:48.293 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****8BJQ","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****1c7a","$type":"Token"},{"TokenType":"access_token","TokenValue":"****3YAQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLMQ7E2IN17V:00000003","TimeStamp":"2019-05-16T20:17:48.0000000Z","ProcessId":12832,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-17 00:17:48.317 +04:00 [DBG] Token request success.
2019-05-17 00:17:48.352 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-05-17 00:17:48.359 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-05-17 00:17:48.362 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-05-17 00:17:48.382 +04:00 [DBG] Start userinfo request
2019-05-17 00:17:48.396 +04:00 [DBG] Bearer token found in header
2019-05-17 00:17:48.559 +04:00 [DBG] StudLab found in database: true
2019-05-17 00:17:48.560 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 00:17:48.579 +04:00 [DBG] StudLab found in database: true
2019-05-17 00:17:48.580 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 00:17:48.600 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-05-17 00:17:48.612 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1558037868,"exp":1558041468,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"StudLab","sub":"3002","auth_time":1558036672,"idp":"local","AspNet.Identity.SecurityStamp":"3J6ZWOULNXHDH2A3F3VVEGSPACJVRNG6","role":"user","preferred_username":"dereguzov1123@yandex.ru","name":"dereguzov1123@yandex.ru","email":"dereguzov1123@yandex.ru","email_verified":false,"given_name":"dereguzov1123@yandex.ru","username":"Kirill","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-05-17 00:17:48.667 +04:00 [DBG] Creating userinfo response
2019-05-17 00:17:48.678 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-17 00:17:48.686 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-17 00:17:48.699 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 00:17:48.705 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-05-17 00:17:48.708 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-17 00:17:48.716 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 00:17:48.740 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email username
2019-05-17 00:17:48.745 +04:00 [DBG] End userinfo request
2019-05-17 00:21:26.987 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-17 00:21:27.119 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-17 00:21:27.120 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-17 00:21:27.121 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-17 00:21:27.122 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-17 00:21:27.123 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-17 00:21:27.123 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-17 00:21:28.463 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 00:21:28.486 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 00:21:28.491 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 00:21:28.741 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 00:21:28.941 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 00:21:28.975 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 00:21:28.993 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 00:21:29.016 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 00:21:29.032 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 00:21:29.190 +04:00 [DBG] Starting grant removal
2019-05-17 14:21:25.239 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-17 14:21:25.637 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-17 14:21:25.644 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-17 14:21:25.646 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-17 14:21:25.652 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-17 14:21:25.656 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-17 14:21:25.661 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-17 14:21:27.684 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 14:21:27.730 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 14:21:27.740 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 14:21:28.172 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 14:21:28.553 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 14:21:28.621 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 14:21:28.742 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 14:21:28.798 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 14:21:28.851 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 14:21:29.117 +04:00 [DBG] Starting grant removal
2019-05-17 14:42:21.929 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-17 14:42:22.303 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-17 14:42:22.307 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-17 14:42:22.310 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-17 14:42:22.311 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-17 14:42:22.315 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-17 14:42:22.320 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-17 14:42:24.310 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 14:42:24.369 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 14:42:24.378 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 14:42:24.932 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 14:42:25.369 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 14:42:25.473 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 14:42:25.529 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 14:42:25.604 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 14:42:25.668 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 14:42:25.911 +04:00 [DBG] Starting grant removal
2019-05-17 14:42:30.721 +04:00 [DBG] Login Url: /Account/Login
2019-05-17 14:42:30.744 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-17 14:42:30.750 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-17 14:42:30.761 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-17 14:42:30.771 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-17 14:42:30.778 +04:00 [DBG] Error Url: /home/error
2019-05-17 14:42:30.794 +04:00 [DBG] Error Id Parameter: errorId
2019-05-17 14:42:31.008 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-17 14:42:31.060 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-17 14:42:31.093 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-17 14:42:31.150 +04:00 [DBG] Start discovery request
2019-05-17 14:42:32.657 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-05-17 14:42:33.490 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-17 14:42:33.528 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-17 14:42:33.555 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-17 14:42:33.586 +04:00 [DBG] Start key discovery request
2019-05-17 14:42:34.407 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-17 14:42:34.445 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-17 14:42:34.456 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-17 14:42:34.487 +04:00 [DBG] Start authorize request
2019-05-17 14:42:34.586 +04:00 [DBG] No user present in authorize request
2019-05-17 14:42:34.622 +04:00 [DBG] Start authorize request protocol validation
2019-05-17 14:42:37.853 +04:00 [DBG] StudLab found in database: true
2019-05-17 14:42:37.893 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 14:42:37.934 +04:00 [DBG] Checking for PKCE parameters
2019-05-17 14:42:37.955 +04:00 [DBG] No PKCE used.
2019-05-17 14:42:38.243 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 14:42:38.520 +04:00 [DBG] Found [] API scopes in database
2019-05-17 14:42:38.575 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 14:42:38.586 +04:00 [DBG] Found [] API scopes in database
2019-05-17 14:42:38.640 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-17 14:42:38.735 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK8_anRxe7x7F3yIl-yokEHWMyTXm71k4MV64BvgSuMBK2oWydpIcoY_mb2zhs-cmvAU7znGP_bMowlf_CCCo17fsELevKsSaO0dUUXNKhK-e6P3pPJj2GEwLrYn3PycP8ryBj4pHdJkZshU7dvyi8CtipTGbayxfjTJxYI9HdSPB5r4fjIG_hEflDphFQzYKG8tziIFlx-Hm0kfmAvcLeLZLLXPwVrZvEwJSKjFreM34jAjuiFDlJmwOJzfbHqNsa0GWlgHLRLJfrqTgFb_zm1xT","UiLocales":null,"Nonce":"636936865541017947.ODQ0YWUxODItZjhiYy00ZTE2LWExMmItZDQ1M2VhOThkYzZlNzM1MGI1MDEtZmZjOC00N2RkLTg3NzYtNzkzZDg4NDQzYWFl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636936865541017947.ODQ0YWUxODItZjhiYy00ZTE2LWExMmItZDQ1M2VhOThkYzZlNzM1MGI1MDEtZmZjOC00N2RkLTg3NzYtNzkzZDg4NDQzYWFl","state":"CfDJ8D73mgAamspIvsbnstRoK8_anRxe7x7F3yIl-yokEHWMyTXm71k4MV64BvgSuMBK2oWydpIcoY_mb2zhs-cmvAU7znGP_bMowlf_CCCo17fsELevKsSaO0dUUXNKhK-e6P3pPJj2GEwLrYn3PycP8ryBj4pHdJkZshU7dvyi8CtipTGbayxfjTJxYI9HdSPB5r4fjIG_hEflDphFQzYKG8tziIFlx-Hm0kfmAvcLeLZLLXPwVrZvEwJSKjFreM34jAjuiFDlJmwOJzfbHqNsa0GWlgHLRLJfrqTgFb_zm1xT","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-17 14:42:38.893 +04:00 [INF] Showing login: User is not authenticated
2019-05-17 14:42:38.976 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-17 14:42:58.409 +04:00 [DBG] Augmenting SignInContext
2019-05-17 14:42:58.440 +04:00 [DBG] Adding idp claim with value: local
2019-05-17 14:42:58.457 +04:00 [DBG] Adding amr claim with value: pwd
2019-05-17 14:42:58.462 +04:00 [DBG] Adding auth_time claim with value: 1558089778
2019-05-17 14:42:58.537 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-17 14:42:58.767 +04:00 [INF] {"Username":"dereguzov1123@yandex.ru","Provider":null,"ProviderUserId":null,"SubjectId":"3002","DisplayName":"dereguzov1123@yandex.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLMQMHE3EPKS:00000002","TimeStamp":"2019-05-17T10:42:58.0000000Z","ProcessId":4704,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-17 14:42:59.124 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-05-17 14:42:59.144 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-05-17 14:42:59.164 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-05-17 14:42:59.238 +04:00 [DBG] Start authorize callback request
2019-05-17 14:42:59.275 +04:00 [DBG] User in authorize request: 3002
2019-05-17 14:42:59.285 +04:00 [DBG] Start authorize request protocol validation
2019-05-17 14:42:59.367 +04:00 [DBG] StudLab found in database: true
2019-05-17 14:42:59.370 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 14:42:59.375 +04:00 [DBG] Checking for PKCE parameters
2019-05-17 14:42:59.402 +04:00 [DBG] No PKCE used.
2019-05-17 14:42:59.457 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 14:42:59.501 +04:00 [DBG] Found [] API scopes in database
2019-05-17 14:42:59.523 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 14:42:59.571 +04:00 [DBG] Found [] API scopes in database
2019-05-17 14:42:59.591 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-17 14:42:59.639 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"3002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK8_anRxe7x7F3yIl-yokEHWMyTXm71k4MV64BvgSuMBK2oWydpIcoY_mb2zhs-cmvAU7znGP_bMowlf_CCCo17fsELevKsSaO0dUUXNKhK-e6P3pPJj2GEwLrYn3PycP8ryBj4pHdJkZshU7dvyi8CtipTGbayxfjTJxYI9HdSPB5r4fjIG_hEflDphFQzYKG8tziIFlx-Hm0kfmAvcLeLZLLXPwVrZvEwJSKjFreM34jAjuiFDlJmwOJzfbHqNsa0GWlgHLRLJfrqTgFb_zm1xT","UiLocales":null,"Nonce":"636936865541017947.ODQ0YWUxODItZjhiYy00ZTE2LWExMmItZDQ1M2VhOThkYzZlNzM1MGI1MDEtZmZjOC00N2RkLTg3NzYtNzkzZDg4NDQzYWFl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a961634245d3899b9b3f4524904e6d0f","Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636936865541017947.ODQ0YWUxODItZjhiYy00ZTE2LWExMmItZDQ1M2VhOThkYzZlNzM1MGI1MDEtZmZjOC00N2RkLTg3NzYtNzkzZDg4NDQzYWFl","state":"CfDJ8D73mgAamspIvsbnstRoK8_anRxe7x7F3yIl-yokEHWMyTXm71k4MV64BvgSuMBK2oWydpIcoY_mb2zhs-cmvAU7znGP_bMowlf_CCCo17fsELevKsSaO0dUUXNKhK-e6P3pPJj2GEwLrYn3PycP8ryBj4pHdJkZshU7dvyi8CtipTGbayxfjTJxYI9HdSPB5r4fjIG_hEflDphFQzYKG8tziIFlx-Hm0kfmAvcLeLZLLXPwVrZvEwJSKjFreM34jAjuiFDlJmwOJzfbHqNsa0GWlgHLRLJfrqTgFb_zm1xT","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-17 14:42:59.971 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-05-17 14:43:00.049 +04:00 [DBG] Creating Hybrid Flow response.
2019-05-17 14:43:00.359 +04:00 [DBG] dIjuGBEESyZ8+IEekTz0WDb9Yb08bFGGKqM7P6E8WTc= not found in database
2019-05-17 14:43:00.876 +04:00 [DBG] Creating Implicit Flow response.
2019-05-17 14:43:00.971 +04:00 [DBG] Getting claims for identity token for subject: 3002 and client: StudLab
2019-05-17 14:43:11.693 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-17 14:43:12.432 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"3002","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****B_vA","$type":"Token"},{"TokenType":"code","TokenValue":"****6051","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLMQMHE3EPKS:00000003","TimeStamp":"2019-05-17T10:43:12.0000000Z","ProcessId":4704,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-17 14:43:12.489 +04:00 [INF] Authorize endpoint response
{"SubjectId":"3002","ClientId":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8D73mgAamspIvsbnstRoK8_anRxe7x7F3yIl-yokEHWMyTXm71k4MV64BvgSuMBK2oWydpIcoY_mb2zhs-cmvAU7znGP_bMowlf_CCCo17fsELevKsSaO0dUUXNKhK-e6P3pPJj2GEwLrYn3PycP8ryBj4pHdJkZshU7dvyi8CtipTGbayxfjTJxYI9HdSPB5r4fjIG_hEflDphFQzYKG8tziIFlx-Hm0kfmAvcLeLZLLXPwVrZvEwJSKjFreM34jAjuiFDlJmwOJzfbHqNsa0GWlgHLRLJfrqTgFb_zm1xT","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-17 14:43:12.652 +04:00 [DBG] Augmenting SignInContext
2019-05-17 14:43:12.659 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-17 14:43:13.837 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-17 14:43:13.890 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-17 14:43:13.906 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-17 14:43:14.006 +04:00 [DBG] Start token request.
2019-05-17 14:43:14.069 +04:00 [DBG] Start client validation
2019-05-17 14:43:14.117 +04:00 [DBG] Start parsing Basic Authentication secret
2019-05-17 14:43:14.169 +04:00 [DBG] Start parsing for secret in post body
2019-05-17 14:43:14.190 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-17 14:43:14.192 +04:00 [DBG] Secret id found: StudLab
2019-05-17 14:43:14.236 +04:00 [DBG] StudLab found in database: true
2019-05-17 14:43:14.237 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 14:43:14.287 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-17 14:43:14.291 +04:00 [DBG] Client validation success
2019-05-17 14:43:14.298 +04:00 [INF] {"ClientId":"StudLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLMQMHE3EPKO:00000003","TimeStamp":"2019-05-17T10:43:14.0000000Z","ProcessId":4704,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-17 14:43:14.366 +04:00 [DBG] Start token request validation
2019-05-17 14:43:14.444 +04:00 [DBG] Start validation of authorization code token request
2019-05-17 14:43:14.536 +04:00 [DBG] dIjuGBEESyZ8+IEekTz0WDb9Yb08bFGGKqM7P6E8WTc= found in database: true
2019-05-17 14:43:14.646 +04:00 [DBG] removing dIjuGBEESyZ8+IEekTz0WDb9Yb08bFGGKqM7P6E8WTc= persisted grant from database
2019-05-17 14:43:14.703 +04:00 [DBG] Validation of authorization code token request success
2019-05-17 14:43:14.743 +04:00 [INF] Token request validation success
{"ClientId":"StudLab","ClientName":"StudLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"9bd675d3cec8c775d7143f697ff08aeac26499eb7bfb9f0f48a513f42b9b6051","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"StudLab","client_secret":"***REDACTED***","code":"9bd675d3cec8c775d7143f697ff08aeac26499eb7bfb9f0f48a513f42b9b6051","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-05-17 14:43:15.802 +04:00 [DBG] StudLab found in database: true
2019-05-17 14:43:15.942 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 14:43:16.447 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 14:43:16.529 +04:00 [DBG] Found [] API scopes in database
2019-05-17 14:43:16.634 +04:00 [DBG] Getting claims for access token for client: StudLab
2019-05-17 14:43:16.650 +04:00 [DBG] Getting claims for access token for subject: 3002
2019-05-17 14:43:16.813 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-17 14:43:16.899 +04:00 [DBG] Creating refresh token
2019-05-17 14:43:16.900 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-05-17 14:43:16.993 +04:00 [DBG] qwoWuv+CTcbfGhuQorzU3hGRXNuPE6Angc27FI2eGeM= not found in database
2019-05-17 14:43:17.028 +04:00 [DBG] StudLab found in database: true
2019-05-17 14:43:17.030 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 14:43:17.047 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 14:43:17.055 +04:00 [DBG] Found [] API scopes in database
2019-05-17 14:43:17.059 +04:00 [DBG] Getting claims for identity token for subject: 3002 and client: StudLab
2019-05-17 14:43:17.090 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-17 14:43:17.129 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****V4JQ","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****224b","$type":"Token"},{"TokenType":"access_token","TokenValue":"****aImA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLMQMHE3EPKO:00000003","TimeStamp":"2019-05-17T10:43:17.0000000Z","ProcessId":4704,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-17 14:43:17.196 +04:00 [DBG] Token request success.
2019-05-17 14:43:17.272 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-05-17 14:43:17.285 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-05-17 14:43:17.289 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-05-17 14:43:17.332 +04:00 [DBG] Start userinfo request
2019-05-17 14:43:17.355 +04:00 [DBG] Bearer token found in header
2019-05-17 14:43:17.858 +04:00 [DBG] StudLab found in database: true
2019-05-17 14:43:17.860 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 14:43:17.895 +04:00 [DBG] StudLab found in database: true
2019-05-17 14:43:17.896 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 14:43:17.937 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-05-17 14:43:17.961 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1558089796,"exp":1558093396,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"StudLab","sub":"3002","auth_time":1558089778,"idp":"local","AspNet.Identity.SecurityStamp":"3J6ZWOULNXHDH2A3F3VVEGSPACJVRNG6","role":"user","preferred_username":"dereguzov1123@yandex.ru","name":"dereguzov1123@yandex.ru","email":"dereguzov1123@yandex.ru","email_verified":false,"given_name":"dereguzov1123@yandex.ru","username":"Kirill","AuthService":"StudLabs","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-05-17 14:43:18.057 +04:00 [DBG] Creating userinfo response
2019-05-17 14:43:18.096 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-17 14:43:18.124 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-17 14:43:18.148 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 14:43:18.156 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-05-17 14:43:18.162 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-17 14:43:18.175 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 14:43:18.218 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email username AuthService
2019-05-17 14:43:18.229 +04:00 [DBG] End userinfo request
2019-05-17 16:40:36.214 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-17 16:40:37.077 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-17 16:40:37.227 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-17 16:40:37.357 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-17 16:40:37.488 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-17 16:40:37.589 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-17 16:40:37.700 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-17 16:40:40.538 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 16:40:40.826 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 16:40:40.906 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 16:40:42.636 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 16:40:44.043 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 16:40:44.171 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 16:40:44.358 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 16:40:44.459 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 16:40:44.790 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 16:40:45.432 +04:00 [DBG] Starting grant removal
2019-05-17 16:40:53.421 +04:00 [DBG] Login Url: /Account/Login
2019-05-17 16:40:53.606 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-17 16:40:53.639 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-17 16:40:53.675 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-17 16:40:53.711 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-17 16:40:53.721 +04:00 [DBG] Error Url: /home/error
2019-05-17 16:40:53.739 +04:00 [DBG] Error Id Parameter: errorId
2019-05-17 16:40:54.026 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-17 16:40:54.062 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-17 16:40:54.071 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-17 16:40:54.105 +04:00 [DBG] Start discovery request
2019-05-17 16:40:56.037 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-05-17 16:40:56.767 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-17 16:40:56.885 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-17 16:40:56.904 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-17 16:40:56.936 +04:00 [DBG] Start key discovery request
2019-05-17 16:41:00.433 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-17 16:41:00.487 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-17 16:41:00.519 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-17 16:41:00.552 +04:00 [DBG] Start authorize request
2019-05-17 16:41:00.613 +04:00 [DBG] User in authorize request: 3002
2019-05-17 16:41:00.642 +04:00 [DBG] Start authorize request protocol validation
2019-05-17 16:41:02.837 +04:00 [DBG] StudLab found in database: true
2019-05-17 16:41:02.880 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 16:41:02.945 +04:00 [DBG] Checking for PKCE parameters
2019-05-17 16:41:02.965 +04:00 [DBG] No PKCE used.
2019-05-17 16:41:03.287 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 16:41:03.635 +04:00 [DBG] Found [] API scopes in database
2019-05-17 16:41:03.677 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 16:41:03.691 +04:00 [DBG] Found [] API scopes in database
2019-05-17 16:41:03.737 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-17 16:41:03.835 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"3002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK8-vreKg3UFzt7LgeXbcwWayMH7nCGmIJ9sLUvS8jXgyOGZ6BC9l5J0FPzUkMDBniBrDuKNxgHNpNTfQVVKKsw-WYABwBCwEZvuEpemLYKrw0bzqEUc3-2Cz4tuFfQLtWKCi6gvdKqLg-fv0UKqnvlJ4v6aoVdR43QieF7MNvE8Ey-oXCq15YVOk_ZvQG_uuQU-bVHPechTmXL8mM5bmALYY0bX7sAOW8HM2SB9V4l96HhVXJr7yfJzInFOy3gOLHSAu-eT95Jap_KsC50beMMVr","UiLocales":null,"Nonce":"636936936574383006.ZjRhNDdkNDItMTA1YS00MTE2LWI1YTEtZWRlMDEzZWFlZDM2MDY1YzYzNmQtMWNmMy00OWQyLTgwMjUtMjk5OTZjOTE0MDk4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a961634245d3899b9b3f4524904e6d0f","Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636936936574383006.ZjRhNDdkNDItMTA1YS00MTE2LWI1YTEtZWRlMDEzZWFlZDM2MDY1YzYzNmQtMWNmMy00OWQyLTgwMjUtMjk5OTZjOTE0MDk4","state":"CfDJ8D73mgAamspIvsbnstRoK8-vreKg3UFzt7LgeXbcwWayMH7nCGmIJ9sLUvS8jXgyOGZ6BC9l5J0FPzUkMDBniBrDuKNxgHNpNTfQVVKKsw-WYABwBCwEZvuEpemLYKrw0bzqEUc3-2Cz4tuFfQLtWKCi6gvdKqLg-fv0UKqnvlJ4v6aoVdR43QieF7MNvE8Ey-oXCq15YVOk_ZvQG_uuQU-bVHPechTmXL8mM5bmALYY0bX7sAOW8HM2SB9V4l96HhVXJr7yfJzInFOy3gOLHSAu-eT95Jap_KsC50beMMVr","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-17 16:41:04.096 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-05-17 16:41:04.130 +04:00 [DBG] Creating Hybrid Flow response.
2019-05-17 16:41:04.396 +04:00 [DBG] O1ppbdr8h2lsRn7TqWheJGGfwvENaQ7ptvAhuPb1b54= not found in database
2019-05-17 16:41:04.818 +04:00 [DBG] Creating Implicit Flow response.
2019-05-17 16:41:04.885 +04:00 [DBG] Getting claims for identity token for subject: 3002 and client: StudLab
2019-05-17 16:41:05.005 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-17 16:41:05.628 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"3002","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****6Icg","$type":"Token"},{"TokenType":"code","TokenValue":"****a841","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLMQOJIS1ML7:00000001","TimeStamp":"2019-05-17T12:41:05.0000000Z","ProcessId":13428,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-17 16:41:05.677 +04:00 [INF] Authorize endpoint response
{"SubjectId":"3002","ClientId":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8D73mgAamspIvsbnstRoK8-vreKg3UFzt7LgeXbcwWayMH7nCGmIJ9sLUvS8jXgyOGZ6BC9l5J0FPzUkMDBniBrDuKNxgHNpNTfQVVKKsw-WYABwBCwEZvuEpemLYKrw0bzqEUc3-2Cz4tuFfQLtWKCi6gvdKqLg-fv0UKqnvlJ4v6aoVdR43QieF7MNvE8Ey-oXCq15YVOk_ZvQG_uuQU-bVHPechTmXL8mM5bmALYY0bX7sAOW8HM2SB9V4l96HhVXJr7yfJzInFOy3gOLHSAu-eT95Jap_KsC50beMMVr","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-17 16:41:06.750 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-17 16:41:06.795 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-17 16:41:06.803 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-17 16:41:06.912 +04:00 [DBG] Start token request.
2019-05-17 16:41:07.090 +04:00 [DBG] Start client validation
2019-05-17 16:41:07.259 +04:00 [DBG] Start parsing Basic Authentication secret
2019-05-17 16:41:07.628 +04:00 [DBG] Start parsing for secret in post body
2019-05-17 16:41:07.955 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-17 16:41:07.971 +04:00 [DBG] Secret id found: StudLab
2019-05-17 16:41:08.704 +04:00 [DBG] StudLab found in database: true
2019-05-17 16:41:08.758 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 16:41:08.935 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-17 16:41:08.957 +04:00 [DBG] Client validation success
2019-05-17 16:41:08.994 +04:00 [INF] {"ClientId":"StudLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLMQOJIS1ML6:00000003","TimeStamp":"2019-05-17T12:41:08.0000000Z","ProcessId":13428,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-17 16:41:09.200 +04:00 [DBG] Start token request validation
2019-05-17 16:41:09.271 +04:00 [DBG] Start validation of authorization code token request
2019-05-17 16:41:09.391 +04:00 [DBG] O1ppbdr8h2lsRn7TqWheJGGfwvENaQ7ptvAhuPb1b54= found in database: true
2019-05-17 16:41:09.610 +04:00 [DBG] removing O1ppbdr8h2lsRn7TqWheJGGfwvENaQ7ptvAhuPb1b54= persisted grant from database
2019-05-17 16:41:09.693 +04:00 [DBG] Validation of authorization code token request success
2019-05-17 16:41:09.827 +04:00 [INF] Token request validation success
{"ClientId":"StudLab","ClientName":"StudLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"ab0f80ad6bf5556f6bd86897ab786774b46cc2008e6f0753a6c85cf26445a841","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"StudLab","client_secret":"***REDACTED***","code":"ab0f80ad6bf5556f6bd86897ab786774b46cc2008e6f0753a6c85cf26445a841","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-05-17 16:41:10.081 +04:00 [DBG] StudLab found in database: true
2019-05-17 16:41:10.082 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 16:41:10.139 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 16:41:10.191 +04:00 [DBG] Found [] API scopes in database
2019-05-17 16:41:10.294 +04:00 [DBG] Getting claims for access token for client: StudLab
2019-05-17 16:41:10.311 +04:00 [DBG] Getting claims for access token for subject: 3002
2019-05-17 16:41:10.382 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-17 16:41:10.633 +04:00 [DBG] Creating refresh token
2019-05-17 16:41:10.635 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-05-17 16:41:10.744 +04:00 [DBG] DGpl+5H/kxfc3qtrD7RS6WO7518Gk2pqNEZqqSg8Si4= not found in database
2019-05-17 16:41:10.805 +04:00 [DBG] StudLab found in database: true
2019-05-17 16:41:10.809 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 16:41:10.884 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 16:41:10.912 +04:00 [DBG] Found [] API scopes in database
2019-05-17 16:41:10.919 +04:00 [DBG] Getting claims for identity token for subject: 3002 and client: StudLab
2019-05-17 16:41:11.017 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-17 16:41:11.087 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****mh2g","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****6d35","$type":"Token"},{"TokenType":"access_token","TokenValue":"****80KA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLMQOJIS1ML6:00000003","TimeStamp":"2019-05-17T12:41:11.0000000Z","ProcessId":13428,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-17 16:41:11.526 +04:00 [DBG] Token request success.
2019-05-17 16:41:11.677 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-05-17 16:41:11.702 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-05-17 16:41:11.721 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-05-17 16:41:11.789 +04:00 [DBG] Start userinfo request
2019-05-17 16:41:11.816 +04:00 [DBG] Bearer token found in header
2019-05-17 16:41:12.237 +04:00 [DBG] StudLab found in database: true
2019-05-17 16:41:12.239 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 16:41:12.287 +04:00 [DBG] StudLab found in database: true
2019-05-17 16:41:12.289 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 16:41:12.375 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-05-17 16:41:12.460 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1558096870,"exp":1558100470,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"StudLab","sub":"3002","auth_time":1558089778,"idp":"local","AspNet.Identity.SecurityStamp":"3J6ZWOULNXHDH2A3F3VVEGSPACJVRNG6","role":"user","preferred_username":"dereguzov1123@yandex.ru","name":"dereguzov1123@yandex.ru","email":"dereguzov1123@yandex.ru","email_verified":false,"given_name":"dereguzov1123@yandex.ru","username":"Kirill","AuthService":"StudLabs","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-05-17 16:41:12.606 +04:00 [DBG] Creating userinfo response
2019-05-17 16:41:12.627 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-17 16:41:12.661 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-17 16:41:12.688 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 16:41:12.697 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-05-17 16:41:12.707 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-17 16:41:12.794 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 16:41:12.873 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email username AuthService
2019-05-17 16:41:12.882 +04:00 [DBG] End userinfo request
2019-05-17 18:18:06.881 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-17 18:18:07.223 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-17 18:18:07.228 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-17 18:18:07.230 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-17 18:18:07.232 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-17 18:18:07.234 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-17 18:18:07.244 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-17 18:18:08.787 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 18:18:08.828 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 18:18:08.846 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 18:18:09.271 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 18:18:09.634 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 18:18:09.716 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 18:18:09.779 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 18:18:09.824 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 18:18:09.859 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 18:18:10.147 +04:00 [DBG] Starting grant removal
2019-05-17 18:18:13.312 +04:00 [DBG] Login Url: /Account/Login
2019-05-17 18:18:13.323 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-17 18:18:13.328 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-17 18:18:13.330 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-17 18:18:13.333 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-17 18:18:13.337 +04:00 [DBG] Error Url: /home/error
2019-05-17 18:18:13.344 +04:00 [DBG] Error Id Parameter: errorId
2019-05-17 18:18:13.593 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-17 18:18:13.663 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-17 18:18:13.686 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-17 18:18:13.713 +04:00 [DBG] Start discovery request
2019-05-17 18:18:15.831 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-05-17 18:18:17.379 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-17 18:18:17.409 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-17 18:18:17.413 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-17 18:18:17.433 +04:00 [DBG] Start key discovery request
2019-05-17 18:18:19.369 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-17 18:18:19.393 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-17 18:18:19.398 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-17 18:18:19.432 +04:00 [DBG] Start authorize request
2019-05-17 18:18:19.509 +04:00 [DBG] User in authorize request: 3002
2019-05-17 18:18:19.598 +04:00 [DBG] Start authorize request protocol validation
2019-05-17 18:18:21.458 +04:00 [DBG] StudLab found in database: true
2019-05-17 18:18:21.512 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 18:18:21.582 +04:00 [DBG] Checking for PKCE parameters
2019-05-17 18:18:21.604 +04:00 [DBG] No PKCE used.
2019-05-17 18:18:21.909 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 18:18:22.232 +04:00 [DBG] Found [] API scopes in database
2019-05-17 18:18:22.282 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 18:18:22.312 +04:00 [DBG] Found [] API scopes in database
2019-05-17 18:18:22.351 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-17 18:18:22.428 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"3002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK8-AISJVq-QoCUd9BU8IOVwJFg92aBSfA3EruT3a8uVEl4DvY5sMhVfdxdDf82AFB_EmYtJxJ06u0b_Z4JNNPf8QjaYQuANXrrZYjDAJI7ytuwxxBePRXECoyQCb9CM7vezH8X62KvEtgNnbVgdsiLwIBx-aKP1VQVjWVqVqDdfxnNI1O636lDQxswyV4BSTcRv7j73gpyzfHVp9ckcTZJjJq640WIqvCbCKcR0Kg_G2kcw2vIxw82o1GI0Dw-URbspQNcBB7ugVBiJcfXHEDIOe","UiLocales":null,"Nonce":"636936994980563704.MWU3ODlhM2EtOWIyYy00ZmRlLTg0YjctODEwOWI4MzA2NmIyNmNhNDIzNzUtNDRiMS00Zjg3LWE0NmEtNmY2ZmQ1Mzc5NTg4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a961634245d3899b9b3f4524904e6d0f","Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636936994980563704.MWU3ODlhM2EtOWIyYy00ZmRlLTg0YjctODEwOWI4MzA2NmIyNmNhNDIzNzUtNDRiMS00Zjg3LWE0NmEtNmY2ZmQ1Mzc5NTg4","state":"CfDJ8D73mgAamspIvsbnstRoK8-AISJVq-QoCUd9BU8IOVwJFg92aBSfA3EruT3a8uVEl4DvY5sMhVfdxdDf82AFB_EmYtJxJ06u0b_Z4JNNPf8QjaYQuANXrrZYjDAJI7ytuwxxBePRXECoyQCb9CM7vezH8X62KvEtgNnbVgdsiLwIBx-aKP1VQVjWVqVqDdfxnNI1O636lDQxswyV4BSTcRv7j73gpyzfHVp9ckcTZJjJq640WIqvCbCKcR0Kg_G2kcw2vIxw82o1GI0Dw-URbspQNcBB7ugVBiJcfXHEDIOe","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-17 18:18:22.659 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-05-17 18:18:22.697 +04:00 [DBG] Creating Hybrid Flow response.
2019-05-17 18:18:22.900 +04:00 [DBG] GJvrEpqn20Ff2RUcUbkgZyrd+EB7N+hbhDVvSfteLlc= not found in database
2019-05-17 18:18:23.175 +04:00 [DBG] Creating Implicit Flow response.
2019-05-17 18:18:23.225 +04:00 [DBG] Getting claims for identity token for subject: 3002 and client: StudLab
2019-05-17 18:18:23.312 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-17 18:18:25.939 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"3002","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****uhCA","$type":"Token"},{"TokenType":"code","TokenValue":"****64e4","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLMQQ9VAN8U6:00000001","TimeStamp":"2019-05-17T14:18:25.0000000Z","ProcessId":14308,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-17 18:18:26.029 +04:00 [INF] Authorize endpoint response
{"SubjectId":"3002","ClientId":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8D73mgAamspIvsbnstRoK8-AISJVq-QoCUd9BU8IOVwJFg92aBSfA3EruT3a8uVEl4DvY5sMhVfdxdDf82AFB_EmYtJxJ06u0b_Z4JNNPf8QjaYQuANXrrZYjDAJI7ytuwxxBePRXECoyQCb9CM7vezH8X62KvEtgNnbVgdsiLwIBx-aKP1VQVjWVqVqDdfxnNI1O636lDQxswyV4BSTcRv7j73gpyzfHVp9ckcTZJjJq640WIqvCbCKcR0Kg_G2kcw2vIxw82o1GI0Dw-URbspQNcBB7ugVBiJcfXHEDIOe","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-17 18:18:27.317 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-17 18:18:27.343 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-17 18:18:27.349 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-17 18:18:27.413 +04:00 [DBG] Start token request.
2019-05-17 18:18:27.482 +04:00 [DBG] Start client validation
2019-05-17 18:18:27.621 +04:00 [DBG] Start parsing Basic Authentication secret
2019-05-17 18:18:27.665 +04:00 [DBG] Start parsing for secret in post body
2019-05-17 18:18:27.812 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-17 18:18:27.814 +04:00 [DBG] Secret id found: StudLab
2019-05-17 18:18:27.844 +04:00 [DBG] StudLab found in database: true
2019-05-17 18:18:27.846 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 18:18:27.932 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-17 18:18:27.935 +04:00 [DBG] Client validation success
2019-05-17 18:18:27.943 +04:00 [INF] {"ClientId":"StudLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLMQQ9VAN8U5:00000003","TimeStamp":"2019-05-17T14:18:27.0000000Z","ProcessId":14308,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-17 18:18:27.992 +04:00 [DBG] Start token request validation
2019-05-17 18:18:28.046 +04:00 [DBG] Start validation of authorization code token request
2019-05-17 18:18:28.142 +04:00 [DBG] GJvrEpqn20Ff2RUcUbkgZyrd+EB7N+hbhDVvSfteLlc= found in database: true
2019-05-17 18:18:28.264 +04:00 [DBG] removing GJvrEpqn20Ff2RUcUbkgZyrd+EB7N+hbhDVvSfteLlc= persisted grant from database
2019-05-17 18:18:28.374 +04:00 [DBG] Validation of authorization code token request success
2019-05-17 18:18:28.410 +04:00 [INF] Token request validation success
{"ClientId":"StudLab","ClientName":"StudLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"4a559d427468c18c77c2174b885cf98d08c7dbdc7bd51e8fd91cfdcb31e764e4","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"StudLab","client_secret":"***REDACTED***","code":"4a559d427468c18c77c2174b885cf98d08c7dbdc7bd51e8fd91cfdcb31e764e4","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-05-17 18:18:28.640 +04:00 [DBG] StudLab found in database: true
2019-05-17 18:18:28.642 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 18:18:28.683 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 18:18:28.714 +04:00 [DBG] Found [] API scopes in database
2019-05-17 18:18:28.791 +04:00 [DBG] Getting claims for access token for client: StudLab
2019-05-17 18:18:28.793 +04:00 [DBG] Getting claims for access token for subject: 3002
2019-05-17 18:18:28.874 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-17 18:18:28.941 +04:00 [DBG] Creating refresh token
2019-05-17 18:18:28.948 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-05-17 18:18:29.040 +04:00 [DBG] DDIQkXdQVgA/8uPCURwIauprheMzehn368H1G9BprYI= not found in database
2019-05-17 18:18:29.097 +04:00 [DBG] StudLab found in database: true
2019-05-17 18:18:29.099 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 18:18:29.113 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 18:18:29.123 +04:00 [DBG] Found [] API scopes in database
2019-05-17 18:18:29.128 +04:00 [DBG] Getting claims for identity token for subject: 3002 and client: StudLab
2019-05-17 18:18:29.168 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-17 18:18:29.207 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****Arjg","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****4775","$type":"Token"},{"TokenType":"access_token","TokenValue":"****W40A","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLMQQ9VAN8U5:00000003","TimeStamp":"2019-05-17T14:18:29.0000000Z","ProcessId":14308,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-17 18:18:29.259 +04:00 [DBG] Token request success.
2019-05-17 18:18:29.363 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-05-17 18:18:29.380 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-05-17 18:18:29.386 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-05-17 18:18:29.425 +04:00 [DBG] Start userinfo request
2019-05-17 18:18:29.445 +04:00 [DBG] Bearer token found in header
2019-05-17 18:18:29.841 +04:00 [DBG] StudLab found in database: true
2019-05-17 18:18:29.843 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 18:18:29.876 +04:00 [DBG] StudLab found in database: true
2019-05-17 18:18:29.878 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 18:18:29.933 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-05-17 18:18:29.988 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1558102708,"exp":1558106308,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"StudLab","sub":"3002","auth_time":1558089778,"idp":"local","AspNet.Identity.SecurityStamp":"3J6ZWOULNXHDH2A3F3VVEGSPACJVRNG6","role":"user","preferred_username":"dereguzov1123@yandex.ru","name":"dereguzov1123@yandex.ru","email":"dereguzov1123@yandex.ru","email_verified":false,"given_name":"dereguzov1123@yandex.ru","username":"Kirill","AuthService":"StudLabs","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-05-17 18:18:30.211 +04:00 [DBG] Creating userinfo response
2019-05-17 18:18:30.233 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-17 18:18:30.261 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-17 18:18:30.283 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 18:18:30.292 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-05-17 18:18:30.299 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-17 18:18:30.321 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 18:18:30.362 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email username AuthService
2019-05-17 18:18:30.376 +04:00 [DBG] End userinfo request
2019-05-17 18:38:09.254 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-17 18:38:40.048 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-17 18:38:40.053 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-17 18:38:40.055 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-17 18:38:40.057 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-17 18:38:40.059 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-17 18:38:40.066 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-17 18:38:44.596 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 18:38:44.820 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 18:38:44.835 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 18:38:45.877 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 18:38:47.199 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 18:38:47.709 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 18:38:47.886 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 18:38:47.997 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 18:38:48.060 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 18:38:48.770 +04:00 [DBG] Starting grant removal
2019-05-17 18:39:26.672 +04:00 [DBG] Login Url: /Account/Login
2019-05-17 18:39:26.689 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-17 18:39:26.702 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-17 18:39:26.711 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-17 18:39:26.720 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-17 18:39:26.724 +04:00 [DBG] Error Url: /home/error
2019-05-17 18:39:26.731 +04:00 [DBG] Error Id Parameter: errorId
2019-05-17 18:39:26.864 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-17 18:39:27.019 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-17 18:39:27.030 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-17 18:39:27.074 +04:00 [DBG] Start discovery request
2019-05-17 18:39:29.758 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-05-17 18:39:31.959 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-17 18:39:32.055 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-17 18:39:32.073 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-17 18:39:32.180 +04:00 [DBG] Start key discovery request
2019-05-17 18:39:33.723 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-17 18:39:33.777 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-17 18:39:33.788 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-17 18:39:33.819 +04:00 [DBG] Start authorize request
2019-05-17 18:39:33.939 +04:00 [DBG] User in authorize request: 3002
2019-05-17 18:39:33.971 +04:00 [DBG] Start authorize request protocol validation
2019-05-17 18:39:36.697 +04:00 [DBG] StudLab found in database: true
2019-05-17 18:39:36.743 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 18:39:36.787 +04:00 [DBG] Checking for PKCE parameters
2019-05-17 18:39:36.800 +04:00 [DBG] No PKCE used.
2019-05-17 18:39:37.157 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 18:39:37.487 +04:00 [DBG] Found [] API scopes in database
2019-05-17 18:39:37.643 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 18:39:37.680 +04:00 [DBG] Found [] API scopes in database
2019-05-17 18:39:37.718 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-17 18:39:37.826 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"3002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK8-xjSs8V6ZRrxZLR6_HrEZk9D_ZSexysBUD2WdAAe2ihPbJ5DQOEVWSfpS6ixyHaXOHedFlbl8fYS2aVZxmmAOZ1O0tm9hspJZHxdacNXQtlN5cRwQSGyauKDvWjJDfmDVglxOHLLfB8ORLwZorKVcezi4qFMA1iF7pexfc41i9VzYLE5TIOIgAMwe5sTkIlxM_fzT9WPDkX0K9-Elh09XNYxg7q_y1wchjl0RscO14S08kQVR654JWMb71qlX-tQfoe1qd9YlxpoSP0wHpnUkE","UiLocales":null,"Nonce":"636937007728672037.ZTM2YTIzMzktMmYyNC00ZmY3LWEyNTktOTA5YTFkYzU1NWE5YWMzNzc0YWYtZTc3NC00ZWQzLTliNjctZjIzNmM4ZWQ1YjUz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a961634245d3899b9b3f4524904e6d0f","Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636937007728672037.ZTM2YTIzMzktMmYyNC00ZmY3LWEyNTktOTA5YTFkYzU1NWE5YWMzNzc0YWYtZTc3NC00ZWQzLTliNjctZjIzNmM4ZWQ1YjUz","state":"CfDJ8D73mgAamspIvsbnstRoK8-xjSs8V6ZRrxZLR6_HrEZk9D_ZSexysBUD2WdAAe2ihPbJ5DQOEVWSfpS6ixyHaXOHedFlbl8fYS2aVZxmmAOZ1O0tm9hspJZHxdacNXQtlN5cRwQSGyauKDvWjJDfmDVglxOHLLfB8ORLwZorKVcezi4qFMA1iF7pexfc41i9VzYLE5TIOIgAMwe5sTkIlxM_fzT9WPDkX0K9-Elh09XNYxg7q_y1wchjl0RscO14S08kQVR654JWMb71qlX-tQfoe1qd9YlxpoSP0wHpnUkE","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-17 18:39:38.293 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-05-17 18:39:38.338 +04:00 [DBG] Creating Hybrid Flow response.
2019-05-17 18:39:38.650 +04:00 [DBG] U184/pwKSnmJ1r+B+is8gXI5aPbwt/Y88G3xcwh3tlA= not found in database
2019-05-17 18:39:39.730 +04:00 [DBG] Creating Implicit Flow response.
2019-05-17 18:39:39.859 +04:00 [DBG] Getting claims for identity token for subject: 3002 and client: StudLab
2019-05-17 18:47:27.293 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-17 18:47:28.493 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"3002","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****7IFQ","$type":"Token"},{"TokenType":"code","TokenValue":"****da2a","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLMQQLQONFCQ:00000001","TimeStamp":"2019-05-17T14:47:28.0000000Z","ProcessId":15248,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-17 18:47:28.956 +04:00 [INF] Authorize endpoint response
{"SubjectId":"3002","ClientId":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8D73mgAamspIvsbnstRoK8-xjSs8V6ZRrxZLR6_HrEZk9D_ZSexysBUD2WdAAe2ihPbJ5DQOEVWSfpS6ixyHaXOHedFlbl8fYS2aVZxmmAOZ1O0tm9hspJZHxdacNXQtlN5cRwQSGyauKDvWjJDfmDVglxOHLLfB8ORLwZorKVcezi4qFMA1iF7pexfc41i9VzYLE5TIOIgAMwe5sTkIlxM_fzT9WPDkX0K9-Elh09XNYxg7q_y1wchjl0RscO14S08kQVR654JWMb71qlX-tQfoe1qd9YlxpoSP0wHpnUkE","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-17 18:47:31.010 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-17 18:47:31.074 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-17 18:47:31.094 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-17 18:47:31.145 +04:00 [DBG] Start token request.
2019-05-17 18:47:31.193 +04:00 [DBG] Start client validation
2019-05-17 18:47:31.253 +04:00 [DBG] Start parsing Basic Authentication secret
2019-05-17 18:47:31.288 +04:00 [DBG] Start parsing for secret in post body
2019-05-17 18:47:31.408 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-17 18:47:31.423 +04:00 [DBG] Secret id found: StudLab
2019-05-17 18:47:31.546 +04:00 [DBG] StudLab found in database: true
2019-05-17 18:47:31.548 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 18:47:31.651 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-17 18:47:31.660 +04:00 [DBG] Client validation success
2019-05-17 18:47:31.702 +04:00 [INF] {"ClientId":"StudLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLMQQLQONFCR:00000001","TimeStamp":"2019-05-17T14:47:31.0000000Z","ProcessId":15248,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-17 18:47:31.772 +04:00 [DBG] Start token request validation
2019-05-17 18:47:31.827 +04:00 [DBG] Start validation of authorization code token request
2019-05-17 18:47:31.909 +04:00 [DBG] U184/pwKSnmJ1r+B+is8gXI5aPbwt/Y88G3xcwh3tlA= found in database: true
2019-05-17 18:47:32.031 +04:00 [DBG] removing U184/pwKSnmJ1r+B+is8gXI5aPbwt/Y88G3xcwh3tlA= persisted grant from database
2019-05-17 18:47:32.355 +04:00 [ERR] Authorization code expired: ["ba908fb999dac897f85be0eb983bc39fc52e9b241bd0f78d92ac4487ceeeda2a"], request details: {"ClientId":"StudLab","ClientName":"StudLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"ba908fb999dac897f85be0eb983bc39fc52e9b241bd0f78d92ac4487ceeeda2a","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"StudLab","client_secret":"***REDACTED***","code":"ba908fb999dac897f85be0eb983bc39fc52e9b241bd0f78d92ac4487ceeeda2a","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-05-17 18:47:32.418 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":null,"GrantType":"authorization_code","Error":"invalid_grant","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLMQQLQONFCR:00000001","TimeStamp":"2019-05-17T14:47:32.0000000Z","ProcessId":15248,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-05-17 18:49:05.544 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-17 18:49:05.552 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-17 18:49:05.555 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-17 18:49:05.579 +04:00 [DBG] Start authorize request
2019-05-17 18:49:05.583 +04:00 [DBG] User in authorize request: 3002
2019-05-17 18:49:05.634 +04:00 [DBG] Start authorize request protocol validation
2019-05-17 18:49:05.742 +04:00 [DBG] StudLab found in database: true
2019-05-17 18:49:05.747 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 18:49:05.770 +04:00 [DBG] Checking for PKCE parameters
2019-05-17 18:49:05.777 +04:00 [DBG] No PKCE used.
2019-05-17 18:49:05.852 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 18:49:05.865 +04:00 [DBG] Found [] API scopes in database
2019-05-17 18:49:05.885 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 18:49:05.912 +04:00 [DBG] Found [] API scopes in database
2019-05-17 18:49:05.916 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-17 18:49:05.929 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"3002","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK88Y13DpzkFgX93RvPcqqX9_Wiwtp9Lfo4sbfBDOeKQ3h3yRXkOiSoud6ewH9uW1XTvNoRbr62ZXAAWVz-UaDBD_-RiVV6d86fQrAy8-hfZ754ewB-EE-iO3YcKIyTgDY-Yj5Pz7aK4fZQYLxRC5-ZCKXeyXUprehEc6gQfqNeYW2TeFezBcb9j-5AqiX9edYe3BgxNLqAMiCmnum6tUcDI1v1Yt28ri8tl7yd6WT9CnzVRv6KlnjqA1aJjysSkTOQAP1i2Db3J006LllhQH49ai","UiLocales":null,"Nonce":"636937013452167809.OWE3MzNkYzYtYTFkMy00OTc4LTkwN2EtOGY4NzJmZjcwNDg1YmJjZjYxYTktMjIxOC00NDIxLWE5ODEtNzkzNTRmYjZhZDkw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a961634245d3899b9b3f4524904e6d0f","Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636937013452167809.OWE3MzNkYzYtYTFkMy00OTc4LTkwN2EtOGY4NzJmZjcwNDg1YmJjZjYxYTktMjIxOC00NDIxLWE5ODEtNzkzNTRmYjZhZDkw","state":"CfDJ8D73mgAamspIvsbnstRoK88Y13DpzkFgX93RvPcqqX9_Wiwtp9Lfo4sbfBDOeKQ3h3yRXkOiSoud6ewH9uW1XTvNoRbr62ZXAAWVz-UaDBD_-RiVV6d86fQrAy8-hfZ754ewB-EE-iO3YcKIyTgDY-Yj5Pz7aK4fZQYLxRC5-ZCKXeyXUprehEc6gQfqNeYW2TeFezBcb9j-5AqiX9edYe3BgxNLqAMiCmnum6tUcDI1v1Yt28ri8tl7yd6WT9CnzVRv6KlnjqA1aJjysSkTOQAP1i2Db3J006LllhQH49ai","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-17 18:49:06.013 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-05-17 18:49:06.018 +04:00 [DBG] Creating Hybrid Flow response.
2019-05-17 18:49:06.032 +04:00 [DBG] 4yKTGGh7nCmWGQmmYBOOB1wGyAwKZb/l+05cHMYZPSY= not found in database
2019-05-17 18:49:06.044 +04:00 [DBG] Creating Implicit Flow response.
2019-05-17 18:49:06.046 +04:00 [DBG] Getting claims for identity token for subject: 3002 and client: StudLab
2019-05-17 18:49:06.079 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-17 18:49:06.103 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"3002","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****4_9w","$type":"Token"},{"TokenType":"code","TokenValue":"****ee17","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLMQQLQONFCQ:00000002","TimeStamp":"2019-05-17T14:49:06.0000000Z","ProcessId":15248,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-17 18:49:06.141 +04:00 [INF] Authorize endpoint response
{"SubjectId":"3002","ClientId":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8D73mgAamspIvsbnstRoK88Y13DpzkFgX93RvPcqqX9_Wiwtp9Lfo4sbfBDOeKQ3h3yRXkOiSoud6ewH9uW1XTvNoRbr62ZXAAWVz-UaDBD_-RiVV6d86fQrAy8-hfZ754ewB-EE-iO3YcKIyTgDY-Yj5Pz7aK4fZQYLxRC5-ZCKXeyXUprehEc6gQfqNeYW2TeFezBcb9j-5AqiX9edYe3BgxNLqAMiCmnum6tUcDI1v1Yt28ri8tl7yd6WT9CnzVRv6KlnjqA1aJjysSkTOQAP1i2Db3J006LllhQH49ai","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-17 18:49:06.691 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-17 18:49:06.721 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-17 18:49:06.756 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-17 18:49:06.770 +04:00 [DBG] Start token request.
2019-05-17 18:49:06.772 +04:00 [DBG] Start client validation
2019-05-17 18:49:06.774 +04:00 [DBG] Start parsing Basic Authentication secret
2019-05-17 18:49:06.783 +04:00 [DBG] Start parsing for secret in post body
2019-05-17 18:49:06.787 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-17 18:49:06.790 +04:00 [DBG] Secret id found: StudLab
2019-05-17 18:49:06.817 +04:00 [DBG] StudLab found in database: true
2019-05-17 18:49:06.819 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 18:49:06.827 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-17 18:49:06.830 +04:00 [DBG] Client validation success
2019-05-17 18:49:06.837 +04:00 [INF] {"ClientId":"StudLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLMQQLQONFCR:00000002","TimeStamp":"2019-05-17T14:49:06.0000000Z","ProcessId":15248,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-17 18:49:06.859 +04:00 [DBG] Start token request validation
2019-05-17 18:49:06.862 +04:00 [DBG] Start validation of authorization code token request
2019-05-17 18:49:06.872 +04:00 [DBG] 4yKTGGh7nCmWGQmmYBOOB1wGyAwKZb/l+05cHMYZPSY= found in database: true
2019-05-17 18:49:06.882 +04:00 [DBG] removing 4yKTGGh7nCmWGQmmYBOOB1wGyAwKZb/l+05cHMYZPSY= persisted grant from database
2019-05-17 18:49:06.937 +04:00 [DBG] Validation of authorization code token request success
2019-05-17 18:49:07.014 +04:00 [INF] Token request validation success
{"ClientId":"StudLab","ClientName":"StudLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"62f17740ba487734e22fa13aedd29de8f07e8c815e242777b5651995afdfee17","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"StudLab","client_secret":"***REDACTED***","code":"62f17740ba487734e22fa13aedd29de8f07e8c815e242777b5651995afdfee17","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-05-17 18:49:07.223 +04:00 [DBG] StudLab found in database: true
2019-05-17 18:49:07.224 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 18:49:07.278 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 18:49:07.311 +04:00 [DBG] Found [] API scopes in database
2019-05-17 18:49:07.378 +04:00 [DBG] Getting claims for access token for client: StudLab
2019-05-17 18:49:07.384 +04:00 [DBG] Getting claims for access token for subject: 3002
2019-05-17 18:49:07.439 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-17 18:49:07.511 +04:00 [DBG] Creating refresh token
2019-05-17 18:49:07.515 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-05-17 18:49:07.762 +04:00 [DBG] 1E6NlO0nH1dcCsf9yTVzFgcJEtxF2NYyLKDdPBDRrAE= not found in database
2019-05-17 18:49:07.797 +04:00 [DBG] StudLab found in database: true
2019-05-17 18:49:07.799 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 18:49:07.817 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 18:49:07.826 +04:00 [DBG] Found [] API scopes in database
2019-05-17 18:49:07.831 +04:00 [DBG] Getting claims for identity token for subject: 3002 and client: StudLab
2019-05-17 18:49:07.859 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-17 18:49:07.896 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****0CwQ","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****2bf0","$type":"Token"},{"TokenType":"access_token","TokenValue":"****-c6g","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLMQQLQONFCR:00000002","TimeStamp":"2019-05-17T14:49:07.0000000Z","ProcessId":15248,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-17 18:49:07.958 +04:00 [DBG] Token request success.
2019-05-17 18:49:08.021 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-05-17 18:49:08.047 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-05-17 18:49:08.054 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-05-17 18:49:08.092 +04:00 [DBG] Start userinfo request
2019-05-17 18:49:08.113 +04:00 [DBG] Bearer token found in header
2019-05-17 18:49:08.429 +04:00 [DBG] StudLab found in database: true
2019-05-17 18:49:08.430 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 18:49:08.463 +04:00 [DBG] StudLab found in database: true
2019-05-17 18:49:08.464 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 18:49:08.499 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-05-17 18:49:08.512 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1558104547,"exp":1558108147,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"StudLab","sub":"3002","auth_time":1558089778,"idp":"local","AspNet.Identity.SecurityStamp":"3J6ZWOULNXHDH2A3F3VVEGSPACJVRNG6","role":"user","preferred_username":"dereguzov1123@yandex.ru","name":"dereguzov1123@yandex.ru","email":"dereguzov1123@yandex.ru","email_verified":false,"given_name":"dereguzov1123@yandex.ru","username":"Kirill","AuthService":"StudLabs","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-05-17 18:49:08.629 +04:00 [DBG] Creating userinfo response
2019-05-17 18:49:08.653 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-17 18:49:08.673 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-17 18:49:08.700 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 18:49:08.708 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-05-17 18:49:08.713 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-17 18:49:08.735 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 18:49:08.787 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email username AuthService
2019-05-17 18:49:08.798 +04:00 [DBG] End userinfo request
2019-05-17 20:15:23.116 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-17 20:15:23.689 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-17 20:15:23.698 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-17 20:15:23.700 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-17 20:15:23.701 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-17 20:15:23.703 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-17 20:15:23.704 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-17 20:15:26.098 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 20:15:27.149 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 20:15:27.485 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 20:15:28.318 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 20:15:29.195 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 20:15:29.306 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 20:15:29.371 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 20:15:29.430 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 20:15:29.508 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 20:15:29.901 +04:00 [DBG] Starting grant removal
2019-05-17 20:15:42.153 +04:00 [DBG] Login Url: /Account/Login
2019-05-17 20:15:42.177 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-17 20:15:42.182 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-17 20:15:42.184 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-17 20:15:42.187 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-17 20:15:42.189 +04:00 [DBG] Error Url: /home/error
2019-05-17 20:15:42.196 +04:00 [DBG] Error Id Parameter: errorId
2019-05-17 20:15:43.719 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-17 20:17:52.610 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-17 20:17:53.609 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-17 20:17:53.758 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-17 20:17:53.875 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-17 20:17:53.910 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-17 20:17:53.974 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-17 20:17:54.030 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-17 20:17:58.834 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 20:17:58.933 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 20:17:58.964 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 20:18:00.043 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 20:18:00.905 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 20:18:01.007 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 20:18:01.238 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 20:18:01.403 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 20:18:01.598 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 20:18:02.564 +04:00 [DBG] Starting grant removal
2019-05-17 20:18:12.635 +04:00 [DBG] Login Url: /Account/Login
2019-05-17 20:18:12.650 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-17 20:18:12.666 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-17 20:18:12.668 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-17 20:18:12.676 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-17 20:18:12.684 +04:00 [DBG] Error Url: /home/error
2019-05-17 20:18:12.688 +04:00 [DBG] Error Id Parameter: errorId
2019-05-17 20:18:17.340 +04:00 [WRN] Failed to determine the https port for redirect.
2019-05-17 20:18:28.902 +04:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-05-17 20:18:28.912 +04:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-05-17 20:18:28.918 +04:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-05-17 20:18:37.873 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-17 20:18:37.953 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-17 20:18:37.987 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-17 20:18:38.097 +04:00 [DBG] Start discovery request
2019-05-17 20:18:39.955 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-05-17 20:18:40.994 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-17 20:18:41.127 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-17 20:18:41.348 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-17 20:18:41.544 +04:00 [DBG] Start key discovery request
2019-05-17 20:18:44.100 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-17 20:18:44.124 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-17 20:18:44.131 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-17 20:18:44.158 +04:00 [DBG] Start authorize request
2019-05-17 20:18:44.263 +04:00 [DBG] No user present in authorize request
2019-05-17 20:18:44.361 +04:00 [DBG] Start authorize request protocol validation
2019-05-17 20:18:47.412 +04:00 [DBG] StudLab found in database: true
2019-05-17 20:18:47.453 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 20:18:47.499 +04:00 [DBG] Checking for PKCE parameters
2019-05-17 20:18:47.521 +04:00 [DBG] No PKCE used.
2019-05-17 20:18:47.888 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 20:18:48.205 +04:00 [DBG] Found [] API scopes in database
2019-05-17 20:18:48.332 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 20:18:48.373 +04:00 [DBG] Found [] API scopes in database
2019-05-17 20:18:48.453 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-17 20:18:48.553 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK8-2wc68zL6zP1huWIXgs_IRzjSW7IAviZMhxKYxStAjMAZeo5scbQBRYm7wgA3Hnc6IMjb5jpgfqx0J8VXVEJd7a_4zHHlI__JnzXR8KKC-ADB833J-jd41EFJNKoWUWRsU93xEZiBZkH8UwgKgMe6kDnZAsBiIcpqXQ6A9Do0eUf6NupSjNvlLvEQwlBMJQWXQKSZMR8eofVgshMLdxo9bBLcdZ61Uv1y65TgvgkMM7jVejlsmXsoU4wm6Poa-frUD8hkZ2oz3zUSIufnLedg1","UiLocales":null,"Nonce":"636937067238759354.ZTQ4MDBiZWQtNTM2Mi00ZmZkLWIyNDEtYzZjNDAwNmY3MTQ0N2EzY2NlN2QtNmE0Ni00M2QwLWE4ZGMtMDgzMTYwMDFmOGU4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636937067238759354.ZTQ4MDBiZWQtNTM2Mi00ZmZkLWIyNDEtYzZjNDAwNmY3MTQ0N2EzY2NlN2QtNmE0Ni00M2QwLWE4ZGMtMDgzMTYwMDFmOGU4","state":"CfDJ8D73mgAamspIvsbnstRoK8-2wc68zL6zP1huWIXgs_IRzjSW7IAviZMhxKYxStAjMAZeo5scbQBRYm7wgA3Hnc6IMjb5jpgfqx0J8VXVEJd7a_4zHHlI__JnzXR8KKC-ADB833J-jd41EFJNKoWUWRsU93xEZiBZkH8UwgKgMe6kDnZAsBiIcpqXQ6A9Do0eUf6NupSjNvlLvEQwlBMJQWXQKSZMR8eofVgshMLdxo9bBLcdZ61Uv1y65TgvgkMM7jVejlsmXsoU4wm6Poa-frUD8hkZ2oz3zUSIufnLedg1","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-17 20:18:48.759 +04:00 [INF] Showing login: User is not authenticated
2019-05-17 20:18:58.608 +04:00 [DBG] Augmenting SignInContext
2019-05-17 20:18:58.652 +04:00 [DBG] Adding idp claim with value: local
2019-05-17 20:18:58.654 +04:00 [DBG] Adding amr claim with value: pwd
2019-05-17 20:18:58.662 +04:00 [DBG] Adding auth_time claim with value: 1558109938
2019-05-17 20:18:58.712 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-17 20:18:58.905 +04:00 [INF] {"Username":"dereguzov1@yandex.ru","Provider":null,"ProviderUserId":null,"SubjectId":"4","DisplayName":"dereguzov1@yandex.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLMQSD0LU3DU:00000007","TimeStamp":"2019-05-17T16:18:58.0000000Z","ProcessId":16964,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-17 20:18:59.117 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-05-17 20:18:59.143 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-05-17 20:18:59.155 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-05-17 20:18:59.213 +04:00 [DBG] Start authorize callback request
2019-05-17 20:18:59.254 +04:00 [DBG] User in authorize request: 4
2019-05-17 20:18:59.288 +04:00 [DBG] Start authorize request protocol validation
2019-05-17 20:18:59.631 +04:00 [DBG] StudLab found in database: true
2019-05-17 20:18:59.633 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 20:18:59.640 +04:00 [DBG] Checking for PKCE parameters
2019-05-17 20:18:59.646 +04:00 [DBG] No PKCE used.
2019-05-17 20:18:59.695 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 20:18:59.718 +04:00 [DBG] Found [] API scopes in database
2019-05-17 20:18:59.730 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 20:18:59.738 +04:00 [DBG] Found [] API scopes in database
2019-05-17 20:18:59.741 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-17 20:18:59.747 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"4","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK8-2wc68zL6zP1huWIXgs_IRzjSW7IAviZMhxKYxStAjMAZeo5scbQBRYm7wgA3Hnc6IMjb5jpgfqx0J8VXVEJd7a_4zHHlI__JnzXR8KKC-ADB833J-jd41EFJNKoWUWRsU93xEZiBZkH8UwgKgMe6kDnZAsBiIcpqXQ6A9Do0eUf6NupSjNvlLvEQwlBMJQWXQKSZMR8eofVgshMLdxo9bBLcdZ61Uv1y65TgvgkMM7jVejlsmXsoU4wm6Poa-frUD8hkZ2oz3zUSIufnLedg1","UiLocales":null,"Nonce":"636937067238759354.ZTQ4MDBiZWQtNTM2Mi00ZmZkLWIyNDEtYzZjNDAwNmY3MTQ0N2EzY2NlN2QtNmE0Ni00M2QwLWE4ZGMtMDgzMTYwMDFmOGU4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"03c9ed8df865fc1416b5e594cf8052ad","Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636937067238759354.ZTQ4MDBiZWQtNTM2Mi00ZmZkLWIyNDEtYzZjNDAwNmY3MTQ0N2EzY2NlN2QtNmE0Ni00M2QwLWE4ZGMtMDgzMTYwMDFmOGU4","state":"CfDJ8D73mgAamspIvsbnstRoK8-2wc68zL6zP1huWIXgs_IRzjSW7IAviZMhxKYxStAjMAZeo5scbQBRYm7wgA3Hnc6IMjb5jpgfqx0J8VXVEJd7a_4zHHlI__JnzXR8KKC-ADB833J-jd41EFJNKoWUWRsU93xEZiBZkH8UwgKgMe6kDnZAsBiIcpqXQ6A9Do0eUf6NupSjNvlLvEQwlBMJQWXQKSZMR8eofVgshMLdxo9bBLcdZ61Uv1y65TgvgkMM7jVejlsmXsoU4wm6Poa-frUD8hkZ2oz3zUSIufnLedg1","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-17 20:18:59.998 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-05-17 20:19:00.100 +04:00 [DBG] Creating Hybrid Flow response.
2019-05-17 20:19:00.446 +04:00 [DBG] nZ90SqvmIKvdUMs93Gi4uG3wb/zg6GsHJ2Z61FWNu3k= not found in database
2019-05-17 20:19:00.819 +04:00 [DBG] Creating Implicit Flow response.
2019-05-17 20:19:00.871 +04:00 [DBG] Getting claims for identity token for subject: 4 and client: StudLab
2019-05-17 20:19:00.952 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-17 20:19:01.506 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"4","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****J3cw","$type":"Token"},{"TokenType":"code","TokenValue":"****a57d","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLMQSD0LU3DU:00000008","TimeStamp":"2019-05-17T16:19:01.0000000Z","ProcessId":16964,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-17 20:19:01.572 +04:00 [INF] Authorize endpoint response
{"SubjectId":"4","ClientId":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8D73mgAamspIvsbnstRoK8-2wc68zL6zP1huWIXgs_IRzjSW7IAviZMhxKYxStAjMAZeo5scbQBRYm7wgA3Hnc6IMjb5jpgfqx0J8VXVEJd7a_4zHHlI__JnzXR8KKC-ADB833J-jd41EFJNKoWUWRsU93xEZiBZkH8UwgKgMe6kDnZAsBiIcpqXQ6A9Do0eUf6NupSjNvlLvEQwlBMJQWXQKSZMR8eofVgshMLdxo9bBLcdZ61Uv1y65TgvgkMM7jVejlsmXsoU4wm6Poa-frUD8hkZ2oz3zUSIufnLedg1","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-17 20:19:01.786 +04:00 [DBG] Augmenting SignInContext
2019-05-17 20:19:01.814 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-17 20:19:02.901 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-17 20:19:02.930 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-17 20:19:02.938 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-17 20:19:02.987 +04:00 [DBG] Start token request.
2019-05-17 20:19:03.045 +04:00 [DBG] Start client validation
2019-05-17 20:19:03.135 +04:00 [DBG] Start parsing Basic Authentication secret
2019-05-17 20:19:03.195 +04:00 [DBG] Start parsing for secret in post body
2019-05-17 20:19:03.208 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-17 20:19:03.228 +04:00 [DBG] Secret id found: StudLab
2019-05-17 20:19:03.343 +04:00 [DBG] StudLab found in database: true
2019-05-17 20:19:03.362 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 20:19:03.428 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-17 20:19:03.432 +04:00 [DBG] Client validation success
2019-05-17 20:19:03.439 +04:00 [INF] {"ClientId":"StudLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLMQSD0LU3E0:00000003","TimeStamp":"2019-05-17T16:19:03.0000000Z","ProcessId":16964,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-17 20:19:03.479 +04:00 [DBG] Start token request validation
2019-05-17 20:19:03.556 +04:00 [DBG] Start validation of authorization code token request
2019-05-17 20:19:03.641 +04:00 [DBG] nZ90SqvmIKvdUMs93Gi4uG3wb/zg6GsHJ2Z61FWNu3k= found in database: true
2019-05-17 20:19:03.729 +04:00 [DBG] removing nZ90SqvmIKvdUMs93Gi4uG3wb/zg6GsHJ2Z61FWNu3k= persisted grant from database
2019-05-17 20:19:03.887 +04:00 [DBG] Validation of authorization code token request success
2019-05-17 20:19:03.909 +04:00 [INF] Token request validation success
{"ClientId":"StudLab","ClientName":"StudLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"bcf2eb6dc37567ae707c1e378d260c3182ae5e4ae8bca612f953d2212701a57d","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"StudLab","client_secret":"***REDACTED***","code":"bcf2eb6dc37567ae707c1e378d260c3182ae5e4ae8bca612f953d2212701a57d","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-05-17 20:19:04.103 +04:00 [DBG] StudLab found in database: true
2019-05-17 20:19:04.105 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 20:19:04.155 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 20:19:04.206 +04:00 [DBG] Found [] API scopes in database
2019-05-17 20:19:04.293 +04:00 [DBG] Getting claims for access token for client: StudLab
2019-05-17 20:19:04.336 +04:00 [DBG] Getting claims for access token for subject: 4
2019-05-17 20:19:04.427 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-17 20:19:04.520 +04:00 [DBG] Creating refresh token
2019-05-17 20:19:04.540 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-05-17 20:19:04.604 +04:00 [DBG] fta9yxktrwQtyjf76XD8xq9mYH1UTLI88KCppj9LQLI= not found in database
2019-05-17 20:19:04.652 +04:00 [DBG] StudLab found in database: true
2019-05-17 20:19:04.654 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 20:19:04.671 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 20:19:04.688 +04:00 [DBG] Found [] API scopes in database
2019-05-17 20:19:04.696 +04:00 [DBG] Getting claims for identity token for subject: 4 and client: StudLab
2019-05-17 20:19:04.748 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-17 20:19:04.795 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****JsCQ","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****2d9c","$type":"Token"},{"TokenType":"access_token","TokenValue":"****GTng","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLMQSD0LU3E0:00000003","TimeStamp":"2019-05-17T16:19:04.0000000Z","ProcessId":16964,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-17 20:19:04.844 +04:00 [DBG] Token request success.
2019-05-17 20:19:04.921 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-05-17 20:19:04.945 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-05-17 20:19:04.951 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-05-17 20:19:04.995 +04:00 [DBG] Start userinfo request
2019-05-17 20:19:05.016 +04:00 [DBG] Bearer token found in header
2019-05-17 20:19:05.388 +04:00 [DBG] StudLab found in database: true
2019-05-17 20:19:05.398 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 20:19:05.438 +04:00 [DBG] StudLab found in database: true
2019-05-17 20:19:05.440 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 20:19:05.480 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-05-17 20:19:05.498 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1558109944,"exp":1558113544,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"StudLab","sub":"4","auth_time":1558109938,"idp":"local","AspNet.Identity.SecurityStamp":"SMEWCFOPKGR2ER6A74KB2DZBDEUNFFQJ","role":"GodAdmin","preferred_username":"dereguzov1@yandex.ru","name":"dereguzov1@yandex.ru","email":"dereguzov1@yandex.ru","email_verified":false,"given_name":"dereguzov1@yandex.ru","username":"","AuthService":"StudLabs","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-05-17 20:19:05.592 +04:00 [DBG] Creating userinfo response
2019-05-17 20:19:05.648 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-17 20:19:05.683 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-17 20:19:05.712 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 20:19:05.721 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-05-17 20:19:05.725 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-17 20:19:05.742 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 20:19:05.833 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email username AuthService
2019-05-17 20:19:05.845 +04:00 [DBG] End userinfo request
2019-05-17 21:18:14.759 +04:00 [INF] Removing 2 grants
2019-05-17 21:50:19.647 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-05-17 21:50:20.450 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-17 21:50:20.465 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-17 21:50:20.592 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-17 21:50:20.648 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-17 21:50:20.661 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-17 21:50:20.666 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-17 21:50:23.085 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 21:50:23.144 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 21:50:23.162 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-05-17 21:50:23.616 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 21:50:24.343 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 21:50:24.590 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 21:50:26.194 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 21:50:26.264 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 21:50:27.487 +04:00 [WRN] User null validation failed: DuplicateUserName.
2019-05-17 21:50:29.280 +04:00 [DBG] Starting grant removal
2019-05-17 21:51:19.737 +04:00 [DBG] Login Url: /Account/Login
2019-05-17 21:51:19.774 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-17 21:51:19.791 +04:00 [DBG] Logout Url: /Account/Logout
2019-05-17 21:51:19.793 +04:00 [DBG] ConsentUrl Url: /consent
2019-05-17 21:51:19.798 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-17 21:51:19.807 +04:00 [DBG] Error Url: /home/error
2019-05-17 21:51:19.809 +04:00 [DBG] Error Id Parameter: errorId
2019-05-17 21:51:20.041 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-17 21:51:20.096 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-17 21:51:20.130 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-17 21:51:20.192 +04:00 [DBG] Start discovery request
2019-05-17 21:51:22.059 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-05-17 21:51:23.995 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-17 21:51:24.142 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-17 21:51:24.292 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-17 21:51:24.496 +04:00 [DBG] Start key discovery request
2019-05-17 21:51:27.890 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-17 21:51:27.915 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-17 21:51:27.922 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-17 21:51:27.948 +04:00 [DBG] Start authorize request
2019-05-17 21:51:28.031 +04:00 [DBG] User in authorize request: 4
2019-05-17 21:51:28.092 +04:00 [DBG] Start authorize request protocol validation
2019-05-17 21:51:31.075 +04:00 [DBG] StudLab found in database: true
2019-05-17 21:51:31.117 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 21:51:31.160 +04:00 [DBG] Checking for PKCE parameters
2019-05-17 21:51:31.177 +04:00 [DBG] No PKCE used.
2019-05-17 21:51:31.561 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 21:51:31.838 +04:00 [DBG] Found [] API scopes in database
2019-05-17 21:51:31.936 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 21:51:31.954 +04:00 [DBG] Found [] API scopes in database
2019-05-17 21:51:31.992 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-17 21:51:32.088 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"4","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8D73mgAamspIvsbnstRoK8_sX8xPsDMZNKamjJniZMe7Y9DEJr6CBPAq_igOrdW3-QYFJWWmatiIQj805EFrJD06DCseCZQKckE-4uIyLOwBSUmPwWbRieIvt9-4lH5hu2womeHvJ-AQNMzvi6lgx-QoCWqLwQf1JK2INrz5iAL4fbkUCGQ_LukPIvO2d-JH8BA2yM_q-8r596N0w7c4ocuEYnCTROMw8PaFxtSRdddvHhwDIILJwrZ_OHQSUPVyNE2oNm-FAtJypMmgVbXD66QZgK9WGhid9xLKmPtVni96","UiLocales":null,"Nonce":"636937122862370422.NmRjN2ZiZDQtZGVlZi00M2UyLTlmOWItZGY3Mzg1ZTc4YjEwMjZiZjgzMDUtNjdkZi00ZDgxLTg1NTQtMjdkMGI5YjI3ODdj","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"03c9ed8df865fc1416b5e594cf8052ad","Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636937122862370422.NmRjN2ZiZDQtZGVlZi00M2UyLTlmOWItZGY3Mzg1ZTc4YjEwMjZiZjgzMDUtNjdkZi00ZDgxLTg1NTQtMjdkMGI5YjI3ODdj","state":"CfDJ8D73mgAamspIvsbnstRoK8_sX8xPsDMZNKamjJniZMe7Y9DEJr6CBPAq_igOrdW3-QYFJWWmatiIQj805EFrJD06DCseCZQKckE-4uIyLOwBSUmPwWbRieIvt9-4lH5hu2womeHvJ-AQNMzvi6lgx-QoCWqLwQf1JK2INrz5iAL4fbkUCGQ_LukPIvO2d-JH8BA2yM_q-8r596N0w7c4ocuEYnCTROMw8PaFxtSRdddvHhwDIILJwrZ_OHQSUPVyNE2oNm-FAtJypMmgVbXD66QZgK9WGhid9xLKmPtVni96","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-17 21:51:32.475 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-05-17 21:51:32.510 +04:00 [DBG] Creating Hybrid Flow response.
2019-05-17 21:51:32.809 +04:00 [DBG] 7wjL/e1YrD3gSJ9lrG29u2e1PYDCKdU2bfBmiv/31gU= not found in database
2019-05-17 21:51:33.699 +04:00 [DBG] Creating Implicit Flow response.
2019-05-17 21:51:33.871 +04:00 [DBG] Getting claims for identity token for subject: 4 and client: StudLab
2019-05-17 21:52:04.675 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-17 21:52:07.035 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"4","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****5-yQ","$type":"Token"},{"TokenType":"code","TokenValue":"****8afb","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLMQU11V6VU4:00000001","TimeStamp":"2019-05-17T17:52:07.0000000Z","ProcessId":18752,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-17 21:52:07.150 +04:00 [INF] Authorize endpoint response
{"SubjectId":"4","ClientId":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8D73mgAamspIvsbnstRoK8_sX8xPsDMZNKamjJniZMe7Y9DEJr6CBPAq_igOrdW3-QYFJWWmatiIQj805EFrJD06DCseCZQKckE-4uIyLOwBSUmPwWbRieIvt9-4lH5hu2womeHvJ-AQNMzvi6lgx-QoCWqLwQf1JK2INrz5iAL4fbkUCGQ_LukPIvO2d-JH8BA2yM_q-8r596N0w7c4ocuEYnCTROMw8PaFxtSRdddvHhwDIILJwrZ_OHQSUPVyNE2oNm-FAtJypMmgVbXD66QZgK9WGhid9xLKmPtVni96","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-17 21:52:08.999 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-17 21:52:09.161 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-17 21:52:09.179 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-17 21:52:09.290 +04:00 [DBG] Start token request.
2019-05-17 21:52:09.367 +04:00 [DBG] Start client validation
2019-05-17 21:52:09.422 +04:00 [DBG] Start parsing Basic Authentication secret
2019-05-17 21:52:09.473 +04:00 [DBG] Start parsing for secret in post body
2019-05-17 21:52:09.613 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-17 21:52:09.621 +04:00 [DBG] Secret id found: StudLab
2019-05-17 21:52:09.660 +04:00 [DBG] StudLab found in database: true
2019-05-17 21:52:09.662 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 21:52:09.713 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-17 21:52:09.717 +04:00 [DBG] Client validation success
2019-05-17 21:52:09.722 +04:00 [INF] {"ClientId":"StudLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLMQU11V6VU3:00000003","TimeStamp":"2019-05-17T17:52:09.0000000Z","ProcessId":18752,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-17 21:52:09.780 +04:00 [DBG] Start token request validation
2019-05-17 21:52:09.918 +04:00 [DBG] Start validation of authorization code token request
2019-05-17 21:52:10.003 +04:00 [DBG] 7wjL/e1YrD3gSJ9lrG29u2e1PYDCKdU2bfBmiv/31gU= found in database: true
2019-05-17 21:52:10.171 +04:00 [DBG] removing 7wjL/e1YrD3gSJ9lrG29u2e1PYDCKdU2bfBmiv/31gU= persisted grant from database
2019-05-17 21:52:10.952 +04:00 [DBG] Validation of authorization code token request success
2019-05-17 21:52:11.028 +04:00 [INF] Token request validation success
{"ClientId":"StudLab","ClientName":"StudLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"d48b2fabfcb5ca12ed138ba76e24e95fa7084d8c52a23598d1ff748cdc9f8afb","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"StudLab","client_secret":"***REDACTED***","code":"d48b2fabfcb5ca12ed138ba76e24e95fa7084d8c52a23598d1ff748cdc9f8afb","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-05-17 21:52:11.393 +04:00 [DBG] StudLab found in database: true
2019-05-17 21:52:11.395 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 21:52:11.525 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 21:52:11.587 +04:00 [DBG] Found [] API scopes in database
2019-05-17 21:52:11.650 +04:00 [DBG] Getting claims for access token for client: StudLab
2019-05-17 21:52:11.656 +04:00 [DBG] Getting claims for access token for subject: 4
2019-05-17 21:52:11.828 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-17 21:52:11.913 +04:00 [DBG] Creating refresh token
2019-05-17 21:52:11.923 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-05-17 21:52:12.037 +04:00 [DBG] /IcQn1Kg67a54/fg53BfkTD8JE0v3y6vTPdEh9f03/U= not found in database
2019-05-17 21:52:12.105 +04:00 [DBG] StudLab found in database: true
2019-05-17 21:52:12.107 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 21:52:12.168 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 21:52:12.215 +04:00 [DBG] Found [] API scopes in database
2019-05-17 21:52:12.223 +04:00 [DBG] Getting claims for identity token for subject: 4 and client: StudLab
2019-05-17 21:52:12.503 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-17 21:52:12.550 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****UirA","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****dc40","$type":"Token"},{"TokenType":"access_token","TokenValue":"****4nNA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLMQU11V6VU3:00000003","TimeStamp":"2019-05-17T17:52:12.0000000Z","ProcessId":18752,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-17 21:52:12.593 +04:00 [DBG] Token request success.
2019-05-17 21:52:12.674 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-05-17 21:52:12.707 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-05-17 21:52:12.738 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-05-17 21:52:12.843 +04:00 [DBG] Start userinfo request
2019-05-17 21:52:12.926 +04:00 [DBG] Bearer token found in header
2019-05-17 21:52:13.632 +04:00 [DBG] StudLab found in database: true
2019-05-17 21:52:13.633 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 21:52:13.678 +04:00 [DBG] StudLab found in database: true
2019-05-17 21:52:13.680 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-05-17 21:52:13.798 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-05-17 21:52:13.812 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1558115531,"exp":1558119131,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"StudLab","sub":"4","auth_time":1558109938,"idp":"local","AspNet.Identity.SecurityStamp":"SMEWCFOPKGR2ER6A74KB2DZBDEUNFFQJ","role":"GodAdmin","preferred_username":"dereguzov1@yandex.ru","name":"dereguzov1@yandex.ru","email":"dereguzov1@yandex.ru","email_verified":false,"given_name":"dereguzov1@yandex.ru","username":"","AuthService":"StudLabs","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-05-17 21:52:13.982 +04:00 [DBG] Creating userinfo response
2019-05-17 21:52:14.007 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-17 21:52:14.042 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-17 21:52:14.117 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 21:52:14.126 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-05-17 21:52:14.170 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-05-17 21:52:14.209 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-17 21:52:16.173 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email username AuthService
2019-05-17 21:52:16.386 +04:00 [DBG] End userinfo request
2019-06-04 20:21:31.403 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-06-04 20:21:31.628 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-04 20:21:31.632 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-04 20:21:31.633 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-04 20:21:31.634 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-04 20:21:31.635 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-04 20:21:31.645 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-04 20:21:32.457 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-06-04 20:21:32.479 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-06-04 20:21:32.483 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-06-04 20:21:33.293 +04:00 [ERR] Failed executing DbCommand (382ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p2='?' (Size = 256), @p3='?' (DbType = Boolean), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTimeOffset), @p8='?' (Size = 4000), @p9='?' (Size = 256), @p10='?' (Size = 256), @p11='?' (Size = 4000), @p12='?' (Size = 4000), @p13='?' (DbType = Boolean), @p14='?' (Size = 4000), @p15='?' (DbType = Boolean), @p16='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [AspNetUsers] ([AccessFailedCount], [ConcurrencyStamp], [Email], [EmailConfirmed], [FirstName], [LastName], [LockoutEnabled], [LockoutEnd], [Login], [NormalizedEmail], [NormalizedUserName], [PasswordHash], [PhoneNumber], [PhoneNumberConfirmed], [SecurityStamp], [TwoFactorEnabled], [UserName])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
SELECT [Id]
FROM [AspNetUsers]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
System.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Login', table 'AuthService.dbo.AspNetUsers'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
ClientConnectionId:bae41b02-9f01-49e6-a804-06974f711287
Error Number:515,State:2,Class:16
2019-06-04 20:21:34.207 +04:00 [ERR] An exception occurred in the database while saving changes for context type 'AuthServiceServer.Models.Data.UsersDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: Cannot insert the value NULL into column 'Login', table 'AuthService.dbo.AspNetUsers'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: Cannot insert the value NULL into column 'Login', table 'AuthService.dbo.AspNetUsers'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2019-06-04 20:21:35.493 +04:00 [FTL] Application startup exception
System.AggregateException: One or more errors occurred. (An error occurred while updating the entries. See the inner exception for details.) ---> Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: Cannot insert the value NULL into column 'Login', table 'AuthService.dbo.AspNetUsers'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Identity.EntityFrameworkCore.UserStore`9.CreateAsync(TUser user, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Identity.UserManager`1.CreateAsync(TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.CreateAsync(TUser user, String password)
   at AuthServiceServer.Services.InitDataService.AddTestUsers() in D:\Projects\StudLab\AuthServiceServer\Services\InitDataService.cs:line 36
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.Wait(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at System.Threading.Tasks.Task.Wait()
   at AuthServiceServer.Services.InitDataService.Init() in D:\Projects\StudLab\AuthServiceServer\Services\InitDataService.cs:line 27
   at AuthServiceServer.Startup.Configure(IApplicationBuilder app, IHostingEnvironment env, InitDataService seed) in D:\Projects\StudLab\AuthServiceServer\Startup.cs:line 147
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.Internal.AutoRequestServicesStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()
---> (Inner Exception #0) Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: Cannot insert the value NULL into column 'Login', table 'AuthService.dbo.AspNetUsers'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Identity.EntityFrameworkCore.UserStore`9.CreateAsync(TUser user, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Identity.UserManager`1.CreateAsync(TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.CreateAsync(TUser user, String password)
   at AuthServiceServer.Services.InitDataService.AddTestUsers() in D:\Projects\StudLab\AuthServiceServer\Services\InitDataService.cs:line 36<---

2019-06-04 21:27:03.777 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-06-04 21:27:04.058 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-04 21:27:04.064 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-04 21:27:04.065 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-04 21:27:04.066 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-04 21:27:04.067 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-04 21:27:04.068 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-04 21:27:04.998 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-06-04 21:27:05.030 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-06-04 21:27:05.037 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-06-04 21:27:06.085 +04:00 [ERR] Failed executing DbCommand (427ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p2='?' (Size = 256), @p3='?' (DbType = Boolean), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTimeOffset), @p8='?' (Size = 4000), @p9='?' (Size = 256), @p10='?' (Size = 256), @p11='?' (Size = 4000), @p12='?' (Size = 4000), @p13='?' (DbType = Boolean), @p14='?' (Size = 4000), @p15='?' (DbType = Boolean), @p16='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [AspNetUsers] ([AccessFailedCount], [ConcurrencyStamp], [Email], [EmailConfirmed], [FirstName], [LastName], [LockoutEnabled], [LockoutEnd], [Login], [NormalizedEmail], [NormalizedUserName], [PasswordHash], [PhoneNumber], [PhoneNumberConfirmed], [SecurityStamp], [TwoFactorEnabled], [UserName])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
SELECT [Id]
FROM [AspNetUsers]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
System.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Login', table 'AuthService.dbo.AspNetUsers'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
ClientConnectionId:17661ee7-95f7-4a73-a53d-8c6dba0693c3
Error Number:515,State:2,Class:16
2019-06-04 21:27:07.852 +04:00 [ERR] An exception occurred in the database while saving changes for context type 'AuthServiceServer.Models.Data.UsersDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: Cannot insert the value NULL into column 'Login', table 'AuthService.dbo.AspNetUsers'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: Cannot insert the value NULL into column 'Login', table 'AuthService.dbo.AspNetUsers'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2019-06-04 21:27:09.038 +04:00 [FTL] Application startup exception
System.AggregateException: One or more errors occurred. (An error occurred while updating the entries. See the inner exception for details.) ---> Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: Cannot insert the value NULL into column 'Login', table 'AuthService.dbo.AspNetUsers'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Identity.EntityFrameworkCore.UserStore`9.CreateAsync(TUser user, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Identity.UserManager`1.CreateAsync(TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.CreateAsync(TUser user, String password)
   at AuthServiceServer.Services.InitDataService.AddTestUsers() in D:\Projects\StudLab\AuthServiceServer\Services\InitDataService.cs:line 36
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.Wait(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at System.Threading.Tasks.Task.Wait()
   at AuthServiceServer.Services.InitDataService.Init() in D:\Projects\StudLab\AuthServiceServer\Services\InitDataService.cs:line 27
   at AuthServiceServer.Startup.Configure(IApplicationBuilder app, IHostingEnvironment env, InitDataService seed) in D:\Projects\StudLab\AuthServiceServer\Startup.cs:line 147
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.Internal.AutoRequestServicesStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()
---> (Inner Exception #0) Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: Cannot insert the value NULL into column 'Login', table 'AuthService.dbo.AspNetUsers'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Identity.EntityFrameworkCore.UserStore`9.CreateAsync(TUser user, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Identity.UserManager`1.CreateAsync(TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.CreateAsync(TUser user, String password)
   at AuthServiceServer.Services.InitDataService.AddTestUsers() in D:\Projects\StudLab\AuthServiceServer\Services\InitDataService.cs:line 36<---

2019-06-04 21:31:51.229 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-06-04 21:31:51.387 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-04 21:31:51.390 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-04 21:31:51.391 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-04 21:31:51.392 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-04 21:31:51.392 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-04 21:31:51.393 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-04 21:31:52.135 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-06-04 21:31:52.160 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-06-04 21:31:52.164 +04:00 [WRN] Role null validation failed: DuplicateRoleName.
2019-06-04 21:31:52.958 +04:00 [ERR] Failed executing DbCommand (356ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p2='?' (Size = 256), @p3='?' (DbType = Boolean), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTimeOffset), @p8='?' (Size = 4000), @p9='?' (Size = 256), @p10='?' (Size = 256), @p11='?' (Size = 4000), @p12='?' (Size = 4000), @p13='?' (DbType = Boolean), @p14='?' (Size = 4000), @p15='?' (DbType = Boolean), @p16='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [AspNetUsers] ([AccessFailedCount], [ConcurrencyStamp], [Email], [EmailConfirmed], [FirstName], [LastName], [LockoutEnabled], [LockoutEnd], [Login], [NormalizedEmail], [NormalizedUserName], [PasswordHash], [PhoneNumber], [PhoneNumberConfirmed], [SecurityStamp], [TwoFactorEnabled], [UserName])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
SELECT [Id]
FROM [AspNetUsers]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
System.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Login', table 'AuthService.dbo.AspNetUsers'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
ClientConnectionId:a0b436d7-24a2-45eb-b179-c043ed1c9b5d
Error Number:515,State:2,Class:16
2019-06-04 21:31:54.015 +04:00 [ERR] An exception occurred in the database while saving changes for context type 'AuthServiceServer.Models.Data.UsersDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: Cannot insert the value NULL into column 'Login', table 'AuthService.dbo.AspNetUsers'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: Cannot insert the value NULL into column 'Login', table 'AuthService.dbo.AspNetUsers'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2019-06-04 21:31:55.361 +04:00 [FTL] Application startup exception
System.AggregateException: One or more errors occurred. (An error occurred while updating the entries. See the inner exception for details.) ---> Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: Cannot insert the value NULL into column 'Login', table 'AuthService.dbo.AspNetUsers'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Identity.EntityFrameworkCore.UserStore`9.CreateAsync(TUser user, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Identity.UserManager`1.CreateAsync(TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.CreateAsync(TUser user, String password)
   at AuthServiceServer.Services.InitDataService.AddTestUsers() in D:\Projects\StudLab\AuthServiceServer\Services\InitDataService.cs:line 36
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.Wait(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at System.Threading.Tasks.Task.Wait()
   at AuthServiceServer.Services.InitDataService.Init() in D:\Projects\StudLab\AuthServiceServer\Services\InitDataService.cs:line 27
   at AuthServiceServer.Startup.Configure(IApplicationBuilder app, IHostingEnvironment env, InitDataService seed) in D:\Projects\StudLab\AuthServiceServer\Startup.cs:line 147
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.Internal.AutoRequestServicesStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()
---> (Inner Exception #0) Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: Cannot insert the value NULL into column 'Login', table 'AuthService.dbo.AspNetUsers'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Identity.EntityFrameworkCore.UserStore`9.CreateAsync(TUser user, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Identity.UserManager`1.CreateAsync(TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.CreateAsync(TUser user, String password)
   at AuthServiceServer.Services.InitDataService.AddTestUsers() in D:\Projects\StudLab\AuthServiceServer\Services\InitDataService.cs:line 36<---

2019-06-04 21:33:16.243 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-06-04 21:33:16.524 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-04 21:33:16.527 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-04 21:33:16.528 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-04 21:33:16.529 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-04 21:33:16.530 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-04 21:33:16.531 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-04 21:33:17.517 +04:00 [DBG] Starting grant removal
2019-06-04 21:33:29.957 +04:00 [DBG] Login Url: /Account/Login
2019-06-04 21:33:29.973 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-04 21:33:29.977 +04:00 [DBG] Logout Url: /Account/Logout
2019-06-04 21:33:30.015 +04:00 [DBG] ConsentUrl Url: /consent
2019-06-04 21:33:30.027 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-04 21:33:30.058 +04:00 [DBG] Error Url: /home/error
2019-06-04 21:33:30.074 +04:00 [DBG] Error Id Parameter: errorId
2019-06-04 21:33:30.308 +04:00 [INF] Identity.Application was not authenticated. Failure message: Ticket expired
2019-06-04 21:33:30.382 +04:00 [INF] Identity.Application was not authenticated. Failure message: Ticket expired
2019-06-04 21:33:30.625 +04:00 [WRN] Failed to determine the https port for redirect.
2019-06-04 21:33:42.025 +04:00 [INF] Identity.Application was not authenticated. Failure message: Ticket expired
2019-06-04 21:33:42.041 +04:00 [INF] Identity.Application was not authenticated. Failure message: Ticket expired
2019-06-04 21:33:44.754 +04:00 [INF] Identity.Application was not authenticated. Failure message: Ticket expired
2019-06-04 21:33:44.763 +04:00 [INF] Identity.Application was not authenticated. Failure message: Ticket expired
2019-06-04 21:33:49.201 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at AuthServiceServer.Controllers.AccountController.Login(LoginModel model) in D:\Projects\StudLab\AuthServiceServer\Controllers\AccountController.cs:line 94
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-06-04 21:34:21.498 +04:00 [INF] Identity.Application was not authenticated. Failure message: Ticket expired
2019-06-04 21:34:21.502 +04:00 [INF] Identity.Application was not authenticated. Failure message: Ticket expired
2019-06-04 21:35:37.565 +04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-06-04 21:35:37.833 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-04 21:35:37.855 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-04 21:35:37.877 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-04 21:35:37.880 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-04 21:35:37.920 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-04 21:35:37.921 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-04 21:35:38.498 +04:00 [DBG] Starting grant removal
2019-06-04 21:35:39.192 +04:00 [DBG] Login Url: /Account/Login
2019-06-04 21:35:39.204 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-04 21:35:39.209 +04:00 [DBG] Logout Url: /Account/Logout
2019-06-04 21:35:39.210 +04:00 [DBG] ConsentUrl Url: /consent
2019-06-04 21:35:39.214 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-04 21:35:39.222 +04:00 [DBG] Error Url: /home/error
2019-06-04 21:35:39.224 +04:00 [DBG] Error Id Parameter: errorId
2019-06-04 21:35:39.307 +04:00 [INF] Identity.Application was not authenticated. Failure message: Ticket expired
2019-06-04 21:35:39.350 +04:00 [INF] Identity.Application was not authenticated. Failure message: Ticket expired
2019-06-04 21:35:39.397 +04:00 [WRN] Failed to determine the https port for redirect.
2019-06-04 21:35:48.082 +04:00 [INF] Identity.Application was not authenticated. Failure message: Ticket expired
2019-06-04 21:35:48.108 +04:00 [INF] Identity.Application was not authenticated. Failure message: Ticket expired
2019-06-04 21:35:53.616 +04:00 [INF] {"Username":"dereguzov1@yandex.ru","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLN92C7IB1TV:00000003","TimeStamp":"2019-06-04T17:35:53.0000000Z","ProcessId":10736,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-06-04 21:35:57.600 +04:00 [INF] Identity.Application was not authenticated. Failure message: Ticket expired
2019-06-04 21:35:57.610 +04:00 [INF] Identity.Application was not authenticated. Failure message: Ticket expired
2019-06-04 21:35:58.664 +04:00 [INF] Identity.Application was not authenticated. Failure message: Ticket expired
2019-06-04 21:35:58.672 +04:00 [INF] Identity.Application was not authenticated. Failure message: Ticket expired
2019-06-04 21:36:38.018 +04:00 [INF] Identity.Application was not authenticated. Failure message: Ticket expired
2019-06-04 21:36:38.024 +04:00 [INF] Identity.Application was not authenticated. Failure message: Ticket expired
2019-06-04 21:36:39.365 +04:00 [DBG] Augmenting SignInContext
2019-06-04 21:36:39.479 +04:00 [DBG] Adding idp claim with value: local
2019-06-04 21:36:39.480 +04:00 [DBG] Adding amr claim with value: pwd
2019-06-04 21:36:39.486 +04:00 [DBG] Adding auth_time claim with value: 1559669799
2019-06-04 21:36:39.497 +04:00 [INF] Identity.Application was not authenticated. Failure message: Ticket expired
2019-06-04 21:36:39.529 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-04 21:37:37.598 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-04 21:37:37.623 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-04 21:37:37.631 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-04 21:37:37.653 +04:00 [DBG] Start discovery request
2019-06-04 21:37:38.939 +04:00 [DBG] Found ["openid","profile"] as all scopes in database
2019-06-04 21:37:39.354 +04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-04 21:37:39.359 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-04 21:37:39.369 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-04 21:37:39.396 +04:00 [DBG] Start key discovery request
2019-06-04 21:37:39.576 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-04 21:37:39.589 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-04 21:37:39.594 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-04 21:37:39.608 +04:00 [DBG] Start authorize request
2019-06-04 21:37:39.636 +04:00 [DBG] User in authorize request: 5004
2019-06-04 21:37:39.653 +04:00 [DBG] Start authorize request protocol validation
2019-06-04 21:37:40.656 +04:00 [DBG] StudLab found in database: true
2019-06-04 21:37:40.681 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-06-04 21:37:40.705 +04:00 [DBG] Checking for PKCE parameters
2019-06-04 21:37:40.713 +04:00 [DBG] No PKCE used.
2019-06-04 21:37:40.865 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-04 21:37:41.069 +04:00 [DBG] Found [] API scopes in database
2019-06-04 21:37:41.096 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-04 21:37:41.104 +04:00 [DBG] Found [] API scopes in database
2019-06-04 21:37:41.131 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-04 21:37:41.163 +04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","AllowedRedirectUris":["https://localhost:5002/signin-oidc"],"SubjectId":"5004","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8OcXt5ZuVPpDui8SbWsOVer2U9qSQMS-krA4RljC3HieIovdTcyc12R7JWpFHRl8XrwVtJNH2c9JeCqq4S6cLS5d1O7ZiajjyDVQLky9_9rsRLCole3_0ZW67xvv0vq5UIEK5RVGbaFuTZriPMaU8UnpD9Td-RXuK031mhp5Rr9IqnNcwW7pUvTgq584vWBUcU3Lf2n-1Ew2TRLWxKQUhL3BEYC2W1KpR0GO3jLatEnu4dUjzYJfe_JIqzwVFZhVtoJwWd2Cn7YYpoY2okXe5udwkQLAiHCsq5_5tcH4IQSo","UiLocales":null,"Nonce":"636952666595012362.OWJmN2EzMzAtMmE0ZC00MDA5LTllMWYtODU4ZTZiMDMxYmQ1YmY1MjExYTYtYjQzMS00YzI0LTk3NDgtNmVhYmQzZWIyY2Rj","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"c847a75f435418bc3b3eae256d7efc75","Raw":{"client_id":"StudLab","redirect_uri":"https://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access","response_mode":"form_post","nonce":"636952666595012362.OWJmN2EzMzAtMmE0ZC00MDA5LTllMWYtODU4ZTZiMDMxYmQ1YmY1MjExYTYtYjQzMS00YzI0LTk3NDgtNmVhYmQzZWIyY2Rj","state":"CfDJ8OcXt5ZuVPpDui8SbWsOVer2U9qSQMS-krA4RljC3HieIovdTcyc12R7JWpFHRl8XrwVtJNH2c9JeCqq4S6cLS5d1O7ZiajjyDVQLky9_9rsRLCole3_0ZW67xvv0vq5UIEK5RVGbaFuTZriPMaU8UnpD9Td-RXuK031mhp5Rr9IqnNcwW7pUvTgq584vWBUcU3Lf2n-1Ew2TRLWxKQUhL3BEYC2W1KpR0GO3jLatEnu4dUjzYJfe_JIqzwVFZhVtoJwWd2Cn7YYpoY2okXe5udwkQLAiHCsq5_5tcH4IQSo","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-04 21:37:41.333 +04:00 [DBG] Client is configured to not require consent, no consent is required
2019-06-04 21:37:41.355 +04:00 [DBG] Creating Hybrid Flow response.
2019-06-04 21:37:41.531 +04:00 [DBG] PRX58AYNYyzbtEUTEyb68EPFMqQHh8xgvvEyLTVSFkM= not found in database
2019-06-04 21:37:41.663 +04:00 [DBG] Creating Implicit Flow response.
2019-06-04 21:37:41.740 +04:00 [DBG] Getting claims for identity token for subject: 5004 and client: StudLab
2019-06-04 21:37:41.810 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-04 21:37:42.089 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","Endpoint":"Authorize","SubjectId":"5004","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****uELQ","$type":"Token"},{"TokenType":"code","TokenValue":"****4fef","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN92C7IB1TV:0000000B","TimeStamp":"2019-06-04T17:37:42.0000000Z","ProcessId":10736,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-04 21:37:42.113 +04:00 [INF] Authorize endpoint response
{"SubjectId":"5004","ClientId":"StudLab","RedirectUri":"https://localhost:5002/signin-oidc","State":"CfDJ8OcXt5ZuVPpDui8SbWsOVer2U9qSQMS-krA4RljC3HieIovdTcyc12R7JWpFHRl8XrwVtJNH2c9JeCqq4S6cLS5d1O7ZiajjyDVQLky9_9rsRLCole3_0ZW67xvv0vq5UIEK5RVGbaFuTZriPMaU8UnpD9Td-RXuK031mhp5Rr9IqnNcwW7pUvTgq584vWBUcU3Lf2n-1Ew2TRLWxKQUhL3BEYC2W1KpR0GO3jLatEnu4dUjzYJfe_JIqzwVFZhVtoJwWd2Cn7YYpoY2okXe5udwkQLAiHCsq5_5tcH4IQSo","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-04 21:37:42.199 +04:00 [DBG] Augmenting SignInContext
2019-06-04 21:37:42.201 +04:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-04 21:37:42.702 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-04 21:37:42.734 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-04 21:37:42.741 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-04 21:37:42.779 +04:00 [DBG] Start token request.
2019-06-04 21:37:42.806 +04:00 [DBG] Start client validation
2019-06-04 21:37:42.859 +04:00 [DBG] Start parsing Basic Authentication secret
2019-06-04 21:37:42.882 +04:00 [DBG] Start parsing for secret in post body
2019-06-04 21:37:42.901 +04:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-04 21:37:42.905 +04:00 [DBG] Secret id found: StudLab
2019-06-04 21:37:42.921 +04:00 [DBG] StudLab found in database: true
2019-06-04 21:37:42.922 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-06-04 21:37:42.955 +04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-06-04 21:37:42.956 +04:00 [DBG] Client validation success
2019-06-04 21:37:42.960 +04:00 [INF] {"ClientId":"StudLab","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN92C7IB1U6:00000003","TimeStamp":"2019-06-04T17:37:42.0000000Z","ProcessId":10736,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-04 21:37:42.989 +04:00 [DBG] Start token request validation
2019-06-04 21:37:43.049 +04:00 [DBG] Start validation of authorization code token request
2019-06-04 21:37:43.115 +04:00 [DBG] PRX58AYNYyzbtEUTEyb68EPFMqQHh8xgvvEyLTVSFkM= found in database: true
2019-06-04 21:37:43.175 +04:00 [DBG] removing PRX58AYNYyzbtEUTEyb68EPFMqQHh8xgvvEyLTVSFkM= persisted grant from database
2019-06-04 21:37:43.226 +04:00 [DBG] Validation of authorization code token request success
2019-06-04 21:37:43.242 +04:00 [INF] Token request validation success
{"ClientId":"StudLab","ClientName":"StudLab","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"51cd780655585be2628a89b81e1e87679c399ad7a10b42a3df81c2d22a524fef","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"StudLab","client_secret":"***REDACTED***","code":"51cd780655585be2628a89b81e1e87679c399ad7a10b42a3df81c2d22a524fef","grant_type":"authorization_code","redirect_uri":"https://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-06-04 21:37:43.315 +04:00 [DBG] StudLab found in database: true
2019-06-04 21:37:43.316 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-06-04 21:37:43.352 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-04 21:37:43.374 +04:00 [DBG] Found [] API scopes in database
2019-06-04 21:37:43.410 +04:00 [DBG] Getting claims for access token for client: StudLab
2019-06-04 21:37:43.412 +04:00 [DBG] Getting claims for access token for subject: 5004
2019-06-04 21:37:43.438 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-04 21:37:43.479 +04:00 [DBG] Creating refresh token
2019-06-04 21:37:43.482 +04:00 [DBG] Setting an absolute lifetime: 2592000
2019-06-04 21:37:43.529 +04:00 [DBG] XABuGbEAgoAuLS3FcY++Yny/HiLiHqSO1QOSfVCNs78= not found in database
2019-06-04 21:37:43.645 +04:00 [DBG] StudLab found in database: true
2019-06-04 21:37:43.646 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-06-04 21:37:43.656 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-04 21:37:43.664 +04:00 [DBG] Found [] API scopes in database
2019-06-04 21:37:43.667 +04:00 [DBG] Getting claims for identity token for subject: 5004 and client: StudLab
2019-06-04 21:37:43.702 +04:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-04 21:37:43.727 +04:00 [INF] {"ClientId":"StudLab","ClientName":"StudLab","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****9y6w","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****b848","$type":"Token"},{"TokenType":"access_token","TokenValue":"****rdxQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN92C7IB1U6:00000003","TimeStamp":"2019-06-04T17:37:43.0000000Z","ProcessId":10736,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-04 21:37:43.752 +04:00 [DBG] Token request success.
2019-06-04 21:37:43.798 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-04 21:37:43.809 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-04 21:37:43.814 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-04 21:37:43.843 +04:00 [DBG] Start userinfo request
2019-06-04 21:37:43.855 +04:00 [DBG] Bearer token found in header
2019-06-04 21:37:44.628 +04:00 [DBG] StudLab found in database: true
2019-06-04 21:37:44.653 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-06-04 21:37:44.673 +04:00 [DBG] StudLab found in database: true
2019-06-04 21:37:44.674 +04:00 [DBG] client configuration validation for client StudLab succeeded.
2019-06-04 21:37:44.756 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-04 21:37:44.858 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1559669863,"exp":1559673463,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"StudLab","sub":"5004","auth_time":1559669799,"idp":"local","AspNet.Identity.SecurityStamp":"WD7WGPQS2AGWPHYJ4DLQMRE7K2I4ZJSQ","role":"user","preferred_username":"dereguzov1@yandex.ru","name":"dereguzov1@yandex.ru","email":"dereguzov1@yandex.ru","email_verified":false,"given_name":"dereguzov1@yandex.ru","username":"Kirill","AuthService":"StudLabs","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-04 21:37:44.914 +04:00 [DBG] Creating userinfo response
2019-06-04 21:37:44.934 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-06-04 21:37:44.945 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-06-04 21:37:44.966 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-04 21:37:44.970 +04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-06-04 21:37:44.975 +04:00 [DBG] Scopes in access token: openid profile offline_access
2019-06-04 21:37:44.984 +04:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-04 21:37:45.055 +04:00 [INF] Profile service returned the following claim types: sub AspNet.Identity.SecurityStamp role preferred_username name email email_verified given_name email username AuthService
2019-06-04 21:37:45.062 +04:00 [DBG] End userinfo request
